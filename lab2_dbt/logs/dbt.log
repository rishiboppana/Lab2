[0m19:55:12.179615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e517ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea11880>]}


============================== 19:55:12.186929 | e06c8474-27a3-443e-95bf-054879509097 ==============================
[0m19:55:12.186929 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:55:12.187732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:55:13.984546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a71fc50>]}
[0m19:55:14.049736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea13a40>]}
[0m19:55:14.050922 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:55:14.220193 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:55:14.221357 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:55:14.221937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99b920>]}
[0m19:55:15.797907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b30e060>]}
[0m19:55:15.883305 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:55:15.884838 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:55:15.918057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b39cda0>]}
[0m19:55:15.918722 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m19:55:15.919315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b3a82c0>]}
[0m19:55:15.922040 [info ] [MainThread]: 
[0m19:55:15.922526 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m19:55:15.922939 [info ] [MainThread]: 
[0m19:55:15.923570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:55:15.929534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m19:55:16.072467 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m19:55:16.072851 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m19:55:16.073174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:16.810650 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.737 seconds
[0m19:55:16.814100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m19:55:16.827418 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m19:55:16.827916 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m19:55:16.946179 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.118 seconds
[0m19:55:16.948490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c903aa0>]}
[0m19:55:16.953790 [debug] [Thread-1 (]: Began running node model.homework7.my_first_dbt_model
[0m19:55:16.954666 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m19:55:16.955495 [debug] [Thread-2 (]: Began running node model.homework7.session_timestamp
[0m19:55:16.956272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.my_first_dbt_model)
[0m19:55:16.956772 [debug] [Thread-3 (]: Began running node model.homework7.user_session_channel
[0m19:55:16.957392 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.homework7.session_timestamp'
[0m19:55:16.957877 [debug] [Thread-1 (]: Began compiling node model.homework7.my_first_dbt_model
[0m19:55:16.958477 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m19:55:16.958979 [debug] [Thread-2 (]: Began compiling node model.homework7.session_timestamp
[0m19:55:16.969943 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.my_first_dbt_model"
[0m19:55:16.970581 [debug] [Thread-3 (]: Began compiling node model.homework7.user_session_channel
[0m19:55:16.973930 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m19:55:16.977308 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m19:55:16.978997 [debug] [Thread-3 (]: Finished running node model.homework7.user_session_channel
[0m19:55:16.979790 [debug] [Thread-2 (]: Finished running node model.homework7.session_timestamp
[0m19:55:16.980416 [debug] [Thread-1 (]: Began executing node model.homework7.my_first_dbt_model
[0m19:55:17.004452 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m19:55:17.011371 [info ] [Thread-5 (]: 2 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m19:55:17.019630 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m19:55:17.020793 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.my_first_dbt_model"
[0m19:55:17.021271 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m19:55:17.026461 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m19:55:17.027351 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m19:55:17.030696 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m19:55:17.031875 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.my_first_dbt_model"
[0m19:55:17.032336 [debug] [Thread-1 (]: On model.homework7.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.my_first_dbt_model"} */
create or replace transient table user_db_lobster.analytics.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:55:17.033463 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m19:55:17.034603 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (with __dbt__cte__user_session_channel as (
SELECT
 userId,
 sessionId,
 channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
),  __dbt__cte__session_timestamp as (
SELECT
 sessionId,
 ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
) SELECT u.userId, u.sessionId, u.channel, st.ts
FROM __dbt__cte__user_session_channel u
JOIN __dbt__cte__session_timestamp st ON u.sessionId = st.sessionId
        );
[0m19:55:17.035053 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m19:55:18.144621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m19:55:18.174721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c845670>]}
[0m19:55:18.175610 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.my_first_dbt_model ................. [[32mSUCCESS 1[0m in 1.22s]
[0m19:55:18.176424 [debug] [Thread-1 (]: Finished running node model.homework7.my_first_dbt_model
[0m19:55:18.177086 [debug] [Thread-3 (]: Began running node model.homework7.my_second_dbt_model
[0m19:55:18.177777 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m19:55:18.178359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.homework7.user_session_channel, now model.homework7.my_second_dbt_model)
[0m19:55:18.178826 [debug] [Thread-3 (]: Began compiling node model.homework7.my_second_dbt_model
[0m19:55:18.182227 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.my_second_dbt_model"
[0m19:55:18.183047 [debug] [Thread-3 (]: Began executing node model.homework7.my_second_dbt_model
[0m19:55:18.209689 [debug] [Thread-3 (]: Writing runtime sql for node "model.homework7.my_second_dbt_model"
[0m19:55:18.210875 [debug] [Thread-3 (]: Using snowflake connection "model.homework7.my_second_dbt_model"
[0m19:55:18.211330 [debug] [Thread-3 (]: On model.homework7.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.my_second_dbt_model"} */
create or replace   view user_db_lobster.analytics.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from user_db_lobster.analytics.my_first_dbt_model
where id = 1
  );
[0m19:55:18.211754 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:55:18.753705 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m19:55:18.757526 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8d7ef0>]}
[0m19:55:18.758429 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics.my_second_dbt_model ................. [[32mSUCCESS 1[0m in 0.58s]
[0m19:55:18.759358 [debug] [Thread-3 (]: Finished running node model.homework7.my_second_dbt_model
[0m19:55:19.002112 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.967 seconds
[0m19:55:19.005224 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f9cd0>]}
[0m19:55:19.006020 [info ] [Thread-5 (]: 2 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.99s]
[0m19:55:19.006823 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m19:55:19.008534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:19.008940 [debug] [MainThread]: Connection 'model.homework7.my_first_dbt_model' was left open.
[0m19:55:19.009394 [debug] [MainThread]: On model.homework7.my_first_dbt_model: Close
[0m19:55:19.129271 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was properly closed.
[0m19:55:19.129753 [debug] [MainThread]: Connection 'model.homework7.my_second_dbt_model' was left open.
[0m19:55:19.130171 [debug] [MainThread]: On model.homework7.my_second_dbt_model: Close
[0m19:55:19.258674 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m19:55:19.259180 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m19:55:19.384631 [info ] [MainThread]: 
[0m19:55:19.385271 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m19:55:19.386941 [debug] [MainThread]: Command end result
[0m19:55:19.414577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:55:19.416391 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:55:19.424349 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m19:55:19.424803 [info ] [MainThread]: 
[0m19:55:19.425290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:55:19.425829 [info ] [MainThread]: 
[0m19:55:19.426286 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:55:19.428866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3337502, "process_in_blocks": "0", "process_kernel_time": 1.117654, "process_mem_max_rss": "195088384", "process_out_blocks": "0", "process_user_time": 5.872046}
[0m19:55:19.429520 [debug] [MainThread]: Command `dbt run` succeeded at 19:55:19.429366 after 7.33 seconds
[0m19:55:19.430023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e517ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b1c30b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b1677d0>]}
[0m19:55:19.430508 [debug] [MainThread]: Flushing usage events
[0m19:55:19.798078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:58:23.965512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127491c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132bf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113325c70>]}


============================== 19:58:23.972267 | 429e1f80-c50e-43c6-a8e8-b41cdba8d774 ==============================
[0m19:58:23.972267 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:58:23.973061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select input', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:58:25.335475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11346a1b0>]}
[0m19:58:25.400804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f58bdd0>]}
[0m19:58:25.401682 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:58:25.553780 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:58:25.728073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:58:25.728449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:58:25.775002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f7773e0>]}
[0m19:58:25.864132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:58:25.865978 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:58:25.880901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9d01a0>]}
[0m19:58:25.881456 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m19:58:25.881880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fad6c90>]}
[0m19:58:25.883938 [info ] [MainThread]: 
[0m19:58:25.884376 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m19:58:25.884791 [info ] [MainThread]: 
[0m19:58:25.885484 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:58:25.891004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m19:58:25.966191 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m19:58:25.966576 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m19:58:25.966886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:26.793772 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb8552-0104-e645-0004-59ff001a11da
[0m19:58:26.794285 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:58:26.794831 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:58:26.795252 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:58:26.796026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9a6ba0>]}
[0m19:58:26.798964 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m19:58:26.799495 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m19:58:26.800033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m19:58:26.800674 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m19:58:26.801165 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m19:58:26.801675 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m19:58:26.812012 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m19:58:26.815029 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m19:58:26.816339 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m19:58:26.817197 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m19:58:26.818665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:26.819045 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m19:58:26.819428 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m19:58:26.938584 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was properly closed.
[0m19:58:26.939273 [info ] [MainThread]: 
[0m19:58:26.939896 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m19:58:26.940716 [debug] [MainThread]: Command end result
[0m19:58:27.049482 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:58:27.051333 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:58:27.055663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m19:58:27.059055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1718254, "process_in_blocks": "0", "process_kernel_time": 0.86305, "process_mem_max_rss": "188960768", "process_out_blocks": "0", "process_user_time": 3.960714}
[0m19:58:27.059793 [debug] [MainThread]: Command `dbt run` succeeded at 19:58:27.059636 after 3.17 seconds
[0m19:58:27.060328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11828a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9f5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9f45c0>]}
[0m19:58:27.060842 [debug] [MainThread]: Flushing usage events
[0m19:58:27.430290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:12.522910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110357290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110885b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110885760>]}


============================== 19:59:12.528458 | 45f36b96-f4cd-44d0-b854-84dd613a4944 ==============================
[0m19:59:12.528458 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:59:12.529218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select input', 'send_anonymous_usage_stats': 'True'}
[0m19:59:13.725940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c7bf920>]}
[0m19:59:13.790066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4450a0>]}
[0m19:59:13.790865 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:59:13.940141 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:59:14.095659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:14.096039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:14.141823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cc1b740>]}
[0m19:59:14.226429 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:59:14.228342 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:59:14.243856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cf73020>]}
[0m19:59:14.244393 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m19:59:14.244811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ce798b0>]}
[0m19:59:14.246719 [info ] [MainThread]: 
[0m19:59:14.247142 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m19:59:14.247505 [info ] [MainThread]: 
[0m19:59:14.248088 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:59:14.253446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m19:59:14.329444 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m19:59:14.329834 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m19:59:14.330144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:14.973237 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.643 seconds
[0m19:59:14.976032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cad16d0>]}
[0m19:59:14.979010 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m19:59:14.979590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m19:59:14.980084 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m19:59:14.986002 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m19:59:14.990761 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m19:59:14.991451 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m19:59:14.992227 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m19:59:14.995724 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m19:59:14.996761 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m19:59:14.997826 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m19:59:14.999383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:14.999786 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m19:59:15.000196 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m19:59:15.150492 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was properly closed.
[0m19:59:15.150987 [info ] [MainThread]: 
[0m19:59:15.151448 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m19:59:15.152262 [debug] [MainThread]: Command end result
[0m19:59:15.338563 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:59:15.340529 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:59:15.344666 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m19:59:15.347174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8970356, "process_in_blocks": "0", "process_kernel_time": 0.832286, "process_mem_max_rss": "188100608", "process_out_blocks": "0", "process_user_time": 3.797138}
[0m19:59:15.347829 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:15.347679 after 2.90 seconds
[0m19:59:15.348335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c90e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c90c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105192b0>]}
[0m19:59:15.348818 [debug] [MainThread]: Flushing usage events
[0m19:59:15.683641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:25.604612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11281c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11298dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11298d880>]}


============================== 20:01:25.610013 | 04373792-94bb-4cdd-a227-00737c900e62 ==============================
[0m20:01:25.610013 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:01:25.610723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select output', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:01:26.774320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177c3170>]}
[0m20:01:26.839640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c2b8c0>]}
[0m20:01:26.840483 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:01:26.990153 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:01:27.146621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:27.147134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:27.193875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112968740>]}
[0m20:01:27.277177 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:01:27.279084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:01:27.292974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ef2b710>]}
[0m20:01:27.293433 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m20:01:27.293784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b3f80>]}
[0m20:01:27.295438 [info ] [MainThread]: 
[0m20:01:27.295799 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:01:27.296111 [info ] [MainThread]: 
[0m20:01:27.296649 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:01:27.297479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m20:01:27.375768 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m20:01:27.376232 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m20:01:27.376607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:27.957263 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.581 seconds
[0m20:01:27.965871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m20:01:27.979233 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:01:27.979738 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:01:28.099894 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.120 seconds
[0m20:01:28.102171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ef29460>]}
[0m20:01:28.105370 [debug] [Thread-1 (]: Began running node model.homework7.session_summary
[0m20:01:28.106038 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m20:01:28.106739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_summary)
[0m20:01:28.107331 [debug] [Thread-1 (]: Began compiling node model.homework7.session_summary
[0m20:01:28.120549 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m20:01:28.124541 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m20:01:28.127037 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m20:01:28.127790 [debug] [Thread-1 (]: Began executing node model.homework7.session_summary
[0m20:01:28.166927 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m20:01:28.168511 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_summary"
[0m20:01:28.168989 [debug] [Thread-1 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (with __dbt__cte__user_session_channel as (
SELECT
 userId,
 sessionId,
 channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
),  __dbt__cte__session_timestamp as (
SELECT
 sessionId,
 ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
) SELECT u.userId, u.sessionId, u.channel, st.ts
FROM __dbt__cte__user_session_channel u
JOIN __dbt__cte__session_timestamp st ON u.sessionId = st.sessionId
        );
[0m20:01:29.483793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.314 seconds
[0m20:01:29.513699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de5940>]}
[0m20:01:29.514498 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.41s]
[0m20:01:29.515285 [debug] [Thread-1 (]: Finished running node model.homework7.session_summary
[0m20:01:29.516862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:29.517283 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m20:01:29.517762 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m20:01:29.638349 [info ] [MainThread]: 
[0m20:01:29.639068 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m20:01:29.640304 [debug] [MainThread]: Command end result
[0m20:01:29.750423 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:01:29.752344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:01:29.760163 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:01:29.760594 [info ] [MainThread]: 
[0m20:01:29.761107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:29.761551 [info ] [MainThread]: 
[0m20:01:29.762001 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:01:29.764583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.233984, "process_in_blocks": "0", "process_kernel_time": 0.812591, "process_mem_max_rss": "187310080", "process_out_blocks": "0", "process_user_time": 3.92447}
[0m20:01:29.765224 [debug] [MainThread]: Command `dbt run` succeeded at 20:01:29.765073 after 4.23 seconds
[0m20:01:29.765722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8cf5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d07a0>]}
[0m20:01:29.766198 [debug] [MainThread]: Flushing usage events
[0m20:01:30.135358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:13.194940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107286de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109579ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109579910>]}


============================== 20:03:13.200499 | 912167af-477b-450e-bfc8-5cb4bf361ead ==============================
[0m20:03:13.200499 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:03:13.201215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select input', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:03:14.396026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a150d0>]}
[0m20:03:14.460643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457742c0>]}
[0m20:03:14.461448 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:03:14.608594 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:03:14.739409 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:03:14.739884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908b2c0>]}
[0m20:03:16.234342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145bce630>]}
[0m20:03:16.314579 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:03:16.316167 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:03:16.329619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c536f30>]}
[0m20:03:16.330067 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m20:03:16.330413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107463dd0>]}
[0m20:03:16.331922 [info ] [MainThread]: 
[0m20:03:16.332268 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:03:16.332571 [info ] [MainThread]: 
[0m20:03:16.333045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:16.337309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m20:03:16.400551 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m20:03:16.400931 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m20:03:16.401224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:16.961980 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.561 seconds
[0m20:03:16.965400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m20:03:16.978794 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:03:16.979428 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:03:17.110364 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m20:03:17.113785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145dbedb0>]}
[0m20:03:17.118050 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m20:03:17.118745 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.session_timestamp ........................ [RUN]
[0m20:03:17.119336 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m20:03:17.119869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m20:03:17.120503 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics.user_session_channel ..................... [RUN]
[0m20:03:17.121120 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m20:03:17.121784 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m20:03:17.131742 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m20:03:17.132293 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m20:03:17.135687 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m20:03:17.136513 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m20:03:17.143369 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m20:03:17.197920 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m20:03:17.194759 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m20:03:17.199217 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m20:03:17.199673 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    SELECT
 userId,
 sessionId,
 channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
  );
[0m20:03:17.200121 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:03:17.201579 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m20:03:17.202009 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    SELECT
 sessionId,
 ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
  );
[0m20:03:17.489257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m20:03:17.518517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a9490>]}
[0m20:03:17.519318 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.40s]
[0m20:03:17.522178 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m20:03:17.753462 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m20:03:17.757388 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1463ed9a0>]}
[0m20:03:17.758337 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.64s]
[0m20:03:17.759144 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m20:03:17.760908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:17.761334 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m20:03:17.761744 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m20:03:17.884783 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m20:03:17.885459 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m20:03:18.004418 [info ] [MainThread]: 
[0m20:03:18.004972 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m20:03:18.006139 [debug] [MainThread]: Command end result
[0m20:03:18.032300 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:03:18.034018 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:03:18.041246 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:03:18.041742 [info ] [MainThread]: 
[0m20:03:18.042301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:03:18.042720 [info ] [MainThread]: 
[0m20:03:18.043162 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:03:18.045587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9229636, "process_in_blocks": "0", "process_kernel_time": 0.816385, "process_mem_max_rss": "193069056", "process_out_blocks": "0", "process_user_time": 5.301402}
[0m20:03:18.046197 [debug] [MainThread]: Command `dbt run` succeeded at 20:03:18.046053 after 4.92 seconds
[0m20:03:18.046679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109550aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459f40b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145d8d670>]}
[0m20:03:18.047137 [debug] [MainThread]: Flushing usage events
[0m20:03:18.426016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:57.738358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e195d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaf9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaf98e0>]}


============================== 20:21:57.746513 | 3ae17d70-d540-4f72-8ecd-19ca7a6a951c ==============================
[0m20:21:57.746513 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:21:57.747527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:22:00.026337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc0500>]}
[0m20:22:00.092026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d675f0>]}
[0m20:22:00.093416 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:22:00.276588 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:22:00.482116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:22:00.482704 [debug] [MainThread]: Partial parsing: added file: homework7://snapshots/snapshot_session_summary.sql
[0m20:22:00.605565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14af1b9e0>]}
[0m20:22:00.705563 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:22:00.707424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:22:00.743406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b1321e0>]}
[0m20:22:00.744087 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m20:22:00.744651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113228920>]}
[0m20:22:00.747023 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:22:00.748327 [debug] [MainThread]: Command end result
[0m20:22:00.773540 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:22:00.775253 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:22:00.779169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:22:00.785428 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 3.1397839, "process_in_blocks": "0", "process_kernel_time": 0.934806, "process_mem_max_rss": "179912704", "process_out_blocks": "0", "process_user_time": 3.880532}
[0m20:22:00.786159 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:22:00.786010 after 3.14 seconds
[0m20:22:00.786687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e79a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df90290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14af1bda0>]}
[0m20:22:00.787159 [debug] [MainThread]: Flushing usage events
[0m20:22:01.224538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:00.493479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e640e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9759d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a975670>]}


============================== 20:26:00.500745 | 49ecf855-b297-481b-be1c-153ff6c0df57 ==============================
[0m20:26:00.500745 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:26:00.501576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:26:02.471973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9771a0>]}
[0m20:26:02.537301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9037d0>]}
[0m20:26:02.538787 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:26:02.708681 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:26:02.910539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:02.911263 [debug] [MainThread]: Partial parsing: updated file: homework7://snapshots/snapshot_session_summary.sql
[0m20:26:03.272788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472fba10>]}
[0m20:26:03.374773 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:26:03.376599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:26:03.408518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472a7c50>]}
[0m20:26:03.409147 [info ] [MainThread]: Found 5 models, 4 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:26:03.409618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472a0320>]}
[0m20:26:03.412091 [info ] [MainThread]: 
[0m20:26:03.412584 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:26:03.412997 [info ] [MainThread]: 
[0m20:26:03.413654 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:26:03.414830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m20:26:03.628671 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m20:26:03.629051 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m20:26:03.629354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:04.334326 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.705 seconds
[0m20:26:04.337126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now create_user_db_lobster_snapshot)
[0m20:26:04.337820 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster"
schema: "snapshot"
"
[0m20:26:04.343696 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster_snapshot"
[0m20:26:04.344200 [debug] [ThreadPool]: On create_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster_snapshot"} */
create schema if not exists user_db_lobster.snapshot
[0m20:26:04.473531 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m20:26:04.481803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster_snapshot, now list_user_db_lobster_snapshot)
[0m20:26:04.482569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:26:04.502468 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:26:04.507168 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:26:04.507595 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:26:04.508090 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:26:04.509334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:04.633510 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.125 seconds
[0m20:26:04.943573 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.434 seconds
[0m20:26:04.947491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f89c9b0>]}
[0m20:26:04.952230 [debug] [Thread-1 (]: Began running node snapshot.homework7.snapshot_session_summary
[0m20:26:04.952973 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:26:04.953603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now snapshot.homework7.snapshot_session_summary)
[0m20:26:04.954095 [debug] [Thread-1 (]: Began compiling node snapshot.homework7.snapshot_session_summary
[0m20:26:04.964243 [debug] [Thread-1 (]: Began executing node snapshot.homework7.snapshot_session_summary
[0m20:26:05.057022 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:26:05.057469 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to
from (
        

SELECT * FROM user_db_lobster.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m20:26:05.733006 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.675 seconds
[0m20:26:05.741396 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:26:05.741945 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:26:05.825649 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m20:26:05.826801 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.homework7.snapshot_session_summary"
[0m20:26:05.828742 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:26:05.829349 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
create or replace transient table user_db_lobster.snapshot.snapshot_session_summary
         as
        (
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to
from (
        

SELECT * FROM user_db_lobster.analytics.session_summary
    ) sbq



        );
[0m20:26:07.619305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m20:26:07.654338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a951c10>]}
[0m20:26:07.655459 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 1[0m in 2.70s]
[0m20:26:07.656313 [debug] [Thread-1 (]: Finished running node snapshot.homework7.snapshot_session_summary
[0m20:26:07.658080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:07.658482 [debug] [MainThread]: Connection 'snapshot.homework7.snapshot_session_summary' was left open.
[0m20:26:07.658886 [debug] [MainThread]: On snapshot.homework7.snapshot_session_summary: Close
[0m20:26:07.779222 [debug] [MainThread]: Connection 'list_user_db_lobster_analytics' was left open.
[0m20:26:07.779738 [debug] [MainThread]: On list_user_db_lobster_analytics: Close
[0m20:26:07.906472 [info ] [MainThread]: 
[0m20:26:07.907029 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m20:26:07.908040 [debug] [MainThread]: Command end result
[0m20:26:07.933575 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:26:07.935628 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:26:07.943467 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:26:07.943991 [info ] [MainThread]: 
[0m20:26:07.944655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:07.945084 [info ] [MainThread]: 
[0m20:26:07.945610 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:26:07.950059 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.5475793, "process_in_blocks": "0", "process_kernel_time": 1.136979, "process_mem_max_rss": "191938560", "process_out_blocks": "0", "process_user_time": 4.915972}
[0m20:26:07.950921 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:26:07.950602 after 7.55 seconds
[0m20:26:07.951467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a522600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e16510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e14500>]}
[0m20:26:07.951953 [debug] [MainThread]: Flushing usage events
[0m20:26:08.330210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:12.164436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9ef680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce15b0>]}


============================== 20:28:12.169885 | 83541a4a-aee2-46d3-bd6e-0757d9fb8402 ==============================
[0m20:28:12.169885 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:28:12.170651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:28:13.383337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e08ac00>]}
[0m20:28:13.447783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c94b60>]}
[0m20:28:13.448584 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:28:13.610494 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:28:13.797343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:13.797738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:13.858278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a125c70>]}
[0m20:28:13.957133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:28:13.959196 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:28:13.975477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3499d0>]}
[0m20:28:13.976020 [info ] [MainThread]: Found 5 models, 4 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:28:13.976446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcbd190>]}
[0m20:28:13.978558 [info ] [MainThread]: 
[0m20:28:13.978986 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:28:13.979348 [info ] [MainThread]: 
[0m20:28:13.979937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:13.980835 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m20:28:14.050377 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m20:28:14.050777 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m20:28:14.051094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:14.664496 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.613 seconds
[0m20:28:14.672704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_snapshot)
[0m20:28:14.673481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:28:14.688414 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:28:14.689290 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:28:14.689704 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:28:14.690146 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:28:14.690559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:14.819240 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m20:28:15.175801 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.485 seconds
[0m20:28:15.179059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a74eb10>]}
[0m20:28:15.181973 [debug] [Thread-1 (]: Began running node snapshot.homework7.snapshot_session_summary
[0m20:28:15.182661 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:28:15.183322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now snapshot.homework7.snapshot_session_summary)
[0m20:28:15.183823 [debug] [Thread-1 (]: Began compiling node snapshot.homework7.snapshot_session_summary
[0m20:28:15.196099 [debug] [Thread-1 (]: Began executing node snapshot.homework7.snapshot_session_summary
[0m20:28:15.347405 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:15.347953 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:28:15.435445 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.087 seconds
[0m20:28:15.512752 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:15.513386 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        

SELECT * FROM user_db_lobster.analytics.session_summary

    ),

    snapshotted_data as (

        select *, 
    
        sessionId as dbt_unique_key
    

        from "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    
,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    
,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            ts as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.ts))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.ts)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:28:16.750696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.237 seconds
[0m20:28:16.754470 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:16.754999 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:28:16.857028 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.101 seconds
[0m20:28:16.861994 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:16.862550 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:28:16.977731 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.115 seconds
[0m20:28:16.982657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:16.983309 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:28:17.085409 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.101 seconds
[0m20:28:17.090916 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.092792 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:28:17.181216 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.088 seconds
[0m20:28:17.190477 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.191029 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:28:17.289128 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.098 seconds
[0m20:28:17.320345 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.321064 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
select * from (
        
    
    with snapshot_query as (

        

SELECT * FROM user_db_lobster.analytics.session_summary

    ),

    snapshotted_data as (

        select *, 
    
        sessionId as dbt_unique_key
    

        from "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    
,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    
,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            ts as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.ts))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.ts)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m20:28:17.776265 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.454 seconds
[0m20:28:17.781381 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.781899 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:28:17.880675 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m20:28:17.881772 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.883730 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.884322 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
BEGIN
[0m20:28:17.993808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m20:28:17.994539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.995183 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("USERID", "SESSIONID", "CHANNEL", "TS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("USERID", "SESSIONID", "CHANNEL", "TS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:28:19.330062 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.334 seconds
[0m20:28:19.330770 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:19.331259 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
COMMIT
[0m20:28:19.568808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m20:28:19.599358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d125970>]}
[0m20:28:19.600388 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 2[0m in 4.41s]
[0m20:28:19.601231 [debug] [Thread-1 (]: Finished running node snapshot.homework7.snapshot_session_summary
[0m20:28:19.603015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:19.603426 [debug] [MainThread]: Connection 'snapshot.homework7.snapshot_session_summary' was left open.
[0m20:28:19.603834 [debug] [MainThread]: On snapshot.homework7.snapshot_session_summary: Close
[0m20:28:19.917138 [debug] [MainThread]: Connection 'list_user_db_lobster_analytics' was left open.
[0m20:28:19.917709 [debug] [MainThread]: On list_user_db_lobster_analytics: Close
[0m20:28:20.047489 [info ] [MainThread]: 
[0m20:28:20.048057 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m20:28:20.049018 [debug] [MainThread]: Command end result
[0m20:28:20.076040 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:28:20.077915 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:28:20.119248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:28:20.120520 [info ] [MainThread]: 
[0m20:28:20.139621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:20.140409 [info ] [MainThread]: 
[0m20:28:20.158277 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:20.161069 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.06887, "process_in_blocks": "0", "process_kernel_time": 0.839272, "process_mem_max_rss": "189124608", "process_out_blocks": "0", "process_user_time": 4.317846}
[0m20:28:20.161748 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:28:20.161592 after 8.07 seconds
[0m20:28:20.162259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddf1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a51e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a51e210>]}
[0m20:28:20.162744 [debug] [MainThread]: Flushing usage events
[0m20:28:20.552400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:39.247166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c0ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a9940>]}


============================== 20:42:39.253597 | 9babcdda-a3fe-4665-81ac-818a51af218d ==============================
[0m20:42:39.253597 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:42:39.254462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:42:41.277831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111036690>]}
[0m20:42:41.346414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161e7170>]}
[0m20:42:41.347732 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:42:41.518891 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:42:41.740609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:42:41.741367 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m20:42:41.961684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8dcef0>]}
[0m20:42:42.053798 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:42:42.055531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:42:42.104649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fc0d9a0>]}
[0m20:42:42.105330 [info ] [MainThread]: Found 5 models, 4 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:42:42.105812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fa450a0>]}
[0m20:42:42.108652 [info ] [MainThread]: 
[0m20:42:42.109155 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:42:42.109574 [info ] [MainThread]: 
[0m20:42:42.110339 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:42:42.116682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:42:42.123740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m20:42:42.302885 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:42:42.303514 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:42:42.303891 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:42:42.304285 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:42:42.304665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:42.305036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:42.955896 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.651 seconds
[0m20:42:42.960671 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.656 seconds
[0m20:42:42.963948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f7e00>]}
[0m20:42:42.969008 [debug] [Thread-1 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:42:42.969675 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:42:42.970182 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:42:42.970754 [debug] [Thread-3 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:42:42.971235 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:42:42.971796 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:42:42.972347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:42:42.972893 [info ] [Thread-3 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:42:42.973475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m20:42:42.973995 [info ] [Thread-4 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:42:42.974533 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:42:42.975432 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m20:42:42.975944 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:42:42.976568 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493'
[0m20:42:42.988975 [debug] [Thread-3 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:42:42.999032 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:42:43.003728 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:42:43.004334 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:42:43.012171 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:42:43.017020 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:42:43.018137 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:42:43.024028 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:42:43.036023 [debug] [Thread-3 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:42:43.043826 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:42:43.060255 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:42:43.070318 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:42:43.073000 [debug] [Thread-4 (]: Writing runtime sql for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:42:43.073705 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:42:43.075220 [debug] [Thread-4 (]: Using snowflake connection "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:42:43.075644 [debug] [Thread-4 (]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:42:43.076044 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:42:43.076809 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:42:43.077245 [debug] [Thread-2 (]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:42:43.079702 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:42:43.080237 [debug] [Thread-1 (]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:42:43.082823 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:42:43.083488 [debug] [Thread-3 (]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:42:43.083980 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:42:43.185312 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb857e-0104-e06d-0004-59ff001873f6
[0m20:42:43.185762 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:42:43.189907 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:42:43.190412 [error] [Thread-2 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.22s]
[0m20:42:43.191023 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:42:43.192186 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m20:42:43.193390 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb857e-0104-e06c-0004-59ff00198352
[0m20:42:43.193755 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:42:43.196897 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:42:43.197370 [error] [Thread-1 (]: 1 of 4 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.23s]
[0m20:42:43.197946 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:42:43.198459 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m20:42:43.483772 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb857e-0104-e072-0004-59ff0018b3aa
[0m20:42:43.484455 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:42:43.488624 [debug] [Thread-4 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:42:43.489272 [error] [Thread-4 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.51s]
[0m20:42:43.490092 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:42:43.490865 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m20:42:43.496300 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bb857e-0104-e5e9-0004-59ff0019f28e
[0m20:42:43.497005 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:42:43.501000 [debug] [Thread-3 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:42:43.501635 [error] [Thread-3 (]: 3 of 4 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.53s]
[0m20:42:43.502428 [debug] [Thread-3 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:42:43.503211 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m20:42:43.504877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:43.505301 [debug] [MainThread]: Connection 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' was left open.
[0m20:42:43.505712 [debug] [MainThread]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:42:43.638433 [debug] [MainThread]: Connection 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' was left open.
[0m20:42:43.638960 [debug] [MainThread]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:42:43.756615 [debug] [MainThread]: Connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321' was left open.
[0m20:42:43.757291 [debug] [MainThread]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:42:43.881700 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m20:42:43.882218 [debug] [MainThread]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:42:44.003540 [info ] [MainThread]: 
[0m20:42:44.004289 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m20:42:44.005946 [debug] [MainThread]: Command end result
[0m20:42:44.033913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:42:44.035755 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:42:44.044821 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:42:44.045293 [info ] [MainThread]: 
[0m20:42:44.045821 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m20:42:44.046277 [info ] [MainThread]: 
[0m20:42:44.046923 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:42:44.047368 [info ] [MainThread]: 
[0m20:42:44.047876 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:42:44.048304 [info ] [MainThread]: 
[0m20:42:44.048800 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:42:44.049225 [info ] [MainThread]: 
[0m20:42:44.049723 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:42:44.050147 [info ] [MainThread]: 
[0m20:42:44.050605 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m20:42:44.053013 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.881109, "process_in_blocks": "0", "process_kernel_time": 0.991156, "process_mem_max_rss": "194392064", "process_out_blocks": "0", "process_user_time": 4.573567}
[0m20:42:44.053771 [debug] [MainThread]: Command `dbt test` failed at 20:42:44.053620 after 4.88 seconds
[0m20:42:44.054272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113037a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eece00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbc44d0>]}
[0m20:42:44.054740 [debug] [MainThread]: Flushing usage events
[0m20:42:44.417811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:59.198031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111058200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a99a0>]}


============================== 20:47:59.205667 | b7ef86d6-bd6b-4356-bffb-52ce43f86010 ==============================
[0m20:47:59.205667 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:47:59.206571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:48:01.231414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7ef86d6-bd6b-4356-bffb-52ce43f86010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef36720>]}
[0m20:48:01.305772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7ef86d6-bd6b-4356-bffb-52ce43f86010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c8290>]}
[0m20:48:01.307206 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:48:01.477660 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:48:01.645078 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading homework7: output/schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | models:
    3  |  - name: session_summary
    4  |  description: "Analytics model for session data"
    5  |  columns:
    6  |  - name: sessionId
    7  |  description: "Unique identifier for each stock price record"
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 2
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 2
[0m20:48:01.649016 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.5315037, "process_in_blocks": "0", "process_kernel_time": 1.000244, "process_mem_max_rss": "177188864", "process_out_blocks": "0", "process_user_time": 3.784936}
[0m20:48:01.649817 [debug] [MainThread]: Command `dbt test` failed at 20:48:01.649653 after 2.53 seconds
[0m20:48:01.650403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c29040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d714050>]}
[0m20:48:01.650950 [debug] [MainThread]: Flushing usage events
[0m20:48:02.027631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:48.498106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a9970>]}


============================== 20:49:48.503333 | 37b504b3-c28e-46e1-897b-a8aad0dcc056 ==============================
[0m20:49:48.503333 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:49:48.504125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m20:49:49.711247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b9a20c0>]}
[0m20:49:49.776970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8708c0>]}
[0m20:49:49.777831 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:49:49.929270 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:49:50.139078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:49:50.139800 [debug] [MainThread]: Partial parsing: added file: homework7://models/output/schema.yml
[0m20:49:50.443786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bcdbf80>]}
[0m20:49:50.539891 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:49:50.541678 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:49:50.675397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bf2fcb0>]}
[0m20:49:50.676106 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:49:50.676638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101dd010>]}
[0m20:49:50.679565 [info ] [MainThread]: 
[0m20:49:50.680101 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:49:50.680562 [info ] [MainThread]: 
[0m20:49:50.681253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:50.687506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m20:49:50.694696 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:49:50.798082 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:49:50.798688 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:49:50.799080 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:49:50.799473 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:49:50.799853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:50.800221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:51.423868 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.624 seconds
[0m20:49:51.439727 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.640 seconds
[0m20:49:51.443239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bf2f710>]}
[0m20:49:51.447463 [debug] [Thread-1 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:51.448054 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:51.448577 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:49:51.449183 [debug] [Thread-3 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:49:51.449663 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:49:51.450124 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:49:51.450691 [debug] [Thread-5 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:51.451235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:49:51.451793 [info ] [Thread-3 (]: 3 of 6 START test not_null_session_summary_sessionId ........................... [RUN]
[0m20:49:51.452377 [info ] [Thread-4 (]: 4 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:49:51.453262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m20:49:51.453795 [info ] [Thread-5 (]: 5 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:49:51.454385 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:51.455034 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6'
[0m20:49:51.455681 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m20:49:51.456319 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:51.456964 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493'
[0m20:49:51.469204 [debug] [Thread-3 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:49:51.480239 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:51.480826 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:49:51.485512 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:51.486223 [debug] [Thread-5 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:51.491279 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:49:51.499063 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:51.503522 [debug] [Thread-5 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:51.504341 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:51.505041 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:51.505652 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:49:51.537234 [debug] [Thread-5 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:51.542453 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:51.545277 [debug] [Thread-5 (]: Writing runtime sql for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:51.552949 [debug] [Thread-4 (]: Writing runtime sql for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:51.561051 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:51.561847 [debug] [Thread-3 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:49:51.563184 [debug] [Thread-5 (]: Using snowflake connection "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:51.563910 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:51.564950 [debug] [Thread-4 (]: Using snowflake connection "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:51.567685 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:49:51.568225 [debug] [Thread-5 (]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:49:51.569019 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:51.569447 [debug] [Thread-2 (]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:49:51.569919 [debug] [Thread-4 (]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:49:51.570561 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:49:51.571102 [debug] [Thread-1 (]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:49:51.572454 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:49:51.573459 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:49:51.579547 [debug] [Thread-3 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m20:49:51.580510 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:49:51.671740 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb8585-0104-e06c-0004-59ff00198366
[0m20:49:51.672202 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:49:51.674985 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb8585-0104-e13d-0004-59ff0019142e
[0m20:49:51.675395 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:49:51.679643 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:49:51.680151 [error] [Thread-1 (]: 1 of 6 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.23s]
[0m20:49:51.680776 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:51.681203 [debug] [Thread-1 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:49:51.681581 [info ] [Thread-1 (]: 6 of 6 START test unique_session_summary_sessionId ............................. [RUN]
[0m20:49:51.682208 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m20:49:51.683835 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:49:51.684247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_first_dbt_model_id.5fb22c2710, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m20:49:51.685423 [error] [Thread-2 (]: 2 of 6 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.23s]
[0m20:49:51.685873 [debug] [Thread-1 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:49:51.686444 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:51.690504 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:49:51.691144 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m20:49:51.691809 [debug] [Thread-1 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:49:51.694039 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:49:51.695001 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:49:51.695383 [debug] [Thread-1 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m20:49:52.013222 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb8585-0104-e113-0004-59ff00189dde
[0m20:49:52.013924 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:49:52.017968 [debug] [Thread-5 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:49:52.018610 [error] [Thread-5 (]: 5 of 6 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.56s]
[0m20:49:52.019432 [debug] [Thread-5 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:52.020128 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m20:49:52.021897 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb8585-0104-e078-0004-59ff0019d2fe
[0m20:49:52.022469 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:49:52.026328 [debug] [Thread-4 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:49:52.026920 [error] [Thread-4 (]: 4 of 6 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.57s]
[0m20:49:52.027702 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:49:52.028467 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m20:49:52.400055 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m20:49:52.412617 [info ] [Thread-3 (]: 3 of 6 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.96s]
[0m20:49:52.413455 [debug] [Thread-3 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:49:52.596069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m20:49:52.599487 [info ] [Thread-1 (]: 6 of 6 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.92s]
[0m20:49:52.600453 [debug] [Thread-1 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:49:52.602179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:52.602596 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m20:49:52.603024 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m20:49:52.734451 [debug] [MainThread]: Connection 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' was left open.
[0m20:49:52.734911 [debug] [MainThread]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:49:52.871118 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m20:49:52.871710 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m20:49:52.995720 [debug] [MainThread]: Connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321' was left open.
[0m20:49:52.996309 [debug] [MainThread]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:49:53.114096 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m20:49:53.114678 [debug] [MainThread]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:49:53.243508 [info ] [MainThread]: 
[0m20:49:53.244151 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m20:49:53.246393 [debug] [MainThread]: Command end result
[0m20:49:53.274849 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:49:53.276692 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:49:53.285618 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:49:53.286069 [info ] [MainThread]: 
[0m20:49:53.286556 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m20:49:53.286989 [info ] [MainThread]: 
[0m20:49:53.287605 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:49:53.288058 [info ] [MainThread]: 
[0m20:49:53.288561 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:49:53.289115 [info ] [MainThread]: 
[0m20:49:53.289644 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:49:53.290144 [info ] [MainThread]: 
[0m20:49:53.290727 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:49:53.291168 [info ] [MainThread]: 
[0m20:49:53.291613 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m20:49:53.294367 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.8683653, "process_in_blocks": "0", "process_kernel_time": 0.87867, "process_mem_max_rss": "196186112", "process_out_blocks": "0", "process_user_time": 4.823345}
[0m20:49:53.295001 [debug] [MainThread]: Command `dbt test` failed at 20:49:53.294852 after 4.87 seconds
[0m20:49:53.295510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f433ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecd3b90>]}
[0m20:49:53.295972 [debug] [MainThread]: Flushing usage events
[0m20:49:53.667620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:13.423865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d463c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a5970>]}


============================== 20:50:13.429595 | b9100d30-c01d-4e99-bc64-ae97c4ccc94d ==============================
[0m20:50:13.429595 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:13.430350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:50:14.669232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adb500>]}
[0m20:50:14.734193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a21520>]}
[0m20:50:14.734978 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:50:14.885217 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:50:15.064604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:50:15.064981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:50:15.126420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764a000>]}
[0m20:50:15.225394 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:50:15.227284 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:50:15.254121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b15ca0>]}
[0m20:50:15.254724 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:50:15.255151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108187ad0>]}
[0m20:50:15.257767 [info ] [MainThread]: 
[0m20:50:15.258229 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:50:15.258606 [info ] [MainThread]: 
[0m20:50:15.259204 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:50:15.264888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:50:15.265567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m20:50:15.347328 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:50:15.347857 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:50:15.348233 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:50:15.348568 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:50:15.348886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:15.349186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:15.957009 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.608 seconds
[0m20:50:15.977752 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.628 seconds
[0m20:50:15.980709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443f9b80>]}
[0m20:50:15.983980 [debug] [Thread-1 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:15.984523 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:50:15.985111 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:15.985642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:50:15.986124 [debug] [Thread-3 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:50:15.986647 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:50:15.987130 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:50:15.987758 [debug] [Thread-5 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:15.988240 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:15.988749 [info ] [Thread-3 (]: 3 of 6 START test not_null_session_summary_sessionId ........................... [RUN]
[0m20:50:15.989300 [info ] [Thread-4 (]: 4 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:50:16.068255 [info ] [Thread-5 (]: 5 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:50:16.071086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m20:50:16.078369 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6'
[0m20:50:16.096610 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m20:50:16.097271 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:16.097945 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493'
[0m20:50:16.098472 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:16.098988 [debug] [Thread-3 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:50:16.099491 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:50:16.100165 [debug] [Thread-5 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:16.105611 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:50:16.110660 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:50:16.117330 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:16.118961 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:16.123903 [debug] [Thread-5 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:16.142505 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:16.149874 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:16.150381 [debug] [Thread-3 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:50:16.153263 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:50:16.153747 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:50:16.154230 [debug] [Thread-5 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:16.157240 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:50:16.160143 [debug] [Thread-4 (]: Writing runtime sql for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:16.162492 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:16.165151 [debug] [Thread-5 (]: Writing runtime sql for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:16.166143 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:50:16.166790 [debug] [Thread-1 (]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:50:16.167589 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:50:16.168227 [debug] [Thread-2 (]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:50:16.169085 [debug] [Thread-4 (]: Using snowflake connection "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:16.169949 [debug] [Thread-5 (]: Using snowflake connection "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:16.171196 [debug] [Thread-3 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m20:50:16.172694 [debug] [Thread-4 (]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:50:16.173573 [debug] [Thread-5 (]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:50:16.174433 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:16.175230 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:16.175758 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:50:16.267661 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb8586-0104-e06d-0004-59ff0018741e
[0m20:50:16.268189 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:50:16.272086 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:50:16.272694 [error] [Thread-1 (]: 1 of 6 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.29s]
[0m20:50:16.273658 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:16.274162 [debug] [Thread-1 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:50:16.274616 [info ] [Thread-1 (]: 6 of 6 START test unique_session_summary_sessionId ............................. [RUN]
[0m20:50:16.275271 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m20:50:16.275742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_first_dbt_model_id.5fb22c2710, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m20:50:16.277619 [debug] [Thread-1 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:50:16.281712 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:50:16.282522 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb8586-0104-e072-0004-59ff0018b3c6
[0m20:50:16.283063 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:50:16.284768 [debug] [Thread-1 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:50:16.287097 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:50:16.289561 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:50:16.290358 [error] [Thread-2 (]: 2 of 6 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.30s]
[0m20:50:16.291177 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:16.291802 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m20:50:16.292628 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:50:16.293000 [debug] [Thread-1 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m20:50:16.425380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m20:50:16.437123 [info ] [Thread-1 (]: 6 of 6 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.16s]
[0m20:50:16.438009 [debug] [Thread-1 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:50:16.626397 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb8586-0104-e06c-0004-59ff0019836a
[0m20:50:16.626960 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:50:16.630855 [debug] [Thread-5 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:50:16.631471 [error] [Thread-5 (]: 5 of 6 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.53s]
[0m20:50:16.632259 [debug] [Thread-5 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:16.632958 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m20:50:16.634477 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb8586-0104-e383-0004-59ff001963d2
[0m20:50:16.634972 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:50:16.638918 [debug] [Thread-4 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:50:16.640385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m20:50:16.640994 [error] [Thread-4 (]: 4 of 6 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.54s]
[0m20:50:16.643831 [info ] [Thread-3 (]: 3 of 6 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.57s]
[0m20:50:16.644741 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:50:16.645498 [debug] [Thread-3 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:50:16.646246 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m20:50:16.648047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:16.648458 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m20:50:16.648928 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m20:50:16.784616 [debug] [MainThread]: Connection 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' was left open.
[0m20:50:16.785311 [debug] [MainThread]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:50:16.906171 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m20:50:16.906690 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m20:50:17.036724 [debug] [MainThread]: Connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321' was left open.
[0m20:50:17.037251 [debug] [MainThread]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:50:17.154964 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m20:50:17.155661 [debug] [MainThread]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:50:17.285666 [info ] [MainThread]: 
[0m20:50:17.286359 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m20:50:17.288792 [debug] [MainThread]: Command end result
[0m20:50:17.319013 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:50:17.321393 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:50:17.330610 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:50:17.331080 [info ] [MainThread]: 
[0m20:50:17.331577 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m20:50:17.332042 [info ] [MainThread]: 
[0m20:50:17.332633 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:50:17.333071 [info ] [MainThread]: 
[0m20:50:17.333579 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:50:17.334008 [info ] [MainThread]: 
[0m20:50:17.334517 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:50:17.334944 [info ] [MainThread]: 
[0m20:50:17.335440 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:50:17.335869 [info ] [MainThread]: 
[0m20:50:17.336325 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m20:50:17.338759 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.9895093, "process_in_blocks": "0", "process_kernel_time": 0.872816, "process_mem_max_rss": "193208320", "process_out_blocks": "0", "process_user_time": 4.481191}
[0m20:50:17.339383 [debug] [MainThread]: Command `dbt test` failed at 20:50:17.339233 after 3.99 seconds
[0m20:50:17.339951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14413f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fab560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fab0e0>]}
[0m20:50:17.340522 [debug] [MainThread]: Flushing usage events
[0m20:50:17.677838 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:24.307173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ef1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b92dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b92d910>]}


============================== 20:51:24.314585 | 5129956c-088a-49a3-9dc1-e567fe48e648 ==============================
[0m20:51:24.314585 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:51:24.315401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select session_summary', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:51:26.343054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107ddf70>]}
[0m20:51:26.408489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a31d0>]}
[0m20:51:26.409932 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:51:26.579331 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:51:26.801706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:26.802177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:26.868565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d826c0>]}
[0m20:51:26.966357 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:51:26.968138 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:51:27.019185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1482a9430>]}
[0m20:51:27.019810 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:51:27.020289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e93e5a0>]}
[0m20:51:27.022484 [info ] [MainThread]: 
[0m20:51:27.023030 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:51:27.023460 [info ] [MainThread]: 
[0m20:51:27.024145 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:51:27.030527 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m20:51:27.031247 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:51:27.137015 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:51:27.137617 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:51:27.137971 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:51:27.138339 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:51:27.138716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:27.139061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:27.792825 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.654 seconds
[0m20:51:27.815351 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.676 seconds
[0m20:51:27.819388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10988bc50>]}
[0m20:51:27.824258 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:51:27.824885 [debug] [Thread-2 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:51:27.825583 [info ] [Thread-1 (]: 1 of 2 START test not_null_session_summary_sessionId ........................... [RUN]
[0m20:51:27.826185 [info ] [Thread-2 (]: 2 of 2 START test unique_session_summary_sessionId ............................. [RUN]
[0m20:51:27.826839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m20:51:27.827387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m20:51:27.827906 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:51:27.828400 [debug] [Thread-2 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:51:27.946453 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:51:27.947100 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:51:27.948040 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:51:27.954859 [debug] [Thread-2 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:51:27.990683 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:51:27.992509 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:51:27.993840 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:51:27.994413 [debug] [Thread-1 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m20:51:27.995689 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:51:27.996173 [debug] [Thread-2 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m20:51:28.099356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m20:51:28.113277 [info ] [Thread-1 (]: 1 of 2 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.29s]
[0m20:51:28.114245 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:51:28.135954 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m20:51:28.138473 [info ] [Thread-2 (]: 2 of 2 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.31s]
[0m20:51:28.139345 [debug] [Thread-2 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:51:28.141042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:28.141466 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m20:51:28.141959 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m20:51:28.278905 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m20:51:28.279507 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m20:51:28.398733 [info ] [MainThread]: 
[0m20:51:28.399392 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m20:51:28.400775 [debug] [MainThread]: Command end result
[0m20:51:28.429871 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:51:28.431750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:51:28.440476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:51:28.440915 [info ] [MainThread]: 
[0m20:51:28.441402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:28.441821 [info ] [MainThread]: 
[0m20:51:28.442443 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:51:28.445886 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.2290583, "process_in_blocks": "0", "process_kernel_time": 1.152994, "process_mem_max_rss": "191164416", "process_out_blocks": "0", "process_user_time": 4.59933}
[0m20:51:28.446584 [debug] [MainThread]: Command `dbt test` succeeded at 20:51:28.446431 after 4.23 seconds
[0m20:51:28.447092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a0b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3caf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14870ed50>]}
[0m20:51:28.447569 [debug] [MainThread]: Flushing usage events
[0m20:51:28.810958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:08.952692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d57c0>]}


============================== 11:22:08.961120 | 20bad376-dfc5-4bc2-9961-f992a643adc8 ==============================
[0m11:22:08.961120 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:22:08.962013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:22:11.751493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4827b0>]}
[0m11:22:11.813770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f09ba10>]}
[0m11:22:11.815033 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:22:11.986307 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:22:12.223204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:22:12.224084 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m11:22:12.224987 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/schema.yml
[0m11:22:12.991886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e7de80>]}
[0m11:22:13.092142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:22:13.093797 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:22:13.150644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e1f380>]}
[0m11:22:13.151259 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m11:22:13.151733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e3f980>]}
[0m11:22:13.154382 [info ] [MainThread]: 
[0m11:22:13.154838 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:22:13.155247 [info ] [MainThread]: 
[0m11:22:13.155870 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:13.162000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:22:13.162716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:22:13.348409 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:22:13.348914 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:22:13.349220 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:22:13.349861 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:22:13.350186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:13.350495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:15.896117 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.545 seconds
[0m11:22:15.902661 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.552 seconds
[0m11:22:15.905631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e1db50>]}
[0m11:22:15.910739 [debug] [Thread-1 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:22:15.911337 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:22:15.911876 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m11:22:15.912483 [debug] [Thread-3 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:15.912990 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m11:22:15.913573 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:22:15.914139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:22:15.914633 [debug] [Thread-5 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:22:15.915146 [info ] [Thread-3 (]: 3 of 6 START test not_null_session_summary_sessionId ........................... [RUN]
[0m11:22:15.916014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m11:22:15.916550 [info ] [Thread-4 (]: 4 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m11:22:15.917332 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:22:15.917872 [info ] [Thread-5 (]: 5 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m11:22:15.918603 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6'
[0m11:22:15.919127 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:22:15.919779 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m11:22:15.931986 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493'
[0m11:22:15.941734 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:22:15.942279 [debug] [Thread-3 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:15.947095 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m11:22:15.947607 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:22:15.948098 [debug] [Thread-5 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:22:15.953322 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:15.960439 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:22:15.962169 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m11:22:15.966792 [debug] [Thread-5 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:22:15.967495 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:22:15.992591 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:22:15.993159 [debug] [Thread-3 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:15.996008 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m11:22:15.996760 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:22:15.999301 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:16.000133 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:22:16.000671 [debug] [Thread-5 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:22:16.003199 [debug] [Thread-4 (]: Writing runtime sql for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m11:22:16.003940 [debug] [Thread-1 (]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m11:22:16.004774 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m11:22:16.007258 [debug] [Thread-5 (]: Writing runtime sql for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:22:16.008012 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:16.008971 [debug] [Thread-2 (]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m11:22:16.010242 [debug] [Thread-4 (]: Using snowflake connection "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m11:22:16.010766 [debug] [Thread-3 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m11:22:16.011664 [debug] [Thread-4 (]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:22:16.012403 [debug] [Thread-5 (]: Using snowflake connection "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:22:16.013328 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:22:16.013893 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:22:16.014272 [debug] [Thread-5 (]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:22:16.016207 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m11:22:16.158556 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb88ee-0104-e078-0004-59ff0019d3d6
[0m11:22:16.159321 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb88ee-0104-e068-0004-59ff0018c53a
[0m11:22:16.159944 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m11:22:16.160496 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m11:22:16.167836 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m11:22:16.168893 [error] [Thread-1 (]: 1 of 6 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.25s]
[0m11:22:16.169756 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:22:16.171691 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m11:22:16.172187 [debug] [Thread-1 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:16.172769 [error] [Thread-2 (]: 2 of 6 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.26s]
[0m11:22:16.173476 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m11:22:16.174613 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:22:16.173949 [info ] [Thread-1 (]: 6 of 6 START test unique_session_summary_sessionId ............................. [RUN]
[0m11:22:16.176109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_first_dbt_model_id.5fb22c2710, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m11:22:16.176732 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m11:22:16.177164 [debug] [Thread-1 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:16.181927 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:16.182703 [debug] [Thread-1 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:16.185619 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:16.186929 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:16.187561 [debug] [Thread-1 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m11:22:16.345182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m11:22:16.358925 [info ] [Thread-1 (]: 6 of 6 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.18s]
[0m11:22:16.359819 [debug] [Thread-1 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:16.458638 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb88ee-0104-e692-0004-59ff001a500e
[0m11:22:16.459484 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m11:22:16.464063 [debug] [Thread-5 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m11:22:16.464711 [error] [Thread-5 (]: 5 of 6 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.53s]
[0m11:22:16.465525 [debug] [Thread-5 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:22:16.466227 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m11:22:16.541195 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb88ee-0104-e383-0004-59ff0019649a
[0m11:22:16.542024 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m11:22:16.546623 [debug] [Thread-4 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m11:22:16.547260 [error] [Thread-4 (]: 4 of 6 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.63s]
[0m11:22:16.548065 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:22:16.548768 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m11:22:16.559795 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m11:22:16.563120 [info ] [Thread-3 (]: 3 of 6 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.64s]
[0m11:22:16.564055 [debug] [Thread-3 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:16.565856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:16.566273 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:22:16.566703 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:22:16.753964 [debug] [MainThread]: Connection 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' was left open.
[0m11:22:16.754545 [debug] [MainThread]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: Close
[0m11:22:16.883488 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m11:22:16.884131 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m11:22:17.036776 [debug] [MainThread]: Connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321' was left open.
[0m11:22:17.037358 [debug] [MainThread]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: Close
[0m11:22:17.151069 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m11:22:17.151730 [debug] [MainThread]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m11:22:17.292454 [info ] [MainThread]: 
[0m11:22:17.293199 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m11:22:17.295218 [debug] [MainThread]: Command end result
[0m11:22:17.330242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:22:17.332974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:22:17.346914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:22:17.347532 [info ] [MainThread]: 
[0m11:22:17.348377 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m11:22:17.348959 [info ] [MainThread]: 
[0m11:22:17.349694 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m11:22:17.350770 [info ] [MainThread]: 
[0m11:22:17.351604 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m11:22:17.352286 [info ] [MainThread]: 
[0m11:22:17.353096 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m11:22:17.353905 [info ] [MainThread]: 
[0m11:22:17.354603 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m11:22:17.355183 [info ] [MainThread]: 
[0m11:22:17.355762 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m11:22:17.360731 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 8.508303, "process_in_blocks": "0", "process_kernel_time": 1.347572, "process_mem_max_rss": "198070272", "process_out_blocks": "0", "process_user_time": 5.716901}
[0m11:22:17.361965 [debug] [MainThread]: Command `dbt test` failed at 11:22:17.361735 after 8.51 seconds
[0m11:22:17.362897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1468140b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f780e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3c170>]}
[0m11:22:17.363589 [debug] [MainThread]: Flushing usage events
[0m11:22:17.730004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:33.026278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095140b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109565c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095657f0>]}


============================== 11:22:33.031705 | 5df65113-52c7-4003-8d0e-02609660d788 ==============================
[0m11:22:33.031705 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:22:33.032416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select session_summary', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:22:34.190254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458349b0>]}
[0m11:22:34.253932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1456e4ec0>]}
[0m11:22:34.254693 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:22:34.412776 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:22:34.596389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:34.596759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:34.657996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458fbbc0>]}
[0m11:22:34.756487 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:22:34.758272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:22:34.785407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e6cdd0>]}
[0m11:22:34.785992 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m11:22:34.786473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145837aa0>]}
[0m11:22:34.788492 [info ] [MainThread]: 
[0m11:22:34.788918 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:22:34.789283 [info ] [MainThread]: 
[0m11:22:34.789881 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:34.795407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:22:34.805171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:22:34.881944 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:22:34.882492 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:22:34.882828 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:22:34.883204 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:22:34.883561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:34.883902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:36.152591 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.269 seconds
[0m11:22:36.156593 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.273 seconds
[0m11:22:36.159828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e38230>]}
[0m11:22:36.162776 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:36.163342 [info ] [Thread-1 (]: 1 of 2 START test not_null_session_summary_sessionId ........................... [RUN]
[0m11:22:36.163941 [debug] [Thread-2 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:36.164481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m11:22:36.165018 [info ] [Thread-2 (]: 2 of 2 START test unique_session_summary_sessionId ............................. [RUN]
[0m11:22:36.165601 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:36.166159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m11:22:36.251702 [debug] [Thread-2 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:36.280755 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:36.282284 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:36.283232 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:36.290304 [debug] [Thread-2 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:36.326530 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:36.327064 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:36.328347 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:36.328818 [debug] [Thread-2 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m11:22:36.329608 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:36.330838 [debug] [Thread-1 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m11:22:36.524478 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m11:22:36.525830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m11:22:36.544396 [info ] [Thread-2 (]: 2 of 2 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.38s]
[0m11:22:36.545418 [info ] [Thread-1 (]: 1 of 2 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.38s]
[0m11:22:36.546317 [debug] [Thread-2 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:36.547068 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:36.548822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:36.549248 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m11:22:36.549672 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m11:22:37.027776 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:22:37.028439 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:22:37.334505 [info ] [MainThread]: 
[0m11:22:37.335074 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m11:22:37.336074 [debug] [MainThread]: Command end result
[0m11:22:37.362950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:22:37.364945 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:22:37.373825 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:22:37.374178 [info ] [MainThread]: 
[0m11:22:37.374547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:37.374866 [info ] [MainThread]: 
[0m11:22:37.375212 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:22:37.377964 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.429436, "process_in_blocks": "0", "process_kernel_time": 0.815429, "process_mem_max_rss": "189771776", "process_out_blocks": "0", "process_user_time": 4.158757}
[0m11:22:37.378899 [debug] [MainThread]: Command `dbt test` succeeded at 11:22:37.378735 after 4.43 seconds
[0m11:22:37.379410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462e6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462e7bf0>]}
[0m11:22:37.379945 [debug] [MainThread]: Flushing usage events
[0m11:22:38.031973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:33.841771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b04ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b56dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b56d940>]}


============================== 11:25:33.847060 | d91b51c6-20ee-4f09-a3c1-eb848eb680fb ==============================
[0m11:25:33.847060 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:25:33.847765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select session_summary', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:25:35.060329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5937d0>]}
[0m11:25:35.123301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e53ab70>]}
[0m11:25:35.124075 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:25:35.267707 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:25:35.438673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:25:35.439373 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/schema.yml
[0m11:25:35.902653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147cdf740>]}
[0m11:25:36.091833 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:25:36.093756 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:25:36.121858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c63bc0>]}
[0m11:25:36.122383 [info ] [MainThread]: Found 5 models, 7 data tests, 1 snapshot, 3 sources, 474 macros
[0m11:25:36.122795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d95100>]}
[0m11:25:36.124681 [info ] [MainThread]: 
[0m11:25:36.125092 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:25:36.125457 [info ] [MainThread]: 
[0m11:25:36.126015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:25:36.131304 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:25:36.138340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:25:36.211287 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:25:36.211816 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:25:36.212122 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:25:36.212452 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:25:36.212813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:36.213115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:36.871504 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.659 seconds
[0m11:25:37.062047 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.849 seconds
[0m11:25:37.066139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094738f0>]}
[0m11:25:37.069323 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:25:37.069887 [debug] [Thread-2 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:25:37.070402 [info ] [Thread-1 (]: 1 of 3 START test not_null_session_summary_channel ............................. [RUN]
[0m11:25:37.071005 [debug] [Thread-3 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:25:37.071508 [info ] [Thread-2 (]: 2 of 3 START test not_null_session_summary_sessionId ........................... [RUN]
[0m11:25:37.072123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_session_summary_channel.816a14d150)
[0m11:25:37.072643 [info ] [Thread-3 (]: 3 of 3 START test unique_session_summary_sessionId ............................. [RUN]
[0m11:25:37.073230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m11:25:37.073740 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:25:37.074379 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0'
[0m11:25:37.074875 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:25:37.081081 [debug] [Thread-3 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:25:37.096942 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:25:37.101537 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:25:37.108722 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:25:37.109701 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:25:37.129380 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:25:37.139530 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:25:37.140114 [debug] [Thread-3 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:25:37.142709 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:25:37.149832 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:25:37.150800 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:25:37.151217 [debug] [Thread-3 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m11:25:37.151595 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:25:37.153222 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:25:37.153596 [debug] [Thread-1 (]: On test.homework7.not_null_session_summary_channel.816a14d150: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_channel.816a14d150"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel
from user_db_lobster.analytics.session_summary
where channel is null



      
    ) dbt_internal_test
[0m11:25:37.155388 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:25:37.155797 [debug] [Thread-2 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m11:25:37.270019 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m11:25:37.280083 [info ] [Thread-2 (]: 2 of 3 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.21s]
[0m11:25:37.281201 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:25:37.633486 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m11:25:37.636043 [info ] [Thread-3 (]: 3 of 3 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.56s]
[0m11:25:37.636852 [debug] [Thread-3 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:25:37.697196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m11:25:37.700591 [info ] [Thread-1 (]: 1 of 3 PASS not_null_session_summary_channel ................................... [[32mPASS[0m in 0.63s]
[0m11:25:37.701601 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:25:37.703321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:37.703728 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_channel.816a14d150' was left open.
[0m11:25:37.704123 [debug] [MainThread]: On test.homework7.not_null_session_summary_channel.816a14d150: Close
[0m11:25:37.830991 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m11:25:37.831581 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m11:25:37.958660 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:25:37.959354 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:25:38.078197 [info ] [MainThread]: 
[0m11:25:38.078920 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m11:25:38.080556 [debug] [MainThread]: Command end result
[0m11:25:38.108654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:25:38.110457 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:25:38.119308 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:25:38.119760 [info ] [MainThread]: 
[0m11:25:38.120253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:38.120681 [info ] [MainThread]: 
[0m11:25:38.121139 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:25:38.123654 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.354272, "process_in_blocks": "0", "process_kernel_time": 0.827647, "process_mem_max_rss": "195416064", "process_out_blocks": "0", "process_user_time": 4.477512}
[0m11:25:38.124313 [debug] [MainThread]: Command `dbt test` succeeded at 11:25:38.124159 after 4.35 seconds
[0m11:25:38.124823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4043e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14744e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ea5d90>]}
[0m11:25:38.125308 [debug] [MainThread]: Flushing usage events
[0m11:25:38.487220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:16.680917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8920f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd4f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdc1940>]}


============================== 11:29:16.687920 | d26fdc75-8fea-48a3-8609-c6de2b200009 ==============================
[0m11:29:16.687920 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:29:16.688670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:29:17.930840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147aa2c00>]}
[0m11:29:17.995362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b0080>]}
[0m11:29:17.996350 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:29:18.152468 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:29:18.328995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:29:18.329376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:29:18.389294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd4f710>]}
[0m11:29:18.406952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148589970>]}
[0m11:29:18.407550 [info ] [MainThread]: Found 5 models, 7 data tests, 1 snapshot, 3 sources, 474 macros
[0m11:29:18.407973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1480e20f0>]}
[0m11:29:18.410515 [info ] [MainThread]: 
[0m11:29:18.410955 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:29:18.411322 [info ] [MainThread]: 
[0m11:29:18.411915 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:29:18.417546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:29:18.418239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:29:18.499205 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:29:18.499830 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:29:18.500371 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:29:18.500766 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:29:18.501115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:18.501431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:19.239933 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.739 seconds
[0m11:29:19.264899 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.763 seconds
[0m11:29:19.268487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148811d90>]}
[0m11:29:19.271534 [debug] [Thread-1 (]: Began running node model.homework7.my_first_dbt_model
[0m11:29:19.272095 [debug] [Thread-2 (]: Began running node model.homework7.session_timestamp
[0m11:29:19.272650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.my_first_dbt_model)
[0m11:29:19.273147 [debug] [Thread-3 (]: Began running node model.homework7.user_session_channel
[0m11:29:19.273696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.session_timestamp)
[0m11:29:19.274212 [debug] [Thread-1 (]: Began compiling node model.homework7.my_first_dbt_model
[0m11:29:19.274851 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m11:29:19.275429 [debug] [Thread-2 (]: Began compiling node model.homework7.session_timestamp
[0m11:29:19.285649 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.my_first_dbt_model"
[0m11:29:19.286195 [debug] [Thread-3 (]: Began compiling node model.homework7.user_session_channel
[0m11:29:19.289338 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:29:19.292481 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:29:19.294219 [debug] [Thread-1 (]: Began executing node model.homework7.my_first_dbt_model
[0m11:29:19.296958 [debug] [Thread-1 (]: Finished running node model.homework7.my_first_dbt_model
[0m11:29:19.297613 [debug] [Thread-2 (]: Began executing node model.homework7.session_timestamp
[0m11:29:19.298693 [debug] [Thread-2 (]: Finished running node model.homework7.session_timestamp
[0m11:29:19.299197 [debug] [Thread-3 (]: Began executing node model.homework7.user_session_channel
[0m11:29:19.300287 [debug] [Thread-3 (]: Finished running node model.homework7.user_session_channel
[0m11:29:19.300856 [debug] [Thread-5 (]: Began running node model.homework7.my_second_dbt_model
[0m11:29:19.301453 [debug] [Thread-3 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:19.301921 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:29:19.302681 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.my_second_dbt_model'
[0m11:29:19.303158 [debug] [Thread-1 (]: Began running node model.homework7.session_summary
[0m11:29:19.303692 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.homework7.user_session_channel, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:29:19.304335 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m11:29:19.304853 [debug] [Thread-5 (]: Began compiling node model.homework7.my_second_dbt_model
[0m11:29:19.305383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.homework7.my_first_dbt_model, now model.homework7.session_summary)
[0m11:29:19.305886 [debug] [Thread-3 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:19.306366 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:29:19.309646 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.my_second_dbt_model"
[0m11:29:19.310226 [debug] [Thread-1 (]: Began compiling node model.homework7.session_summary
[0m11:29:19.330735 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:29:19.335014 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m11:29:19.338408 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:29:19.339166 [debug] [Thread-5 (]: Began executing node model.homework7.my_second_dbt_model
[0m11:29:19.339813 [debug] [Thread-3 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:19.340698 [debug] [Thread-5 (]: Finished running node model.homework7.my_second_dbt_model
[0m11:29:19.341585 [debug] [Thread-3 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:19.342296 [debug] [Thread-1 (]: Began executing node model.homework7.session_summary
[0m11:29:19.342723 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:29:19.343203 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:19.343654 [debug] [Thread-3 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:19.344555 [debug] [Thread-1 (]: Finished running node model.homework7.session_summary
[0m11:29:19.345344 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:29:19.345818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.homework7.session_timestamp, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m11:29:19.346296 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_first_dbt_model_id.5fb22c2710, now test.homework7.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:29:19.347086 [debug] [Thread-5 (]: Began running node snapshot.homework7.snapshot_session_summary
[0m11:29:19.347510 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:19.347931 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:29:19.348391 [debug] [Thread-4 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:29:19.348813 [debug] [Thread-3 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:19.349440 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.homework7.my_second_dbt_model, now snapshot.homework7.snapshot_session_summary)
[0m11:29:19.353949 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m11:29:19.354428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.homework7.session_summary, now test.homework7.not_null_session_summary_channel.816a14d150)
[0m11:29:19.354892 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.homework7.unique_my_first_dbt_model_id.16e066b321, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m11:29:19.358887 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:29:19.359337 [debug] [Thread-5 (]: Began compiling node snapshot.homework7.snapshot_session_summary
[0m11:29:19.359890 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:29:19.360421 [debug] [Thread-4 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:29:19.361019 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:19.364287 [debug] [Thread-5 (]: Began executing node snapshot.homework7.snapshot_session_summary
[0m11:29:19.368317 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:29:19.371915 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:29:19.372307 [debug] [Thread-3 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:19.372948 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:19.373575 [debug] [Thread-5 (]: Finished running node snapshot.homework7.snapshot_session_summary
[0m11:29:19.374426 [debug] [Thread-3 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:19.374876 [debug] [Thread-2 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:29:19.375318 [debug] [Thread-4 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:29:19.375808 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:29:19.376210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_second_dbt_model_id.151b76d778, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m11:29:19.376902 [debug] [Thread-4 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:29:19.377537 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:29:19.377893 [debug] [Thread-2 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:29:19.381473 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:29:19.382057 [debug] [Thread-2 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:29:19.382745 [debug] [Thread-2 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:29:19.384292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:19.384606 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_channel.816a14d150' was left open.
[0m11:29:19.384920 [debug] [MainThread]: On test.homework7.not_null_session_summary_channel.816a14d150: Close
[0m11:29:19.504731 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:29:19.505327 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:29:19.629208 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:29:19.629776 [debug] [MainThread]: Connection 'snapshot.homework7.snapshot_session_summary' was properly closed.
[0m11:29:19.630234 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was properly closed.
[0m11:29:19.633902 [debug] [MainThread]: Command end result
[0m11:29:19.840401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:29:19.843197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:29:19.856310 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:29:19.860912 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:29:19.861625 [info ] [MainThread]: Building catalog
[0m11:29:19.879651 [debug] [ThreadPool]: Acquiring new snowflake connection 'user_db_lobster.information_schema'
[0m11:29:19.880613 [debug] [ThreadPool]: Acquiring new snowflake connection 'USER_DB_LOBSTER.information_schema'
[0m11:29:19.924716 [debug] [ThreadPool]: Using snowflake connection "USER_DB_LOBSTER.information_schema"
[0m11:29:19.925414 [debug] [ThreadPool]: Using snowflake connection "user_db_lobster.information_schema"
[0m11:29:19.926405 [debug] [ThreadPool]: On USER_DB_LOBSTER.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "USER_DB_LOBSTER.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from USER_DB_LOBSTER.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from USER_DB_LOBSTER.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m11:29:19.927989 [debug] [ThreadPool]: On user_db_lobster.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "user_db_lobster.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from user_db_lobster.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_session_summary' and upper("table_name") = upper('snapshot_session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'my_second_dbt_model' and upper("table_name") = upper('my_second_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from user_db_lobster.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_session_summary' and upper("table_name") = upper('snapshot_session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'my_second_dbt_model' and upper("table_name") = upper('my_second_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m11:29:19.929139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:19.929740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:22.613863 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.685 seconds
[0m11:29:23.246569 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 3.317 seconds
[0m11:29:23.275283 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/homework7/target/catalog.json
[0m11:29:23.301528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:29:23.303364 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:29:23.303757 [info ] [MainThread]: Catalog written to /Users/user/homework7/target/catalog.json
[0m11:29:23.308980 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.699813, "process_in_blocks": "0", "process_kernel_time": 0.832356, "process_mem_max_rss": "190144512", "process_out_blocks": "0", "process_user_time": 4.471943}
[0m11:29:23.309791 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:29:23.309627 after 6.70 seconds
[0m11:29:23.310242 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:29:23.310629 [debug] [MainThread]: Connection 'user_db_lobster.information_schema' was left open.
[0m11:29:23.311031 [debug] [MainThread]: On user_db_lobster.information_schema: Close
[0m11:29:23.443247 [debug] [MainThread]: Connection 'USER_DB_LOBSTER.information_schema' was left open.
[0m11:29:23.443800 [debug] [MainThread]: On USER_DB_LOBSTER.information_schema: Close
[0m11:29:23.617997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdc1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ff7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1489f9610>]}
[0m11:29:23.618690 [debug] [MainThread]: Flushing usage events
[0m11:29:23.986353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:16.335939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140be930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147e1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147e1910>]}


============================== 11:32:16.342773 | 1dc59887-dfb4-410b-b3d5-79f4042a8185 ==============================
[0m11:32:16.342773 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:32:16.343563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:18.127304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dc59887-dfb4-410b-b3d5-79f4042a8185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150b4e4b0>]}
[0m11:32:18.195001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dc59887-dfb4-410b-b3d5-79f4042a8185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11375dd60>]}
[0m11:49:06.270335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105170980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a1880>]}


============================== 11:49:06.278546 | f782131e-5a06-4087-a1e9-e87f23132e13 ==============================
[0m11:49:06.278546 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:49:06.279445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:08.625724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaaca10>]}
[0m11:49:08.690240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d5a00>]}
[0m11:49:08.691545 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:49:08.865325 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:49:09.096654 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m11:49:09.097526 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m11:49:09.098174 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/example/my_first_dbt_model.sql
[0m11:49:09.098503 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/example/my_second_dbt_model.sql
[0m11:49:09.227888 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:49:09.243603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141f16b40>]}
[0m11:49:09.340264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:49:09.342125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:49:09.380798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141e90050>]}
[0m11:49:09.381744 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m11:49:09.382432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141e8ffe0>]}
[0m11:49:09.384946 [info ] [MainThread]: 
[0m11:49:09.385462 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:49:09.385955 [info ] [MainThread]: 
[0m11:49:09.386766 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:49:09.392476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:49:09.530175 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:49:09.530667 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:49:09.531022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:10.368457 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.836 seconds
[0m11:49:10.372469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_snapshot)
[0m11:49:10.373303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:49:10.391898 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:49:10.397889 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:49:10.397747 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:49:10.399513 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:49:10.399937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:10.619504 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.221 seconds
[0m11:49:10.850615 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.451 seconds
[0m11:49:10.854679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141eec6b0>]}
[0m11:49:10.860762 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:49:10.861461 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:49:10.862213 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:49:10.863030 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:49:10.863937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.session_timestamp)
[0m11:49:10.864509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.user_session_channel)
[0m11:49:10.865044 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:49:10.865563 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:49:10.875690 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:49:10.878940 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:49:10.880529 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:49:10.881101 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:49:10.952184 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:49:10.952974 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:49:10.954205 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:49:10.954722 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    SELECT
 sessionId,
 ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
  );
[0m11:49:10.955822 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:49:10.956274 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    SELECT
 userId,
 sessionId,
 channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
  );
[0m11:49:11.467271 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m11:49:11.468346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m11:49:11.515204 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104acdbe0>]}
[0m11:49:11.515727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a65280>]}
[0m11:49:11.516497 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.65s]
[0m11:49:11.517290 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.65s]
[0m11:49:11.518108 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:49:11.518819 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:49:11.519885 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:49:11.520502 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:49:11.521296 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:49:11.521789 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:49:11.525475 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:49:11.526331 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:49:11.554918 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:49:11.556521 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:49:11.557011 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:49:11.557446 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:49:14.763557 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.206 seconds
[0m11:49:14.767827 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421d2c60>]}
[0m11:49:14.768737 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 3.25s]
[0m11:49:14.769554 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:49:14.771280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:14.771704 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:49:14.772132 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:49:14.975293 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:49:14.976043 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:49:15.156054 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:49:15.156725 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:49:15.295910 [info ] [MainThread]: 
[0m11:49:15.296716 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.91 seconds (5.91s).
[0m11:49:15.298361 [debug] [MainThread]: Command end result
[0m11:49:15.327064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:49:15.328888 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:49:15.337593 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:49:15.338088 [info ] [MainThread]: 
[0m11:49:15.338588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:15.339096 [info ] [MainThread]: 
[0m11:49:15.339772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:49:15.343198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.167012, "process_in_blocks": "0", "process_kernel_time": 1.25409, "process_mem_max_rss": "188628992", "process_out_blocks": "0", "process_user_time": 4.953983}
[0m11:49:15.343858 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:15.343712 after 9.17 seconds
[0m11:49:15.344365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0c410>]}
[0m11:49:15.344843 [debug] [MainThread]: Flushing usage events
[0m11:49:15.737791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:52.184427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a371d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3719d0>]}


============================== 11:53:52.191672 | bebbb6c8-5f99-465c-8bd8-f0f5bdc17555 ==============================
[0m11:53:52.191672 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:53:52.192601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:53:54.337212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bebbb6c8-5f99-465c-8bd8-f0f5bdc17555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14652bd10>]}
[0m11:53:54.415922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bebbb6c8-5f99-465c-8bd8-f0f5bdc17555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4d7b30>]}
[0m11:55:43.172569 [error] [MainThread]: Encountered an error:

[0m11:55:43.181967 [error] [MainThread]: Traceback (most recent call last):
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Applications/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:55:43.186677 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 111.09314, "process_in_blocks": "0", "process_kernel_time": 1.086063, "process_mem_max_rss": "171642880", "process_out_blocks": "0", "process_user_time": 3.675928}
[0m11:55:43.187624 [debug] [MainThread]: Command `dbt docs serve` failed at 11:55:43.187440 after 111.09 seconds
[0m11:55:43.188340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e83560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2062a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1467c6c00>]}
[0m11:55:43.189250 [debug] [MainThread]: Flushing usage events
[0m11:55:43.581306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:01.182171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113865ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113865940>]}


============================== 11:56:01.189343 | e07c5cc2-a849-4565-9668-85601f07e8a7 ==============================
[0m11:56:01.189343 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:56:01.190129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:03.210987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf9250>]}
[0m11:56:03.273155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f523c50>]}
[0m11:56:03.274560 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:56:03.434648 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:56:03.661773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:03.662224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:03.668535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:56:03.722159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fe1cdd0>]}
[0m11:56:03.814964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:56:03.817420 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:56:03.869790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1501afaa0>]}
[0m11:56:03.870514 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m11:56:03.871005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113812b70>]}
[0m11:56:03.873598 [info ] [MainThread]: 
[0m11:56:03.874089 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:56:03.874502 [info ] [MainThread]: 
[0m11:56:03.875166 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:03.881564 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:56:03.882303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:56:03.991518 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:56:03.992111 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:56:03.992462 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:56:03.992841 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:56:03.993203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:03.993540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:04.733442 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.740 seconds
[0m11:56:04.777130 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.783 seconds
[0m11:56:04.783809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbaf500>]}
[0m11:56:04.788732 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:56:04.789335 [debug] [Thread-2 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:56:04.789843 [debug] [Thread-3 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:56:04.790362 [info ] [Thread-1 (]: 1 of 3 START test not_null_session_summary_channel ............................. [RUN]
[0m11:56:04.790984 [info ] [Thread-2 (]: 2 of 3 START test not_null_session_summary_sessionId ........................... [RUN]
[0m11:56:04.791549 [info ] [Thread-3 (]: 3 of 3 START test unique_session_summary_sessionId ............................. [RUN]
[0m11:56:04.792172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_session_summary_channel.816a14d150)
[0m11:56:04.792711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m11:56:04.793357 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0'
[0m11:56:04.793855 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:56:04.794334 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:56:04.794813 [debug] [Thread-3 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:56:04.908445 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:56:04.911611 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:56:04.919757 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:56:04.921668 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:56:04.949116 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:56:04.949765 [debug] [Thread-3 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:56:04.950395 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:56:04.953508 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:56:04.954407 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:56:04.957167 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:56:04.957867 [debug] [Thread-1 (]: On test.homework7.not_null_session_summary_channel.816a14d150: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_channel.816a14d150"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel
from user_db_lobster.analytics.session_summary
where channel is null



      
    ) dbt_internal_test
[0m11:56:04.959077 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:56:04.960029 [debug] [Thread-3 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m11:56:04.960531 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:56:04.963323 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:56:04.964257 [debug] [Thread-2 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m11:56:05.313478 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m11:56:05.329602 [info ] [Thread-2 (]: 2 of 3 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.54s]
[0m11:56:05.330531 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:56:05.346030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m11:56:05.349480 [info ] [Thread-1 (]: 1 of 3 PASS not_null_session_summary_channel ................................... [[32mPASS[0m in 0.56s]
[0m11:56:05.350455 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:56:05.703695 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m11:56:05.706620 [info ] [Thread-3 (]: 3 of 3 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.91s]
[0m11:56:05.707478 [debug] [Thread-3 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:56:05.710229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:05.710713 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_channel.816a14d150' was left open.
[0m11:56:05.711137 [debug] [MainThread]: On test.homework7.not_null_session_summary_channel.816a14d150: Close
[0m11:56:05.839326 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m11:56:05.839904 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m11:56:05.979686 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:56:05.980355 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:56:06.112210 [info ] [MainThread]: 
[0m11:56:06.113036 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m11:56:06.114985 [debug] [MainThread]: Command end result
[0m11:56:06.142591 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:56:06.144578 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:56:06.154336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:56:06.154795 [info ] [MainThread]: 
[0m11:56:06.155289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:06.155860 [info ] [MainThread]: 
[0m11:56:06.156446 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:56:06.159008 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.0645742, "process_in_blocks": "0", "process_kernel_time": 1.142826, "process_mem_max_rss": "190873600", "process_out_blocks": "0", "process_user_time": 4.837632}
[0m11:56:06.159640 [debug] [MainThread]: Command `dbt test` succeeded at 11:56:06.159495 after 5.07 seconds
[0m11:56:06.160135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f768bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150662d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150662cc0>]}
[0m11:56:06.160609 [debug] [MainThread]: Flushing usage events
[0m11:56:06.497817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:23.718771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c99ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bdbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bd850>]}


============================== 12:15:23.725881 | d6539130-c352-4331-a193-08ac10a26bf6 ==============================
[0m12:15:23.725881 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:15:23.726667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:15:25.919384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6539130-c352-4331-a193-08ac10a26bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104865280>]}
[0m12:15:25.991892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6539130-c352-4331-a193-08ac10a26bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d79dc0>]}
[0m12:28:07.010024 [error] [MainThread]: Encountered an error:

[0m12:28:07.025920 [error] [MainThread]: Traceback (most recent call last):
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Applications/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:28:07.035091 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 763.4001, "process_in_blocks": "0", "process_kernel_time": 1.059505, "process_mem_max_rss": "171917312", "process_out_blocks": "0", "process_user_time": 3.731515}
[0m12:28:07.036973 [debug] [MainThread]: Command `dbt docs serve` failed at 12:28:07.036676 after 763.40 seconds
[0m12:28:07.038631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141724560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141875370>]}
[0m12:28:07.039748 [debug] [MainThread]: Flushing usage events
[0m12:28:07.475755 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:37.097021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112239a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112731b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127317c0>]}


============================== 11:38:37.102592 | d0365f89-baf8-4690-83e5-3e2143f69013 ==============================
[0m11:38:37.102592 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:38:37.103422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:38:49.385272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0365f89-baf8-4690-83e5-3e2143f69013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df00e0>]}
[0m11:38:49.453058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0365f89-baf8-4690-83e5-3e2143f69013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb138c0>]}
[0m11:44:15.848169 [error] [MainThread]: Encountered an error:

[0m11:44:15.857000 [error] [MainThread]: Traceback (most recent call last):
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Applications/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:44:15.860180 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 338.84485, "process_in_blocks": "0", "process_kernel_time": 0.853525, "process_mem_max_rss": "171712512", "process_out_blocks": "0", "process_user_time": 3.319986}
[0m11:44:15.861113 [debug] [MainThread]: Command `dbt docs serve` failed at 11:44:15.860946 after 338.85 seconds
[0m11:44:15.861780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112731a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c50110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb13f50>]}
[0m11:44:15.862377 [debug] [MainThread]: Flushing usage events
[0m11:44:16.254301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:46.401182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e961070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee75b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee75730>]}


============================== 11:47:46.408395 | ae6996f3-c3cf-49cf-8316-da9a6cee6e27 ==============================
[0m11:47:46.408395 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:47:46.409177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:47:48.308051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd029c0>]}
[0m11:47:48.368418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e266bd0>]}
[0m11:47:48.369799 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:47:48.534766 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:47:48.747441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:47:48.748132 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/user_session_channel.sql
[0m11:47:48.748626 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/session_timestamp.sql
[0m11:47:49.033671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:47:49.045304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b636fc0>]}
[0m11:47:49.141691 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:47:49.144201 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:47:49.168260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4ae600>]}
[0m11:47:49.168723 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 2 sources, 474 macros
[0m11:47:49.169064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cbfaa0>]}
[0m11:47:49.171450 [info ] [MainThread]: 
[0m11:47:49.171825 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:47:49.172164 [info ] [MainThread]: 
[0m11:47:49.172724 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:49.177194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:47:49.395456 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:47:49.395891 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:47:49.396236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:50.938994 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.543 seconds
[0m11:47:50.942958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_snapshot)
[0m11:47:50.943813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:47:50.963526 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:47:50.967894 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:47:50.968303 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:47:50.968737 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:47:50.969972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:51.241928 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.273 seconds
[0m11:47:51.514793 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.545 seconds
[0m11:47:51.518836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b75a810>]}
[0m11:47:51.525006 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:47:51.525968 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:47:51.526734 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:47:51.527582 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:47:51.528228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.session_timestamp)
[0m11:47:51.528765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.user_session_channel)
[0m11:47:51.529271 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:47:51.529757 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:47:51.539568 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:47:51.542708 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:47:51.543747 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:47:51.550554 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:47:51.600379 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:47:51.601789 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:47:51.602742 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:47:51.603099 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
  );
[0m11:47:51.604030 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:47:51.604391 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
  );
[0m11:47:52.065441 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m11:47:52.072921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m11:47:52.121554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ece450>]}
[0m11:47:52.122088 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd01850>]}
[0m11:47:52.122878 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.59s]
[0m11:47:52.123620 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.59s]
[0m11:47:52.124369 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:47:52.125029 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:47:52.125979 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:47:52.126600 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:47:52.127268 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:47:52.127705 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:47:52.131059 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:47:52.131883 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:47:52.156902 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:47:52.157916 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:47:52.158266 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:47:52.158595 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:47:55.035339 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.877 seconds
[0m11:47:55.039073 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed06d50>]}
[0m11:47:55.039969 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.91s]
[0m11:47:55.040877 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:47:55.042639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:55.043074 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:47:55.043508 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:47:55.154689 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:47:55.155400 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:47:55.280452 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:47:55.281160 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:47:55.427953 [info ] [MainThread]: 
[0m11:47:55.428705 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m11:47:55.430335 [debug] [MainThread]: Command end result
[0m11:47:55.456902 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:47:55.458689 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:47:55.466855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:47:55.467294 [info ] [MainThread]: 
[0m11:47:55.467875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:55.468380 [info ] [MainThread]: 
[0m11:47:55.468851 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:47:55.471342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.156489, "process_in_blocks": "0", "process_kernel_time": 1.264549, "process_mem_max_rss": "193368064", "process_out_blocks": "0", "process_user_time": 5.401274}
[0m11:47:55.471969 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:55.471824 after 9.16 seconds
[0m11:47:55.472506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9607a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e997fe0>]}
[0m11:47:55.472998 [debug] [MainThread]: Flushing usage events
[0m11:47:55.829098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:50:49.744309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dcaab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122b09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129e1790>]}


============================== 11:50:49.749479 | 855ff77f-aff6-458f-9ca7-dc9e1c7b9879 ==============================
[0m11:50:49.749479 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:50:49.750175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:50:50.807617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ed14c20>]}
[0m11:50:50.867910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dff2c0>]}
[0m11:50:50.868628 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:50:51.003923 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:50:51.163729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:51.164080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:51.169193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:50:51.219866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e522570>]}
[0m11:50:51.309671 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:50:51.312065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:50:51.325838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ee5dac0>]}
[0m11:50:51.326283 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 2 sources, 474 macros
[0m11:50:51.326635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f173e90>]}
[0m11:50:51.328406 [info ] [MainThread]: 
[0m11:50:51.328760 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:50:51.329059 [info ] [MainThread]: 
[0m11:50:51.329549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:50:51.333701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:50:51.394323 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:50:51.394708 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:50:51.395012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:51.954758 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.560 seconds
[0m11:50:51.957873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now create_user_db_lobster_analytics)
[0m11:50:51.958645 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster"
schema: "analytics"
"
[0m11:50:51.964427 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster_analytics"
[0m11:50:51.964830 [debug] [ThreadPool]: On create_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster_analytics"} */
create schema if not exists user_db_lobster.analytics
[0m11:50:52.078152 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m11:50:52.081289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster_analytics, now list_user_db_lobster_analytics)
[0m11:50:52.082181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:50:52.102468 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:50:52.107430 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:50:52.107859 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:50:52.108301 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:50:52.109517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:52.206214 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.097 seconds
[0m11:50:52.619753 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.510 seconds
[0m11:50:52.623202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ece1700>]}
[0m11:50:52.626515 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:50:52.627069 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:50:52.627722 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:50:52.628415 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:50:52.629045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m11:50:52.629592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m11:50:52.630115 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:50:52.630613 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:50:52.641548 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:50:52.719588 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:50:52.721909 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:50:52.722648 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:50:52.790250 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:50:52.792418 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:50:52.794781 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:50:52.795652 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:50:52.796085 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
  );
[0m11:50:52.796550 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
  );
[0m11:50:53.006176 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m11:50:53.036939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m11:50:53.039671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108152e0>]}
[0m11:50:53.040435 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.41s]
[0m11:50:53.040939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bd0d0>]}
[0m11:50:53.041652 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:50:53.042353 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.41s]
[0m11:50:53.043262 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:50:53.043993 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:50:53.044668 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:50:53.045411 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:50:53.045867 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:50:53.049176 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:50:53.049923 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:50:53.075856 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:50:53.077431 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:50:53.077850 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:50:53.078203 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:50:54.819990 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.742 seconds
[0m11:50:54.823416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f63b9b0>]}
[0m11:50:54.824326 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.78s]
[0m11:50:54.825255 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:50:54.827011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:54.827448 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:50:54.827860 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:50:54.934547 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:50:54.935248 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:50:55.059867 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:50:55.060607 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:50:55.170406 [info ] [MainThread]: 
[0m11:50:55.171121 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m11:50:55.172752 [debug] [MainThread]: Command end result
[0m11:50:55.199102 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:50:55.202105 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:50:55.210176 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:50:55.210613 [info ] [MainThread]: 
[0m11:50:55.211109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:55.211538 [info ] [MainThread]: 
[0m11:50:55.212160 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:50:55.214682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.538956, "process_in_blocks": "0", "process_kernel_time": 0.740321, "process_mem_max_rss": "189628416", "process_out_blocks": "0", "process_user_time": 3.944396}
[0m11:50:55.215341 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:55.215193 after 5.54 seconds
[0m11:50:55.215844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e1cd220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0f440>]}
[0m11:50:55.216322 [debug] [MainThread]: Flushing usage events
[0m11:50:55.562201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:15.608401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7510a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d795d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7959a0>]}


============================== 11:51:15.613368 | 4fe1203a-33b5-4fa9-8c92-2e76b514c6c6 ==============================
[0m11:51:15.613368 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:51:15.614035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:16.677770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b3cc20>]}
[0m11:51:16.737767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14989cc20>]}
[0m11:51:16.738497 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:51:16.876338 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:51:17.043606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:17.044023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:17.049451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:51:17.100432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8b1ee0>]}
[0m11:51:17.193324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:51:17.195071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:51:17.207896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149f51e80>]}
[0m11:51:17.208315 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 2 sources, 474 macros
[0m11:51:17.208639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149a55fd0>]}
[0m11:51:17.210377 [info ] [MainThread]: 
[0m11:51:17.210828 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:51:17.211113 [info ] [MainThread]: 
[0m11:51:17.211647 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:17.215632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:51:17.274388 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:51:17.274755 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:51:17.275057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:17.823927 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.549 seconds
[0m11:51:17.826989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now create_user_db_lobster_analytics)
[0m11:51:17.827778 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster"
schema: "analytics"
"
[0m11:51:17.833744 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster_analytics"
[0m11:51:17.834174 [debug] [ThreadPool]: On create_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster_analytics"} */
create schema if not exists user_db_lobster.analytics
[0m11:51:17.936199 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m11:51:17.939287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster_analytics, now list_user_db_lobster_analytics)
[0m11:51:17.940113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:51:17.963514 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:51:17.964361 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:51:17.964771 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:51:17.965205 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:51:17.965615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:18.152906 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.187 seconds
[0m11:51:18.393492 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.428 seconds
[0m11:51:18.397033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149a896a0>]}
[0m11:51:18.400155 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:51:18.400718 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:51:18.401363 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:51:18.402052 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:51:18.402683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m11:51:18.403260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m11:51:18.403796 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:51:18.404306 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:51:18.415361 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:51:18.498006 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:51:18.499209 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:51:18.519037 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:51:18.554402 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:51:18.557871 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:51:18.559147 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:51:18.559637 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
  );
[0m11:51:18.561216 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:51:18.561685 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
  );
[0m11:51:18.747826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m11:51:18.755250 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m11:51:18.795688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d77d1f0>]}
[0m11:51:18.796135 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbcd130>]}
[0m11:51:18.796821 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.39s]
[0m11:51:18.797551 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.39s]
[0m11:51:18.798295 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:51:18.798969 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:51:18.799916 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:51:18.800457 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:51:18.801051 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:51:18.801467 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:51:18.804660 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:51:18.805362 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:51:18.828746 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:51:18.829659 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:51:18.830010 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:51:18.830340 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:51:20.649786 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.819 seconds
[0m11:51:20.653293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a39fc20>]}
[0m11:51:20.654200 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.85s]
[0m11:51:20.655140 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:51:20.656931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:20.657373 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:51:20.657815 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:51:20.778531 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:51:20.779222 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:51:20.913948 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:51:20.914641 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:51:21.029848 [info ] [MainThread]: 
[0m11:51:21.030545 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m11:51:21.032165 [debug] [MainThread]: Command end result
[0m11:51:21.058492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:51:21.060205 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:51:21.067874 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:51:21.068321 [info ] [MainThread]: 
[0m11:51:21.068804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:21.069223 [info ] [MainThread]: 
[0m11:51:21.069672 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:51:21.072137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5289373, "process_in_blocks": "0", "process_kernel_time": 0.727422, "process_mem_max_rss": "189067264", "process_out_blocks": "0", "process_user_time": 3.928096}
[0m11:51:21.072754 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:21.072612 after 5.53 seconds
[0m11:51:21.073254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d72fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3e3890>]}
[0m11:51:21.073721 [debug] [MainThread]: Flushing usage events
[0m11:51:21.453336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:09.691678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbb7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0779b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e9c40>]}


============================== 11:53:09.696654 | 70fe3fbf-0856-45e3-8b38-6a0b4b336f6f ==============================
[0m11:53:09.696654 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:53:09.697454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:10.753487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70fe3fbf-0856-45e3-8b38-6a0b4b336f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a1eea80>]}
[0m11:53:10.813151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70fe3fbf-0856-45e3-8b38-6a0b4b336f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a4080e0>]}
[0m11:53:10.813886 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:53:10.956354 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:53:11.117858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:11.118677 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m11:53:11.754617 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.user_session_channel' (models/input/user_session_channel.sql) depends on a source named 'raw.user_session_channel' which was not found
[0m11:53:11.756669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1311536, "process_in_blocks": "0", "process_kernel_time": 0.660979, "process_mem_max_rss": "181518336", "process_out_blocks": "0", "process_user_time": 3.743632}
[0m11:53:11.757159 [debug] [MainThread]: Command `dbt run` failed at 11:53:11.757046 after 2.13 seconds
[0m11:53:11.757549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0779b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d283920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a96dca0>]}
[0m11:53:11.757926 [debug] [MainThread]: Flushing usage events
[0m11:53:12.132568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:43.080508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cae9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938dbb0>]}


============================== 11:53:43.085433 | afa10642-ee70-44ff-ba9d-f68d6bd9c12f ==============================
[0m11:53:43.085433 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:53:43.086100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:53:44.139757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b894c0>]}
[0m11:53:44.198903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1455a2ab0>]}
[0m11:53:44.199609 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:53:44.334006 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:53:44.494241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:44.494864 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/schema.yml
[0m11:53:44.765224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:53:44.777229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457459d0>]}
[0m11:53:44.851421 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:53:44.853149 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:53:44.865351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145c03b30>]}
[0m11:53:44.865762 [info ] [MainThread]: Found 1 snapshot, 3 models, 2 sources, 474 macros
[0m11:53:44.866084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14541b9b0>]}
[0m11:53:44.867765 [info ] [MainThread]: 
[0m11:53:44.868456 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:53:44.868872 [info ] [MainThread]: 
[0m11:53:44.869373 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:53:44.873407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:53:45.025125 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:53:45.025587 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:53:45.025960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:45.677380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.651 seconds
[0m11:53:45.680500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now create_user_db_lobster_analytics)
[0m11:53:45.681293 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster"
schema: "analytics"
"
[0m11:53:45.687263 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster_analytics"
[0m11:53:45.687719 [debug] [ThreadPool]: On create_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster_analytics"} */
create schema if not exists user_db_lobster.analytics
[0m11:53:45.813395 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m11:53:45.816625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster_analytics, now list_user_db_lobster_analytics)
[0m11:53:45.817458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:53:45.836782 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:53:45.837248 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:53:45.842448 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:53:45.843790 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:53:45.844315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:45.930405 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.093 seconds
[0m11:53:46.299717 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.455 seconds
[0m11:53:46.303212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd99be0>]}
[0m11:53:46.306542 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:53:46.307135 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:53:46.307819 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:53:46.308575 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:53:46.309251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m11:53:46.309822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m11:53:46.310350 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:53:46.310840 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:53:46.321061 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:53:46.324261 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:53:46.325133 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:53:46.331570 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:53:46.389726 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:53:46.390292 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:53:46.391363 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:53:46.391727 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
  );
[0m11:53:46.392637 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:53:46.393000 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
  );
[0m11:53:46.670400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.277 seconds
[0m11:53:46.700938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107219910>]}
[0m11:53:46.701748 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.39s]
[0m11:53:46.702563 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:53:46.707767 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m11:53:46.710530 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e22420>]}
[0m11:53:46.711282 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.40s]
[0m11:53:46.712074 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:53:46.712948 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:53:46.713553 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:53:46.714280 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:53:46.714779 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:53:46.718326 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:53:46.719185 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:53:46.747283 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:53:46.748537 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:53:46.749001 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:53:46.749547 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:53:48.410957 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.661 seconds
[0m11:53:48.414400 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145f51610>]}
[0m11:53:48.415341 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.70s]
[0m11:53:48.416242 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:53:48.417931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:48.418349 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:53:48.418769 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:53:48.549436 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:53:48.550101 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:53:48.673655 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:53:48.674335 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:53:48.809214 [info ] [MainThread]: 
[0m11:53:48.809946 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m11:53:48.811567 [debug] [MainThread]: Command end result
[0m11:53:48.837021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:53:48.838672 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:53:48.846203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:53:48.846615 [info ] [MainThread]: 
[0m11:53:48.847099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:48.847520 [info ] [MainThread]: 
[0m11:53:48.848049 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:53:48.850796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.837704, "process_in_blocks": "0", "process_kernel_time": 0.736893, "process_mem_max_rss": "190857216", "process_out_blocks": "0", "process_user_time": 4.121493}
[0m11:53:48.851444 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:48.851299 after 5.84 seconds
[0m11:53:48.851937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0ef920>]}
[0m11:53:48.852414 [debug] [MainThread]: Flushing usage events
[0m11:53:49.256364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:48.526800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d2eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112215e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112215b20>]}


============================== 12:01:48.535035 | 65ac24f7-7af2-4a2c-a49a-bbcaa3078e87 ==============================
[0m12:01:48.535035 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:01:48.535936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:01:50.700659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65ac24f7-7af2-4a2c-a49a-bbcaa3078e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11763ca10>]}
[0m12:01:50.764329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65ac24f7-7af2-4a2c-a49a-bbcaa3078e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117619a0>]}
[0m12:05:55.544732 [error] [MainThread]: Encountered an error:

[0m12:05:55.553755 [error] [MainThread]: Traceback (most recent call last):
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Applications/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:05:55.558556 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 247.11655, "process_in_blocks": "0", "process_kernel_time": 0.988685, "process_mem_max_rss": "171667456", "process_out_blocks": "0", "process_user_time": 3.726048}
[0m12:05:55.559556 [debug] [MainThread]: Command `dbt docs serve` failed at 12:05:55.559380 after 247.12 seconds
[0m12:05:55.560239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d2eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3ec110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121d3740>]}
[0m12:05:55.560812 [debug] [MainThread]: Flushing usage events
[0m12:05:55.958904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:27.490259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b605f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba59d0>]}


============================== 18:32:27.498699 | 00436a86-ff5e-48b8-a97f-a80144c98245 ==============================
[0m18:32:27.498699 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:32:27.499643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:32:30.189839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c0fda0>]}
[0m18:32:30.252645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ded4d10>]}
[0m18:32:30.253970 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:32:30.406765 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:32:30.533154 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:32:30.533754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116cf800>]}
[0m18:32:32.163182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m18:32:32.175308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11104a810>]}
[0m18:32:32.270222 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:32:32.271788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:32:32.310542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3fbe90>]}
[0m18:32:32.311202 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m18:32:32.311676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3324b0>]}
[0m18:32:32.314062 [info ] [MainThread]: 
[0m18:32:32.314535 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m18:32:32.314955 [info ] [MainThread]: 
[0m18:32:32.315597 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:32:32.321327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m18:32:32.484752 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m18:32:32.485129 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m18:32:32.485485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:33.094364 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.609 seconds
[0m18:32:33.098187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m18:32:33.099013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m18:32:33.110775 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m18:32:33.113174 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m18:32:33.113601 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m18:32:33.113990 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m18:32:33.114499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:33.262836 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.148 seconds
[0m18:32:33.556028 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.441 seconds
[0m18:32:33.559369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e4d0470>]}
[0m18:32:33.563882 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m18:32:33.564419 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m18:32:33.565030 [info ] [Thread-1 (]: 1 of 3 START sql empheral model analytics.session_timestamp .................... [RUN]
[0m18:32:33.565687 [info ] [Thread-2 (]: 2 of 3 START sql empheral model analytics.user_session_channel ................. [RUN]
[0m18:32:33.566269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m18:32:33.566789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m18:32:33.567226 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m18:32:33.567646 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m18:32:33.576402 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m18:32:33.579449 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m18:32:33.580411 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m18:32:33.582854 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m18:32:33.588093 [debug] [Thread-1 (]: Compilation Error in model session_timestamp (models/input/session_timestamp.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m18:32:33.588874 [debug] [Thread-2 (]: Compilation Error in model user_session_channel (models/input/user_session_channel.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m18:32:33.591035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e40e300>]}
[0m18:32:33.591504 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ea0cbf0>]}
[0m18:32:33.592388 [error] [Thread-2 (]: 2 of 3 ERROR creating sql empheral model analytics.user_session_channel ........ [[31mERROR[0m in 0.02s]
[0m18:32:33.594059 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m18:32:33.592950 [error] [Thread-1 (]: 1 of 3 ERROR creating sql empheral model analytics.session_timestamp ........... [[31mERROR[0m in 0.02s]
[0m18:32:33.595205 [debug] [Thread-8 (]: Marking all children of 'model.homework7.user_session_channel' to be skipped because of status 'error'.  Reason: Compilation Error in model user_session_channel (models/input/user_session_channel.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake').
[0m18:32:33.596079 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m18:32:33.597593 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_timestamp' to be skipped because of status 'error'.  Reason: Compilation Error in model session_timestamp (models/input/session_timestamp.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake').
[0m18:32:33.598578 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m18:32:33.599088 [info ] [Thread-4 (]: 3 of 3 SKIP relation analytics.session_summary ................................. [[33mSKIP[0m]
[0m18:32:33.599611 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m18:32:33.600930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:33.601298 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m18:32:33.601659 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m18:32:33.786049 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m18:32:33.786781 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m18:32:33.911338 [info ] [MainThread]: 
[0m18:32:33.912036 [info ] [MainThread]: Finished running 2 empheral models, 1 table model in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m18:32:33.913432 [debug] [MainThread]: Command end result
[0m18:32:33.936840 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:32:33.938518 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:32:33.945745 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m18:32:33.946185 [info ] [MainThread]: 
[0m18:32:33.946643 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:32:33.947043 [info ] [MainThread]: 
[0m18:32:33.947512 [error] [MainThread]:   Compilation Error in model user_session_channel (models/input/user_session_channel.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m18:32:33.948026 [info ] [MainThread]: 
[0m18:32:33.948489 [error] [MainThread]:   Compilation Error in model session_timestamp (models/input/session_timestamp.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m18:32:33.948871 [info ] [MainThread]: 
[0m18:32:33.949284 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m18:32:33.952310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5529375, "process_in_blocks": "0", "process_kernel_time": 1.205898, "process_mem_max_rss": "195276800", "process_out_blocks": "0", "process_user_time": 5.815993}
[0m18:32:33.952892 [debug] [MainThread]: Command `dbt run` failed at 18:32:33.952759 after 6.55 seconds
[0m18:32:33.953352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e63f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de2a060>]}
[0m18:32:33.953787 [debug] [MainThread]: Flushing usage events
[0m18:32:34.311566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:18.516382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f18c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112119a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121196d0>]}


============================== 18:34:18.522878 | 2c5e60eb-3baa-482b-8101-8412123729d9 ==============================
[0m18:34:18.522878 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:34:18.523593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:20.540101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f0680>]}
[0m18:34:20.600726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11152e270>]}
[0m18:34:20.602120 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:34:20.767111 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:34:20.916486 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:34:20.917015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c1f620>]}
[0m18:34:22.615576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m18:34:22.625977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ebbbc20>]}
[0m18:34:22.713977 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:34:22.715411 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:34:22.752821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ec380e0>]}
[0m18:34:22.753495 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m18:34:22.753972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e72a5a0>]}
[0m18:34:22.756373 [info ] [MainThread]: 
[0m18:34:22.756843 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m18:34:22.757260 [info ] [MainThread]: 
[0m18:34:22.757902 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:34:22.758904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m18:34:22.841278 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m18:34:22.841746 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m18:34:22.842115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:23.423016 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.580 seconds
[0m18:34:23.426581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m18:34:23.427310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m18:34:23.441883 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m18:34:23.442472 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m18:34:23.442879 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m18:34:23.443318 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m18:34:23.443742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:23.573730 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.129 seconds
[0m18:34:23.926169 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.482 seconds
[0m18:34:23.929559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ec221e0>]}
[0m18:34:23.935321 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m18:34:23.936011 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m18:34:23.936666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m18:34:23.937324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m18:34:23.937912 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m18:34:23.938524 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m18:34:23.948745 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m18:34:23.951974 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m18:34:23.953198 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m18:34:23.954212 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m18:34:23.955073 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m18:34:23.955770 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m18:34:23.956463 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m18:34:23.956923 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m18:34:23.961887 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m18:34:23.962651 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m18:34:24.007044 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m18:34:24.008752 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m18:34:24.009231 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (with __dbt__cte__user_session_channel as (
with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
),  __dbt__cte__session_timestamp as (
with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
) SELECT u.userId, u.sessionId, u.channel, st.ts
FROM __dbt__cte__user_session_channel u
JOIN __dbt__cte__session_timestamp st ON u.sessionId = st.sessionId
        );
[0m18:34:24.009694 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:34:27.467784 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.458 seconds
[0m18:34:27.498099 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115518b0>]}
[0m18:34:27.498740 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 3.54s]
[0m18:34:27.499333 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m18:34:27.500966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:27.501278 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m18:34:27.501577 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m18:34:27.644154 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m18:34:27.644552 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m18:34:27.772613 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m18:34:27.773084 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m18:34:27.907082 [info ] [MainThread]: 
[0m18:34:27.907497 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m18:34:27.908156 [debug] [MainThread]: Command end result
[0m18:34:27.947257 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:34:27.949084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:34:27.955876 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m18:34:27.956267 [info ] [MainThread]: 
[0m18:34:27.956746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:27.957137 [info ] [MainThread]: 
[0m18:34:27.957554 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:27.961045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.517253, "process_in_blocks": "0", "process_kernel_time": 1.111896, "process_mem_max_rss": "199045120", "process_out_blocks": "0", "process_user_time": 5.879602}
[0m18:34:27.961630 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:27.961499 after 9.52 seconds
[0m18:34:27.962159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111979220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e23350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e9dcad0>]}
[0m18:34:27.962616 [debug] [MainThread]: Flushing usage events
[0m18:34:28.342108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:47:42.240036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0dd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b18e0>]}


============================== 18:47:42.247558 | 08e4755f-8f37-4807-b2b1-ba0ea08470fd ==============================
[0m18:47:42.247558 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:47:42.248350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:47:44.305765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149adcf50>]}
[0m18:47:44.368999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149746330>]}
[0m18:47:44.370218 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:47:44.525566 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:47:44.733121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:47:44.733833 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/user_session_channel.sql
[0m18:47:44.734327 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/session_timestamp.sql
[0m18:47:45.020261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m18:47:45.033658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a076ab0>]}
[0m18:47:45.124962 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:47:45.126607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:47:45.162559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a0c6bd0>]}
[0m18:47:45.163181 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m18:47:45.163654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a076660>]}
[0m18:47:45.166104 [info ] [MainThread]: 
[0m18:47:45.166596 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m18:47:45.167017 [info ] [MainThread]: 
[0m18:47:45.167678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:47:45.168722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m18:47:45.333829 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m18:47:45.334484 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m18:47:45.335028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:46.182465 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.847 seconds
[0m18:47:46.186257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m18:47:46.187108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m18:47:46.207054 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m18:47:46.211677 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m18:47:46.212093 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m18:47:46.212523 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m18:47:46.213769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:46.394583 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.182 seconds
[0m18:47:46.767378 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.554 seconds
[0m18:47:46.770834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149e538f0>]}
[0m18:47:46.776629 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m18:47:46.777316 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m18:47:46.777967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m18:47:46.778614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m18:47:46.779211 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m18:47:46.779778 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m18:47:46.790389 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m18:47:46.793696 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m18:47:46.794979 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m18:47:46.795979 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m18:47:46.796863 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m18:47:46.797517 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m18:47:46.798290 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m18:47:46.798800 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m18:47:46.804106 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m18:47:46.805036 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m18:47:46.857861 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m18:47:46.859842 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m18:47:46.860409 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (with __dbt__cte__user_session_channel as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
),  __dbt__cte__session_timestamp as (
SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
) SELECT u.userId, u.sessionId, u.channel, st.ts
FROM __dbt__cte__user_session_channel u
JOIN __dbt__cte__session_timestamp st ON u.sessionId = st.sessionId
        );
[0m18:47:46.879931 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:47:49.815676 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.936 seconds
[0m18:47:49.853660 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5e1580>]}
[0m18:47:49.854594 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 3.05s]
[0m18:47:49.855409 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m18:47:49.857026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:49.857426 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m18:47:49.857826 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m18:47:50.039950 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m18:47:50.040647 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m18:47:50.202771 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m18:47:50.203456 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m18:47:50.374722 [info ] [MainThread]: 
[0m18:47:50.375433 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m18:47:50.376571 [debug] [MainThread]: Command end result
[0m18:47:50.404227 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:47:50.405918 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:47:50.413091 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m18:47:50.413540 [info ] [MainThread]: 
[0m18:47:50.414080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:47:50.414508 [info ] [MainThread]: 
[0m18:47:50.414962 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:47:50.419613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.260412, "process_in_blocks": "0", "process_kernel_time": 1.131122, "process_mem_max_rss": "192610304", "process_out_blocks": "0", "process_user_time": 4.785747}
[0m18:47:50.420326 [debug] [MainThread]: Command `dbt run` succeeded at 18:47:50.420181 after 8.26 seconds
[0m18:47:50.420832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d624260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ac4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a05f020>]}
[0m18:47:50.421338 [debug] [MainThread]: Flushing usage events
[0m18:47:50.830179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:59.384453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c5a00>]}


============================== 14:49:59.392858 | bcb639bd-520e-4bb4-b8fe-1374084805e9 ==============================
[0m14:49:59.392858 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:49:59.393770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:01.909306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ffc1a0>]}
[0m14:50:01.970158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e6c2180>]}
[0m14:50:01.971374 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:50:02.134970 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:50:02.285796 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:50:02.286529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ea5fb60>]}
[0m14:50:03.885684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m14:50:03.899995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ec62780>]}
[0m14:50:03.989149 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m14:50:03.991339 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m14:50:04.028307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eebc0b0>]}
[0m14:50:04.028974 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m14:50:04.029459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eedf140>]}
[0m14:50:04.031879 [info ] [MainThread]: 
[0m14:50:04.032358 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m14:50:04.032782 [info ] [MainThread]: 
[0m14:50:04.033422 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:04.034422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m14:50:04.211835 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m14:50:04.212326 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m14:50:04.212679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:05.251917 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m14:50:05.252550 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:50:05.253171 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m14:50:05.253705 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:50:05.254920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:05.255363 [debug] [MainThread]: Connection 'list_user_db_lobster1' was left open.
[0m14:50:05.255794 [debug] [MainThread]: On list_user_db_lobster1: No close available on handle
[0m14:50:05.256213 [info ] [MainThread]: 
[0m14:50:05.256712 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m14:50:05.257334 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "user_db_lobster1"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m14:50:05.262158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.9691887, "process_in_blocks": "0", "process_kernel_time": 1.138938, "process_mem_max_rss": "193024000", "process_out_blocks": "0", "process_user_time": 5.47593}
[0m14:50:05.262947 [debug] [MainThread]: Command `dbt run` failed at 14:50:05.262792 after 5.97 seconds
[0m14:50:05.263473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ecad880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eedf140>]}
[0m14:50:05.263971 [debug] [MainThread]: Flushing usage events
[0m14:50:05.268151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:40.737751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142241d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114271ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114271940>]}


============================== 17:04:40.745655 | 91038138-ccb5-4469-9737-037cd10fa040 ==============================
[0m17:04:40.745655 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:04:40.746551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:04:43.044178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91038138-ccb5-4469-9737-037cd10fa040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117250530>]}
[0m17:04:43.103403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91038138-ccb5-4469-9737-037cd10fa040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1505c9520>]}
[0m17:04:43.104634 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:04:43.268097 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:04:43.485075 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m17:04:43.485705 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/moving_average.sql
[0m17:04:43.486137 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/gap_analysis.sql
[0m17:04:43.486688 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m17:04:43.487277 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/user_session_channel.sql
[0m17:04:43.487640 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/session_timestamp.sql
[0m17:04:43.488052 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:04:44.224813 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.moving_average' (models/input/moving_average.sql) depends on a source named 'raw.session_timestamp' which was not found
[0m17:04:44.229157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.581145, "process_in_blocks": "0", "process_kernel_time": 0.99234, "process_mem_max_rss": "182067200", "process_out_blocks": "0", "process_user_time": 4.471711}
[0m17:04:44.230235 [debug] [MainThread]: Command `dbt run` failed at 17:04:44.229977 after 3.58 seconds
[0m17:04:44.230885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c65a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150adfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150aefc50>]}
[0m17:04:44.231495 [debug] [MainThread]: Flushing usage events
[0m17:04:44.573555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:18.943775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148d790>]}


============================== 17:05:18.948747 | de609a81-ef1f-44de-a5ae-c340536260b9 ==============================
[0m17:05:18.948747 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:05:18.949408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:20.037224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de609a81-ef1f-44de-a5ae-c340536260b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d7ce360>]}
[0m17:05:20.100299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de609a81-ef1f-44de-a5ae-c340536260b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d6408f0>]}
[0m17:05:20.101084 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:05:20.240286 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:05:20.398677 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m17:05:20.399185 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/moving_average.sql
[0m17:05:20.399515 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/gap_analysis.sql
[0m17:05:20.399935 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m17:05:20.400385 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/session_timestamp.sql
[0m17:05:20.400675 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/user_session_channel.sql
[0m17:05:20.401001 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:05:21.159354 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.gap_analysis' (models/input/gap_analysis.sql) depends on a source named 'raw.user_session_channel' which was not found
[0m17:05:21.161442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.285344, "process_in_blocks": "0", "process_kernel_time": 0.6881, "process_mem_max_rss": "182714368", "process_out_blocks": "0", "process_user_time": 3.894451}
[0m17:05:21.161935 [debug] [MainThread]: Command `dbt run` failed at 17:05:21.161818 after 2.29 seconds
[0m17:05:21.162333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dc78c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dd6f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dd67a10>]}
[0m17:05:21.162718 [debug] [MainThread]: Flushing usage events
[0m17:05:21.614570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:37.922441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327d940>]}


============================== 17:05:37.927368 | 0e759921-0e2c-47bd-9656-fd0e159b409e ==============================
[0m17:05:37.927368 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:05:37.928035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:38.997967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184966c0>]}
[0m17:05:39.057716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f5d06e0>]}
[0m17:05:39.058447 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:05:39.195825 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:05:39.355039 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m17:05:39.355553 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/moving_average.sql
[0m17:05:39.355884 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/gap_analysis.sql
[0m17:05:39.356307 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m17:05:39.356759 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/user_session_channel.sql
[0m17:05:39.357049 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/session_timestamp.sql
[0m17:05:39.357372 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:05:40.137424 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:05:40.147234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fafa6c0>]}
[0m17:05:40.236454 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:05:40.238159 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:05:40.275885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8cac90>]}
[0m17:05:40.276551 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 1 source, 474 macros
[0m17:05:40.277028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb5c8f0>]}
[0m17:05:40.279412 [info ] [MainThread]: 
[0m17:05:40.279900 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:05:40.280304 [info ] [MainThread]: 
[0m17:05:40.280924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:05:40.281892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:05:40.364007 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:05:40.364461 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:05:40.364811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:41.455083 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.090 seconds
[0m17:05:41.458070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now create_user_db_lobster1_analytics)
[0m17:05:41.459778 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster1"
schema: "analytics"
"
[0m17:05:41.466244 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster1_analytics"
[0m17:05:41.466724 [debug] [ThreadPool]: On create_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster1_analytics"} */
create schema if not exists user_db_lobster1.analytics
[0m17:05:41.582561 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m17:05:41.585417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m17:05:41.586244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:05:41.605317 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:05:41.610280 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:05:41.610694 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:05:41.611131 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:05:41.611678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:41.731868 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9585-0304-eb6a-0004-59ff001ca22a
[0m17:05:41.732409 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:05:41.732958 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:05:41.733376 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:05:41.902985 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.291 seconds
[0m17:05:41.905928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f645670>]}
[0m17:05:41.912320 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:05:41.912994 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:05:41.913639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:05:41.914288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:05:41.914874 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:05:41.915442 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:05:41.925303 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:05:41.928367 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:05:41.929515 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:05:41.930394 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:05:41.931120 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:05:41.931744 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:05:41.932414 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:05:41.932869 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:05:41.937145 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:05:41.938118 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:05:41.975013 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:05:41.976550 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:05:41.977005 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap
        );
[0m17:05:41.977445 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:05:43.500893 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.523 seconds
[0m17:05:43.535373 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b1460>]}
[0m17:05:43.536282 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.60s]
[0m17:05:43.537062 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:05:43.538607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:43.538997 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:05:43.539390 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:05:43.639229 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:05:43.639917 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:05:43.741876 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:05:43.742535 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:05:43.845312 [info ] [MainThread]: 
[0m17:05:43.846024 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m17:05:43.847115 [debug] [MainThread]: Command end result
[0m17:05:43.876154 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:05:43.878021 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:05:43.885189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:05:43.885636 [info ] [MainThread]: 
[0m17:05:43.886137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:43.886607 [info ] [MainThread]: 
[0m17:05:43.887051 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:05:43.889633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0349092, "process_in_blocks": "0", "process_kernel_time": 0.885148, "process_mem_max_rss": "199393280", "process_out_blocks": "0", "process_user_time": 4.891568}
[0m17:05:43.890295 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:43.890153 after 6.04 seconds
[0m17:05:43.890790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f968140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c30b0>]}
[0m17:05:43.891260 [debug] [MainThread]: Flushing usage events
[0m17:05:44.219461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:45.760648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104751730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1d970>]}


============================== 17:07:45.765628 | dc062e73-9558-497d-9cb9-d1271c2fdef1 ==============================
[0m17:07:45.765628 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:07:45.766285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:46.842935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140dff770>]}
[0m17:07:46.903835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140411940>]}
[0m17:07:46.904583 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:07:47.043758 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:07:47.205424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:07:47.205984 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/gap_analysis.sql
[0m17:07:47.206372 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/moving_average.sql
[0m17:07:47.483894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:07:47.495809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1414e6f60>]}
[0m17:07:47.586279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:07:47.588087 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:07:47.601053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141515ac0>]}
[0m17:07:47.601496 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 1 source, 474 macros
[0m17:07:47.601838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1412bc2c0>]}
[0m17:07:47.603595 [info ] [MainThread]: 
[0m17:07:47.603945 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:07:47.604245 [info ] [MainThread]: 
[0m17:07:47.604725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:47.605476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:07:47.740948 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:07:47.741564 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:07:47.742095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:48.324586 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.582 seconds
[0m17:07:48.328545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:07:48.329283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:07:48.352978 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:07:48.353458 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:07:48.353868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:48.355847 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:07:48.356394 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:07:48.554991 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9587-0304-e858-0004-59ff001cb236
[0m17:07:48.555612 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:07:48.556148 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:07:48.556560 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:07:48.840998 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.487 seconds
[0m17:07:48.844458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141583f50>]}
[0m17:07:48.847720 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:07:48.848275 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:07:48.848807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:07:48.849359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:07:48.849853 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:07:48.850328 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:07:48.860519 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:07:48.863681 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:07:48.864900 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:07:48.865843 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:07:48.866664 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:07:48.867355 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:07:48.868062 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:07:48.868540 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:07:48.872896 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:07:48.873692 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:07:48.910723 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:07:48.912256 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:07:48.912718 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap
        );
[0m17:07:48.913156 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:07:50.245817 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.332 seconds
[0m17:07:50.280779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a3d820>]}
[0m17:07:50.281465 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.41s]
[0m17:07:50.282156 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:07:50.283621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:50.283975 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:07:50.284331 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:07:50.393911 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:07:50.394595 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:07:50.548136 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:07:50.548849 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:07:50.636920 [info ] [MainThread]: 
[0m17:07:50.637590 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m17:07:50.638690 [debug] [MainThread]: Command end result
[0m17:07:50.665802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:07:50.667646 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:07:50.675515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:07:50.676031 [info ] [MainThread]: 
[0m17:07:50.676567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:50.677011 [info ] [MainThread]: 
[0m17:07:50.677461 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:07:50.680041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.98543, "process_in_blocks": "0", "process_kernel_time": 0.743435, "process_mem_max_rss": "193392640", "process_out_blocks": "0", "process_user_time": 4.139705}
[0m17:07:50.680700 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:50.680556 after 4.99 seconds
[0m17:07:50.681231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104723ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104723dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1419b6d50>]}
[0m17:07:50.681736 [debug] [MainThread]: Flushing usage events
[0m17:07:51.111766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:15.224828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b1a30>]}


============================== 17:09:15.232179 | 81757008-2ee8-494e-af1b-f755cbf54288 ==============================
[0m17:09:15.232179 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:09:15.233117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:17.333370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1446b6990>]}
[0m17:09:17.392972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14491d040>]}
[0m17:09:17.394698 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:09:17.564930 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:09:17.781247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:17.782017 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:09:18.215469 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:09:18.227392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d4db20>]}
[0m17:09:18.417913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:09:18.419696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:09:18.458080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e48f80>]}
[0m17:09:18.458691 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:09:18.459163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106528380>]}
[0m17:09:18.461483 [info ] [MainThread]: 
[0m17:09:18.461954 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:09:18.462380 [info ] [MainThread]: 
[0m17:09:18.463015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:09:18.464018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:09:18.551788 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:09:18.552314 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:09:18.552721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:19.361898 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.809 seconds
[0m17:09:19.365522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:09:19.366370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:09:19.385966 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:09:19.390311 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:09:19.390724 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:09:19.391160 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:09:19.392011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:19.535876 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m17:09:19.824677 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9589-0304-e858-0004-59ff001cb26e
[0m17:09:19.825300 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:09:19.825943 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:09:19.826446 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:09:19.827393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14524d2e0>]}
[0m17:09:19.831948 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:09:19.832533 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:09:19.833098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:09:19.833659 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:09:19.834173 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:09:19.834707 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:09:19.844769 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:09:19.847924 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:09:19.849262 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:09:19.850142 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:09:19.850956 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:09:19.851583 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:09:19.852308 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:09:19.852781 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:09:19.857336 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:09:19.858059 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:09:19.895673 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:09:19.897213 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:09:19.897667 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date
        );
[0m17:09:19.898109 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:09:21.051255 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.153 seconds
[0m17:09:21.089370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f59d0>]}
[0m17:09:21.090240 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.24s]
[0m17:09:21.091006 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:09:21.092499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:21.092875 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:09:21.093249 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:09:21.214042 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:09:21.214812 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:09:21.314062 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:09:21.314695 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:09:21.407010 [info ] [MainThread]: 
[0m17:09:21.407716 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m17:09:21.408831 [debug] [MainThread]: Command end result
[0m17:09:21.433349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:09:21.434914 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:09:21.441225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:09:21.441577 [info ] [MainThread]: 
[0m17:09:21.442027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:21.442402 [info ] [MainThread]: 
[0m17:09:21.442797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:21.446339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3019366, "process_in_blocks": "0", "process_kernel_time": 1.180201, "process_mem_max_rss": "193806336", "process_out_blocks": "0", "process_user_time": 5.047975}
[0m17:09:21.446998 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:21.446866 after 6.30 seconds
[0m17:09:21.447464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e5640>]}
[0m17:09:21.447900 [debug] [MainThread]: Flushing usage events
[0m17:09:21.775636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:05.701583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c965cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce2dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce2d8e0>]}


============================== 17:11:05.709070 | eacbaac8-54da-4031-a8cd-25138967942f ==============================
[0m17:11:05.709070 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:11:05.709857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:11:07.743804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac52a50>]}
[0m17:11:07.806935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe43260>]}
[0m17:11:07.808419 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:11:07.975792 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:11:08.193249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:11:08.193937 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/moving_average.sql
[0m17:11:08.194396 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/gap_analysis.sql
[0m17:11:08.194900 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:11:08.648194 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:11:08.660460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1495b2660>]}
[0m17:11:08.851682 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:11:08.853552 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:11:08.890356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149660230>]}
[0m17:11:08.890983 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:11:08.891457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149801370>]}
[0m17:11:08.893755 [info ] [MainThread]: 
[0m17:11:08.894230 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:11:08.894647 [info ] [MainThread]: 
[0m17:11:08.895276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:11:08.896266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:11:08.982758 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:11:08.983220 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:11:08.983602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:09.786075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.802 seconds
[0m17:11:09.789695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:11:09.790543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:11:09.809696 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:11:09.813991 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:11:09.814392 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:11:09.814822 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:11:09.816045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:10.068524 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.253 seconds
[0m17:11:10.373569 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb958b-0304-eb90-0004-59ff001c7da2
[0m17:11:10.374183 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:11:10.374833 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:11:10.375329 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:11:10.376284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1496339b0>]}
[0m17:11:10.381233 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:11:10.381930 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:11:10.382586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:11:10.383225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:11:10.383816 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:11:10.384383 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:11:10.394525 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:11:10.397648 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:11:10.399692 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:11:10.400546 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:11:10.401552 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:11:10.402215 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:11:10.402977 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:11:10.403471 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:11:10.408731 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:11:10.409915 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:11:10.448504 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:11:10.450093 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:11:10.450555 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol == gap.symbol
        );
[0m17:11:10.450996 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:11:11.659487 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb958b-0304-eb90-0004-59ff001c7da6
[0m17:11:11.660326 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function "=="
[0m17:11:11.666944 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:11:11.669555 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c259ac0>]}
[0m17:11:11.670382 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 1.26s]
[0m17:11:11.671198 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:11:11.671914 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:11:11.674259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:11.674682 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:11:11.675081 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:11:11.788181 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:11:11.788872 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:11:11.900975 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:11:11.901662 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:11:12.556026 [info ] [MainThread]: 
[0m17:11:12.556665 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m17:11:12.557767 [debug] [MainThread]: Command end result
[0m17:11:12.583105 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:11:12.584817 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:11:12.591337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:11:12.591736 [info ] [MainThread]: 
[0m17:11:12.592195 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:11:12.592597 [info ] [MainThread]: 
[0m17:11:12.593065 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:11:12.593480 [info ] [MainThread]: 
[0m17:11:12.593905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:11:12.597720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.9856052, "process_in_blocks": "0", "process_kernel_time": 1.14177, "process_mem_max_rss": "194854912", "process_out_blocks": "0", "process_user_time": 5.054076}
[0m17:11:12.598379 [debug] [MainThread]: Command `dbt run` failed at 17:11:12.598243 after 6.99 seconds
[0m17:11:12.598844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb9b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c298350>]}
[0m17:11:12.599284 [debug] [MainThread]: Flushing usage events
[0m17:11:13.084386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:48.445833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112441460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113011910>]}


============================== 17:13:48.450850 | 6897dba8-96f9-4020-8a06-2f229c6b9268 ==============================
[0m17:13:48.450850 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:13:48.451527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:49.767204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea2360>]}
[0m17:13:49.826990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ecd1340>]}
[0m17:13:49.827723 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:13:49.973230 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:13:50.134798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:50.135383 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:13:50.561318 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:13:50.574282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fa04a40>]}
[0m17:13:50.771335 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:13:50.773094 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:13:50.788249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14faaae70>]}
[0m17:13:50.788772 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:13:50.789181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9a64b0>]}
[0m17:13:50.791185 [info ] [MainThread]: 
[0m17:13:50.791590 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:13:50.791957 [info ] [MainThread]: 
[0m17:13:50.792505 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:13:50.793380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:13:50.855246 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:13:50.855625 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:13:50.855920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:51.369960 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.514 seconds
[0m17:13:51.373576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:13:51.374436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:13:51.387430 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:13:51.389858 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:13:51.390297 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:13:51.390718 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:13:51.391270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:51.467780 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb958d-0304-eb8b-0004-59ff001c84e2
[0m17:13:51.468244 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:13:51.468720 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:13:51.469083 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:13:51.816008 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.425 seconds
[0m17:13:51.819501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8da960>]}
[0m17:13:51.822689 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:13:51.823255 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:13:51.823794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:13:51.824357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:13:51.824862 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:13:51.825351 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:13:51.835372 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:13:51.838481 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:13:51.839875 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:13:51.840784 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:13:51.841512 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:13:51.842292 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:13:51.843046 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:13:51.843532 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:13:51.848209 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:13:51.848972 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:13:51.887116 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:13:51.888699 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:13:51.889156 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.symbol == gap.symbol
        );
[0m17:13:51.889596 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:13:52.337308 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb958d-0304-eb6a-0004-59ff001ca34a
[0m17:13:52.337961 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function "=="
[0m17:13:52.342262 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:13:52.344246 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112441b20>]}
[0m17:13:52.345027 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.50s]
[0m17:13:52.345818 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:13:52.346502 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:13:52.348747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:52.349149 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:13:52.349629 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:13:52.458840 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:13:52.459354 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:13:52.563394 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:13:52.564087 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:13:52.830385 [info ] [MainThread]: 
[0m17:13:52.831028 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m17:13:52.832112 [debug] [MainThread]: Command end result
[0m17:13:52.856894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:13:52.858585 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:13:52.865121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:13:52.865507 [info ] [MainThread]: 
[0m17:13:52.865965 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:13:52.866395 [info ] [MainThread]: 
[0m17:13:52.866868 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:13:52.867287 [info ] [MainThread]: 
[0m17:13:52.867706 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:13:52.871039 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4930243, "process_in_blocks": "0", "process_kernel_time": 0.779382, "process_mem_max_rss": "193212416", "process_out_blocks": "0", "process_user_time": 4.322025}
[0m17:13:52.871755 [debug] [MainThread]: Command `dbt run` failed at 17:13:52.871609 after 4.49 seconds
[0m17:13:52.872288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124803e0>]}
[0m17:13:52.872787 [debug] [MainThread]: Flushing usage events
[0m17:13:53.298016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:15.265191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104992f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d8e0>]}


============================== 17:14:15.272690 | 632501b8-f80d-4225-92a0-56144f21ff3a ==============================
[0m17:14:15.272690 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:14:15.273613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:14:17.557912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aaa6f0>]}
[0m17:14:17.621165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7e600>]}
[0m17:14:17.622549 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:14:17.786510 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:14:17.997053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:17.997498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:18.003639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:14:18.057449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142feaf30>]}
[0m17:14:18.150603 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:14:18.152495 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:14:18.185951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142efac30>]}
[0m17:14:18.186588 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:14:18.187042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431383b0>]}
[0m17:14:18.189426 [info ] [MainThread]: 
[0m17:14:18.189898 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:14:18.190312 [info ] [MainThread]: 
[0m17:14:18.190936 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:14:18.191967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:14:18.276628 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:14:18.277082 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:14:18.277460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:18.842040 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.564 seconds
[0m17:14:18.845701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:14:18.846550 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:14:18.866219 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:14:18.870431 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:14:18.870847 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:14:18.871284 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:14:18.872509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:18.977232 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb958e-0304-eb6a-0004-59ff001ca34e
[0m17:14:18.977784 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:14:18.978340 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:14:18.978757 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:14:19.556243 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.684 seconds
[0m17:14:19.559698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142fea8d0>]}
[0m17:14:19.564850 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:14:19.565511 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:14:19.566116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:14:19.566696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:14:19.567226 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:14:19.567736 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:14:19.580053 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:14:19.581418 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:14:19.582529 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:14:19.583398 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:14:19.584227 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:14:19.584855 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:14:19.585712 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:14:19.586208 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:14:19.590999 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:14:19.591764 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:14:19.708063 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:14:19.710078 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:14:19.710677 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.symbol == gap.symbol
        );
[0m17:14:19.711275 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:14:20.102589 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb958e-0304-eb8b-0004-59ff001c84fa
[0m17:14:20.103278 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function "=="
[0m17:14:20.109490 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:14:20.111849 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595d0a0>]}
[0m17:14:20.112683 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.52s]
[0m17:14:20.113514 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:14:20.114242 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:14:20.116538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:20.116937 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:14:20.117340 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:14:20.227743 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:14:20.228437 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:14:20.328565 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:14:20.329258 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:14:20.427085 [info ] [MainThread]: 
[0m17:14:20.427728 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m17:14:20.428818 [debug] [MainThread]: Command end result
[0m17:14:20.454521 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:14:20.456254 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:14:20.463099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:14:20.463460 [info ] [MainThread]: 
[0m17:14:20.463930 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:14:20.464378 [info ] [MainThread]: 
[0m17:14:20.464909 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:14:20.465302 [info ] [MainThread]: 
[0m17:14:20.465723 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:14:20.469824 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.293099, "process_in_blocks": "0", "process_kernel_time": 1.083994, "process_mem_max_rss": "188469248", "process_out_blocks": "0", "process_user_time": 4.457203}
[0m17:14:20.470551 [debug] [MainThread]: Command `dbt run` failed at 17:14:20.470406 after 5.29 seconds
[0m17:14:20.471036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143473fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104992f60>]}
[0m17:14:20.471489 [debug] [MainThread]: Flushing usage events
[0m17:14:20.792526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:44.250286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ee9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0d970>]}


============================== 17:15:44.255358 | 8322c274-f080-4611-9bd8-ddbb8e0acdc3 ==============================
[0m17:15:44.255358 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:15:44.256025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:45.349630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cc98ad0>]}
[0m17:15:45.417852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9d5430>]}
[0m17:15:45.418862 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:15:45.561543 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:15:45.723716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:15:45.724306 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:15:46.149693 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:15:46.161280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d349220>]}
[0m17:15:46.343936 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:15:46.345701 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:15:46.360575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d423f50>]}
[0m17:15:46.361092 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:15:46.361507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d348470>]}
[0m17:15:46.363522 [info ] [MainThread]: 
[0m17:15:46.363929 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:15:46.364292 [info ] [MainThread]: 
[0m17:15:46.364848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:15:46.365712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:15:46.430861 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:15:46.431237 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:15:46.431533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:46.964452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.533 seconds
[0m17:15:46.968125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:15:46.968960 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:15:46.987670 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:15:46.991405 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:15:46.991787 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:15:46.992186 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:15:46.993293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:47.095429 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m17:15:47.414309 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb958f-0304-eb8b-0004-59ff001c8522
[0m17:15:47.414905 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:15:47.415519 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:15:47.415943 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:15:47.416733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb612e0>]}
[0m17:15:47.419670 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:15:47.420230 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:15:47.420764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:15:47.421324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:15:47.421837 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:15:47.422327 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:15:47.432385 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:15:47.435491 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:15:47.436741 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:15:47.437748 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:15:47.438670 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:15:47.439312 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:15:47.439989 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:15:47.440459 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:15:47.445077 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:15:47.445807 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:15:47.483592 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:15:47.485163 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:15:47.485615 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.symbol = gap.symbol
        );
[0m17:15:47.486054 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:15:49.815475 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.329 seconds
[0m17:15:49.850585 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe79730>]}
[0m17:15:49.851315 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.41s]
[0m17:15:49.852017 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:15:49.853485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:49.853837 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:15:49.854194 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:15:49.944585 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:15:49.945275 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:15:50.038924 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:15:50.039604 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:15:50.158897 [info ] [MainThread]: 
[0m17:15:50.159532 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m17:15:50.160620 [debug] [MainThread]: Command end result
[0m17:15:50.186319 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:15:50.188177 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:15:50.195329 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:15:50.195770 [info ] [MainThread]: 
[0m17:15:50.196285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:50.196798 [info ] [MainThread]: 
[0m17:15:50.197396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:15:50.199971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.01698, "process_in_blocks": "0", "process_kernel_time": 0.753626, "process_mem_max_rss": "194883584", "process_out_blocks": "0", "process_user_time": 4.310293}
[0m17:15:50.200628 [debug] [MainThread]: Command `dbt run` succeeded at 17:15:50.200487 after 6.02 seconds
[0m17:15:50.201124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6ded20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d670350>]}
[0m17:15:50.201592 [debug] [MainThread]: Flushing usage events
[0m17:15:50.520192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:56.073926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a9550>]}


============================== 17:16:56.079494 | 53b7e899-4744-4b5d-8217-e4141ee93c24 ==============================
[0m17:16:56.079494 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:16:56.080288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:16:57.266783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14669be60>]}
[0m17:16:57.343851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7992b0>]}
[0m17:16:57.344716 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:16:57.555327 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:16:57.754858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:57.755599 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:16:58.216924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:16:58.229163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146c9c290>]}
[0m17:16:58.414264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:16:58.416086 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:16:58.430942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146d53dd0>]}
[0m17:16:58.431444 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:16:58.431853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146de5640>]}
[0m17:16:58.434636 [info ] [MainThread]: 
[0m17:16:58.435177 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:16:58.435584 [info ] [MainThread]: 
[0m17:16:58.436161 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:58.437094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:16:58.504947 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:16:58.505344 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:16:58.505651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:59.101464 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.596 seconds
[0m17:16:59.103786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:16:59.104346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:16:59.114759 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:16:59.116942 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:16:59.117298 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:16:59.117625 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:16:59.118592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:59.229559 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9590-0304-eb6a-0004-59ff001ca3a6
[0m17:16:59.229957 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:16:59.230429 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:16:59.230756 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:16:59.515161 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.397 seconds
[0m17:16:59.517697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f199a0>]}
[0m17:16:59.520379 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:16:59.520871 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:16:59.521354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:16:59.521872 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:16:59.522331 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:16:59.522761 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:16:59.532885 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:16:59.536325 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:16:59.537556 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:16:59.538385 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:16:59.539186 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:16:59.540082 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:16:59.540981 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:16:59.541436 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:16:59.546085 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:16:59.546855 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:16:59.590682 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:16:59.592488 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:16:59.593012 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,symbola
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date
        );
[0m17:16:59.593482 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:17:00.017767 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb9590-0304-eb6a-0004-59ff001ca3aa
[0m17:17:00.018293 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 26
invalid identifier 'SYMBOLA'
[0m17:17:00.021938 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  000904 (42000): SQL compilation error: error line 15 at position 26
  invalid identifier 'SYMBOLA'
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:17:00.023827 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d9af0>]}
[0m17:17:00.024630 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.48s]
[0m17:17:00.025614 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:17:00.026322 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  000904 (42000): SQL compilation error: error line 15 at position 26
  invalid identifier 'SYMBOLA'
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:17:00.028522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:00.028921 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:17:00.029300 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:17:00.147456 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:17:00.147909 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:17:00.234106 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:17:00.234793 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:17:00.326329 [info ] [MainThread]: 
[0m17:17:00.327071 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m17:17:00.328166 [debug] [MainThread]: Command end result
[0m17:17:00.354808 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:17:00.356688 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:17:00.364144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:17:00.364606 [info ] [MainThread]: 
[0m17:17:00.365319 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:17:00.366036 [info ] [MainThread]: 
[0m17:17:00.366607 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  000904 (42000): SQL compilation error: error line 15 at position 26
  invalid identifier 'SYMBOLA'
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:17:00.367089 [info ] [MainThread]: 
[0m17:17:00.367594 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:00.370456 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.383221, "process_in_blocks": "0", "process_kernel_time": 0.865388, "process_mem_max_rss": "193835008", "process_out_blocks": "0", "process_user_time": 4.58367}
[0m17:17:00.371337 [debug] [MainThread]: Command `dbt run` failed at 17:17:00.371168 after 4.38 seconds
[0m17:17:00.371889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43bf50>]}
[0m17:17:00.372398 [debug] [MainThread]: Flushing usage events
[0m17:17:00.672861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:42.829547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba3f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c061b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0617c0>]}


============================== 17:17:42.835450 | 5e2b6b3a-0b60-455a-93dc-e4cfbece88a4 ==============================
[0m17:17:42.835450 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:17:42.836204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:17:44.084067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f058710>]}
[0m17:17:44.147282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad86b0>]}
[0m17:17:44.148045 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:17:44.295350 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:17:44.461489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:44.462187 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:17:44.895552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:17:44.907345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1483ac9b0>]}
[0m17:17:45.099695 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:17:45.101471 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:17:45.116521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1488e6b70>]}
[0m17:17:45.117065 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:17:45.117479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148ab7710>]}
[0m17:17:45.119532 [info ] [MainThread]: 
[0m17:17:45.119937 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:17:45.120301 [info ] [MainThread]: 
[0m17:17:45.120854 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:17:45.121735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:17:45.190783 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:17:45.191185 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:17:45.191519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:45.857560 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.666 seconds
[0m17:17:45.861189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:17:45.862052 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:17:45.876662 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:17:45.877380 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:17:45.877785 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:17:45.878224 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:17:45.878634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:45.978407 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m17:17:46.312371 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9591-0304-eb6a-0004-59ff001ca3ae
[0m17:17:46.312967 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:17:46.313587 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:17:46.314029 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:17:46.314839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1488d8320>]}
[0m17:17:46.317824 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:17:46.318386 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:17:46.318917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:17:46.319468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:17:46.319966 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:17:46.320441 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:17:46.330322 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:17:46.333392 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:17:46.334702 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:17:46.335597 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:17:46.336318 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:17:46.337110 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:17:46.337857 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:17:46.338348 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:17:46.343081 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:17:46.343857 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:17:46.381352 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:17:46.382914 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:17:46.383375 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,symbol
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date
        );
[0m17:17:46.383810 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:17:46.761873 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb9591-0304-eb8b-0004-59ff001c8536
[0m17:17:46.762528 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'SYMBOL'
[0m17:17:46.766851 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'SYMBOL'
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:17:46.768869 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b49d8e0>]}
[0m17:17:46.769681 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.43s]
[0m17:17:46.770488 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:17:46.771194 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'SYMBOL'
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:17:46.773560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:46.773971 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:17:46.774383 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:17:46.926056 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:17:46.926654 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:17:47.019928 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:17:47.020613 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:17:47.250524 [info ] [MainThread]: 
[0m17:17:47.251237 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m17:17:47.252297 [debug] [MainThread]: Command end result
[0m17:17:47.277410 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:17:47.278980 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:17:47.285286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:17:47.285648 [info ] [MainThread]: 
[0m17:17:47.286104 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:17:47.286499 [info ] [MainThread]: 
[0m17:17:47.286966 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'SYMBOL'
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:17:47.287334 [info ] [MainThread]: 
[0m17:17:47.287854 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:47.290376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.536257, "process_in_blocks": "0", "process_kernel_time": 0.874429, "process_mem_max_rss": "195395584", "process_out_blocks": "0", "process_user_time": 4.594849}
[0m17:17:47.291071 [debug] [MainThread]: Command `dbt run` failed at 17:17:47.290930 after 4.54 seconds
[0m17:17:47.291558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b550140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11140be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beec2c0>]}
[0m17:17:47.291995 [debug] [MainThread]: Flushing usage events
[0m17:17:47.779324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:53.779777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a86e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d71cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d71940>]}


============================== 17:18:53.785130 | bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11 ==============================
[0m17:18:53.785130 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:18:53.786282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:18:54.943974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117debfe0>]}
[0m17:18:55.013854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d03d10>]}
[0m17:18:55.014813 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:18:55.164279 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:18:55.329275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:55.329977 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:18:55.767889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:18:55.780258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1505a4440>]}
[0m17:18:55.970735 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:18:55.972503 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:18:55.987627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1506493d0>]}
[0m17:18:55.988171 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:18:55.988580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150335850>]}
[0m17:18:55.990630 [info ] [MainThread]: 
[0m17:18:55.991043 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:18:55.991407 [info ] [MainThread]: 
[0m17:18:55.991957 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:18:55.993309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:18:56.061537 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:18:56.061923 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:18:56.062225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:56.842186 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.780 seconds
[0m17:18:56.845729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:18:56.846498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:18:56.865884 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:18:56.870053 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:18:56.870446 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:18:56.870863 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:18:56.872064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:56.965823 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m17:18:57.256195 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9592-0304-e849-0004-59ff001c9492
[0m17:18:57.256824 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:18:57.257460 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:18:57.257902 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:57.258710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150722fc0>]}
[0m17:18:57.261713 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:18:57.262297 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:18:57.262849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:18:57.263427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:18:57.263959 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:18:57.264451 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:18:57.274500 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:18:57.277629 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:18:57.278889 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:18:57.279899 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:18:57.280730 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:18:57.281415 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:18:57.282092 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:18:57.282566 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:18:57.287391 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:18:57.288143 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:18:57.325708 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:18:57.327428 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:18:57.327957 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,ma.symbol
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date
        );
[0m17:18:57.328398 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:18:58.818792 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.490 seconds
[0m17:18:58.855486 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a1c10>]}
[0m17:18:58.856246 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.57s]
[0m17:18:58.856986 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:18:58.858444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:58.858813 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:18:58.859183 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:18:59.008802 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:18:59.009477 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:18:59.107644 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:18:59.108315 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:18:59.234652 [info ] [MainThread]: 
[0m17:18:59.235366 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m17:18:59.236469 [debug] [MainThread]: Command end result
[0m17:18:59.262002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:18:59.263782 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:18:59.270608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:18:59.271025 [info ] [MainThread]: 
[0m17:18:59.271514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:59.271933 [info ] [MainThread]: 
[0m17:18:59.272387 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:18:59.275566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5667977, "process_in_blocks": "0", "process_kernel_time": 0.79893, "process_mem_max_rss": "193953792", "process_out_blocks": "0", "process_user_time": 4.375016}
[0m17:18:59.276248 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:59.276108 after 5.57 seconds
[0m17:18:59.276742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1507d48c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1508b52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d71a90>]}
[0m17:18:59.277209 [debug] [MainThread]: Flushing usage events
[0m17:18:59.728537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:28.708002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107085bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c1520>]}


============================== 17:21:28.715083 | 1a5a5258-e548-41df-a3c8-fc492cde0f0c ==============================
[0m17:21:28.715083 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:21:28.715832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:21:30.521579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2a3da0>]}
[0m17:21:30.594958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ea120>]}
[0m17:21:30.595751 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:21:30.735331 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:21:30.903122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:30.903777 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:21:31.333456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:21:31.345356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143e50110>]}
[0m17:21:31.540192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:21:31.541953 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:21:31.556846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143c6eba0>]}
[0m17:21:31.557352 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:21:31.557757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143d094f0>]}
[0m17:21:31.559816 [info ] [MainThread]: 
[0m17:21:31.560230 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:21:31.560604 [info ] [MainThread]: 
[0m17:21:31.561159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:21:31.562030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:21:31.624161 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:21:31.624568 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:21:31.624861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:32.345251 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.720 seconds
[0m17:21:32.348893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:21:32.349764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:21:32.368925 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:21:32.373410 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:21:32.373805 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:21:32.374228 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:21:32.375388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:32.581885 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9595-0304-eb6a-0004-59ff001ca42e
[0m17:21:32.582384 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:21:32.582911 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:21:32.583319 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:21:32.882064 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.507 seconds
[0m17:21:32.885810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143c6d670>]}
[0m17:21:32.888922 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:21:32.889489 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:21:32.890039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:21:32.890686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:21:32.891416 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:21:32.891950 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:21:32.902582 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:21:32.905644 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:21:32.907089 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:21:32.908232 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:21:32.909113 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:21:32.909776 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:21:32.910529 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:21:32.911017 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:21:32.916650 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:21:32.917483 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:21:32.957473 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:21:32.959099 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:21:32.959551 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,ma.symbol,ma.date
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
        );
[0m17:21:32.959985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:21:34.220766 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m17:21:34.258273 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ed5e0>]}
[0m17:21:34.259062 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.35s]
[0m17:21:34.259822 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:21:34.261296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:34.261666 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:21:34.262047 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:21:34.363972 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:21:34.364655 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:21:34.550937 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:21:34.551608 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:21:34.649642 [info ] [MainThread]: 
[0m17:21:34.650316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m17:21:34.651423 [debug] [MainThread]: Command end result
[0m17:21:34.677844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:21:34.679653 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:21:34.686701 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:21:34.687130 [info ] [MainThread]: 
[0m17:21:34.687660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:34.688144 [info ] [MainThread]: 
[0m17:21:34.688692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:21:34.692114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0647745, "process_in_blocks": "0", "process_kernel_time": 1.076793, "process_mem_max_rss": "192348160", "process_out_blocks": "0", "process_user_time": 5.02097}
[0m17:21:34.692971 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:34.692803 after 6.07 seconds
[0m17:21:34.693506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143bc5b20>]}
[0m17:21:34.694001 [debug] [MainThread]: Flushing usage events
[0m17:21:35.267336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:09.588777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efeda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efed700>]}


============================== 17:27:09.597059 | b0fab347-54c5-4688-ab74-73125c36d947 ==============================
[0m17:27:09.597059 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:09.597989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:27:12.119292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0fab347-54c5-4688-ab74-73125c36d947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e983a70>]}
[0m17:27:12.179066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0fab347-54c5-4688-ab74-73125c36d947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139705f0>]}
[0m17:27:12.180677 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:27:12.347147 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:12.566893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m17:27:12.567536 [debug] [MainThread]: Partial parsing: added file: homework7://models/output/select.sql
[0m17:27:12.567950 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/volatility.sql
[0m17:27:12.568484 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:27:12.923278 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.select' (models/output/select.sql) depends on a source named 'ref.market_price' which was not found
[0m17:27:12.928175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4242203, "process_in_blocks": "0", "process_kernel_time": 1.067098, "process_mem_max_rss": "180142080", "process_out_blocks": "0", "process_user_time": 4.136104}
[0m17:27:12.928890 [debug] [MainThread]: Command `dbt run` failed at 17:27:12.928738 after 3.43 seconds
[0m17:27:12.929410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efeda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c0a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8cffe0>]}
[0m17:27:12.929874 [debug] [MainThread]: Flushing usage events
[0m17:27:13.269544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:38.650819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e03d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114065b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140657c0>]}


============================== 17:27:38.655868 | 2aa1eff0-c06f-40e4-bdc7-b43148ac7bc4 ==============================
[0m17:27:38.655868 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:38.656539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:27:39.730180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa1eff0-c06f-40e4-bdc7-b43148ac7bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140431a0>]}
[0m17:27:39.790211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa1eff0-c06f-40e4-bdc7-b43148ac7bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ee8d40>]}
[0m17:27:39.790974 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:27:39.927720 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:40.090286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:27:40.090777 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/volatility.sql
[0m17:27:40.091209 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:27:40.453890 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.volatility' (models/input/volatility.sql) depends on a source named 'ref.market_price' which was not found
[0m17:27:40.455950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8739976, "process_in_blocks": "0", "process_kernel_time": 0.696644, "process_mem_max_rss": "180326400", "process_out_blocks": "0", "process_user_time": 3.517618}
[0m17:27:40.456460 [debug] [MainThread]: Command `dbt run` failed at 17:27:40.456345 after 1.87 seconds
[0m17:27:40.456870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ff3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150429580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d33b00>]}
[0m17:27:40.457255 [debug] [MainThread]: Flushing usage events
[0m17:27:41.092944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:56.698347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ffcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf9910>]}


============================== 17:27:56.703961 | b3592141-ecbe-4a0c-b1e7-b53038f3e136 ==============================
[0m17:27:56.703961 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:56.704690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:27:57.907513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3592141-ecbe-4a0c-b1e7-b53038f3e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107519760>]}
[0m17:27:57.971239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3592141-ecbe-4a0c-b1e7-b53038f3e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142cf08c0>]}
[0m17:27:57.972014 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:27:58.128827 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:58.291766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:27:58.292277 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/volatility.sql
[0m17:27:58.292706 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:27:58.650446 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.session_summary' (models/output/session_summary.sql) depends on a node named 'volatality' which was not found
[0m17:27:58.652459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0261688, "process_in_blocks": "0", "process_kernel_time": 0.731172, "process_mem_max_rss": "181587968", "process_out_blocks": "0", "process_user_time": 3.749609}
[0m17:27:58.652964 [debug] [MainThread]: Command `dbt run` failed at 17:27:58.652848 after 2.03 seconds
[0m17:27:58.653372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142fbb170>]}
[0m17:27:58.653750 [debug] [MainThread]: Flushing usage events
[0m17:27:58.961614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:08.989826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6bbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a72d940>]}


============================== 17:29:08.996350 | c7c3782e-e542-4f85-8721-ec45ccc3fc60 ==============================
[0m17:29:08.996350 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:29:08.997052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:29:11.128450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465a80b0>]}
[0m17:29:11.188503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e78fa10>]}
[0m17:29:11.189940 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:29:11.343473 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:29:11.560928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:29:11.561547 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/volatility.sql
[0m17:29:11.562081 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:29:12.001943 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:29:12.014150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a93740>]}
[0m17:29:12.203745 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:29:12.205467 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:29:12.245142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147140ad0>]}
[0m17:29:12.245747 [info ] [MainThread]: Found 1 snapshot, 4 models, 3 data tests, 1 source, 474 macros
[0m17:29:12.246216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef827e0>]}
[0m17:29:12.248548 [info ] [MainThread]: 
[0m17:29:12.249016 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:29:12.249434 [info ] [MainThread]: 
[0m17:29:12.250065 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:29:12.251049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:29:12.432857 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:29:12.433235 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:29:12.433541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:13.114694 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.681 seconds
[0m17:29:13.118315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:29:13.119148 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:29:13.138399 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:29:13.142475 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:29:13.142863 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:29:13.143290 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:29:13.143800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:13.257207 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m17:29:13.634491 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb959d-0304-eb8b-0004-59ff001c861e
[0m17:29:13.635102 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:29:13.635764 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:29:13.636259 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:29:13.637094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147034d70>]}
[0m17:29:13.640953 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:29:13.641544 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:29:13.642105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:29:13.642594 [debug] [Thread-3 (]: Began running node model.homework7.volatility
[0m17:29:13.643163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:29:13.643723 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:29:13.644373 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:29:13.644879 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:29:13.655043 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:29:13.655552 [debug] [Thread-3 (]: Began compiling node model.homework7.volatility
[0m17:29:13.658629 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:29:13.661686 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:29:13.662867 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:29:13.664863 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:29:13.665737 [debug] [Thread-3 (]: Finished running node model.homework7.volatility
[0m17:29:13.666713 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:29:13.667363 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:29:13.668168 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:29:13.668655 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:29:13.675264 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:29:13.676078 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:29:13.713900 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:29:13.716293 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:29:13.716807 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,ma.symbol,ma.date,v.volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = gap.date and v.symbol = gap.symbol
        );
[0m17:29:13.717251 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:29:14.891342 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.174 seconds
[0m17:29:14.929512 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b719a0>]}
[0m17:29:14.930449 [info ] [Thread-5 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.26s]
[0m17:29:14.931266 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:29:14.932953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:14.933363 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:29:14.933774 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:29:15.072627 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:29:15.073221 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:29:15.164391 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:29:15.165048 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:29:15.165534 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:29:15.281566 [info ] [MainThread]: 
[0m17:29:15.282267 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m17:29:15.283366 [debug] [MainThread]: Command end result
[0m17:29:15.309484 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:29:15.311281 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:29:15.318204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:29:15.318596 [info ] [MainThread]: 
[0m17:29:15.319094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:15.319600 [info ] [MainThread]: 
[0m17:29:15.320065 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:29:15.324040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.405778, "process_in_blocks": "0", "process_kernel_time": 1.141673, "process_mem_max_rss": "194420736", "process_out_blocks": "0", "process_user_time": 4.996925}
[0m17:29:15.324716 [debug] [MainThread]: Command `dbt run` succeeded at 17:29:15.324577 after 6.41 seconds
[0m17:29:15.325199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6bbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a266510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fff20>]}
[0m17:29:15.325665 [debug] [MainThread]: Flushing usage events
[0m17:29:15.802393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:15.491021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d5f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111905cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111905940>]}


============================== 17:30:15.498832 | 7423849f-3fdf-456a-bd81-c5a9a3b12071 ==============================
[0m17:30:15.498832 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:30:15.499612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:30:16.920626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d73b8c0>]}
[0m17:30:16.981585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dce4f20>]}
[0m17:30:16.982336 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:30:17.122411 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:30:17.287838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:17.288436 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:30:17.722983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:30:17.734713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e37bb90>]}
[0m17:30:17.921641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:30:17.923527 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:30:17.938629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e225670>]}
[0m17:30:17.939142 [info ] [MainThread]: Found 1 snapshot, 4 models, 3 data tests, 1 source, 474 macros
[0m17:30:17.939551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e350b00>]}
[0m17:30:17.941600 [info ] [MainThread]: 
[0m17:30:17.942013 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:30:17.942384 [info ] [MainThread]: 
[0m17:30:17.942937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:17.943807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:30:18.005541 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:30:18.005918 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:30:18.006216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:18.614059 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.608 seconds
[0m17:30:18.617723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:30:18.618560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:30:18.637651 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:30:18.642540 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:30:18.642956 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:30:18.643376 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:30:18.644510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:18.721587 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb959e-0304-e858-0004-59ff001cb4b2
[0m17:30:18.722057 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:30:18.722548 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:30:18.722929 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:30:19.377974 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.733 seconds
[0m17:30:19.381529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3cf920>]}
[0m17:30:19.384733 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:30:19.385299 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:30:19.385837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:30:19.386318 [debug] [Thread-3 (]: Began running node model.homework7.volatility
[0m17:30:19.386863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:30:19.387378 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:30:19.388017 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:30:19.388519 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:30:19.395080 [debug] [Thread-3 (]: Began compiling node model.homework7.volatility
[0m17:30:19.399444 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:30:19.402521 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:30:19.405428 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:30:19.406706 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:30:19.407995 [debug] [Thread-3 (]: Finished running node model.homework7.volatility
[0m17:30:19.408878 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:30:19.409605 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:30:19.410417 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:30:19.411149 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:30:19.411621 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:30:19.419126 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:30:19.419943 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:30:19.456510 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:30:19.458388 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:30:19.458862 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,ma.symbol,ma.date,v.volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
        );
[0m17:30:19.459314 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:30:20.834556 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.375 seconds
[0m17:30:20.870716 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f791790>]}
[0m17:30:20.871428 [info ] [Thread-5 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.46s]
[0m17:30:20.872131 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:30:20.873582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:20.873935 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:30:20.874285 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:30:20.994162 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:30:20.994823 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:30:21.198834 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:30:21.199491 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:30:21.199988 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:30:21.309175 [info ] [MainThread]: 
[0m17:30:21.309860 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m17:30:21.310975 [debug] [MainThread]: Command end result
[0m17:30:21.336714 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:30:21.338510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:30:21.345614 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:30:21.346016 [info ] [MainThread]: 
[0m17:30:21.346612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:21.347056 [info ] [MainThread]: 
[0m17:30:21.347502 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:30:21.350258 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9398546, "process_in_blocks": "0", "process_kernel_time": 1.001784, "process_mem_max_rss": "194416640", "process_out_blocks": "0", "process_user_time": 4.894569}
[0m17:30:21.350946 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:21.350804 after 5.94 seconds
[0m17:30:21.351439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111905ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111905cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dd7e270>]}
[0m17:30:21.351911 [debug] [MainThread]: Flushing usage events
[0m17:30:21.780620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:55.974790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fed3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112155c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121557c0>]}


============================== 17:30:55.980279 | 76172368-41aa-4c7d-b293-3e4e632c0529 ==============================
[0m17:30:55.980279 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:30:55.981013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:57.237524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116282c0>]}
[0m17:30:57.299067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fedeb0>]}
[0m17:30:57.299801 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:30:57.438945 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:30:57.617489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:57.618234 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:30:58.106382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:30:58.118524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e4e42c0>]}
[0m17:30:58.307217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:30:58.309071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:30:58.324257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eaf63f0>]}
[0m17:30:58.324799 [info ] [MainThread]: Found 1 snapshot, 4 models, 3 data tests, 1 source, 474 macros
[0m17:30:58.325216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e7083e0>]}
[0m17:30:58.327406 [info ] [MainThread]: 
[0m17:30:58.327870 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:30:58.328257 [info ] [MainThread]: 
[0m17:30:58.328818 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:58.329685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:30:58.393606 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:30:58.394095 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:30:58.394406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:58.891380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.497 seconds
[0m17:30:58.894975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:30:58.895813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:30:58.913493 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:30:58.918260 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:30:58.918641 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:30:58.919031 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:30:58.919521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:59.044012 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m17:30:59.365205 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb959e-0304-e849-0004-59ff001c95ca
[0m17:30:59.365822 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:30:59.366467 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:30:59.366917 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:30:59.367772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ed99970>]}
[0m17:30:59.370774 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:30:59.371332 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:30:59.371875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:30:59.372361 [debug] [Thread-3 (]: Began running node model.homework7.volatility
[0m17:30:59.372917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:30:59.373434 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:30:59.374067 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:30:59.374564 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:30:59.384806 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:30:59.385309 [debug] [Thread-3 (]: Began compiling node model.homework7.volatility
[0m17:30:59.388356 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:30:59.391423 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:30:59.392559 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:30:59.393837 [debug] [Thread-3 (]: Finished running node model.homework7.volatility
[0m17:30:59.394690 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:30:59.395532 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:30:59.396235 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:30:59.396910 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:30:59.397373 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:30:59.405003 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:30:59.405896 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:30:59.441783 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:30:59.443649 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:30:59.444121 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
        );
[0m17:30:59.444587 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:31:00.574536 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.130 seconds
[0m17:31:00.611132 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffe9ac0>]}
[0m17:31:00.611882 [info ] [Thread-5 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.21s]
[0m17:31:00.612636 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:31:00.614217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:00.614587 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:31:00.614962 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:31:00.728290 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:31:00.728877 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:31:00.853840 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:31:00.854492 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:31:00.854984 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:31:00.959642 [info ] [MainThread]: 
[0m17:31:00.960342 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m17:31:00.961451 [debug] [MainThread]: Command end result
[0m17:31:00.987437 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:31:00.989188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:31:00.996140 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:31:00.996540 [info ] [MainThread]: 
[0m17:31:00.997119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:00.997537 [info ] [MainThread]: 
[0m17:31:00.997984 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:31:01.000821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0984726, "process_in_blocks": "0", "process_kernel_time": 0.839595, "process_mem_max_rss": "193773568", "process_out_blocks": "0", "process_user_time": 4.65356}
[0m17:31:01.001617 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:01.001421 after 5.10 seconds
[0m17:31:01.002133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a05400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a894c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112186570>]}
[0m17:31:01.002608 [debug] [MainThread]: Flushing usage events
[0m17:31:01.329127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:57.968190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae22210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d5910>]}


============================== 17:33:57.975621 | de250866-58b9-4c99-8274-3ce68bf8bef0 ==============================
[0m17:33:57.975621 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:33:57.976457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:33:59.187001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471a7bf0>]}
[0m17:33:59.246705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147aba420>]}
[0m17:33:59.247429 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:33:59.384323 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:33:59.550333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:33:59.551966 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/rolling_volatality.sql
[0m17:33:59.552524 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:33:59.987252 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:33:59.999067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148193980>]}
[0m17:34:00.185160 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:34:00.186927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:34:00.201875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1482470b0>]}
[0m17:34:00.202371 [info ] [MainThread]: Found 1 snapshot, 5 models, 3 data tests, 1 source, 474 macros
[0m17:34:00.202784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148267560>]}
[0m17:34:00.204862 [info ] [MainThread]: 
[0m17:34:00.205273 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:34:00.205641 [info ] [MainThread]: 
[0m17:34:00.206198 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:34:00.207055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:34:00.266182 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:34:00.266557 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:34:00.266855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:01.205997 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.939 seconds
[0m17:34:01.209655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:34:01.210487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:34:01.230245 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:34:01.234687 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:34:01.235092 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:34:01.235534 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:34:01.236764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:01.375467 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.139 seconds
[0m17:34:01.736959 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a2-0304-eb6a-0004-59ff001ca526
[0m17:34:01.737582 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:34:01.738222 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:34:01.738647 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:34:01.739427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148246e40>]}
[0m17:34:01.742282 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:34:01.742848 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:34:01.743373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:34:01.743848 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:34:01.744382 [debug] [Thread-4 (]: Began running node model.homework7.volatility
[0m17:34:01.744901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:34:01.745427 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:34:01.746579 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:34:01.747238 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:34:01.747762 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:34:01.758498 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:34:01.759016 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:34:01.759518 [debug] [Thread-4 (]: Began compiling node model.homework7.volatility
[0m17:34:01.762647 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:34:01.764838 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:34:01.767897 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:34:01.769148 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:34:01.770138 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:34:01.770897 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:34:01.772109 [debug] [Thread-4 (]: Finished running node model.homework7.volatility
[0m17:34:01.772906 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:34:01.773509 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:34:01.774225 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:34:01.774695 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:34:01.783398 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:34:01.784092 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:34:01.819337 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:34:01.821542 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:34:01.822015 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from source('raw','market_price')
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation;
[0m17:34:01.822460 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:34:02.284349 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb95a2-0304-e849-0004-59ff001c960a
[0m17:34:02.285163 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 11 unexpected '('.
syntax error line 27 at position 12 unexpected ''raw''.
syntax error line 27 at position 18 unexpected ''market_price''.
syntax error line 29 at position 0 unexpected 'select'.
[0m17:34:02.291934 [debug] [Thread-5 (]: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:34:02.294145 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae41910>]}
[0m17:34:02.294936 [error] [Thread-5 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.52s]
[0m17:34:02.295737 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:34:02.296435 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:34:02.298765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:02.299159 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:34:02.299553 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:34:02.565752 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:34:02.566433 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:34:02.797098 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:34:02.797643 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:34:02.798090 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:34:02.798564 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:34:03.013166 [info ] [MainThread]: 
[0m17:34:03.013872 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m17:34:03.014952 [debug] [MainThread]: Command end result
[0m17:34:03.041201 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:34:03.043108 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:34:03.049983 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:34:03.050376 [info ] [MainThread]: 
[0m17:34:03.050942 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:34:03.051357 [info ] [MainThread]: 
[0m17:34:03.051847 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:34:03.052289 [info ] [MainThread]: 
[0m17:34:03.052777 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:34:03.055846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.1691737, "process_in_blocks": "0", "process_kernel_time": 0.946255, "process_mem_max_rss": "195715072", "process_out_blocks": "0", "process_user_time": 4.792502}
[0m17:34:03.056494 [debug] [MainThread]: Command `dbt run` failed at 17:34:03.056352 after 5.17 seconds
[0m17:34:03.056966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1671a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b780800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1482ba750>]}
[0m17:34:03.057421 [debug] [MainThread]: Flushing usage events
[0m17:34:03.489789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:34.783457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce5970>]}


============================== 17:34:34.790703 | f6580335-efc4-41da-bf16-34168a74d278 ==============================
[0m17:34:34.790703 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:34:34.791442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:34:36.601749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccf7d10>]}
[0m17:34:36.663491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccf7d10>]}
[0m17:34:36.664777 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:34:36.839259 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:34:37.070889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:37.071609 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/rolling_volatality.sql
[0m17:34:37.370922 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:34:37.383298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465bade0>]}
[0m17:34:37.477901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:34:37.479704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:34:37.515993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146603440>]}
[0m17:34:37.516619 [info ] [MainThread]: Found 1 snapshot, 5 models, 3 data tests, 1 source, 474 macros
[0m17:34:37.517092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465bae70>]}
[0m17:34:37.519626 [info ] [MainThread]: 
[0m17:34:37.520118 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:34:37.520533 [info ] [MainThread]: 
[0m17:34:37.521196 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:34:37.522218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:34:37.694567 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:34:37.695222 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:34:37.695759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:38.238748 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.543 seconds
[0m17:34:38.242390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:34:38.243226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:34:38.257778 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:34:38.260305 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:34:38.260758 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:34:38.261196 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:34:38.261756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:38.397932 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m17:34:38.691343 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a2-0304-eb8b-0004-59ff001c86ce
[0m17:34:38.691983 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:34:38.692640 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:34:38.693158 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:34:38.694208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146399490>]}
[0m17:34:38.698245 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:34:38.698803 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:34:38.699311 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:34:38.699854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:34:38.700338 [debug] [Thread-4 (]: Began running node model.homework7.volatility
[0m17:34:38.700892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:34:38.701577 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:34:38.702102 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:34:38.702774 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:34:38.703282 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:34:38.703771 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:34:38.711697 [debug] [Thread-4 (]: Began compiling node model.homework7.volatility
[0m17:34:38.714629 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:34:38.717693 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:34:38.719695 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:34:38.722695 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:34:38.723925 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:34:38.725051 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:34:38.726004 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:34:38.726900 [debug] [Thread-4 (]: Finished running node model.homework7.volatility
[0m17:34:38.727671 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:34:38.728392 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:34:38.729123 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:34:38.729577 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:34:38.736981 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:34:38.737739 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:34:38.772270 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:34:38.774178 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:34:38.774576 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from source('raw','market_price')
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
        );
[0m17:34:38.774958 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:34:39.108005 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb95a2-0304-eb6a-0004-59ff001ca52a
[0m17:34:39.108690 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 11 unexpected '('.
syntax error line 27 at position 12 unexpected ''raw''.
syntax error line 27 at position 18 unexpected ''market_price''.
syntax error line 29 at position 0 unexpected 'select'.
[0m17:34:39.113746 [debug] [Thread-5 (]: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:34:39.116634 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466285f0>]}
[0m17:34:39.117920 [error] [Thread-5 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.39s]
[0m17:34:39.118916 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:34:39.119784 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:34:39.122463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:39.122886 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:34:39.123305 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:34:39.456045 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:34:39.456586 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:34:39.562342 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:34:39.562838 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:34:39.563193 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:34:39.563555 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:34:39.761607 [info ] [MainThread]: 
[0m17:34:39.762320 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m17:34:39.763415 [debug] [MainThread]: Command end result
[0m17:34:39.792082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:34:39.793894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:34:39.801989 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:34:39.802544 [info ] [MainThread]: 
[0m17:34:39.803075 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:34:39.803526 [info ] [MainThread]: 
[0m17:34:39.804055 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:34:39.804496 [info ] [MainThread]: 
[0m17:34:39.804961 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:34:39.809058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.106394, "process_in_blocks": "0", "process_kernel_time": 0.946746, "process_mem_max_rss": "192266240", "process_out_blocks": "0", "process_user_time": 4.546972}
[0m17:34:39.809705 [debug] [MainThread]: Command `dbt run` failed at 17:34:39.809557 after 5.11 seconds
[0m17:34:39.810224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099782c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e5fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c73620>]}
[0m17:34:39.810734 [debug] [MainThread]: Flushing usage events
[0m17:34:40.166431 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:41.264572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11352c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113571e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113571ac0>]}


============================== 17:35:41.271760 | b5277002-e659-4c06-9178-f1a2de7069e1 ==============================
[0m17:35:41.271760 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:35:41.272531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:35:42.542936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f800830>]}
[0m17:35:42.605427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e989b0>]}
[0m17:35:42.606183 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:35:42.744072 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:35:42.914391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:42.914984 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/rolling_volatality.sql
[0m17:35:43.198916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:35:43.210548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fe5ec00>]}
[0m17:35:43.304334 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:35:43.306001 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:35:43.318848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbb45c0>]}
[0m17:35:43.319288 [info ] [MainThread]: Found 1 snapshot, 5 models, 3 data tests, 1 source, 474 macros
[0m17:35:43.319628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f98de50>]}
[0m17:35:43.321439 [info ] [MainThread]: 
[0m17:35:43.321791 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:35:43.322095 [info ] [MainThread]: 
[0m17:35:43.322576 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:35:43.323326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:35:43.459933 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:35:43.460553 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:35:43.461072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:44.060869 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.600 seconds
[0m17:35:44.064523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:35:44.065389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:35:44.085091 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:35:44.089459 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:35:44.089872 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:35:44.090311 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:35:44.091526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:44.200637 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m17:35:44.424195 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a3-0304-eb8b-0004-59ff001c86da
[0m17:35:44.424805 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:35:44.425424 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:35:44.425862 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:35:44.426659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122ad250>]}
[0m17:35:44.429624 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:35:44.430206 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:35:44.430754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:35:44.431248 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:35:44.431788 [debug] [Thread-4 (]: Began running node model.homework7.volatility
[0m17:35:44.432301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:35:44.432827 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:35:44.433859 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:35:44.434512 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:35:44.435017 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:35:44.441903 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:35:44.445207 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:35:44.445701 [debug] [Thread-4 (]: Began compiling node model.homework7.volatility
[0m17:35:44.448793 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:35:44.451876 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:35:44.455067 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:35:44.456350 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:35:44.457487 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:35:44.459297 [debug] [Thread-4 (]: Finished running node model.homework7.volatility
[0m17:35:44.460366 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:35:44.461325 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:35:44.461950 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:35:44.462657 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:35:44.463120 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:35:44.470545 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:35:44.471312 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:35:44.506930 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:35:44.509380 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:35:44.509920 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
        );
[0m17:35:44.510385 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:35:45.681296 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.171 seconds
[0m17:35:45.718124 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129d5b50>]}
[0m17:35:45.718859 [info ] [Thread-5 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.25s]
[0m17:35:45.719604 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:35:45.721064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:45.721442 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:35:45.721814 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:35:45.836922 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:35:45.837621 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:35:45.989132 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:35:45.989782 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:35:45.990232 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:35:45.990718 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:35:46.109937 [info ] [MainThread]: 
[0m17:35:46.110581 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m17:35:46.111683 [debug] [MainThread]: Command end result
[0m17:35:46.137695 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:35:46.139370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:35:46.146539 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:35:46.146946 [info ] [MainThread]: 
[0m17:35:46.147447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:46.147861 [info ] [MainThread]: 
[0m17:35:46.148307 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:35:46.151075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.970337, "process_in_blocks": "0", "process_kernel_time": 0.859532, "process_mem_max_rss": "193744896", "process_out_blocks": "0", "process_user_time": 4.477894}
[0m17:35:46.151763 [debug] [MainThread]: Command `dbt run` succeeded at 17:35:46.151607 after 4.97 seconds
[0m17:35:46.152251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a14410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150279430>]}
[0m17:35:46.152734 [debug] [MainThread]: Flushing usage events
[0m17:35:46.471454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:00.024800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e61eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cd700>]}


============================== 17:39:00.029797 | d8e2b1ba-debd-4324-bf50-3aab4b26fb79 ==============================
[0m17:39:00.029797 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:39:00.030466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:39:01.131930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14596c830>]}
[0m17:39:01.198217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebd7f80>]}
[0m17:39:01.199021 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:39:01.354364 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:39:01.524514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:39:01.525024 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/rsi.sql
[0m17:39:01.525473 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:39:01.972607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:39:01.985168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14629a210>]}
[0m17:39:02.172220 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:39:02.174046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:39:02.189249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097431a0>]}
[0m17:39:02.189768 [info ] [MainThread]: Found 1 snapshot, 6 models, 3 data tests, 1 source, 474 macros
[0m17:39:02.190183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1463dd9a0>]}
[0m17:39:02.192322 [info ] [MainThread]: 
[0m17:39:02.192779 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:39:02.193226 [info ] [MainThread]: 
[0m17:39:02.193814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:39:02.194691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:39:02.257594 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:39:02.257968 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:39:02.258271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:03.062512 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.804 seconds
[0m17:39:03.066134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:39:03.066965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:39:03.086325 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:39:03.090511 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:39:03.090917 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:39:03.091340 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:39:03.092541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:03.213380 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.122 seconds
[0m17:39:03.718342 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a7-0304-eb90-0004-59ff001c7ff2
[0m17:39:03.718940 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:39:03.719576 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:39:03.720004 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:39:03.720798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14622dca0>]}
[0m17:39:03.723814 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:39:03.724376 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:39:03.724909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:39:03.725400 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:39:03.725936 [debug] [Thread-4 (]: Began running node model.homework7.rsi
[0m17:39:03.726414 [debug] [Thread-5 (]: Began running node model.homework7.volatility
[0m17:39:03.727288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:39:03.727818 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:39:03.728470 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:39:03.729090 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.rsi'
[0m17:39:03.729705 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:39:03.730189 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:39:03.739739 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:39:03.740247 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:39:03.740720 [debug] [Thread-4 (]: Began compiling node model.homework7.rsi
[0m17:39:03.741197 [debug] [Thread-5 (]: Began compiling node model.homework7.volatility
[0m17:39:03.744242 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:39:03.747369 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:39:03.751748 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.rsi"
[0m17:39:03.752517 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:39:03.755107 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:39:03.756510 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:39:03.757263 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:39:03.758007 [debug] [Thread-4 (]: Finished running node model.homework7.rsi
[0m17:39:03.759084 [debug] [Thread-5 (]: Finished running node model.homework7.volatility
[0m17:39:03.759759 [debug] [Thread-1 (]: Began running node model.homework7.session_summary
[0m17:39:03.760317 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:39:03.760819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.homework7.gap_analysis, now model.homework7.session_summary)
[0m17:39:03.761235 [debug] [Thread-1 (]: Began compiling node model.homework7.session_summary
[0m17:39:03.771357 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:39:03.772405 [debug] [Thread-1 (]: Began executing node model.homework7.session_summary
[0m17:39:03.812562 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:39:03.815878 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:39:03.816465 [debug] [Thread-1 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs;
[0m17:39:03.923607 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb95a7-0304-eb6a-0004-59ff001ca54e
[0m17:39:03.924375 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 62 at position 7 unexpected ';'.
[0m17:39:03.929750 [debug] [Thread-1 (]: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 7 unexpected ';'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:39:03.931846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e318e0>]}
[0m17:39:03.932661 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.17s]
[0m17:39:03.933488 [debug] [Thread-1 (]: Finished running node model.homework7.session_summary
[0m17:39:03.934215 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 7 unexpected ';'.
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:39:03.936606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:03.937021 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:39:03.937439 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:39:04.140495 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:39:04.141186 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:39:04.327130 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:39:04.327767 [debug] [MainThread]: Connection 'model.homework7.rsi' was properly closed.
[0m17:39:04.328218 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:39:04.328719 [info ] [MainThread]: 
[0m17:39:04.329275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m17:39:04.330345 [debug] [MainThread]: Command end result
[0m17:39:04.357222 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:39:04.358855 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:39:04.365543 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:39:04.365929 [info ] [MainThread]: 
[0m17:39:04.366399 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:39:04.366808 [info ] [MainThread]: 
[0m17:39:04.367290 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 7 unexpected ';'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:39:04.367803 [info ] [MainThread]: 
[0m17:39:04.368299 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:39:04.371421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4150224, "process_in_blocks": "0", "process_kernel_time": 0.769356, "process_mem_max_rss": "193044480", "process_out_blocks": "0", "process_user_time": 4.268648}
[0m17:39:04.372060 [debug] [MainThread]: Command `dbt run` failed at 17:39:04.371927 after 4.42 seconds
[0m17:39:04.372532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14596ec30>]}
[0m17:39:04.372984 [debug] [MainThread]: Flushing usage events
[0m17:39:04.884305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:18.455347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134391c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11347dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11347d9d0>]}


============================== 17:39:18.460861 | d7158e11-d719-4e4d-895c-c62de4527b0e ==============================
[0m17:39:18.460861 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:39:18.461615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:39:19.701360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117650c50>]}
[0m17:39:19.772112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f5746e0>]}
[0m17:39:19.772963 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:39:19.959258 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:39:20.159014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:20.159667 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/rsi.sql
[0m17:39:20.459328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:39:20.471865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fd2b080>]}
[0m17:39:20.563606 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:39:20.565295 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:39:20.578234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fd7a0f0>]}
[0m17:39:20.578667 [info ] [MainThread]: Found 1 snapshot, 6 models, 3 data tests, 1 source, 474 macros
[0m17:39:20.579006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fd1b320>]}
[0m17:39:20.580848 [info ] [MainThread]: 
[0m17:39:20.581202 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:39:20.581504 [info ] [MainThread]: 
[0m17:39:20.581990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:39:20.582733 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:39:20.720173 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:39:20.720791 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:39:20.721301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:21.264327 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.543 seconds
[0m17:39:21.267959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:39:21.268803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:39:21.288184 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:39:21.292323 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:39:21.292735 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:39:21.293183 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:39:21.294380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:21.378998 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a7-0304-eb6a-0004-59ff001ca552
[0m17:39:21.379449 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:39:21.379934 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:39:21.380296 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:39:21.713234 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.419 seconds
[0m17:39:21.716515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fa4bc50>]}
[0m17:39:21.719627 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:39:21.720185 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:39:21.720722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:39:21.721214 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:39:21.721747 [debug] [Thread-4 (]: Began running node model.homework7.rsi
[0m17:39:21.722226 [debug] [Thread-5 (]: Began running node model.homework7.volatility
[0m17:39:21.723162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:39:21.723696 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:39:21.724345 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:39:21.724990 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.rsi'
[0m17:39:21.725628 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:39:21.726141 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:39:21.736059 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:39:21.736527 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:39:21.737011 [debug] [Thread-4 (]: Began compiling node model.homework7.rsi
[0m17:39:21.737491 [debug] [Thread-5 (]: Began compiling node model.homework7.volatility
[0m17:39:21.740546 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:39:21.743808 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:39:21.747030 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.rsi"
[0m17:39:21.747839 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:39:21.750731 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:39:21.752364 [debug] [Thread-4 (]: Finished running node model.homework7.rsi
[0m17:39:21.753120 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:39:21.753864 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:39:21.754913 [debug] [Thread-5 (]: Finished running node model.homework7.volatility
[0m17:39:21.756167 [debug] [Thread-1 (]: Began running node model.homework7.session_summary
[0m17:39:21.756986 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:39:21.757625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.homework7.gap_analysis, now model.homework7.session_summary)
[0m17:39:21.758096 [debug] [Thread-1 (]: Began compiling node model.homework7.session_summary
[0m17:39:21.766605 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:39:21.767361 [debug] [Thread-1 (]: Began executing node model.homework7.session_summary
[0m17:39:21.804594 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:39:21.807401 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:39:21.807888 [debug] [Thread-1 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m17:39:22.823635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.015 seconds
[0m17:39:22.860405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cd8b0>]}
[0m17:39:22.861143 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.10s]
[0m17:39:22.861886 [debug] [Thread-1 (]: Finished running node model.homework7.session_summary
[0m17:39:22.863406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:22.863791 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:39:22.864178 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:39:22.985440 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:39:22.986147 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:39:23.105878 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:39:23.106497 [debug] [MainThread]: Connection 'model.homework7.rsi' was properly closed.
[0m17:39:23.106952 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:39:23.107467 [info ] [MainThread]: 
[0m17:39:23.108019 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m17:39:23.109116 [debug] [MainThread]: Command end result
[0m17:39:23.135186 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:39:23.136903 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:39:23.145580 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:39:23.146173 [info ] [MainThread]: 
[0m17:39:23.147685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:39:23.148915 [info ] [MainThread]: 
[0m17:39:23.149856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:39:23.153587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.774929, "process_in_blocks": "0", "process_kernel_time": 0.822712, "process_mem_max_rss": "192315392", "process_out_blocks": "0", "process_user_time": 4.370629}
[0m17:39:23.154351 [debug] [MainThread]: Command `dbt run` succeeded at 17:39:23.154195 after 4.78 seconds
[0m17:39:23.154896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ba4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133142c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fd58f80>]}
[0m17:39:23.155404 [debug] [MainThread]: Flushing usage events
[0m17:39:23.467607 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:42.803071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec5b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b3ad0>]}


============================== 11:33:42.809906 | be0a454d-f42c-4237-ae74-d563b1d1a409 ==============================
[0m11:33:42.809906 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:33:42.810663 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'warn_error': 'None', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:33:42.814900 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'homework7'
[0m11:33:42.817715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.111121245, "process_in_blocks": "0", "process_kernel_time": 0.414683, "process_mem_max_rss": "103079936", "process_out_blocks": "0", "process_user_time": 1.970489}
[0m11:33:42.818485 [debug] [MainThread]: Command `dbt run` failed at 11:33:42.818322 after 0.11 seconds
[0m11:33:42.818984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecae000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecafad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecade50>]}
[0m11:33:42.819450 [debug] [MainThread]: Flushing usage events
[0m11:33:43.191537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:20.584907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f0f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114793fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114793d70>]}


============================== 11:34:20.590414 | 2ecb9113-7b83-4224-b180-8d28efcde8c4 ==============================
[0m11:34:20.590414 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:34:20.591156 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:34:20.595242 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'homework7'
[0m11:34:20.597871 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09020489, "process_in_blocks": "0", "process_kernel_time": 0.255686, "process_mem_max_rss": "102907904", "process_out_blocks": "0", "process_user_time": 1.592978}
[0m11:34:20.598616 [debug] [MainThread]: Command `dbt run` failed at 11:34:20.598454 after 0.09 seconds
[0m11:34:20.599117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114793f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114397c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11442faa0>]}
[0m11:34:20.599603 [debug] [MainThread]: Flushing usage events
[0m11:34:20.929659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:26.036558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fcb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b7c20>]}


============================== 11:35:26.041457 | 883c8297-110c-43bd-8586-763997de83cc ==============================
[0m11:35:26.041457 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:35:26.042127 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m11:35:26.045861 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'homework7'
[0m11:35:26.047501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.078052945, "process_in_blocks": "0", "process_kernel_time": 0.227375, "process_mem_max_rss": "102965248", "process_out_blocks": "0", "process_user_time": 1.50887}
[0m11:35:26.048134 [debug] [MainThread]: Command `dbt run` failed at 11:35:26.047996 after 0.08 seconds
[0m11:35:26.048563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a211f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961bb00>]}
[0m11:35:26.048994 [debug] [MainThread]: Flushing usage events
[0m11:35:26.415067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:01.334696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111faa870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112887fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112887c80>]}


============================== 11:37:01.339821 | 108d64ae-9b6a-465b-8f2b-fa9234d6a9d8 ==============================
[0m11:37:01.339821 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:37:01.340508 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'profiles_dir': '/Users/user/.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:37:03.610752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e112ea0>]}
[0m11:37:03.673027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e60ec90>]}
[0m11:37:03.674449 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:37:03.846247 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:37:03.995227 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m11:37:03.995739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ef06120>]}
[0m11:37:05.638821 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_dbt.example
[0m11:37:05.649835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f188920>]}
[0m11:37:05.742168 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:37:05.744501 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:37:05.783895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f10ba70>]}
[0m11:37:05.784585 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 474 macros
[0m11:37:05.785064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f3a88f0>]}
[0m11:37:05.787627 [info ] [MainThread]: 
[0m11:37:05.788108 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:37:05.788526 [info ] [MainThread]: 
[0m11:37:05.789175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:05.790192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m11:37:05.968268 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m11:37:05.968754 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m11:37:05.969155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:06.643124 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.674 seconds
[0m11:37:06.646911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m11:37:06.647763 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m11:37:06.663177 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m11:37:06.663636 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m11:37:06.664042 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m11:37:06.664483 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m11:37:06.664915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:06.829737 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.164 seconds
[0m11:37:07.042797 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb99dd-0304-eb8b-0004-59ff001d57a6
[0m11:37:07.043396 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:37:07.044028 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:37:07.044519 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:37:07.045447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f29a7b0>]}
[0m11:37:07.051608 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m11:37:07.052305 [debug] [Thread-2 (]: Began running node model.lab2_dbt.moving_average
[0m11:37:07.052940 [debug] [Thread-3 (]: Began running node model.lab2_dbt.rolling_volatality
[0m11:37:07.053599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m11:37:07.054164 [debug] [Thread-4 (]: Began running node model.lab2_dbt.rsi
[0m11:37:07.054697 [debug] [Thread-5 (]: Began running node model.lab2_dbt.volatility
[0m11:37:07.055221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.moving_average)
[0m11:37:07.055902 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.lab2_dbt.rolling_volatality'
[0m11:37:07.056416 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m11:37:07.057046 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.lab2_dbt.rsi'
[0m11:37:07.058143 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.lab2_dbt.volatility'
[0m11:37:07.058619 [debug] [Thread-2 (]: Began compiling node model.lab2_dbt.moving_average
[0m11:37:07.059132 [debug] [Thread-3 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m11:37:07.070163 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m11:37:07.070642 [debug] [Thread-4 (]: Began compiling node model.lab2_dbt.rsi
[0m11:37:07.071126 [debug] [Thread-5 (]: Began compiling node model.lab2_dbt.volatility
[0m11:37:07.074051 [debug] [Thread-2 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m11:37:07.077167 [debug] [Thread-3 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m11:37:07.080442 [debug] [Thread-4 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m11:37:07.083458 [debug] [Thread-5 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m11:37:07.085141 [debug] [Thread-2 (]: Finished running node model.lab2_dbt.moving_average
[0m11:37:07.086057 [debug] [Thread-4 (]: Finished running node model.lab2_dbt.rsi
[0m11:37:07.086894 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m11:37:07.087761 [debug] [Thread-5 (]: Finished running node model.lab2_dbt.volatility
[0m11:37:07.088465 [debug] [Thread-3 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m11:37:07.089420 [debug] [Thread-2 (]: Began running node model.lab2_dbt.session_summary
[0m11:37:07.090075 [info ] [Thread-2 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m11:37:07.090762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.session_summary)
[0m11:37:07.091235 [debug] [Thread-2 (]: Began compiling node model.lab2_dbt.session_summary
[0m11:37:07.099672 [debug] [Thread-2 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m11:37:07.100549 [debug] [Thread-2 (]: Began executing node model.lab2_dbt.session_summary
[0m11:37:07.135420 [debug] [Thread-2 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m11:37:07.139162 [debug] [Thread-2 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m11:37:07.139700 [debug] [Thread-2 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m11:37:09.191007 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.051 seconds
[0m11:37:09.229213 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f73e0>]}
[0m11:37:09.230036 [info ] [Thread-2 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.14s]
[0m11:37:09.230810 [debug] [Thread-2 (]: Finished running node model.lab2_dbt.session_summary
[0m11:37:09.232371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:09.232762 [debug] [MainThread]: Connection 'model.lab2_dbt.gap_analysis' was left open.
[0m11:37:09.233155 [debug] [MainThread]: On model.lab2_dbt.gap_analysis: Close
[0m11:37:09.341246 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was left open.
[0m11:37:09.341943 [debug] [MainThread]: On model.lab2_dbt.session_summary: Close
[0m11:37:09.461798 [debug] [MainThread]: Connection 'model.lab2_dbt.rolling_volatality' was properly closed.
[0m11:37:09.462444 [debug] [MainThread]: Connection 'model.lab2_dbt.rsi' was properly closed.
[0m11:37:09.462898 [debug] [MainThread]: Connection 'model.lab2_dbt.volatility' was properly closed.
[0m11:37:09.463413 [info ] [MainThread]: 
[0m11:37:09.463954 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m11:37:09.465225 [debug] [MainThread]: Command end result
[0m11:37:09.494016 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:37:09.495881 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:37:09.504422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/airflow_setup/lab2_dbt/target/run_results.json
[0m11:37:09.504921 [info ] [MainThread]: 
[0m11:37:09.505468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:09.505896 [info ] [MainThread]: 
[0m11:37:09.506352 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:37:09.509083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.245608, "process_in_blocks": "0", "process_kernel_time": 1.012327, "process_mem_max_rss": "198705152", "process_out_blocks": "0", "process_user_time": 5.642897}
[0m11:37:09.509779 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:09.509635 after 8.25 seconds
[0m11:37:09.510282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1e99d0>]}
[0m11:37:09.510763 [debug] [MainThread]: Flushing usage events
[0m11:37:09.857965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:09.163879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1aee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db78500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db7bcb0>]}


============================== 11:45:09.172065 | 3e01dc4d-808b-4d2b-9661-b34a3001300c ==============================
[0m11:45:09.172065 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:45:09.172887 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/Users/user/.dbt', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m11:45:11.949292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a0edeb0>]}
[0m11:45:12.015896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c09f140>]}
[0m11:45:12.018618 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:45:12.222630 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:45:12.479273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:45:12.480037 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models/output/schema.yml
[0m11:45:12.817230 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_dbt.example
[0m11:45:12.832688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aff0860>]}
[0m11:45:12.937736 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:45:12.939918 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:45:13.069579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14adde8a0>]}
[0m11:45:13.070408 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 474 macros
[0m11:45:13.070965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14afddd30>]}
[0m11:45:13.073799 [info ] [MainThread]: 
[0m11:45:13.074335 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:45:13.074811 [info ] [MainThread]: 
[0m11:45:13.075527 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:45:13.076629 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m11:45:13.210823 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m11:45:13.211308 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m11:45:13.211705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:13.853852 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.642 seconds
[0m11:45:13.856870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m11:45:13.857621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m11:45:13.877499 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m11:45:13.883285 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m11:45:13.883910 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m11:45:13.885195 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m11:45:13.885631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:14.046612 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.162 seconds
[0m11:45:14.300527 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb99e5-0304-efe8-0004-59ff001d77ea
[0m11:45:14.301074 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:45:14.301637 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:45:14.302070 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:45:14.302905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14addeb10>]}
[0m11:45:14.306701 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m11:45:14.307270 [debug] [Thread-2 (]: Began running node model.lab2_dbt.moving_average
[0m11:45:14.307830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m11:45:14.308330 [debug] [Thread-3 (]: Began running node model.lab2_dbt.rolling_volatality
[0m11:45:14.308860 [debug] [Thread-4 (]: Began running node model.lab2_dbt.rsi
[0m11:45:14.309376 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.moving_average)
[0m11:45:14.309857 [debug] [Thread-5 (]: Began running node model.lab2_dbt.volatility
[0m11:45:14.310833 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m11:45:14.311500 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.lab2_dbt.rolling_volatality'
[0m11:45:14.312141 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.lab2_dbt.rsi'
[0m11:45:14.312660 [debug] [Thread-2 (]: Began compiling node model.lab2_dbt.moving_average
[0m11:45:14.313304 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.lab2_dbt.volatility'
[0m11:45:14.324962 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m11:45:14.325540 [debug] [Thread-3 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m11:45:14.326029 [debug] [Thread-4 (]: Began compiling node model.lab2_dbt.rsi
[0m11:45:14.329078 [debug] [Thread-2 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m11:45:14.329641 [debug] [Thread-5 (]: Began compiling node model.lab2_dbt.volatility
[0m11:45:14.333689 [debug] [Thread-3 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m11:45:14.337186 [debug] [Thread-4 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m11:45:14.338218 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m11:45:14.341325 [debug] [Thread-5 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m11:45:14.342333 [debug] [Thread-2 (]: Finished running node model.lab2_dbt.moving_average
[0m11:45:14.343682 [debug] [Thread-4 (]: Finished running node model.lab2_dbt.rsi
[0m11:45:14.344619 [debug] [Thread-3 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m11:45:14.345588 [debug] [Thread-5 (]: Finished running node model.lab2_dbt.volatility
[0m11:45:14.346434 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m11:45:14.347081 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m11:45:14.347780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.session_summary)
[0m11:45:14.348347 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m11:45:14.358327 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m11:45:14.359283 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m11:45:14.401033 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m11:45:14.404628 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m11:45:14.405255 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m11:45:15.283402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.877 seconds
[0m11:45:15.323300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ff7a0>]}
[0m11:45:15.324277 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 0.97s]
[0m11:45:15.325100 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m11:45:15.326739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:15.327148 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was left open.
[0m11:45:15.327563 [debug] [MainThread]: On model.lab2_dbt.session_summary: Close
[0m11:45:15.444200 [debug] [MainThread]: Connection 'model.lab2_dbt.moving_average' was left open.
[0m11:45:15.444902 [debug] [MainThread]: On model.lab2_dbt.moving_average: Close
[0m11:45:15.553965 [debug] [MainThread]: Connection 'model.lab2_dbt.rolling_volatality' was properly closed.
[0m11:45:15.554455 [debug] [MainThread]: Connection 'model.lab2_dbt.rsi' was properly closed.
[0m11:45:15.554840 [debug] [MainThread]: Connection 'model.lab2_dbt.volatility' was properly closed.
[0m11:45:15.555277 [info ] [MainThread]: 
[0m11:45:15.555742 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m11:45:15.556679 [debug] [MainThread]: Command end result
[0m11:45:15.586265 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:45:15.588220 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:45:15.596214 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/airflow_setup/lab2_dbt/target/run_results.json
[0m11:45:15.596801 [info ] [MainThread]: 
[0m11:45:15.597348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:15.597788 [info ] [MainThread]: 
[0m11:45:15.598358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:45:15.602861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5453095, "process_in_blocks": "0", "process_kernel_time": 1.345645, "process_mem_max_rss": "191795200", "process_out_blocks": "0", "process_user_time": 5.289168}
[0m11:45:15.603582 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:15.603438 after 6.55 seconds
[0m11:45:15.604083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4d2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4d2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4d2ed0>]}
[0m11:45:15.604559 [debug] [MainThread]: Flushing usage events
[0m11:45:15.958631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:37.672703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108929100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ac2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0afb00>]}


============================== 11:46:37.678409 | 08f1b76e-9f68-4ea3-a71e-def843152987 ==============================
[0m11:46:37.678409 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:46:37.679392 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'profiles_dir': '/Users/user/.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:46:39.042841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a607a0>]}
[0m11:46:39.118995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110096b40>]}
[0m11:46:39.119844 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:46:39.297051 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:46:39.452740 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:46:39.453296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a751a60>]}
[0m11:46:41.135802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147565d60>]}
[0m11:46:41.232347 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:46:41.234786 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:46:41.251526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473d0e60>]}
[0m11:46:41.252107 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 474 macros
[0m11:46:41.252538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14727a8a0>]}
[0m11:46:41.254916 [info ] [MainThread]: 
[0m11:46:41.255467 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:46:41.255860 [info ] [MainThread]: 
[0m11:46:41.256457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:41.257385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m11:46:41.337432 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m11:46:41.337903 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m11:46:41.338298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:41.967928 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.629 seconds
[0m11:46:41.971130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m11:46:41.971841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m11:46:41.991393 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m11:46:41.996120 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m11:46:41.996536 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m11:46:41.996977 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m11:46:41.997922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:42.084661 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb99e6-0304-eec0-0004-59ff001d845a
[0m11:46:42.085138 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:46:42.085628 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:46:42.086000 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:46:42.381381 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.383 seconds
[0m11:46:42.385608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147728620>]}
[0m11:46:42.388772 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m11:46:42.389346 [debug] [Thread-2 (]: Began running node model.lab2_dbt.moving_average
[0m11:46:42.389894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m11:46:42.390385 [debug] [Thread-3 (]: Began running node model.lab2_dbt.rolling_volatality
[0m11:46:42.391000 [debug] [Thread-4 (]: Began running node model.lab2_dbt.rsi
[0m11:46:42.391548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.moving_average)
[0m11:46:42.392442 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m11:46:42.393063 [debug] [Thread-5 (]: Began running node model.lab2_dbt.volatility
[0m11:46:42.393725 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.lab2_dbt.rolling_volatality'
[0m11:46:42.394374 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.lab2_dbt.rsi'
[0m11:46:42.394886 [debug] [Thread-2 (]: Began compiling node model.lab2_dbt.moving_average
[0m11:46:42.405128 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m11:46:42.405863 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.lab2_dbt.volatility'
[0m11:46:42.406372 [debug] [Thread-3 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m11:46:42.406844 [debug] [Thread-4 (]: Began compiling node model.lab2_dbt.rsi
[0m11:46:42.411159 [debug] [Thread-2 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m11:46:42.411833 [debug] [Thread-5 (]: Began compiling node model.lab2_dbt.volatility
[0m11:46:42.415022 [debug] [Thread-3 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m11:46:42.419100 [debug] [Thread-4 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m11:46:42.420185 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m11:46:42.423359 [debug] [Thread-5 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m11:46:42.424515 [debug] [Thread-2 (]: Finished running node model.lab2_dbt.moving_average
[0m11:46:42.425800 [debug] [Thread-3 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m11:46:42.426567 [debug] [Thread-4 (]: Finished running node model.lab2_dbt.rsi
[0m11:46:42.427429 [debug] [Thread-5 (]: Finished running node model.lab2_dbt.volatility
[0m11:46:42.428293 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m11:46:42.429035 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m11:46:42.429610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.session_summary)
[0m11:46:42.430081 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m11:46:42.439820 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m11:46:42.440735 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m11:46:42.479926 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m11:46:42.483680 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m11:46:42.484562 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m11:46:43.650564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.165 seconds
[0m11:46:43.688859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c37da0>]}
[0m11:46:43.689703 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.26s]
[0m11:46:43.690499 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m11:46:43.692108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:43.692576 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was left open.
[0m11:46:43.693003 [debug] [MainThread]: On model.lab2_dbt.session_summary: Close
[0m11:46:43.835555 [debug] [MainThread]: Connection 'model.lab2_dbt.moving_average' was left open.
[0m11:46:43.836085 [debug] [MainThread]: On model.lab2_dbt.moving_average: Close
[0m11:46:43.949096 [debug] [MainThread]: Connection 'model.lab2_dbt.rolling_volatality' was properly closed.
[0m11:46:43.950140 [debug] [MainThread]: Connection 'model.lab2_dbt.rsi' was properly closed.
[0m11:46:43.951367 [debug] [MainThread]: Connection 'model.lab2_dbt.volatility' was properly closed.
[0m11:46:43.952095 [info ] [MainThread]: 
[0m11:46:43.952671 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m11:46:43.953724 [debug] [MainThread]: Command end result
[0m11:46:43.981561 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:46:43.984274 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:46:43.992289 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/airflow_setup/lab2_dbt/target/run_results.json
[0m11:46:43.992778 [info ] [MainThread]: 
[0m11:46:43.993335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:43.993777 [info ] [MainThread]: 
[0m11:46:43.994248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:46:43.996883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.411817, "process_in_blocks": "0", "process_kernel_time": 0.961242, "process_mem_max_rss": "196149248", "process_out_blocks": "0", "process_user_time": 5.99042}
[0m11:46:43.997560 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:43.997409 after 6.41 seconds
[0m11:46:43.998081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108929100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473fef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a68b830>]}
[0m11:46:43.998581 [debug] [MainThread]: Flushing usage events
[0m11:46:44.365819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:50:11.689915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7c08f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35bd70>]}


============================== 11:50:11.697734 | 1a8ff2df-a50f-4ae9-b2db-9d0c3ad1d46c ==============================
[0m11:50:11.697734 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:50:11.698660 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/user/Desktop/airflow_setup/lab2_dbt', 'use_colors': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:50:11.705906 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m11:50:11.708519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.102116704, "process_in_blocks": "0", "process_kernel_time": 0.434719, "process_mem_max_rss": "103636992", "process_out_blocks": "0", "process_user_time": 1.941819}
[0m11:50:11.709344 [debug] [MainThread]: Command `dbt run` failed at 11:50:11.709183 after 0.10 seconds
[0m11:50:11.709860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd2ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc02660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe71c10>]}
[0m11:50:11.710378 [debug] [MainThread]: Flushing usage events
[0m11:50:12.355263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:02.536456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61ff7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61dc6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61fae8a0>]}


============================== 17:44:02.548740 | 07cc8b61-51cb-4dcd-b063-43f92d36f7ba ==============================
[0m17:44:02.548740 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:44:02.549897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m17:44:03.905039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e39fc9dc0>]}
[0m17:44:03.967249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4f1a4350>]}
[0m17:44:03.968432 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:44:04.124474 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:44:04.277968 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:44:04.278678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e625893a0>]}
[0m17:44:05.833045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3a25d340>]}
[0m17:44:06.061147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e381877a0>]}
[0m17:44:06.061955 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:44:06.062631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e39b3cf20>]}
[0m17:44:06.065019 [info ] [MainThread]: 
[0m17:44:06.065869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:44:06.067163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:44:06.087177 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:44:06.087928 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:44:06.088512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:06.863973 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.775 seconds
[0m17:44:06.867178 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:44:07.199818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:44:07.216808 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:44:07.217627 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:44:07.218344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:08.107776 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9f48-0304-eb6a-0004-59ff001dae76
[0m17:44:08.108701 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:44:08.109625 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:44:08.110329 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:44:08.111090 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:44:08.466128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:44:08.470770 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:44:08.471670 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:44:08.472596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:09.373497 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.901 seconds
[0m17:44:09.377139 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:44:09.706238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3815adb0>]}
[0m17:44:09.707409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:09.708237 [info ] [MainThread]: 
[0m17:44:09.720725 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m17:44:09.721645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m17:44:09.722411 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m17:44:09.735149 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m17:44:09.739893 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m17:44:09.741220 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m17:44:09.742023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m17:44:09.742814 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m17:44:09.746989 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m17:44:09.749837 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m17:44:09.750791 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m17:44:09.751621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m17:44:09.752259 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m17:44:09.756250 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m17:44:09.759919 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m17:44:09.761200 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m17:44:09.762699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m17:44:09.763589 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m17:44:09.768252 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m17:44:09.771351 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m17:44:09.772302 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m17:44:09.773148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m17:44:09.773921 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m17:44:09.778421 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m17:44:09.780804 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m17:44:09.782664 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m17:44:09.783532 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:44:09.784315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m17:44:09.784949 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m17:44:09.797685 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m17:44:09.801516 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m17:44:09.850384 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m17:44:09.857041 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m17:44:09.858198 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m17:44:09.859202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:12.116912 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.258 seconds
[0m17:44:12.159724 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m17:44:12.653285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e6258a660>]}
[0m17:44:12.654485 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.87s]
[0m17:44:12.655647 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m17:44:12.658521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:12.659201 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m17:44:12.659932 [info ] [MainThread]: 
[0m17:44:12.660778 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.59 seconds (6.59s).
[0m17:44:12.662227 [debug] [MainThread]: Command end result
[0m17:44:12.730215 [info ] [MainThread]: 
[0m17:44:12.731318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:12.732351 [info ] [MainThread]: 
[0m17:44:12.733235 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:12.734793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.32809, "process_user_time": 6.634786, "process_kernel_time": 1.258536, "process_mem_max_rss": "222104", "process_in_blocks": "2448", "process_out_blocks": "5097"}
[0m17:44:12.735880 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:12.735711 after 10.33 seconds
[0m17:44:12.736706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61d38c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61ff7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61ff6ed0>]}
[0m17:44:12.737431 [debug] [MainThread]: Flushing usage events
[0m17:44:44.927480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd552718b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd549e0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5436b7a0>]}


============================== 17:44:44.935747 | 6f4ccac8-4252-4655-af16-f26a9ccd64a0 ==============================
[0m17:44:44.935747 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:44:44.936808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:44:46.120957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd54a7e570>]}
[0m17:44:46.191959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2cf38b00>]}
[0m17:44:46.193186 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:44:46.325300 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:44:46.498827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:46.499488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:46.549261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd27bd0f80>]}
[0m17:44:46.686168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd277557c0>]}
[0m17:44:46.686875 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:44:46.687518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2742a990>]}
[0m17:44:46.689830 [info ] [MainThread]: 
[0m17:44:46.690868 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:44:46.692415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:44:46.714622 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:44:46.715331 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:44:46.715935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:47.831940 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.116 seconds
[0m17:44:47.834863 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:44:48.174111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:44:48.189156 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:44:48.190154 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:44:48.191417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:48.899660 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9f48-0304-eb6a-0004-59ff001dae7e
[0m17:44:48.900592 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:44:48.901548 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:44:48.902305 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:44:48.903115 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:44:49.227516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:44:49.232563 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:44:49.233574 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:44:49.234475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:49.951037 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.717 seconds
[0m17:44:49.954341 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:44:50.281723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd269bd010>]}
[0m17:44:50.282935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:50.283823 [info ] [MainThread]: 
[0m17:44:50.296472 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m17:44:50.297519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m17:44:50.298308 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m17:44:50.312900 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m17:44:50.315871 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m17:44:50.316807 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m17:44:50.317808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m17:44:50.318556 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m17:44:50.322509 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m17:44:50.325856 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m17:44:50.327734 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m17:44:50.328806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m17:44:50.329730 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m17:44:50.334444 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m17:44:50.337720 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m17:44:50.338587 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m17:44:50.339362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m17:44:50.340210 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m17:44:50.344695 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m17:44:50.347657 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m17:44:50.348490 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m17:44:50.349281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m17:44:50.349964 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m17:44:50.353851 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m17:44:50.356244 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m17:44:50.358231 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m17:44:50.359692 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:44:50.360921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m17:44:50.361811 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m17:44:50.374943 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m17:44:50.377279 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m17:44:50.422317 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m17:44:50.428347 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m17:44:50.429561 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m17:44:50.430678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:52.651625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.221 seconds
[0m17:44:52.694974 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m17:44:52.834425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd278166c0>]}
[0m17:44:52.835726 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.47s]
[0m17:44:52.836940 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m17:44:52.839651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:52.840398 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m17:44:52.841386 [info ] [MainThread]: 
[0m17:44:52.842192 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m17:44:52.843572 [debug] [MainThread]: Command end result
[0m17:44:52.910448 [info ] [MainThread]: 
[0m17:44:52.911237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:52.911888 [info ] [MainThread]: 
[0m17:44:52.912578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:52.913871 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.06056, "process_user_time": 5.344937, "process_kernel_time": 0.717456, "process_mem_max_rss": "218056", "process_out_blocks": "1886", "process_in_blocks": "0"}
[0m17:44:52.914664 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:52.914519 after 8.06 seconds
[0m17:44:52.915262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5325fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd542259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd27718320>]}
[0m17:44:52.915856 [debug] [MainThread]: Flushing usage events
[0m17:44:57.404521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9914711f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9933f2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe991472b10>]}


============================== 17:44:57.414662 | 1f96246b-70de-472d-9fe8-99e01d6ba371 ==============================
[0m17:44:57.414662 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:44:57.415897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:58.730498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9697dd460>]}
[0m17:44:58.804187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96a43b200>]}
[0m17:44:58.805388 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:44:58.942611 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:44:59.091906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:59.092539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:59.139807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe991060da0>]}
[0m17:44:59.278210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9691a3f50>]}
[0m17:44:59.278937 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:44:59.279614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe969f3ab70>]}
[0m17:44:59.281703 [info ] [MainThread]: 
[0m17:44:59.282340 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:44:59.284744 [debug] [MainThread]: Command end result
[0m17:44:59.333677 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0087087, "process_user_time": 4.457289, "process_kernel_time": 0.794987, "process_mem_max_rss": "212016", "process_out_blocks": "1831", "process_in_blocks": "0"}
[0m17:44:59.334335 [debug] [MainThread]: Command `dbt test` succeeded at 17:44:59.334225 after 2.01 seconds
[0m17:44:59.334809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe992036900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9694e06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9694ef3e0>]}
[0m17:44:59.335271 [debug] [MainThread]: Flushing usage events
[0m17:45:04.082198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89aa803e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89acb62600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89aa8028a0>]}


============================== 17:45:04.089598 | 137ddd88-2a55-48ec-bff8-4dd0bbb4de0b ==============================
[0m17:45:04.089598 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:45:04.090445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:05.287423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a9e50830>]}
[0m17:45:05.358694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89aa59e3c0>]}
[0m17:45:05.359956 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:45:05.497702 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:45:05.665305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:05.665988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:05.719442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a217af90>]}
[0m17:45:05.881315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897e5d7890>]}
[0m17:45:05.882104 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:45:05.882730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897e699dc0>]}
[0m17:45:05.885003 [info ] [MainThread]: 
[0m17:45:05.885895 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:45:05.887295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:45:05.910068 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:45:05.910884 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:45:05.911591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:07.210882 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.299 seconds
[0m17:45:07.213754 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:45:07.574803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now create_user_db_lobster1_snapshot)
[0m17:45:07.575962 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster1"
schema: "snapshot"
"
[0m17:45:07.582489 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster1_snapshot"
[0m17:45:07.583177 [debug] [ThreadPool]: On create_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "create_user_db_lobster1_snapshot"} */
create schema if not exists user_db_lobster1.snapshot
[0m17:45:07.583789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:08.265330 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.681 seconds
[0m17:45:08.267345 [debug] [ThreadPool]: On create_user_db_lobster1_snapshot: Close
[0m17:45:08.627685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:45:08.643413 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:45:08.644278 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:45:08.644964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:09.319559 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.675 seconds
[0m17:45:09.322382 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:45:09.586205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m17:45:09.591127 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:45:09.591993 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:45:09.592772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:10.162433 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.570 seconds
[0m17:45:10.164906 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:45:10.320487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897e433ec0>]}
[0m17:45:10.321530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:10.322445 [info ] [MainThread]: 
[0m17:45:10.335138 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:45:10.336174 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m17:45:10.337089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m17:45:10.337848 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m17:45:10.351747 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m17:45:10.475659 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m17:45:10.476820 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m17:45:10.477596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:11.109750 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb9f49-0304-f117-0004-59ff001e1282
[0m17:45:11.110680 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 26
invalid identifier 'SESSIONID'
[0m17:45:11.111757 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m17:45:11.275299 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SESSIONID'
[0m17:45:11.278054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897db4e4e0>]}
[0m17:45:11.279442 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 0.94s]
[0m17:45:11.280855 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:45:11.284856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:11.285552 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m17:45:11.286330 [info ] [MainThread]: 
[0m17:45:11.287154 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.40 seconds (5.40s).
[0m17:45:11.288499 [debug] [MainThread]: Command end result
[0m17:45:11.351742 [info ] [MainThread]: 
[0m17:45:11.352549 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:45:11.353326 [info ] [MainThread]: 
[0m17:45:11.354176 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SESSIONID'
[0m17:45:11.354858 [info ] [MainThread]: 
[0m17:45:11.355475 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:45:11.356767 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.348532, "process_user_time": 5.433128, "process_kernel_time": 0.845672, "process_mem_max_rss": "218492", "process_out_blocks": "1855", "command_success": false, "process_in_blocks": "0"}
[0m17:45:11.357698 [debug] [MainThread]: Command `dbt snapshot` failed at 17:45:11.357545 after 7.35 seconds
[0m17:45:11.358442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89aa8ab3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a217af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897e9c3080>]}
[0m17:45:11.359110 [debug] [MainThread]: Flushing usage events
[0m17:54:07.222026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eba83e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eb4b4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eb4b7fb0>]}


============================== 17:54:07.229682 | 5e6b9f05-1eea-4896-9c64-e2fdae195843 ==============================
[0m17:54:07.229682 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:54:07.230582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:08.279919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c2066990>]}
[0m17:54:08.339277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c23158e0>]}
[0m17:54:08.340291 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:54:08.465400 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:54:08.638691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:08.639534 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m17:54:08.992067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c1bb0ec0>]}
[0m17:54:09.208960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c1d37350>]}
[0m17:54:09.209953 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:54:09.211250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c1f77da0>]}
[0m17:54:09.214366 [info ] [MainThread]: 
[0m17:54:09.215922 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:09.217894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:54:09.240166 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:54:09.240982 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:54:09.241653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:10.323430 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.082 seconds
[0m17:54:10.326001 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:54:10.658341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:54:10.672749 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:54:10.673552 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:54:10.674254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:11.388060 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.714 seconds
[0m17:54:11.391263 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:54:11.710008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:54:11.714703 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:54:11.715668 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:54:11.716450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:12.587121 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.870 seconds
[0m17:54:12.590681 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:54:12.883155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e5dcd460>]}
[0m17:54:12.884703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:12.886200 [info ] [MainThread]: 
[0m17:54:12.898639 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:54:12.899676 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m17:54:12.900698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m17:54:12.901507 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m17:54:12.915259 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m17:54:13.054729 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m17:54:13.055995 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m17:54:13.056952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:13.784992 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb9f52-0304-f117-0004-59ff001e12ce
[0m17:54:13.786111 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'TS'
[0m17:54:13.787374 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m17:54:14.151005 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m17:54:14.153704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ea4f9940>]}
[0m17:54:14.155500 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 1.25s]
[0m17:54:14.157043 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:54:14.160834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:14.161619 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m17:54:14.162373 [info ] [MainThread]: 
[0m17:54:14.163581 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m17:54:14.164949 [debug] [MainThread]: Command end result
[0m17:54:14.229815 [info ] [MainThread]: 
[0m17:54:14.231330 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:14.232374 [info ] [MainThread]: 
[0m17:54:14.233432 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m17:54:14.234172 [info ] [MainThread]: 
[0m17:54:14.234981 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:54:14.236898 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.087391, "process_user_time": 5.124285, "process_kernel_time": 0.836984, "process_mem_max_rss": "221112", "process_out_blocks": "2770", "command_success": false, "process_in_blocks": "0"}
[0m17:54:14.237974 [debug] [MainThread]: Command `dbt snapshot` failed at 17:54:14.237740 after 7.09 seconds
[0m17:54:14.238621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e9a73bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c1c70290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c19d3fb0>]}
[0m17:54:14.239328 [debug] [MainThread]: Flushing usage events
[0m17:55:08.474926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589b176e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589b9ab260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589c6945c0>]}


============================== 17:55:08.482098 | 8291b180-a1f9-4863-8221-adf80ae052b6 ==============================
[0m17:55:08.482098 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:55:08.483033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:55:09.556536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589ab59d60>]}
[0m17:55:09.629124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5883382210>]}
[0m17:55:09.630325 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:55:09.777529 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:55:10.043214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:10.056517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:10.116203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586efbcb00>]}
[0m17:55:10.265875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586edbac30>]}
[0m17:55:10.266606 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:55:10.267224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5894311850>]}
[0m17:55:10.269964 [info ] [MainThread]: 
[0m17:55:10.270958 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:55:10.272461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:55:10.294254 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:55:10.295000 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:55:10.295558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:11.299023 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.003 seconds
[0m17:55:11.301301 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:55:11.454539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:55:11.469270 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:55:11.470077 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:55:11.470822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:11.906835 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.436 seconds
[0m17:55:11.909294 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:55:12.056975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:55:12.061038 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:55:12.061826 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:55:12.062548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:12.552197 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.490 seconds
[0m17:55:12.555694 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:55:12.701416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586fe306b0>]}
[0m17:55:12.702744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:12.703644 [info ] [MainThread]: 
[0m17:55:12.715677 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m17:55:12.716633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m17:55:12.717437 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m17:55:12.730400 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m17:55:12.733354 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m17:55:12.734279 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m17:55:12.735159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m17:55:12.735958 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m17:55:12.740659 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m17:55:12.743057 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m17:55:12.743905 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m17:55:12.744670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m17:55:12.745859 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m17:55:12.750402 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m17:55:12.753078 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m17:55:12.753922 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m17:55:12.754758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m17:55:12.755459 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m17:55:12.759470 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m17:55:12.761753 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m17:55:12.762525 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m17:55:12.763186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m17:55:12.763871 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m17:55:12.767619 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m17:55:12.769875 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m17:55:12.771334 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m17:55:12.772263 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:55:12.773086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m17:55:12.773703 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m17:55:12.785194 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m17:55:12.787563 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m17:55:12.839620 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m17:55:12.850010 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m17:55:12.856724 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m17:55:12.859899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:14.615205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.755 seconds
[0m17:55:14.671888 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m17:55:14.818337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586f2aea20>]}
[0m17:55:14.819922 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.04s]
[0m17:55:14.821125 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m17:55:14.823914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:14.824615 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m17:55:14.825414 [info ] [MainThread]: 
[0m17:55:14.826175 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m17:55:14.827640 [debug] [MainThread]: Command end result
[0m17:55:14.892183 [info ] [MainThread]: 
[0m17:55:14.893043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:14.893767 [info ] [MainThread]: 
[0m17:55:14.894390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:55:14.895953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.488143, "process_user_time": 5.369087, "process_kernel_time": 0.906706, "process_mem_max_rss": "217404", "process_out_blocks": "1886", "process_in_blocks": "0"}
[0m17:55:14.896703 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:14.896559 after 6.49 seconds
[0m17:55:14.897316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589d48be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589a761160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589ae7ef30>]}
[0m17:55:14.898020 [debug] [MainThread]: Flushing usage events
[0m17:55:18.903874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ab0285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a9586330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a988efc0>]}


============================== 17:55:18.910044 | c4494c3c-7468-4c85-9ff6-cd7d155a4458 ==============================
[0m17:55:18.910044 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:55:18.910767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:55:19.865066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99aa4496a0>]}
[0m17:55:19.919495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9981b023f0>]}
[0m17:55:19.920515 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:55:20.043474 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:55:20.182950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:20.183478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:20.228878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99815cf500>]}
[0m17:55:20.400309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998135f9e0>]}
[0m17:55:20.401100 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:55:20.401797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9981b254f0>]}
[0m17:55:20.403926 [info ] [MainThread]: 
[0m17:55:20.404550 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:55:20.406851 [debug] [MainThread]: Command end result
[0m17:55:20.455082 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6190332, "process_user_time": 3.969786, "process_kernel_time": 0.774335, "process_mem_max_rss": "212904", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m17:55:20.455712 [debug] [MainThread]: Command `dbt test` succeeded at 17:55:20.455600 after 1.62 seconds
[0m17:55:20.456205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a9e98a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a9522db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99aa2e16d0>]}
[0m17:55:20.456743 [debug] [MainThread]: Flushing usage events
[0m17:55:26.174824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce94a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce99d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccf35b3b0>]}


============================== 17:55:26.180668 | a3b5f857-e170-4e34-9c81-0d9dff34e3c3 ==============================
[0m17:55:26.180668 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:55:26.181681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:55:27.187446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2852510>]}
[0m17:55:27.241972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccdf243b0>]}
[0m17:55:27.242905 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:55:27.365737 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:55:27.503977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:27.504497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:27.549847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2cbfcb0>]}
[0m17:55:27.669784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2719580>]}
[0m17:55:27.670371 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:55:27.671058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2627440>]}
[0m17:55:27.673110 [info ] [MainThread]: 
[0m17:55:27.673866 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:55:27.675066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:55:27.693056 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:55:27.693607 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:55:27.694067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:29.147194 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.453 seconds
[0m17:55:29.149108 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:55:29.311375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:55:29.324267 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:55:29.325065 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:55:29.325854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:29.838537 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.513 seconds
[0m17:55:29.840709 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:55:30.058219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m17:55:30.065543 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:55:30.066699 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:55:30.067617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:30.517803 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.450 seconds
[0m17:55:30.520074 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:55:30.746569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca23e6cc0>]}
[0m17:55:30.747453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:30.748004 [info ] [MainThread]: 
[0m17:55:30.756655 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:55:30.757411 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m17:55:30.758179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m17:55:30.758795 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m17:55:30.769053 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m17:55:30.868317 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m17:55:30.869354 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m17:55:30.870032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:31.371714 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb9f53-0304-efe8-0004-59ff001dcd92
[0m17:55:31.372496 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'TS'
[0m17:55:31.373223 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m17:55:31.546991 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m17:55:31.548846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca1b7fdd0>]}
[0m17:55:31.550006 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 0.79s]
[0m17:55:31.551144 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:55:31.554273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:31.554855 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m17:55:31.555414 [info ] [MainThread]: 
[0m17:55:31.555986 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m17:55:31.556866 [debug] [MainThread]: Command end result
[0m17:55:31.610951 [info ] [MainThread]: 
[0m17:55:31.611583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:31.612056 [info ] [MainThread]: 
[0m17:55:31.612805 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m17:55:31.613297 [info ] [MainThread]: 
[0m17:55:31.613892 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:55:31.615021 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.5061603, "process_user_time": 4.404809, "process_kernel_time": 0.866931, "process_mem_max_rss": "219368", "process_out_blocks": "1853", "command_success": false, "process_in_blocks": "0"}
[0m17:55:31.615759 [debug] [MainThread]: Command `dbt snapshot` failed at 17:55:31.615642 after 5.51 seconds
[0m17:55:31.616307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce977e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd1eba2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2829880>]}
[0m17:55:31.616862 [debug] [MainThread]: Flushing usage events
[0m17:56:43.238531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383e3a2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383f135790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383e61ffb0>]}


============================== 17:56:43.246106 | 4953d818-6b4c-4cd8-89ec-4c7757803c48 ==============================
[0m17:56:43.246106 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:56:43.247006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:56:44.300754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4953d818-6b4c-4cd8-89ec-4c7757803c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3814df6db0>]}
[0m17:56:44.358701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4953d818-6b4c-4cd8-89ec-4c7757803c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383cd2a3c0>]}
[0m17:56:44.359736 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:56:44.486945 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:56:44.657023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:44.658063 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m17:56:44.836416 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  invalid syntax for function call expression
    line 3
      config(
[0m17:56:44.837535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6712099, "process_user_time": 4.398362, "process_kernel_time": 0.825021, "process_mem_max_rss": "210444", "process_in_blocks": "16", "process_out_blocks": "21", "command_success": false}
[0m17:56:44.838433 [debug] [MainThread]: Command `dbt run` failed at 17:56:44.838318 after 1.67 seconds
[0m17:56:44.838968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383d40aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3814d25880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38148587d0>]}
[0m17:56:44.839515 [debug] [MainThread]: Flushing usage events
[0m17:57:29.538789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa08ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48adb100e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa4a8d70>]}


============================== 17:57:29.546726 | 9e0d62b4-7b31-4e6a-9d26-59c49dff6f48 ==============================
[0m17:57:29.546726 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:57:29.547898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:57:30.880073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e0d62b4-7b31-4e6a-9d26-59c49dff6f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48822643e0>]}
[0m17:57:30.948983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e0d62b4-7b31-4e6a-9d26-59c49dff6f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa6e9970>]}
[0m17:57:30.950184 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:57:31.091514 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:57:31.268938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:31.269854 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m17:57:31.484948 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: A snapshot configured with the check strategy must specify a check_cols configuration.
[0m17:57:31.486806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0166278, "process_user_time": 4.581082, "process_kernel_time": 0.773429, "process_mem_max_rss": "210220", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m17:57:31.487602 [debug] [MainThread]: Command `dbt run` failed at 17:57:31.487465 after 2.02 seconds
[0m17:57:31.488364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa4a8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa5eb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa001eb0>]}
[0m17:57:31.489098 [debug] [MainThread]: Flushing usage events
[0m18:00:48.535361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e395de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e5437d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e3355310>]}


============================== 18:00:48.542856 | c0b79c99-6053-4ab5-aa1e-85496426f245 ==============================
[0m18:00:48.542856 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:00:48.543807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:00:49.637115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e4c466c0>]}
[0m18:00:49.694931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01bcf91940>]}
[0m18:00:49.695913 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:00:49.816990 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:00:49.969993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:49.970930 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m18:00:50.260802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b7415220>]}
[0m18:00:50.408501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b7891af0>]}
[0m18:00:50.409242 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:00:50.409879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e3377a10>]}
[0m18:00:50.412526 [info ] [MainThread]: 
[0m18:00:50.413613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:50.415473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m18:00:50.439420 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m18:00:50.440212 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m18:00:50.440830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:51.693304 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.252 seconds
[0m18:00:51.696018 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m18:00:52.057119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m18:00:52.071793 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m18:00:52.072598 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m18:00:52.073299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:52.744422 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.671 seconds
[0m18:00:52.747624 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m18:00:53.107086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m18:00:53.111652 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m18:00:53.112471 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m18:00:53.113263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:53.797908 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.685 seconds
[0m18:00:53.800821 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m18:00:54.061898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b73c32c0>]}
[0m18:00:54.063020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:54.063792 [info ] [MainThread]: 
[0m18:00:54.075812 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m18:00:54.076749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m18:00:54.077561 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m18:00:54.091250 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m18:00:54.094533 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m18:00:54.095464 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m18:00:54.096344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m18:00:54.097004 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m18:00:54.101212 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m18:00:54.103710 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m18:00:54.104671 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m18:00:54.105491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m18:00:54.106163 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m18:00:54.110093 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m18:00:54.112899 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m18:00:54.113953 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m18:00:54.115297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m18:00:54.116557 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m18:00:54.121186 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m18:00:54.124494 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m18:00:54.125376 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m18:00:54.126105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m18:00:54.126995 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m18:00:54.131200 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m18:00:54.133992 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m18:00:54.136050 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m18:00:54.137097 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m18:00:54.137953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m18:00:54.138642 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m18:00:54.152732 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m18:00:54.155425 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m18:00:54.202514 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m18:00:54.208300 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m18:00:54.209350 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m18:00:54.210366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:56.421634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.211 seconds
[0m18:00:56.463019 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m18:00:56.785418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e3f519a0>]}
[0m18:00:56.787039 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.65s]
[0m18:00:56.788608 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m18:00:56.791685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:56.792451 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m18:00:56.793247 [info ] [MainThread]: 
[0m18:00:56.794042 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.38 seconds (6.38s).
[0m18:00:56.795497 [debug] [MainThread]: Command end result
[0m18:00:56.861852 [info ] [MainThread]: 
[0m18:00:56.862877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:56.863725 [info ] [MainThread]: 
[0m18:00:56.864499 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:00:56.865841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.40162, "process_user_time": 5.07091, "process_kernel_time": 0.679686, "process_mem_max_rss": "219736", "process_out_blocks": "2803", "process_in_blocks": "0"}
[0m18:00:56.866641 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:56.866486 after 8.40 seconds
[0m18:00:56.867378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e395de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e39b60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b6974ce0>]}
[0m18:00:56.868027 [debug] [MainThread]: Flushing usage events
[0m18:01:01.557085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1267011c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb126703140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1296753a0>]}


============================== 18:01:01.564903 | 26a85b92-16ff-4d86-83e2-bd084402f344 ==============================
[0m18:01:01.564903 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:01:01.565877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:02.619362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb125b060f0>]}
[0m18:01:02.678728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb126de0e30>]}
[0m18:01:02.679670 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:01:02.805996 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:01:02.952414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:02.952961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:03.001790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fe46cef0>]}
[0m18:01:03.142266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fdc93fe0>]}
[0m18:01:03.142942 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:01:03.143523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fdffc980>]}
[0m18:01:03.145519 [info ] [MainThread]: 
[0m18:01:03.146187 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:01:03.148515 [debug] [MainThread]: Command end result
[0m18:01:03.196300 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7097229, "process_user_time": 4.099531, "process_kernel_time": 0.840263, "process_mem_max_rss": "212320", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m18:01:03.196955 [debug] [MainThread]: Command `dbt test` succeeded at 18:01:03.196845 after 1.71 seconds
[0m18:01:03.197490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb125b04f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fe76f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1103716d0>]}
[0m18:01:03.197958 [debug] [MainThread]: Flushing usage events
[0m18:01:07.186274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e52c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e52f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e52ed20>]}


============================== 18:01:07.195285 | ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8 ==============================
[0m18:01:07.195285 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:01:07.196444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:01:08.275155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59317ae70>]}
[0m18:01:08.334789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59eb2e660>]}
[0m18:01:08.335734 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:01:08.471730 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:01:08.658935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:08.659910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:08.720213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe575a0f5f0>]}
[0m18:01:08.877880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57554cbf0>]}
[0m18:01:08.878726 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:01:08.879775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe575442f00>]}
[0m18:01:08.882508 [info ] [MainThread]: 
[0m18:01:08.884607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:08.886484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m18:01:08.908935 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m18:01:08.909775 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m18:01:08.910415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:10.288445 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.378 seconds
[0m18:01:10.291825 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m18:01:10.796073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m18:01:10.810645 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m18:01:10.811503 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m18:01:10.812287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:11.662737 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.850 seconds
[0m18:01:11.666093 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m18:01:11.985161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m18:01:11.990621 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m18:01:11.991447 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m18:01:11.992231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:12.652655 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.660 seconds
[0m18:01:12.655706 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m18:01:13.022620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe576ec89b0>]}
[0m18:01:13.023913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:13.024683 [info ] [MainThread]: 
[0m18:01:13.036878 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m18:01:13.037967 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m18:01:13.039149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m18:01:13.039861 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m18:01:13.056419 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m18:01:13.186558 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:01:13.187631 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:01:13.188534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:13.939014 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.750 seconds
[0m18:01:13.944895 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:01:13.946033 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:01:14.089604 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.143 seconds
[0m18:01:14.091081 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:01:14.096140 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:01:14.097060 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace transient table user_db_lobster1.snapshot.snapshot_session_summary
         as
        (
    

    select *,
        md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



        );
[0m18:01:15.140819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.043 seconds
[0m18:01:15.184969 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m18:01:15.657410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe575a42720>]}
[0m18:01:15.659480 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 1[0m in 2.62s]
[0m18:01:15.660879 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m18:01:15.663873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:15.664546 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m18:01:15.665261 [info ] [MainThread]: 
[0m18:01:15.666117 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.78 seconds (6.78s).
[0m18:01:15.667467 [debug] [MainThread]: Command end result
[0m18:01:15.737288 [info ] [MainThread]: 
[0m18:01:15.738260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:15.739119 [info ] [MainThread]: 
[0m18:01:15.739988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:01:15.741533 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.633961, "process_user_time": 4.867982, "process_kernel_time": 0.830086, "process_mem_max_rss": "217816", "process_out_blocks": "1858", "process_in_blocks": "0"}
[0m18:01:15.742740 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:01:15.742397 after 8.64 seconds
[0m18:01:15.743486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe576182ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59d661ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59d699040>]}
[0m18:01:15.744327 [debug] [MainThread]: Flushing usage events
[0m18:06:35.919192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc631d9e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc631d9fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc632074bf0>]}


============================== 18:06:35.927675 | b5002bc6-68de-4797-b966-153f788f587a ==============================
[0m18:06:35.927675 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:35.929100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:36.990670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60a9041a0>]}
[0m18:06:37.073096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc631de63c0>]}
[0m18:06:37.074670 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:06:37.242966 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:06:37.443873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:37.444734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:37.504722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc609ec0290>]}
[0m18:06:37.667133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc609ec1760>]}
[0m18:06:37.667857 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:06:37.668519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc609b94b00>]}
[0m18:06:37.670791 [info ] [MainThread]: 
[0m18:06:37.671718 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:37.673159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m18:06:37.697337 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m18:06:37.698146 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m18:06:37.698826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:38.840267 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.141 seconds
[0m18:06:38.843477 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m18:06:39.178866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m18:06:39.194971 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m18:06:39.195717 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m18:06:39.196399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:40.075740 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.879 seconds
[0m18:06:40.079145 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m18:06:40.402422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m18:06:40.406215 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m18:06:40.406801 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m18:06:40.407303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:41.154850 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.747 seconds
[0m18:06:41.158050 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m18:06:41.451620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60932c290>]}
[0m18:06:41.453057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:41.453849 [info ] [MainThread]: 
[0m18:06:41.465575 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m18:06:41.466530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m18:06:41.467556 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m18:06:41.481978 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m18:06:41.485477 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m18:06:41.486425 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m18:06:41.487326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m18:06:41.488063 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m18:06:41.492415 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m18:06:41.495420 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m18:06:41.496549 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m18:06:41.497451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m18:06:41.498278 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m18:06:41.502571 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m18:06:41.505254 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m18:06:41.506092 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m18:06:41.507031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m18:06:41.507888 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m18:06:41.512791 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m18:06:41.515910 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m18:06:41.516906 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m18:06:41.517783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m18:06:41.518532 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m18:06:41.522976 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m18:06:41.526045 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m18:06:41.527700 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m18:06:41.528670 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m18:06:41.529530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m18:06:41.530338 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m18:06:41.542631 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m18:06:41.545416 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m18:06:41.592312 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m18:06:41.598110 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m18:06:41.599149 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m18:06:41.600266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:43.400386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.800 seconds
[0m18:06:43.442208 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m18:06:43.934353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60a186990>]}
[0m18:06:43.935658 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.40s]
[0m18:06:43.937046 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m18:06:43.939937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:43.940623 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m18:06:43.941441 [info ] [MainThread]: 
[0m18:06:43.942392 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.27 seconds (6.27s).
[0m18:06:43.943983 [debug] [MainThread]: Command end result
[0m18:06:44.010412 [info ] [MainThread]: 
[0m18:06:44.011915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:44.013016 [info ] [MainThread]: 
[0m18:06:44.014111 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:06:44.015483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.171677, "process_user_time": 4.853146, "process_kernel_time": 0.849038, "process_mem_max_rss": "217368", "process_out_blocks": "1886", "process_in_blocks": "0"}
[0m18:06:44.016418 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:44.016264 after 8.17 seconds
[0m18:06:44.017075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc632074bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc632006d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6333fc1d0>]}
[0m18:06:44.017720 [debug] [MainThread]: Flushing usage events
[0m18:06:48.215623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09f6fd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09f739fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0a0118560>]}


============================== 18:06:48.223263 | 20c2be2e-1588-48ad-b2be-cb0ffa4b03c2 ==============================
[0m18:06:48.223263 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:48.224194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:49.296496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb073ee7a70>]}
[0m18:06:49.353992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09f73a420>]}
[0m18:06:49.355001 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:06:49.478161 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:06:49.628926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:49.629498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:49.676156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0736bfa40>]}
[0m18:06:49.816083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb073243bf0>]}
[0m18:06:49.816909 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:06:49.817612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb087194a70>]}
[0m18:06:49.819903 [info ] [MainThread]: 
[0m18:06:49.820529 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:06:49.823060 [debug] [MainThread]: Command end result
[0m18:06:49.874083 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7290015, "process_user_time": 4.303706, "process_kernel_time": 0.674047, "process_mem_max_rss": "212172", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m18:06:49.874938 [debug] [MainThread]: Command `dbt test` succeeded at 18:06:49.874820 after 1.73 seconds
[0m18:06:49.875490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09f6fd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0a128fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb073a82930>]}
[0m18:06:49.876115 [debug] [MainThread]: Flushing usage events
[0m18:06:54.139406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbb3ac050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbbb90230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbbf63e60>]}


============================== 18:06:54.147323 | c5705774-8ef5-46e7-8ea0-b290dfd66cef ==============================
[0m18:06:54.147323 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:54.148237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:55.326787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbb3ce570>]}
[0m18:06:55.401072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbbf436e0>]}
[0m18:06:55.402191 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:06:55.557157 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:06:55.741426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:55.742165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:55.802240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8f925280>]}
[0m18:06:55.956812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8f7c5640>]}
[0m18:06:55.957597 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:06:55.958315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8f488710>]}
[0m18:06:55.960627 [info ] [MainThread]: 
[0m18:06:55.961515 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:55.962991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m18:06:55.985360 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m18:06:55.986139 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m18:06:55.986810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:57.253558 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.267 seconds
[0m18:06:57.256639 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m18:06:57.582900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m18:06:57.598666 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m18:06:57.599525 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m18:06:57.600218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:58.450221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.850 seconds
[0m18:06:58.453470 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m18:06:58.774655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m18:06:58.781017 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m18:06:58.781856 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m18:06:58.782579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:59.642228 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.860 seconds
[0m18:06:59.645342 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m18:07:00.006252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8ec29760>]}
[0m18:07:00.007637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:00.008526 [info ] [MainThread]: 
[0m18:07:00.022425 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m18:07:00.023620 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m18:07:00.024917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m18:07:00.025657 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m18:07:00.040116 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m18:07:00.136273 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:00.137161 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m18:07:00.137874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:01.076280 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.938 seconds
[0m18:07:01.098609 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:01.100091 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m18:07:01.407598 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.306 seconds
[0m18:07:01.422263 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:01.423275 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m18:07:01.586838 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.163 seconds
[0m18:07:01.666007 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:01.667786 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:07:02.777497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.108 seconds
[0m18:07:02.783924 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:02.785030 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m18:07:02.900817 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.115 seconds
[0m18:07:02.907498 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:02.908392 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m18:07:03.037501 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.128 seconds
[0m18:07:03.043695 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.044687 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m18:07:03.149215 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.104 seconds
[0m18:07:03.155714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.156688 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m18:07:03.257144 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m18:07:03.268673 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.269568 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m18:07:03.365646 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.095 seconds
[0m18:07:03.405025 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.407035 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:07:03.715192 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.306 seconds
[0m18:07:03.721260 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.722088 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:07:03.843528 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.121 seconds
[0m18:07:03.844948 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.848257 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.849080 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m18:07:03.964746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m18:07:03.965917 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.967001 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:07:04.642124 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.674 seconds
[0m18:07:04.643094 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:04.644035 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m18:07:05.460578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m18:07:05.488119 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m18:07:05.686519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8fa82870>]}
[0m18:07:05.688180 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 0[0m in 5.66s]
[0m18:07:05.689445 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m18:07:05.692519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:05.693238 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m18:07:05.693886 [info ] [MainThread]: 
[0m18:07:05.694617 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m18:07:05.696036 [debug] [MainThread]: Command end result
[0m18:07:05.759610 [info ] [MainThread]: 
[0m18:07:05.760459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:05.761256 [info ] [MainThread]: 
[0m18:07:05.762086 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:07:05.763449 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.696003, "process_user_time": 5.299479, "process_kernel_time": 0.792273, "process_mem_max_rss": "218172", "process_out_blocks": "1897", "process_in_blocks": "0"}
[0m18:07:05.764299 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:07:05.764163 after 11.70 seconds
[0m18:07:05.764897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbf447ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbb97da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8f533ef0>]}
[0m18:07:05.765481 [debug] [MainThread]: Flushing usage events
[0m11:13:10.337618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b18b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446fbc0>]}


============================== 11:13:10.343705 | 3115ad8d-a733-42d9-b631-474a7db14f35 ==============================
[0m11:13:10.343705 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:13:10.344416 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'profiles_dir': '/Users/user/Desktop/airflow_setup/lab2_dbt', 'warn_error': 'None', 'introspect': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m11:13:10.351070 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m11:13:10.353141 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.08685418, "process_in_blocks": "0", "process_kernel_time": 0.223543, "process_mem_max_rss": "102809600", "process_out_blocks": "0", "process_user_time": 1.51656}
[0m11:13:10.353949 [debug] [MainThread]: Command `dbt docs serve` failed at 11:13:10.353802 after 0.09 seconds
[0m11:13:10.354399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499fec0>]}
[0m11:13:10.354871 [debug] [MainThread]: Flushing usage events
[0m11:13:10.719764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:00.839558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110506630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058bd70>]}


============================== 11:15:00.846310 | 6d25925f-d21b-4b96-b204-1bb8d386f5d6 ==============================
[0m11:15:00.846310 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:15:00.847046 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve --port 8085', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'profiles_dir': '/Users/user/Desktop/airflow_setup/lab2_dbt', 'warn_error': 'None', 'empty': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:15:00.853085 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m11:15:00.855472 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.09653288, "process_in_blocks": "0", "process_kernel_time": 0.443381, "process_mem_max_rss": "103596032", "process_out_blocks": "0", "process_user_time": 1.847504}
[0m11:15:00.856306 [debug] [MainThread]: Command `dbt docs serve` failed at 11:15:00.856148 after 0.10 seconds
[0m11:15:00.856803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110506630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107685f0>]}
[0m11:15:00.857291 [debug] [MainThread]: Flushing usage events
[0m11:15:01.248914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:00.679181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28363775c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28365c92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28363761e0>]}


============================== 20:27:00.686265 | 80630faa-1246-47df-8942-0ce5461368fc ==============================
[0m20:27:00.686265 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:27:00.687082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:27:01.891491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80630faa-1246-47df-8942-0ce5461368fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280abbdbe0>]}
[0m20:27:01.955227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80630faa-1246-47df-8942-0ce5461368fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2811ef6c30>]}
[0m20:27:01.956151 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:27:01.965162 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:27:01.982852 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:27:01.983658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '80630faa-1246-47df-8942-0ce5461368fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280ac2b080>]}
[0m20:27:03.665772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80630faa-1246-47df-8942-0ce5461368fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280909c050>]}
[0m20:27:03.687586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80630faa-1246-47df-8942-0ce5461368fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280938efc0>]}
[0m20:27:03.688545 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:27:03.689316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80630faa-1246-47df-8942-0ce5461368fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28092ce4b0>]}
[0m20:27:03.692300 [info ] [MainThread]: 
[0m20:27:03.693764 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:27:03.695637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:27:03.717812 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:27:03.718613 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:27:03.719343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:04.405887 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:27:04.408827 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:27:04.607169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m20:27:04.620524 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:27:04.621532 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:27:04.622289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:05.036831 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:27:05.039782 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:27:05.214639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m20:27:05.224116 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:27:05.227369 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:27:05.231027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:05.614842 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:27:05.617809 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:27:05.748890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80630faa-1246-47df-8942-0ce5461368fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280909cf80>]}
[0m20:27:05.750264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:27:05.751147 [info ] [MainThread]: 
[0m20:27:05.765268 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m20:27:05.766704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m20:27:05.767577 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m20:27:05.780116 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m20:27:05.786396 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 20:27:05.768133 => 20:27:05.785779
[0m20:27:05.788068 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m20:27:05.788986 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m20:27:05.790078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m20:27:05.790780 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m20:27:05.797153 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m20:27:05.800051 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 20:27:05.791267 => 20:27:05.799627
[0m20:27:05.801701 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m20:27:05.802700 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m20:27:05.803837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m20:27:05.804627 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m20:27:05.809150 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m20:27:05.812458 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 20:27:05.805197 => 20:27:05.812076
[0m20:27:05.813906 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m20:27:05.814777 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m20:27:05.815802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m20:27:05.816579 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m20:27:05.820986 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m20:27:05.824001 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 20:27:05.817096 => 20:27:05.823587
[0m20:27:05.826154 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m20:27:05.827164 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m20:27:05.828484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m20:27:05.829241 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m20:27:05.833754 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m20:27:05.836988 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 20:27:05.829837 => 20:27:05.836558
[0m20:27:05.838427 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m20:27:05.840253 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m20:27:05.841134 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m20:27:05.842847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m20:27:05.843677 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m20:27:05.856853 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m20:27:05.860890 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 20:27:05.844154 => 20:27:05.860472
[0m20:27:05.861695 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m20:27:05.911330 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m20:27:05.919962 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m20:27:05.921013 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m20:27:05.922199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:07.210409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:27:07.254850 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 20:27:05.862169 => 20:27:07.254213
[0m20:27:07.256302 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m20:27:07.398008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80630faa-1246-47df-8942-0ce5461368fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280937d700>]}
[0m20:27:07.399231 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.56s]
[0m20:27:07.400800 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m20:27:07.404667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:07.405381 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m20:27:07.406181 [info ] [MainThread]: 
[0m20:27:07.407082 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m20:27:07.408575 [debug] [MainThread]: Command end result
[0m20:27:07.427565 [info ] [MainThread]: 
[0m20:27:07.428772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:07.429992 [info ] [MainThread]: 
[0m20:27:07.431234 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:27:07.433279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8185086, "process_user_time": 7.181574, "process_kernel_time": 1.153155, "process_mem_max_rss": "222888", "process_in_blocks": "10928", "process_out_blocks": "4809"}
[0m20:27:07.434571 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:07.434279 after 6.82 seconds
[0m20:27:07.435391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28365c92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280b0e13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280bb4e150>]}
[0m20:27:07.436552 [debug] [MainThread]: Flushing usage events
[0m20:27:16.247607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0014aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a00149c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a00149640>]}


============================== 20:27:16.253956 | ddb52380-f3f3-4879-ba3a-053d2d8b6a8c ==============================
[0m20:27:16.253956 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:27:16.254658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:27:17.413525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddb52380-f3f3-4879-ba3a-053d2d8b6a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0013e270>]}
[0m20:27:17.476669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddb52380-f3f3-4879-ba3a-053d2d8b6a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e43c0bc0>]}
[0m20:27:17.477625 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:27:17.487988 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:27:17.545676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:27:17.546263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:27:17.553049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddb52380-f3f3-4879-ba3a-053d2d8b6a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d8913320>]}
[0m20:27:17.567082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddb52380-f3f3-4879-ba3a-053d2d8b6a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d8898830>]}
[0m20:27:17.567802 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:27:17.568388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb52380-f3f3-4879-ba3a-053d2d8b6a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d9f1af60>]}
[0m20:27:17.570441 [info ] [MainThread]: 
[0m20:27:17.571044 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:27:17.572087 [debug] [MainThread]: Command end result
[0m20:27:17.585543 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3911188, "process_user_time": 8.086654, "process_kernel_time": 0.953262, "process_mem_max_rss": "208928", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m20:27:17.586363 [debug] [MainThread]: Command `dbt test` succeeded at 20:27:17.586208 after 1.39 seconds
[0m20:27:17.586999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a001e5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79da98e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79da98e570>]}
[0m20:27:17.587578 [debug] [MainThread]: Flushing usage events
[0m20:27:22.506181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c23f5ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c24ec3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c23f5e810>]}


============================== 20:27:22.514831 | c2ea15d9-7c72-45a8-9044-1412566e51ef ==============================
[0m20:27:22.514831 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:27:22.515788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:27:23.796869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2ea15d9-7c72-45a8-9044-1412566e51ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfcaee1e0>]}
[0m20:27:23.887798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2ea15d9-7c72-45a8-9044-1412566e51ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfceb9850>]}
[0m20:27:23.889147 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:27:23.904317 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:27:23.992377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:27:23.993603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:27:24.023569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2ea15d9-7c72-45a8-9044-1412566e51ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfc66ce90>]}
[0m20:27:24.048932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2ea15d9-7c72-45a8-9044-1412566e51ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfc50c770>]}
[0m20:27:24.049830 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:27:24.050707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ea15d9-7c72-45a8-9044-1412566e51ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfc761d00>]}
[0m20:27:24.054156 [info ] [MainThread]: 
[0m20:27:24.055514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:27:24.057194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:27:24.079395 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:27:24.080207 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:27:24.080888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:25.731241 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m20:27:25.733913 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:27:25.877687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m20:27:25.891636 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:27:25.892485 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:27:25.893369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:26.363575 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:27:26.366264 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:27:26.499305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m20:27:26.504148 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:27:26.505279 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:27:26.505989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:26.853785 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:27:26.856869 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:27:26.982683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ea15d9-7c72-45a8-9044-1412566e51ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfca233b0>]}
[0m20:27:26.984219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:27:26.985092 [info ] [MainThread]: 
[0m20:27:26.999411 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:27:27.001607 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:27:27.003759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m20:27:27.004722 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m20:27:27.018589 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 20:27:27.005404 => 20:27:27.018132
[0m20:27:27.019515 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m20:27:27.117599 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:27.118503 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m20:27:27.119231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:27.805042 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:27:27.820488 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:27.821936 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:27:27.950385 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:27:27.962614 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:27.963604 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:27:28.063903 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:27:28.119928 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:28.121792 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:27:29.343608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:27:29.348876 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:29.349733 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:27:29.440293 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:27:29.448292 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:29.449144 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:27:29.537342 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:27:29.543824 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:29.545052 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:27:29.645191 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:27:29.652127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:29.653070 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:27:29.734044 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:27:29.746042 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:29.747051 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:27:29.824220 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:27:29.837973 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:29.845019 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:29.845905 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m20:27:29.951166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:27:29.952208 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:29.953293 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:27:30.646217 [debug] [Thread-1 (]: SQL status: SUCCESS 1128 in 1.0 seconds
[0m20:27:30.647234 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:27:30.648064 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m20:27:31.129703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:27:31.165408 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 20:27:27.020087 => 20:27:31.165051
[0m20:27:31.166263 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m20:27:31.303316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ea15d9-7c72-45a8-9044-1412566e51ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfc2f3620>]}
[0m20:27:31.305352 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 1128[0m in 4.30s]
[0m20:27:31.306972 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:27:31.310910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:31.311660 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m20:27:31.312484 [info ] [MainThread]: 
[0m20:27:31.313535 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m20:27:31.314814 [debug] [MainThread]: Command end result
[0m20:27:31.330329 [info ] [MainThread]: 
[0m20:27:31.331208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:31.331859 [info ] [MainThread]: 
[0m20:27:31.332523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:27:31.333831 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.890659, "process_user_time": 6.282164, "process_kernel_time": 0.559468, "process_mem_max_rss": "218212", "process_out_blocks": "1754", "process_in_blocks": "0"}
[0m20:27:31.334953 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:27:31.334676 after 8.89 seconds
[0m20:27:31.335777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c23f67170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c242ac260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfce00560>]}
[0m20:27:31.336689 [debug] [MainThread]: Flushing usage events
[0m13:31:45.957014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107011400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a378c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a37d40>]}


============================== 13:31:45.964862 | 1bcc10bf-9171-4364-a075-21ca083c363a ==============================
[0m13:31:45.964862 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:31:45.965680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/user/Desktop/airflow_setup/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:31:45.972492 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m13:31:45.976321 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.12785521, "process_in_blocks": "0", "process_kernel_time": 0.452245, "process_mem_max_rss": "103993344", "process_out_blocks": "0", "process_user_time": 1.882947}
[0m13:31:45.977228 [debug] [MainThread]: Command `dbt docs serve` failed at 13:31:45.977067 after 0.13 seconds
[0m13:31:45.977724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109310680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59bb30>]}
[0m13:31:45.978227 [debug] [MainThread]: Flushing usage events
[0m13:31:46.371312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:45.360530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c12909c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c12f32cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c12908830>]}


============================== 20:42:45.367934 | 402c1383-1483-46cf-9d3f-486b3d2c6b4c ==============================
[0m20:42:45.367934 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:42:45.369657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:42:46.708750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '402c1383-1483-46cf-9d3f-486b3d2c6b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be77ebda0>]}
[0m20:42:46.782558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '402c1383-1483-46cf-9d3f-486b3d2c6b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0becb66c60>]}
[0m20:42:46.783858 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:42:46.796363 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:42:46.904497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:42:46.905281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:42:46.913943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '402c1383-1483-46cf-9d3f-486b3d2c6b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c12f0a540>]}
[0m20:42:46.933712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '402c1383-1483-46cf-9d3f-486b3d2c6b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be70581a0>]}
[0m20:42:46.934486 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:42:46.935217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '402c1383-1483-46cf-9d3f-486b3d2c6b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be70dbc20>]}
[0m20:42:46.938365 [info ] [MainThread]: 
[0m20:42:46.939767 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:42:46.941767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:42:46.965194 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:42:46.965951 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:42:46.966796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:47.414624 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m20:42:47.418208 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:42:47.544783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m20:42:47.558562 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:42:47.559714 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:42:47.560484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:47.876371 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:42:47.879195 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:42:48.011545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m20:42:48.017338 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:42:48.018364 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:42:48.019386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:48.439320 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:42:48.441886 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:42:48.581483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '402c1383-1483-46cf-9d3f-486b3d2c6b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be714cd10>]}
[0m20:42:48.582909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:42:48.583585 [info ] [MainThread]: 
[0m20:42:48.595580 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m20:42:48.597210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m20:42:48.598029 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m20:42:48.609347 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m20:42:48.612804 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 20:42:48.598570 => 20:42:48.612333
[0m20:42:48.614923 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m20:42:48.615869 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m20:42:48.617003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m20:42:48.617745 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m20:42:48.622270 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m20:42:48.625526 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 20:42:48.618221 => 20:42:48.624993
[0m20:42:48.627179 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m20:42:48.628086 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m20:42:48.629917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m20:42:48.631018 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m20:42:48.636259 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m20:42:48.640061 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 20:42:48.631640 => 20:42:48.639430
[0m20:42:48.641665 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m20:42:48.642583 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m20:42:48.643822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m20:42:48.644647 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m20:42:48.649855 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m20:42:48.652485 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 20:42:48.645288 => 20:42:48.652128
[0m20:42:48.654061 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m20:42:48.654946 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m20:42:48.656124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m20:42:48.657206 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m20:42:48.661537 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m20:42:48.664391 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 20:42:48.657684 => 20:42:48.664000
[0m20:42:48.665885 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m20:42:48.667414 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m20:42:48.668320 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m20:42:48.669625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m20:42:48.670305 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m20:42:48.684200 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m20:42:48.687438 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 20:42:48.670787 => 20:42:48.686978
[0m20:42:48.688371 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m20:42:48.743519 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m20:42:48.750893 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m20:42:48.752275 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m20:42:48.753766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:49.908958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:42:49.955372 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 20:42:48.689433 => 20:42:49.955014
[0m20:42:49.956261 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m20:42:50.086534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '402c1383-1483-46cf-9d3f-486b3d2c6b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be655bc80>]}
[0m20:42:50.087791 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.42s]
[0m20:42:50.089101 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m20:42:50.092461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:50.093319 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m20:42:50.094124 [info ] [MainThread]: 
[0m20:42:50.094873 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m20:42:50.096129 [debug] [MainThread]: Command end result
[0m20:42:50.114561 [info ] [MainThread]: 
[0m20:42:50.115564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:42:50.116439 [info ] [MainThread]: 
[0m20:42:50.117568 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:42:50.119886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.812897, "process_user_time": 5.815862, "process_kernel_time": 0.918067, "process_mem_max_rss": "216884", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m20:42:50.120822 [debug] [MainThread]: Command `dbt run` succeeded at 20:42:50.120566 after 4.81 seconds
[0m20:42:50.121490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c17072a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c12915fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bec71d1f0>]}
[0m20:42:50.122467 [debug] [MainThread]: Flushing usage events
[0m20:42:55.108112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08dbf5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08e2802f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08dbf45f0>]}


============================== 20:42:55.113964 | 72a964a1-c51c-437e-b762-902e0d506927 ==============================
[0m20:42:55.113964 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:42:55.114745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:42:56.100035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72a964a1-c51c-437e-b762-902e0d506927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa063b9a570>]}
[0m20:42:56.166774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72a964a1-c51c-437e-b762-902e0d506927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06831e480>]}
[0m20:42:56.167711 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:42:56.179276 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:42:56.238957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:42:56.239668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:42:56.247570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72a964a1-c51c-437e-b762-902e0d506927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa062490080>]}
[0m20:42:56.264731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72a964a1-c51c-437e-b762-902e0d506927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06233f980>]}
[0m20:42:56.265720 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:42:56.267167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72a964a1-c51c-437e-b762-902e0d506927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08e016630>]}
[0m20:42:56.269851 [info ] [MainThread]: 
[0m20:42:56.270758 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:42:56.271809 [debug] [MainThread]: Command end result
[0m20:42:56.285834 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2254046, "process_user_time": 4.683198, "process_kernel_time": 0.784026, "process_mem_max_rss": "208632", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m20:42:56.286719 [debug] [MainThread]: Command `dbt test` succeeded at 20:42:56.286489 after 1.23 seconds
[0m20:42:56.287355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0923b6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08e2802f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08e4911c0>]}
[0m20:42:56.288046 [debug] [MainThread]: Flushing usage events
[0m20:43:01.370190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af79f5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af79f5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af79f5f70>]}


============================== 20:43:01.376656 | dc958c89-6e5f-4580-a8a7-abe079b4f832 ==============================
[0m20:43:01.376656 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:43:01.377756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:02.376962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc958c89-6e5f-4580-a8a7-abe079b4f832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ad18b2570>]}
[0m20:43:02.439033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc958c89-6e5f-4580-a8a7-abe079b4f832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ad2105c10>]}
[0m20:43:02.439976 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:43:02.448680 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:43:02.494433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:43:02.495056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:43:02.501777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc958c89-6e5f-4580-a8a7-abe079b4f832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ad05a5b20>]}
[0m20:43:02.515886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc958c89-6e5f-4580-a8a7-abe079b4f832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ad014c740>]}
[0m20:43:02.516496 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:43:02.517066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc958c89-6e5f-4580-a8a7-abe079b4f832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ad0233a40>]}
[0m20:43:02.519055 [info ] [MainThread]: 
[0m20:43:02.520504 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:43:02.522414 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:43:02.538987 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:43:02.539630 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:43:02.540138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:03.094027 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:43:03.097030 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:43:03.335662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m20:43:03.348366 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:43:03.349158 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:43:03.349797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:03.723985 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:43:03.727064 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:43:03.839327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m20:43:03.843699 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:43:03.844445 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:43:03.845207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:04.196071 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:43:04.199065 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:43:04.404216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc958c89-6e5f-4580-a8a7-abe079b4f832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ad2192810>]}
[0m20:43:04.406011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:43:04.406862 [info ] [MainThread]: 
[0m20:43:04.418373 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:43:04.419421 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:43:04.420747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m20:43:04.421445 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m20:43:04.435997 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 20:43:04.422064 => 20:43:04.435528
[0m20:43:04.436882 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m20:43:04.518880 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:04.519564 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m20:43:04.520201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:05.018140 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m20:43:05.032884 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:05.036258 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:43:05.133945 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:43:05.144936 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:05.145817 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:43:05.227382 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:43:05.283757 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:05.285485 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:43:06.248181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:43:06.254148 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:06.255160 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:43:06.349024 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:43:06.355348 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:06.356281 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:43:06.440516 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:43:06.446836 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:06.447808 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:43:06.529222 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:43:06.536397 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:06.537163 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:43:06.615264 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:43:06.628107 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:06.628885 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:43:06.723174 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:43:06.737524 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:06.741745 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:06.742453 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m20:43:06.848755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:43:06.849720 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:06.850560 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:43:07.539094 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:43:07.539932 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:43:07.540719 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m20:43:07.831797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:43:07.867967 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 20:43:04.437435 => 20:43:07.867527
[0m20:43:07.868950 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m20:43:07.984340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc958c89-6e5f-4580-a8a7-abe079b4f832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ad00df980>]}
[0m20:43:07.986976 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 0[0m in 3.56s]
[0m20:43:07.988875 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:43:07.993148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:07.994097 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m20:43:07.994841 [info ] [MainThread]: 
[0m20:43:07.995868 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.47 seconds (5.47s).
[0m20:43:07.997251 [debug] [MainThread]: Command end result
[0m20:43:08.013345 [info ] [MainThread]: 
[0m20:43:08.014357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:43:08.015123 [info ] [MainThread]: 
[0m20:43:08.016046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:43:08.017704 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.6947603, "process_user_time": 5.539109, "process_kernel_time": 0.82712, "process_mem_max_rss": "217624", "process_out_blocks": "1754", "process_in_blocks": "0"}
[0m20:43:08.019046 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:43:08.018808 after 6.70 seconds
[0m20:43:08.020018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af79f6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af8ba86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7acb414560>]}
[0m20:43:08.020984 [debug] [MainThread]: Flushing usage events
[0m20:44:22.089718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e1b1608c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e1b160860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e1b160a40>]}


============================== 20:44:22.096246 | 8a3f25a7-8a48-4ac3-8b74-dee4f0b57413 ==============================
[0m20:44:22.096246 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:44:22.097055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:23.374605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a3f25a7-8a48-4ac3-8b74-dee4f0b57413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df5b4a210>]}
[0m20:44:23.458766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a3f25a7-8a48-4ac3-8b74-dee4f0b57413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df5b4a210>]}
[0m20:44:23.459976 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:44:23.472545 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:44:23.538245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:44:23.538929 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:44:23.547082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a3f25a7-8a48-4ac3-8b74-dee4f0b57413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def98f260>]}
[0m20:44:23.567343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a3f25a7-8a48-4ac3-8b74-dee4f0b57413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def8bc260>]}
[0m20:44:23.568314 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:44:23.569392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a3f25a7-8a48-4ac3-8b74-dee4f0b57413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7defb182c0>]}
[0m20:44:23.572419 [info ] [MainThread]: 
[0m20:44:23.573643 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:44:23.575536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:44:23.598003 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:44:23.598744 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:44:23.599428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:24.213012 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:44:24.215546 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:44:24.343655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m20:44:24.357366 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:44:24.358178 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:44:24.358986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:24.716156 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:44:24.719251 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:44:24.852442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m20:44:24.856491 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:44:24.857080 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:44:24.857686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:25.190490 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:44:25.193376 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:44:25.298100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a3f25a7-8a48-4ac3-8b74-dee4f0b57413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e07dddcd0>]}
[0m20:44:25.299534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:44:25.300327 [info ] [MainThread]: 
[0m20:44:25.312388 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m20:44:25.313650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m20:44:25.314551 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m20:44:25.327023 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m20:44:25.330493 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 20:44:25.315179 => 20:44:25.330065
[0m20:44:25.331993 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m20:44:25.332811 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m20:44:25.334037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m20:44:25.335278 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m20:44:25.340290 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m20:44:25.343136 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 20:44:25.335898 => 20:44:25.342611
[0m20:44:25.344703 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m20:44:25.345781 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m20:44:25.347237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m20:44:25.348094 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m20:44:25.352633 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m20:44:25.355428 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 20:44:25.348636 => 20:44:25.354989
[0m20:44:25.356965 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m20:44:25.357773 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m20:44:25.359007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m20:44:25.359739 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m20:44:25.364727 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m20:44:25.367464 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 20:44:25.360373 => 20:44:25.367072
[0m20:44:25.369066 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m20:44:25.370076 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m20:44:25.371442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m20:44:25.372190 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m20:44:25.378256 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m20:44:25.381367 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 20:44:25.372707 => 20:44:25.380934
[0m20:44:25.382912 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m20:44:25.385269 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m20:44:25.386309 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m20:44:25.387540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m20:44:25.388343 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m20:44:25.402871 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m20:44:25.406195 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 20:44:25.388917 => 20:44:25.405739
[0m20:44:25.407057 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m20:44:25.455268 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m20:44:25.461153 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m20:44:25.462275 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m20:44:25.463315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:26.650177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:44:26.689246 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 20:44:25.407840 => 20:44:26.688798
[0m20:44:26.690093 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m20:44:26.827651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a3f25a7-8a48-4ac3-8b74-dee4f0b57413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7deed97920>]}
[0m20:44:26.829144 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.44s]
[0m20:44:26.830861 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m20:44:26.834496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:26.835780 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m20:44:26.836586 [info ] [MainThread]: 
[0m20:44:26.837430 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m20:44:26.838913 [debug] [MainThread]: Command end result
[0m20:44:26.858327 [info ] [MainThread]: 
[0m20:44:26.859280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:44:26.860040 [info ] [MainThread]: 
[0m20:44:26.861278 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:44:26.864399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.827862, "process_user_time": 5.662749, "process_kernel_time": 0.864325, "process_mem_max_rss": "217292", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m20:44:26.865458 [debug] [MainThread]: Command `dbt run` succeeded at 20:44:26.865255 after 4.83 seconds
[0m20:44:26.866323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e1fa3ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e1c6729c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df5253830>]}
[0m20:44:26.867163 [debug] [MainThread]: Flushing usage events
[0m20:44:31.445141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54d0d71cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54d1275f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54d0d72180>]}


============================== 20:44:31.452059 | 8e9b17fe-c79f-469c-9f1f-1f1aaa120bb0 ==============================
[0m20:44:31.452059 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:44:31.453035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:44:32.588353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e9b17fe-c79f-469c-9f1f-1f1aaa120bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a9922f00>]}
[0m20:44:32.673452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e9b17fe-c79f-469c-9f1f-1f1aaa120bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54cd53eba0>]}
[0m20:44:32.674536 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:44:32.686646 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:44:32.750171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:44:32.750937 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:44:32.759150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e9b17fe-c79f-469c-9f1f-1f1aaa120bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a9922e10>]}
[0m20:44:32.776627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e9b17fe-c79f-469c-9f1f-1f1aaa120bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a951c920>]}
[0m20:44:32.777481 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:44:32.778287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e9b17fe-c79f-469c-9f1f-1f1aaa120bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54ac75c440>]}
[0m20:44:32.780997 [info ] [MainThread]: 
[0m20:44:32.781776 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:44:32.782833 [debug] [MainThread]: Command end result
[0m20:44:32.797232 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4063576, "process_user_time": 4.738096, "process_kernel_time": 0.748673, "process_mem_max_rss": "208888", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m20:44:32.798130 [debug] [MainThread]: Command `dbt test` succeeded at 20:44:32.797963 after 1.41 seconds
[0m20:44:32.798743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54d1275f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54a9afbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54d54baff0>]}
[0m20:44:32.799444 [debug] [MainThread]: Flushing usage events
[0m20:44:38.325328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc1d20c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc1d87a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc1d223c0>]}


============================== 20:44:38.331581 | 9a24e438-eae7-4201-ad6c-25638c998ea6 ==============================
[0m20:44:38.331581 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:44:38.332593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:39.384702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a24e438-eae7-4201-ad6c-25638c998ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff96bb0aa0>]}
[0m20:44:39.448591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a24e438-eae7-4201-ad6c-25638c998ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff96563c50>]}
[0m20:44:39.449517 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:44:39.459262 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:44:39.508682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:44:39.509228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:44:39.516384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a24e438-eae7-4201-ad6c-25638c998ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff964fd0d0>]}
[0m20:44:39.532682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a24e438-eae7-4201-ad6c-25638c998ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff962d41d0>]}
[0m20:44:39.533338 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:44:39.534244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a24e438-eae7-4201-ad6c-25638c998ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff964c3620>]}
[0m20:44:39.537056 [info ] [MainThread]: 
[0m20:44:39.538417 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:44:39.539870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:44:39.558951 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:44:39.559767 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:44:39.560447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:40.074822 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:44:40.078038 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:44:40.265486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m20:44:40.280204 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:44:40.281073 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:44:40.281786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:40.725227 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:44:40.728375 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:44:40.861511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m20:44:40.865949 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:44:40.866675 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:44:40.867475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:41.229490 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:44:41.232082 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:44:41.398245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a24e438-eae7-4201-ad6c-25638c998ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9c550c50>]}
[0m20:44:41.399451 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:44:41.400445 [info ] [MainThread]: 
[0m20:44:41.416246 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:44:41.417281 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:44:41.419020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m20:44:41.419792 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m20:44:41.432287 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 20:44:41.420427 => 20:44:41.431868
[0m20:44:41.433124 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m20:44:41.513498 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:41.514237 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m20:44:41.515002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:41.957773 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m20:44:41.974230 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:41.976207 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:44:42.099801 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:44:42.111629 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:42.112703 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:44:42.224490 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:44:42.280162 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:42.282028 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:44:43.281709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:44:43.286820 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:43.288119 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:44:43.435764 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:44:43.443683 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:43.444720 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:44:43.513522 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:44:43.519855 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:43.520803 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:44:43.638823 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:44:43.645690 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:43.646623 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:44:43.722764 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:44:43.733940 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:43.735026 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:44:43.834080 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:44:43.848990 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:43.854366 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:43.855282 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m20:44:43.982803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:44:43.983777 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:43.985251 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:44:44.546633 [debug] [Thread-1 (]: SQL status: SUCCESS 552 in 1.0 seconds
[0m20:44:44.547824 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:44:44.548870 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m20:44:44.799020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:44:44.833410 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 20:44:41.433668 => 20:44:44.833068
[0m20:44:44.834221 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m20:44:44.973329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a24e438-eae7-4201-ad6c-25638c998ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9580acc0>]}
[0m20:44:44.974924 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 552[0m in 3.55s]
[0m20:44:44.976550 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:44:44.980196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:44.980967 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m20:44:44.981681 [info ] [MainThread]: 
[0m20:44:44.982729 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m20:44:44.984272 [debug] [MainThread]: Command end result
[0m20:44:44.999631 [info ] [MainThread]: 
[0m20:44:45.000721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:44:45.001435 [info ] [MainThread]: 
[0m20:44:45.003036 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:44:45.004437 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.7334514, "process_user_time": 5.326046, "process_kernel_time": 0.854746, "process_mem_max_rss": "217712", "process_out_blocks": "1754", "process_in_blocks": "0"}
[0m20:44:45.005308 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:44:45.005116 after 6.73 seconds
[0m20:44:45.006112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc1d87a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc62d1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9590a900>]}
[0m20:44:45.007048 [debug] [MainThread]: Flushing usage events
[0m22:48:17.331227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa718f78dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa719484c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa718f78a70>]}


============================== 22:48:17.350698 | 1a711774-b258-4250-a8ce-b416639a42aa ==============================
[0m22:48:17.350698 [info ] [MainThread]: Running with dbt=1.7.19
[0m22:48:17.353540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:48:19.317610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a711774-b258-4250-a8ce-b416639a42aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f178a090>]}
[0m22:48:19.416746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a711774-b258-4250-a8ce-b416639a42aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f1f91100>]}
[0m22:48:19.417883 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:48:19.435826 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m22:48:19.558582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:48:19.559344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:48:19.568954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a711774-b258-4250-a8ce-b416639a42aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f17fe3c0>]}
[0m22:48:19.596618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a711774-b258-4250-a8ce-b416639a42aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f16cc980>]}
[0m22:48:19.597776 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:48:19.598950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a711774-b258-4250-a8ce-b416639a42aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f1ad9e50>]}
[0m22:48:19.605849 [info ] [MainThread]: 
[0m22:48:19.608364 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:48:19.611127 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m22:48:19.663055 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m22:48:19.664882 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m22:48:19.665790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:20.464680 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:48:20.467128 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m22:48:20.597540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m22:48:20.611864 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m22:48:20.612724 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m22:48:20.613447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:21.050243 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:48:21.052847 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m22:48:21.213626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m22:48:21.217785 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m22:48:21.218526 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m22:48:21.219263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:21.628756 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:48:21.631263 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m22:48:21.782526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a711774-b258-4250-a8ce-b416639a42aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f17c7e00>]}
[0m22:48:21.783962 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:48:21.785160 [info ] [MainThread]: 
[0m22:48:21.802008 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m22:48:21.804646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m22:48:21.805555 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m22:48:21.820918 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m22:48:21.826148 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 22:48:21.806192 => 22:48:21.825705
[0m22:48:21.827934 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m22:48:21.828954 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m22:48:21.830204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m22:48:21.831280 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m22:48:21.836819 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m22:48:21.912556 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 22:48:21.831834 => 22:48:21.886254
[0m22:48:21.916400 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m22:48:21.917489 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m22:48:21.918846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m22:48:21.919637 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m22:48:21.926396 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m22:48:21.929879 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 22:48:21.920646 => 22:48:21.929457
[0m22:48:21.931308 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m22:48:21.932206 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m22:48:21.933462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m22:48:21.934419 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m22:48:21.940814 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m22:48:21.943788 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 22:48:21.934997 => 22:48:21.943381
[0m22:48:21.945445 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m22:48:21.946623 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m22:48:21.947806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m22:48:21.948557 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m22:48:21.953115 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m22:48:21.956894 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 22:48:21.949080 => 22:48:21.956265
[0m22:48:21.958564 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m22:48:21.960634 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m22:48:21.961920 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m22:48:21.963889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m22:48:21.964987 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m22:48:21.979432 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m22:48:21.982766 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 22:48:21.965680 => 22:48:21.982368
[0m22:48:21.983531 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m22:48:22.034770 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m22:48:22.042572 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m22:48:22.043727 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m22:48:22.045040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:23.424391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:48:23.473044 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 22:48:21.984040 => 22:48:23.472700
[0m22:48:23.473963 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m22:48:23.632356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a711774-b258-4250-a8ce-b416639a42aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f0bc3530>]}
[0m22:48:23.633541 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.67s]
[0m22:48:23.634763 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m22:48:23.640716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:23.641451 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m22:48:23.642164 [info ] [MainThread]: 
[0m22:48:23.642941 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m22:48:23.644566 [debug] [MainThread]: Command end result
[0m22:48:23.665864 [info ] [MainThread]: 
[0m22:48:23.666767 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:48:23.667477 [info ] [MainThread]: 
[0m22:48:23.668632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:48:23.674116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4389033, "process_user_time": 6.923678, "process_kernel_time": 2.834944, "process_mem_max_rss": "216964", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m22:48:23.675424 [debug] [MainThread]: Command `dbt run` succeeded at 22:48:23.675113 after 6.44 seconds
[0m22:48:23.676512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71cc17e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f196c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa718f7a0f0>]}
[0m22:48:23.677303 [debug] [MainThread]: Flushing usage events
[0m22:48:30.631402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74fb73cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74fbbffa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74fbc40c20>]}


============================== 22:48:30.639176 | 11c3895c-ca0c-47f6-9cf1-9468d1078bf0 ==============================
[0m22:48:30.639176 [info ] [MainThread]: Running with dbt=1.7.19
[0m22:48:30.640111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:48:32.374270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11c3895c-ca0c-47f6-9cf1-9468d1078bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d413a2a0>]}
[0m22:48:32.553043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11c3895c-ca0c-47f6-9cf1-9468d1078bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d45e8200>]}
[0m22:48:32.555437 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:48:32.570503 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m22:48:32.662543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:48:32.663582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:48:32.676774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11c3895c-ca0c-47f6-9cf1-9468d1078bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d430c9e0>]}
[0m22:48:32.700642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11c3895c-ca0c-47f6-9cf1-9468d1078bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74cfec0890>]}
[0m22:48:32.701711 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:48:32.702726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11c3895c-ca0c-47f6-9cf1-9468d1078bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d45e8d40>]}
[0m22:48:32.706793 [info ] [MainThread]: 
[0m22:48:32.707686 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:48:32.708817 [debug] [MainThread]: Command end result
[0m22:48:32.730908 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.153814, "process_user_time": 6.400567, "process_kernel_time": 0.8925, "process_mem_max_rss": "208944", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m22:48:32.732639 [debug] [MainThread]: Command `dbt test` succeeded at 22:48:32.732376 after 2.16 seconds
[0m22:48:32.733598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ffefaa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d48917c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d4420a70>]}
[0m22:48:32.734460 [debug] [MainThread]: Flushing usage events
[0m22:48:37.941925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e4669acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e468f5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e46938320>]}


============================== 22:48:37.948180 | a0932b77-c562-4f60-873f-27c72290e966 ==============================
[0m22:48:37.948180 [info ] [MainThread]: Running with dbt=1.7.19
[0m22:48:37.949025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:48:39.016983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0932b77-c562-4f60-873f-27c72290e966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e20d1aae0>]}
[0m22:48:39.080968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0932b77-c562-4f60-873f-27c72290e966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1afe2d20>]}
[0m22:48:39.081903 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:48:39.091195 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m22:48:39.140952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:48:39.141646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:48:39.148405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0932b77-c562-4f60-873f-27c72290e966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1aaa2bd0>]}
[0m22:48:39.163586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0932b77-c562-4f60-873f-27c72290e966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1aba4260>]}
[0m22:48:39.164420 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:48:39.165066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0932b77-c562-4f60-873f-27c72290e966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1b490230>]}
[0m22:48:39.167483 [info ] [MainThread]: 
[0m22:48:39.168749 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:48:39.170580 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m22:48:39.190654 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m22:48:39.191353 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m22:48:39.191915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:39.893740 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:48:39.896474 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m22:48:40.065651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m22:48:40.079661 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m22:48:40.080506 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m22:48:40.081171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:40.636731 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:48:40.639771 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m22:48:40.801455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m22:48:40.805642 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m22:48:40.806474 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m22:48:40.807384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:41.136478 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:48:41.139782 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m22:48:41.290104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0932b77-c562-4f60-873f-27c72290e966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1ae03d40>]}
[0m22:48:41.291559 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:48:41.292298 [info ] [MainThread]: 
[0m22:48:41.303929 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m22:48:41.305450 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m22:48:41.306690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m22:48:41.307538 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m22:48:41.321687 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 22:48:41.308110 => 22:48:41.321265
[0m22:48:41.322611 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m22:48:41.407942 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:41.408709 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m22:48:41.409300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:41.887825 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m22:48:41.903439 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:41.905073 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m22:48:42.000832 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:48:42.012289 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:42.013198 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m22:48:42.106421 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:48:42.157824 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:42.159660 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m22:48:43.235346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:48:43.240514 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:43.241495 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m22:48:43.340684 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m22:48:43.348327 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:43.349217 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m22:48:43.450217 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:48:43.456801 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:43.457746 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m22:48:43.563074 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m22:48:43.569551 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:43.570357 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m22:48:43.686279 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:48:43.697826 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:43.698979 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m22:48:43.817738 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m22:48:43.831225 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:43.838929 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:43.839800 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m22:48:43.965204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:48:43.966369 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:43.967477 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m22:48:44.646395 [debug] [Thread-1 (]: SQL status: SUCCESS 882 in 1.0 seconds
[0m22:48:44.647408 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:48:44.648185 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m22:48:44.953521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:48:44.991548 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 22:48:41.323189 => 22:48:44.991182
[0m22:48:44.994921 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m22:48:45.211586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0932b77-c562-4f60-873f-27c72290e966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1a090320>]}
[0m22:48:45.213214 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 882[0m in 3.91s]
[0m22:48:45.214732 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m22:48:45.218369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:45.219073 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m22:48:45.219656 [info ] [MainThread]: 
[0m22:48:45.220368 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.05 seconds (6.05s).
[0m22:48:45.221748 [debug] [MainThread]: Command end result
[0m22:48:45.238697 [info ] [MainThread]: 
[0m22:48:45.239664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:48:45.240548 [info ] [MainThread]: 
[0m22:48:45.242271 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:48:45.244873 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.3537664, "process_user_time": 5.686204, "process_kernel_time": 0.73016, "process_mem_max_rss": "218116", "process_out_blocks": "1754", "process_in_blocks": "0"}
[0m22:48:45.246300 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:48:45.246083 after 7.36 seconds
[0m22:48:45.247187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e46938320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1b0f01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1a090380>]}
[0m22:48:45.248079 [debug] [MainThread]: Flushing usage events
[0m13:05:06.708340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a511670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1bfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1bc590>]}


============================== 13:05:06.716664 | 7ae818a6-e199-429c-87cc-b82df7bde268 ==============================
[0m13:05:06.716664 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:05:06.717581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/Desktop/airflow_setup/lab2_dbt', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:05:06.726942 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_TYPE'
[0m13:05:06.733679 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.11112053, "process_in_blocks": "0", "process_kernel_time": 0.430221, "process_mem_max_rss": "103272448", "process_out_blocks": "0", "process_user_time": 1.847001}
[0m13:05:06.734594 [debug] [MainThread]: Command `dbt docs serve` failed at 13:05:06.734429 after 0.11 seconds
[0m13:05:06.735126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcf7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcf7ce0>]}
[0m13:05:06.735639 [debug] [MainThread]: Flushing usage events
[0m13:05:07.126985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:06:00.981340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a50cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111577ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111577c50>]}


============================== 13:06:00.988446 | 8363c754-8d36-4af2-99bc-ef1e800a67b2 ==============================
[0m13:06:00.988446 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:06:00.989232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/Desktop/airflow_setup/lab2_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:06:12.675613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8363c754-8d36-4af2-99bc-ef1e800a67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115117860>]}
[0m13:06:12.735956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8363c754-8d36-4af2-99bc-ef1e800a67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e550ad0>]}
[0m20:09:57.148314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d9ce4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d9bffc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d9ce5df0>]}


============================== 20:09:57.156517 | 58db273b-984c-44b6-83e0-26316e733751 ==============================
[0m20:09:57.156517 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:09:57.157275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:09:57.927078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96588e0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9658d00bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96588e1c10>]}


============================== 20:09:57.935240 | e35e5198-fae7-45c1-9486-a89d2357d10c ==============================
[0m20:09:57.935240 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:09:57.936271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:09:58.631241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58db273b-984c-44b6-83e0-26316e733751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d9cddc40>]}
[0m20:09:58.722431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58db273b-984c-44b6-83e0-26316e733751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b2e4b650>]}
[0m20:09:58.724102 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:09:58.738047 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:09:58.841573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:58.842928 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models/source.yml
[0m20:09:59.334854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e35e5198-fae7-45c1-9486-a89d2357d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96599f6060>]}
[0m20:09:59.436426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e35e5198-fae7-45c1-9486-a89d2357d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963147a2a0>]}
[0m20:09:59.437612 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:09:59.451595 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:09:59.526842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58db273b-984c-44b6-83e0-26316e733751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b221ff20>]}
[0m20:09:59.535916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:59.538664 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models/source.yml
[0m20:09:59.560389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58db273b-984c-44b6-83e0-26316e733751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b2467740>]}
[0m20:09:59.562819 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:09:59.565189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58db273b-984c-44b6-83e0-26316e733751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b2278680>]}
[0m20:09:59.574810 [info ] [MainThread]: 
[0m20:09:59.578854 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:09:59.584294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:09:59.628337 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:09:59.629677 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:09:59.630729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:00.502272 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:10:00.504870 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:10:00.580205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e35e5198-fae7-45c1-9486-a89d2357d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9630e68110>]}
[0m20:10:00.602215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e35e5198-fae7-45c1-9486-a89d2357d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963103fc20>]}
[0m20:10:00.603158 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:10:00.603876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35e5198-fae7-45c1-9486-a89d2357d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96301bf0b0>]}
[0m20:10:00.606630 [info ] [MainThread]: 
[0m20:10:00.608622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:00.611140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:10:00.640074 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:10:00.642566 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:10:00.644158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:00.646273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m20:10:00.666327 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:10:00.667110 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:10:00.667743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:01.102089 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:01.104565 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:10:01.227323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m20:10:01.231657 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:10:01.232434 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:10:01.233119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:01.281749 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:10:01.284436 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:10:01.431029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m20:10:01.447756 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:10:01.448644 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:10:01.449361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:01.845496 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:01.848349 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:10:01.877923 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:01.880612 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:10:01.980672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m20:10:01.985578 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:10:01.986418 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:10:01.987053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:02.005800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58db273b-984c-44b6-83e0-26316e733751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b090b350>]}
[0m20:10:02.007569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:02.009270 [info ] [MainThread]: 
[0m20:10:02.025695 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m20:10:02.027928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m20:10:02.030175 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m20:10:02.044193 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m20:10:02.048329 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 20:10:02.031084 => 20:10:02.047819
[0m20:10:02.049877 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m20:10:02.050776 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m20:10:02.052109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m20:10:02.053072 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m20:10:02.058419 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m20:10:02.061456 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 20:10:02.053576 => 20:10:02.060948
[0m20:10:02.063225 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m20:10:02.064133 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m20:10:02.065269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m20:10:02.066042 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m20:10:02.070276 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m20:10:02.073214 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 20:10:02.066538 => 20:10:02.072700
[0m20:10:02.077816 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m20:10:02.079232 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m20:10:02.080571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m20:10:02.081566 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m20:10:02.086314 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m20:10:02.089280 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 20:10:02.082239 => 20:10:02.088828
[0m20:10:02.091909 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m20:10:02.092965 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m20:10:02.094240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m20:10:02.095179 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m20:10:02.100430 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m20:10:02.103097 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 20:10:02.095804 => 20:10:02.102724
[0m20:10:02.104686 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m20:10:02.106418 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m20:10:02.107620 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m20:10:02.109478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m20:10:02.110262 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m20:10:02.124430 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m20:10:02.128456 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 20:10:02.110761 => 20:10:02.127856
[0m20:10:02.129373 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m20:10:02.183214 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m20:10:02.190406 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m20:10:02.191944 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m20:10:02.193395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:02.383140 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:02.385437 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:10:02.519931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35e5198-fae7-45c1-9486-a89d2357d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9630fddc40>]}
[0m20:10:02.521727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:02.522753 [info ] [MainThread]: 
[0m20:10:02.543899 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m20:10:02.545793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m20:10:02.547237 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m20:10:02.566023 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m20:10:02.569302 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 20:10:02.549104 => 20:10:02.568684
[0m20:10:02.571431 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m20:10:02.572508 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m20:10:02.573836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m20:10:02.575562 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m20:10:02.583841 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m20:10:02.587703 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 20:10:02.576864 => 20:10:02.586837
[0m20:10:02.590665 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m20:10:02.592889 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m20:10:02.594718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m20:10:02.596231 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m20:10:02.603561 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m20:10:02.606437 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 20:10:02.597056 => 20:10:02.605821
[0m20:10:02.609285 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m20:10:02.610506 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m20:10:02.612335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m20:10:02.613640 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m20:10:02.618840 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m20:10:02.621621 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 20:10:02.614416 => 20:10:02.621236
[0m20:10:02.623499 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m20:10:02.626536 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m20:10:02.628168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m20:10:02.629223 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m20:10:02.662517 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m20:10:02.666756 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 20:10:02.630177 => 20:10:02.666320
[0m20:10:02.670721 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m20:10:02.673139 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m20:10:02.676169 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m20:10:02.680041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m20:10:02.684649 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m20:10:02.712325 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m20:10:02.716007 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 20:10:02.685874 => 20:10:02.715534
[0m20:10:02.717165 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m20:10:02.782009 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m20:10:02.791838 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m20:10:02.794207 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m20:10:02.795594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:03.832011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:10:03.868062 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 20:10:02.129912 => 20:10:03.867744
[0m20:10:03.868894 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m20:10:04.026560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58db273b-984c-44b6-83e0-26316e733751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b050d820>]}
[0m20:10:04.027938 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.92s]
[0m20:10:04.029426 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m20:10:04.032607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:04.033221 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m20:10:04.033930 [info ] [MainThread]: 
[0m20:10:04.034876 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m20:10:04.036492 [debug] [MainThread]: Command end result
[0m20:10:04.053254 [info ] [MainThread]: 
[0m20:10:04.054312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:04.055113 [info ] [MainThread]: 
[0m20:10:04.056058 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:10:04.058443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.96028, "process_user_time": 6.947065, "process_kernel_time": 0.853822, "process_mem_max_rss": "223436", "process_in_blocks": "37456", "process_out_blocks": "2617"}
[0m20:10:04.059508 [debug] [MainThread]: Command `dbt run` succeeded at 20:10:04.059309 after 6.96 seconds
[0m20:10:04.060259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d9cedb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d9d95dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b3b69b20>]}
[0m20:10:04.061304 [debug] [MainThread]: Flushing usage events
[0m20:10:04.496016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:10:04.535863 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 20:10:02.717861 => 20:10:04.535551
[0m20:10:04.536690 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m20:10:04.716945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e35e5198-fae7-45c1-9486-a89d2357d10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961a8718b0>]}
[0m20:10:04.718708 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.04s]
[0m20:10:04.720244 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m20:10:04.724296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:04.725669 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m20:10:04.726472 [info ] [MainThread]: 
[0m20:10:04.727590 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m20:10:04.730161 [debug] [MainThread]: Command end result
[0m20:10:04.754397 [info ] [MainThread]: 
[0m20:10:04.755936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:04.757241 [info ] [MainThread]: 
[0m20:10:04.758835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:10:04.761477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.884196, "process_user_time": 6.74474, "process_kernel_time": 1.042279, "process_mem_max_rss": "223412", "process_out_blocks": "2617", "process_in_blocks": "0"}
[0m20:10:04.762797 [debug] [MainThread]: Command `dbt run` succeeded at 20:10:04.762534 after 6.89 seconds
[0m20:10:04.764020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d0a2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9631a7d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96588e0f50>]}
[0m20:10:04.764990 [debug] [MainThread]: Flushing usage events
[0m20:10:10.532424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f6fd5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f6fd5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f6fd6690>]}


============================== 20:10:10.538886 | 8c04ba53-daa8-4715-a790-06e424cf9531 ==============================
[0m20:10:10.538886 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:10:10.539677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:10:10.536969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482dfddc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482e2d7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482dda09b0>]}


============================== 20:10:10.543641 | 3fae1677-b424-4d4e-8e86-49660c538e6f ==============================
[0m20:10:10.543641 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:10:10.544441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:10:11.826330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fae1677-b424-4d4e-8e86-49660c538e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4808835460>]}
[0m20:10:11.826330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c04ba53-daa8-4715-a790-06e424cf9531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb9c7b30>]}
[0m20:10:11.980805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c04ba53-daa8-4715-a790-06e424cf9531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb922ba0>]}
[0m20:10:11.982386 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:10:11.986142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fae1677-b424-4d4e-8e86-49660c538e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4808835460>]}
[0m20:10:11.987702 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:10:12.001064 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:10:12.006712 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:10:12.096862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:12.097673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:12.103324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:12.104056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:12.107529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c04ba53-daa8-4715-a790-06e424cf9531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb83c920>]}
[0m20:10:12.115183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fae1677-b424-4d4e-8e86-49660c538e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480253fe60>]}
[0m20:10:12.132718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c04ba53-daa8-4715-a790-06e424cf9531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb728980>]}
[0m20:10:12.133718 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:10:12.134564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c04ba53-daa8-4715-a790-06e424cf9531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d0fa5fd0>]}
[0m20:10:12.136914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fae1677-b424-4d4e-8e86-49660c538e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48026d5040>]}
[0m20:10:12.137040 [info ] [MainThread]: 
[0m20:10:12.137838 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:10:12.137894 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:10:12.138947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fae1677-b424-4d4e-8e86-49660c538e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482dda1670>]}
[0m20:10:12.139352 [debug] [MainThread]: Command end result
[0m20:10:12.142905 [info ] [MainThread]: 
[0m20:10:12.145813 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:10:12.147599 [debug] [MainThread]: Command end result
[0m20:10:12.164574 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6863835, "process_user_time": 4.874192, "process_kernel_time": 0.577165, "process_mem_max_rss": "208232", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m20:10:12.166707 [debug] [MainThread]: Command `dbt test` succeeded at 20:10:12.166297 after 1.69 seconds
[0m20:10:12.168362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d01905f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f6fd0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f6fd10a0>]}
[0m20:10:12.169228 [debug] [MainThread]: Flushing usage events
[0m20:10:12.171352 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6858099, "process_user_time": 4.868672, "process_kernel_time": 0.627353, "process_mem_max_rss": "208740", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m20:10:12.172707 [debug] [MainThread]: Command `dbt test` succeeded at 20:10:12.172490 after 1.69 seconds
[0m20:10:12.173664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482e0032f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482decdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48035d4590>]}
[0m20:10:12.175292 [debug] [MainThread]: Flushing usage events
[0m20:10:17.914191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402b39e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402b645fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402b5dcdd0>]}


============================== 20:10:17.920471 | 280d6383-468c-4a18-a4d4-0af3c5aec83b ==============================
[0m20:10:17.920471 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:10:17.921285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:10:17.925878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9ddd89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9ddd87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9ddd85f0>]}


============================== 20:10:17.931872 | 6db86dda-da7c-45e9-8b16-cd77b4229b33 ==============================
[0m20:10:17.931872 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:10:17.932580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:10:18.912204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '280d6383-468c-4a18-a4d4-0af3c5aec83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40047111c0>]}
[0m20:10:18.932949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6db86dda-da7c-45e9-8b16-cd77b4229b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7279ba70>]}
[0m20:10:18.977824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '280d6383-468c-4a18-a4d4-0af3c5aec83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40259c20c0>]}
[0m20:10:18.978731 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:10:18.988209 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:10:18.999361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6db86dda-da7c-45e9-8b16-cd77b4229b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c796d2de0>]}
[0m20:10:19.000297 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:10:19.013367 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:10:19.054038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:19.054632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:19.062978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '280d6383-468c-4a18-a4d4-0af3c5aec83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402b4c9dc0>]}
[0m20:10:19.080124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '280d6383-468c-4a18-a4d4-0af3c5aec83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fffcd4ad0>]}
[0m20:10:19.080923 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:10:19.081657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '280d6383-468c-4a18-a4d4-0af3c5aec83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fffc0be90>]}
[0m20:10:19.082700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:19.083625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:19.085307 [info ] [MainThread]: 
[0m20:10:19.086546 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:19.088073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:10:19.092550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6db86dda-da7c-45e9-8b16-cd77b4229b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c79777ad0>]}
[0m20:10:19.115814 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:10:19.117282 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:10:19.118362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:19.119232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6db86dda-da7c-45e9-8b16-cd77b4229b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c72538620>]}
[0m20:10:19.120627 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:10:19.121990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6db86dda-da7c-45e9-8b16-cd77b4229b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7279bbc0>]}
[0m20:10:19.127083 [info ] [MainThread]: 
[0m20:10:19.130607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:19.134234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:10:19.177596 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:10:19.178780 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:10:19.179654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:19.798867 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:10:19.802776 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:10:19.940530 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:10:19.942446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m20:10:19.943916 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:10:19.955865 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:10:19.956953 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:10:19.957872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:20.088393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m20:10:20.101198 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:10:20.101952 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:10:20.102571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:20.388883 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:20.391836 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:10:20.516984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m20:10:20.521338 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:10:20.522118 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:10:20.522858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:20.549175 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:20.552013 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:10:20.687709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m20:10:20.691765 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:10:20.692730 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:10:20.693638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:20.923759 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:20.926740 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:10:21.059471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '280d6383-468c-4a18-a4d4-0af3c5aec83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4004458a40>]}
[0m20:10:21.061167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:21.062100 [info ] [MainThread]: 
[0m20:10:21.073722 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:10:21.075072 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:10:21.076761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m20:10:21.077678 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m20:10:21.090153 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 20:10:21.078318 => 20:10:21.089795
[0m20:10:21.090945 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m20:10:21.109724 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:21.111914 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:10:21.171034 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:21.171974 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m20:10:21.173150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:21.240885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6db86dda-da7c-45e9-8b16-cd77b4229b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c726722d0>]}
[0m20:10:21.242236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:21.242988 [info ] [MainThread]: 
[0m20:10:21.254288 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:10:21.255203 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:10:21.256347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m20:10:21.257197 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m20:10:21.268693 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 20:10:21.257751 => 20:10:21.268313
[0m20:10:21.269493 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m20:10:21.342637 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:21.343333 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m20:10:21.343911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:21.612007 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m20:10:21.626195 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:21.627588 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:10:21.725676 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m20:10:21.725582 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:10:21.737231 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:21.738166 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:10:21.740907 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:21.742170 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:10:21.837868 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:10:21.837850 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:10:21.849364 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:21.850259 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:10:21.896094 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:21.897883 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:10:21.964551 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:10:22.016282 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:22.018120 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:10:23.287233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:23.287256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:23.292692 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.292571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.293688 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:10:23.294931 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:10:23.384191 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:10:23.385332 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:10:23.401910 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.402296 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.402997 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:10:23.403218 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:10:23.528241 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:10:23.533682 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:10:23.535094 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.537260 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:10:23.539597 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.540632 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:10:23.628668 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:10:23.635299 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.636207 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:10:23.651560 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:10:23.658378 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.659308 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:10:23.725611 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:10:23.737342 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.738211 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:10:23.842904 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:10:23.856171 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.904284 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:23.921295 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m20:10:24.039145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:24.040101 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:24.042287 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:10:24.293555 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 1.0 seconds
[0m20:10:24.305995 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:24.307431 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:10:24.414475 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:10:24.431015 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:24.434867 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:24.435641 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m20:10:24.544276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:10:24.545167 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:10:24.546183 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:10:25.138639 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbddba-0305-0c96-0004-59ff00297efa
[0m20:10:25.139496 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m20:10:25.140560 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 20:10:21.270029 => 20:10:25.140206
[0m20:10:25.141509 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m20:10:25.285937 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m20:10:25.287000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db86dda-da7c-45e9-8b16-cd77b4229b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c71a257f0>]}
[0m20:10:25.288374 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 4.03s]
[0m20:10:25.289611 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:10:25.295524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:25.296354 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m20:10:25.297132 [info ] [MainThread]: 
[0m20:10:25.297864 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m20:10:25.299385 [debug] [MainThread]: Command end result
[0m20:10:25.315657 [info ] [MainThread]: 
[0m20:10:25.316935 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:10:25.317955 [info ] [MainThread]: 
[0m20:10:25.318942 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m20:10:25.319657 [info ] [MainThread]: 
[0m20:10:25.321066 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:10:25.322546 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.442739, "process_user_time": 5.458651, "process_kernel_time": 0.67392, "process_mem_max_rss": "218632", "process_in_blocks": "600", "process_out_blocks": "1755", "command_success": false}
[0m20:10:25.323478 [debug] [MainThread]: Command `dbt snapshot` failed at 20:10:25.323285 after 7.44 seconds
[0m20:10:25.324855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca26b29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c72f40b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c71a1ca10>]}
[0m20:10:25.325887 [debug] [MainThread]: Flushing usage events
[0m20:10:25.591864 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbddba-0305-0be2-0004-59ff0029a0c6
[0m20:10:25.592811 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m20:10:25.594046 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 20:10:21.091493 => 20:10:25.593576
[0m20:10:25.594827 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m20:10:25.729797 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m20:10:25.731088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280d6383-468c-4a18-a4d4-0af3c5aec83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fffae9a30>]}
[0m20:10:25.732537 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 4.66s]
[0m20:10:25.733967 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:10:25.738211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:25.738939 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m20:10:25.739621 [info ] [MainThread]: 
[0m20:10:25.741018 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m20:10:25.743529 [debug] [MainThread]: Command end result
[0m20:10:25.761570 [info ] [MainThread]: 
[0m20:10:25.762879 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:10:25.763892 [info ] [MainThread]: 
[0m20:10:25.765000 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m20:10:25.766021 [info ] [MainThread]: 
[0m20:10:25.766961 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:10:25.768438 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.8999434, "process_user_time": 5.40628, "process_kernel_time": 0.701454, "process_mem_max_rss": "218884", "process_out_blocks": "1755", "command_success": false, "process_in_blocks": "0"}
[0m20:10:25.770568 [debug] [MainThread]: Command `dbt snapshot` failed at 20:10:25.769811 after 7.90 seconds
[0m20:10:25.771461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402b645fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402c22ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400415d430>]}
[0m20:10:25.772375 [debug] [MainThread]: Flushing usage events
[0m20:16:10.341903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc3ab8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc3ea82f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc3f63c20>]}


============================== 20:16:10.349192 | 7ab15c4d-60b5-462c-8fed-fca2444c87fe ==============================
[0m20:16:10.349192 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:16:10.349978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:10.347537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd89b5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd8d08bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd89b47a0>]}


============================== 20:16:10.354891 | c1f9edf5-dad4-4992-96c0-8a63148c77f0 ==============================
[0m20:16:10.354891 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:16:10.355741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:16:11.590787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ab15c4d-60b5-462c-8fed-fca2444c87fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9e38cb60>]}
[0m20:16:11.593084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1f9edf5-dad4-4992-96c0-8a63148c77f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdcf64890>]}
[0m20:16:11.657013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ab15c4d-60b5-462c-8fed-fca2444c87fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9c5ba900>]}
[0m20:16:11.657995 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:16:11.660121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1f9edf5-dad4-4992-96c0-8a63148c77f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf3ef080>]}
[0m20:16:11.660937 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:16:11.668264 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:16:11.670443 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:16:11.724351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:11.724745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:11.724947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:11.725348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:11.732071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ab15c4d-60b5-462c-8fed-fca2444c87fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc4137e90>]}
[0m20:16:11.732495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f9edf5-dad4-4992-96c0-8a63148c77f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb13ae930>]}
[0m20:16:11.754010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1f9edf5-dad4-4992-96c0-8a63148c77f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb1128110>]}
[0m20:16:11.754552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ab15c4d-60b5-462c-8fed-fca2444c87fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9c078c50>]}
[0m20:16:11.755445 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:16:11.755721 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:16:11.756584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f9edf5-dad4-4992-96c0-8a63148c77f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcbbecb30>]}
[0m20:16:11.756713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ab15c4d-60b5-462c-8fed-fca2444c87fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc3aad880>]}
[0m20:16:11.759478 [info ] [MainThread]: 
[0m20:16:11.759969 [info ] [MainThread]: 
[0m20:16:11.761322 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:11.761459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:11.763827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:16:11.763909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:16:11.789330 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:16:11.789461 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:16:11.790180 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:16:11.790480 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:16:11.790915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:11.791301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:12.524680 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:16:12.528012 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:16:12.531203 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:16:12.534101 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:16:12.673654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m20:16:12.682014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m20:16:12.689332 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:16:12.690122 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:16:12.690797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:12.697312 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:16:12.698259 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:16:12.699084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:13.068240 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:13.068853 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:13.070488 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:16:13.070969 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:16:13.187005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m20:16:13.190026 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:16:13.190726 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:16:13.191346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:13.193169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m20:16:13.196875 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:16:13.197546 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:16:13.198230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:13.569643 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:13.572432 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:16:13.573973 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:13.576810 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:16:13.698871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f9edf5-dad4-4992-96c0-8a63148c77f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb1322a20>]}
[0m20:16:13.700556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:13.701777 [info ] [MainThread]: 
[0m20:16:13.718401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ab15c4d-60b5-462c-8fed-fca2444c87fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9e36a8a0>]}
[0m20:16:13.719657 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m20:16:13.719799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:13.720850 [info ] [MainThread]: 
[0m20:16:13.721112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m20:16:13.721988 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m20:16:13.735779 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m20:16:13.735924 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m20:16:13.737089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m20:16:13.737960 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m20:16:13.739690 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 20:16:13.722583 => 20:16:13.739200
[0m20:16:13.741294 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m20:16:13.742186 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m20:16:13.743673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m20:16:13.744617 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m20:16:13.749447 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m20:16:13.751152 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m20:16:13.752495 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 20:16:13.745242 => 20:16:13.752100
[0m20:16:13.753786 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 20:16:13.738478 => 20:16:13.753324
[0m20:16:13.754251 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m20:16:13.755312 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m20:16:13.755495 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m20:16:13.756254 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m20:16:13.757058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m20:16:13.757454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m20:16:13.757808 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m20:16:13.758275 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m20:16:13.762847 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m20:16:13.763153 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m20:16:13.766097 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 20:16:13.758838 => 20:16:13.765663
[0m20:16:13.766114 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 20:16:13.758299 => 20:16:13.765622
[0m20:16:13.767601 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m20:16:13.768023 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m20:16:13.768749 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m20:16:13.769157 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m20:16:13.770213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m20:16:13.770411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m20:16:13.771069 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m20:16:13.771253 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m20:16:13.776118 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m20:16:13.776850 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m20:16:13.778639 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 20:16:13.771718 => 20:16:13.778265
[0m20:16:13.779088 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 20:16:13.771930 => 20:16:13.778719
[0m20:16:13.780166 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m20:16:13.780536 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m20:16:13.780957 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m20:16:13.781403 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m20:16:13.782099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m20:16:13.782535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m20:16:13.782839 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m20:16:13.783292 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m20:16:13.787215 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m20:16:13.787472 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m20:16:13.789435 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 20:16:13.783312 => 20:16:13.788971
[0m20:16:13.790680 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 20:16:13.783810 => 20:16:13.790089
[0m20:16:13.791265 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m20:16:13.792121 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m20:16:13.792418 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m20:16:13.793737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m20:16:13.794934 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m20:16:13.795172 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m20:16:13.796084 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m20:16:13.797271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m20:16:13.797978 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m20:16:13.799691 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m20:16:13.802194 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 20:16:13.795574 => 20:16:13.801847
[0m20:16:13.803549 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m20:16:13.805454 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m20:16:13.806370 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m20:16:13.807491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m20:16:13.808227 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m20:16:13.811711 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m20:16:13.815396 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 20:16:13.798488 => 20:16:13.814980
[0m20:16:13.816208 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m20:16:13.822907 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m20:16:13.827069 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 20:16:13.808743 => 20:16:13.825864
[0m20:16:13.829046 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m20:16:13.906618 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m20:16:13.913839 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m20:16:13.914902 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m20:16:13.916091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:13.916921 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m20:16:13.923562 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m20:16:13.925349 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m20:16:13.926813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:15.135683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:16:15.171986 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 20:16:13.816757 => 20:16:15.171614
[0m20:16:15.172821 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m20:16:15.331289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f9edf5-dad4-4992-96c0-8a63148c77f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb062cdd0>]}
[0m20:16:15.332705 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.53s]
[0m20:16:15.334028 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m20:16:15.337340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:15.337990 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m20:16:15.338744 [info ] [MainThread]: 
[0m20:16:15.339499 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m20:16:15.340765 [debug] [MainThread]: Command end result
[0m20:16:15.359058 [info ] [MainThread]: 
[0m20:16:15.359846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:15.360469 [info ] [MainThread]: 
[0m20:16:15.361247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:16:15.362761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.067508, "process_user_time": 5.436789, "process_kernel_time": 0.785511, "process_mem_max_rss": "217380", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m20:16:15.363560 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:15.363392 after 5.07 seconds
[0m20:16:15.364524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdd11aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb287b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb1dbbaa0>]}
[0m20:16:15.365384 [debug] [MainThread]: Flushing usage events
[0m20:16:15.643490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:16:15.669791 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 20:16:13.831068 => 20:16:15.669513
[0m20:16:15.670449 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m20:16:15.795640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ab15c4d-60b5-462c-8fed-fca2444c87fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b976d3f50>]}
[0m20:16:15.797044 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.99s]
[0m20:16:15.798633 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m20:16:15.802631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:15.803781 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m20:16:15.804887 [info ] [MainThread]: 
[0m20:16:15.805889 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m20:16:15.807807 [debug] [MainThread]: Command end result
[0m20:16:15.830315 [info ] [MainThread]: 
[0m20:16:15.831590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:15.833188 [info ] [MainThread]: 
[0m20:16:15.835127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:16:15.837437 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.550624, "process_user_time": 5.424185, "process_kernel_time": 0.744454, "process_mem_max_rss": "217444", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m20:16:15.838810 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:15.838396 after 5.55 seconds
[0m20:16:15.840104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc3f319a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc302b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc3b22300>]}
[0m20:16:15.841570 [debug] [MainThread]: Flushing usage events
[0m20:16:20.791475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b9b4cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b9c811f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b9b4c800>]}


============================== 20:16:20.797631 | 646b7b47-9f63-4fa5-a9d4-3846f06c065a ==============================
[0m20:16:20.797631 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:16:20.798860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:16:20.806819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa669db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa669fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa669dbe0>]}


============================== 20:16:20.812674 | 7cbf6e78-12d0-4700-a1e8-97baefe43ffc ==============================
[0m20:16:20.812674 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:16:20.813421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:16:21.844363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '646b7b47-9f63-4fa5-a9d4-3846f06c065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08faef620>]}
[0m20:16:21.872849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cbf6e78-12d0-4700-a1e8-97baefe43ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f7b817a10>]}
[0m20:16:21.908863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '646b7b47-9f63-4fa5-a9d4-3846f06c065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08f8b22a0>]}
[0m20:16:21.909753 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:16:21.925946 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:16:21.946835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cbf6e78-12d0-4700-a1e8-97baefe43ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f919bcef0>]}
[0m20:16:21.947790 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:16:21.958032 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:16:21.978967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:21.979638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:21.986992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '646b7b47-9f63-4fa5-a9d4-3846f06c065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08eca4950>]}
[0m20:16:22.000282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '646b7b47-9f63-4fa5-a9d4-3846f06c065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08e2dc590>]}
[0m20:16:22.000930 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:16:22.001465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '646b7b47-9f63-4fa5-a9d4-3846f06c065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b9b4d3a0>]}
[0m20:16:22.003202 [info ] [MainThread]: 
[0m20:16:22.003749 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:16:22.004551 [debug] [MainThread]: Command end result
[0m20:16:22.011357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:22.011903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:22.016128 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2743688, "process_user_time": 4.359651, "process_kernel_time": 0.721776, "process_mem_max_rss": "208620", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m20:16:22.016836 [debug] [MainThread]: Command `dbt test` succeeded at 20:16:22.016691 after 1.28 seconds
[0m20:16:22.017397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0be30aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08e5fe000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b9ea03e0>]}
[0m20:16:22.017917 [debug] [MainThread]: Flushing usage events
[0m20:16:22.018626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cbf6e78-12d0-4700-a1e8-97baefe43ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f7b15f470>]}
[0m20:16:22.034365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cbf6e78-12d0-4700-a1e8-97baefe43ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f7adefb60>]}
[0m20:16:22.035026 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:16:22.035605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cbf6e78-12d0-4700-a1e8-97baefe43ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f7af0f8c0>]}
[0m20:16:22.037388 [info ] [MainThread]: 
[0m20:16:22.037925 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:16:22.038622 [debug] [MainThread]: Command end result
[0m20:16:22.049637 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2888225, "process_user_time": 4.356512, "process_kernel_time": 0.686837, "process_mem_max_rss": "209004", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m20:16:22.050288 [debug] [MainThread]: Command `dbt test` succeeded at 20:16:22.050147 after 1.29 seconds
[0m20:16:22.050841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faad8aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa19ee4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fa670a300>]}
[0m20:16:22.051486 [debug] [MainThread]: Flushing usage events
[0m20:16:26.537350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee377c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee38b0c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee377cbf0>]}


============================== 20:16:26.543561 | 87ce3993-cd0f-4310-8bdb-bdd44fa2fea9 ==============================
[0m20:16:26.543561 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:16:26.544507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:26.542227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53488ce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53488ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53488cda0>]}


============================== 20:16:26.548258 | 34a0de21-3bd1-4911-85cb-63d3d08df29d ==============================
[0m20:16:26.548258 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:16:26.549012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:27.493607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a0de21-3bd1-4911-85cb-63d3d08df29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53488f230>]}
[0m20:16:27.493645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87ce3993-cd0f-4310-8bdb-bdd44fa2fea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee377c9e0>]}
[0m20:16:27.554266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87ce3993-cd0f-4310-8bdb-bdd44fa2fea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebc1328d0>]}
[0m20:16:27.554367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34a0de21-3bd1-4911-85cb-63d3d08df29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50d575160>]}
[0m20:16:27.555178 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:16:27.555385 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:16:27.564558 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:16:27.564779 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:16:27.614715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:27.614892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:27.615247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:27.615418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:27.621844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34a0de21-3bd1-4911-85cb-63d3d08df29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50cf11b80>]}
[0m20:16:27.622218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87ce3993-cd0f-4310-8bdb-bdd44fa2fea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb7f97350>]}
[0m20:16:27.635447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87ce3993-cd0f-4310-8bdb-bdd44fa2fea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb7eb8860>]}
[0m20:16:27.635668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34a0de21-3bd1-4911-85cb-63d3d08df29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50ce3c6e0>]}
[0m20:16:27.636039 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:16:27.636230 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:16:27.636844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87ce3993-cd0f-4310-8bdb-bdd44fa2fea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebc1327e0>]}
[0m20:16:27.637003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a0de21-3bd1-4911-85cb-63d3d08df29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50d72c800>]}
[0m20:16:27.638936 [info ] [MainThread]: 
[0m20:16:27.639085 [info ] [MainThread]: 
[0m20:16:27.640392 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:27.640669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:27.642165 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:16:27.642364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m20:16:27.657823 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:16:27.657860 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m20:16:27.658422 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:16:27.658652 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m20:16:27.658917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:27.659157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:28.261187 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:16:28.263931 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:16:28.293313 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:16:28.296453 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m20:16:28.388367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m20:16:28.400579 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:16:28.401255 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:16:28.401958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:28.425362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m20:16:28.436735 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m20:16:28.437296 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m20:16:28.437888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:28.770974 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:28.774298 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:16:28.793713 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:28.796592 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m20:16:28.896640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m20:16:28.901073 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:16:28.901894 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:16:28.902624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:28.932313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m20:16:28.936156 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m20:16:28.936716 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m20:16:28.937262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:29.318613 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:29.318650 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:29.321733 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:16:29.322030 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m20:16:29.448079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87ce3993-cd0f-4310-8bdb-bdd44fa2fea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebc19b740>]}
[0m20:16:29.448313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a0de21-3bd1-4911-85cb-63d3d08df29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50deb98e0>]}
[0m20:16:29.449822 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:29.450050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:29.450786 [info ] [MainThread]: 
[0m20:16:29.451176 [info ] [MainThread]: 
[0m20:16:29.463244 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:16:29.463734 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:16:29.464529 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:16:29.464720 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:16:29.466025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m20:16:29.466269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m20:16:29.467044 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m20:16:29.467303 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m20:16:29.480197 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 20:16:29.467658 => 20:16:29.479773
[0m20:16:29.481053 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 20:16:29.468086 => 20:16:29.480645
[0m20:16:29.481142 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m20:16:29.481913 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m20:16:29.564613 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:29.565344 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m20:16:29.565539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:29.565998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:29.566220 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m20:16:29.566875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:30.015268 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m20:16:30.029418 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:30.030628 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:16:30.049749 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m20:16:30.064233 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:30.065581 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:16:30.111866 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:16:30.123271 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:30.124223 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:16:30.162619 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:16:30.173800 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:30.174618 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:16:30.220537 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:16:30.260063 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:16:30.275046 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:30.276837 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:16:30.305085 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:30.306579 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:16:31.620605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:16:31.625808 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:31.627188 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:16:31.628846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:16:31.633446 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:31.634349 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:16:31.711653 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:16:31.719869 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:31.720752 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:16:31.726309 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:16:31.733872 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:31.734787 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:16:31.801529 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:16:31.807824 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:31.808756 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:16:31.813362 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:16:31.819388 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:31.820275 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:16:31.898739 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:16:31.905348 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:31.906176 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:16:31.906214 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:16:31.916453 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:31.917925 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:16:32.005255 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:16:32.005309 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m20:16:32.017350 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:32.017578 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:32.018676 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:16:32.018911 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:16:32.107487 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:16:32.114907 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m20:16:32.121153 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:32.124830 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:32.125585 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m20:16:32.127904 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:32.130641 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:32.131358 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m20:16:32.264718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:32.264709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:16:32.266043 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:32.266331 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m20:16:32.267217 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:16:32.267599 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:16:32.954788 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbddc0-0305-0c96-0004-59ff00297f9e
[0m20:16:32.954908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbddc0-0305-0bd9-0004-59ff0029b086
[0m20:16:32.955723 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m20:16:32.956027 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m20:16:32.956800 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 20:16:29.482531 => 20:16:32.956418
[0m20:16:32.957167 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 20:16:29.481876 => 20:16:32.956796
[0m20:16:32.957639 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m20:16:32.958077 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m20:16:33.086102 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m20:16:33.086128 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m20:16:33.087166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a0de21-3bd1-4911-85cb-63d3d08df29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50c348c50>]}
[0m20:16:33.087530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87ce3993-cd0f-4310-8bdb-bdd44fa2fea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb7348e90>]}
[0m20:16:33.088666 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 3.62s]
[0m20:16:33.088917 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 3.62s]
[0m20:16:33.089996 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:16:33.090281 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m20:16:33.094448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:33.094599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:33.095261 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m20:16:33.095547 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m20:16:33.096104 [info ] [MainThread]: 
[0m20:16:33.096410 [info ] [MainThread]: 
[0m20:16:33.097055 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m20:16:33.097245 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m20:16:33.098414 [debug] [MainThread]: Command end result
[0m20:16:33.098678 [debug] [MainThread]: Command end result
[0m20:16:33.113874 [info ] [MainThread]: 
[0m20:16:33.114101 [info ] [MainThread]: 
[0m20:16:33.115018 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:16:33.115213 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:16:33.116037 [info ] [MainThread]: 
[0m20:16:33.116217 [info ] [MainThread]: 
[0m20:16:33.116976 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m20:16:33.117205 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m20:16:33.118161 [info ] [MainThread]: 
[0m20:16:33.118576 [info ] [MainThread]: 
[0m20:16:33.119115 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:16:33.119618 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:16:33.120659 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.628882, "process_user_time": 4.569146, "process_kernel_time": 0.592676, "process_mem_max_rss": "218964", "process_out_blocks": "1755", "command_success": false, "process_in_blocks": "0"}
[0m20:16:33.121023 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.623714, "process_user_time": 4.506659, "process_kernel_time": 0.637868, "process_mem_max_rss": "218616", "process_out_blocks": "1755", "command_success": false, "process_in_blocks": "0"}
[0m20:16:33.121575 [debug] [MainThread]: Command `dbt snapshot` failed at 20:16:33.121383 after 6.63 seconds
[0m20:16:33.121883 [debug] [MainThread]: Command `dbt snapshot` failed at 20:16:33.121708 after 6.62 seconds
[0m20:16:33.122257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee3ad01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee7cbee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb7351460>]}
[0m20:16:33.122534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff538ff29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50ce37b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50ce89970>]}
[0m20:16:33.122999 [debug] [MainThread]: Flushing usage events
[0m20:16:33.123188 [debug] [MainThread]: Flushing usage events
[0m22:53:40.895763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1917041d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19176c8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19170405f0>]}


============================== 22:53:40.907852 | 9b4177b2-c4c8-4df3-ba8d-d8521deb02f7 ==============================
[0m22:53:40.907852 [info ] [MainThread]: Running with dbt=1.7.19
[0m22:53:40.908846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:42.263160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b4177b2-c4c8-4df3-ba8d-d8521deb02f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ebaf63c0>]}
[0m22:53:42.344888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b4177b2-c4c8-4df3-ba8d-d8521deb02f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f191b7fe9f0>]}
[0m22:53:42.346017 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:53:42.358914 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m22:53:42.438408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:42.439134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:42.446708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b4177b2-c4c8-4df3-ba8d-d8521deb02f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1916f269c0>]}
[0m22:53:42.468403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b4177b2-c4c8-4df3-ba8d-d8521deb02f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18eb798680>]}
[0m22:53:42.469185 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:53:42.469822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b4177b2-c4c8-4df3-ba8d-d8521deb02f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18eb83e6f0>]}
[0m22:53:42.472218 [info ] [MainThread]: 
[0m22:53:42.473378 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:53:42.475190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m22:53:42.494685 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m22:53:42.495458 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m22:53:42.496128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:43.068802 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:53:43.071749 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m22:53:43.191019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m22:53:43.204592 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m22:53:43.205473 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m22:53:43.206248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:43.575384 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:53:43.578255 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m22:53:43.693642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m22:53:43.698139 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m22:53:43.699016 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m22:53:43.700105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:44.042822 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:53:44.045666 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m22:53:44.154250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b4177b2-c4c8-4df3-ba8d-d8521deb02f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18eb6c9b50>]}
[0m22:53:44.155839 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:53:44.156658 [info ] [MainThread]: 
[0m22:53:44.169325 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m22:53:44.170780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m22:53:44.171670 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m22:53:44.184145 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m22:53:44.187784 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 22:53:44.172240 => 22:53:44.187308
[0m22:53:44.189326 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m22:53:44.190154 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m22:53:44.191217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m22:53:44.191899 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m22:53:44.196153 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m22:53:44.198873 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 22:53:44.192366 => 22:53:44.198291
[0m22:53:44.200769 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m22:53:44.201739 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m22:53:44.202980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m22:53:44.203752 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m22:53:44.208028 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m22:53:44.210760 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 22:53:44.204238 => 22:53:44.210257
[0m22:53:44.212252 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m22:53:44.213114 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m22:53:44.214361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m22:53:44.215148 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m22:53:44.220425 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m22:53:44.223112 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 22:53:44.215931 => 22:53:44.222662
[0m22:53:44.224527 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m22:53:44.225412 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m22:53:44.226511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m22:53:44.227205 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m22:53:44.231465 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m22:53:44.234587 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 22:53:44.227722 => 22:53:44.234167
[0m22:53:44.236070 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m22:53:44.237424 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m22:53:44.238509 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m22:53:44.239758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m22:53:44.240418 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m22:53:44.252905 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m22:53:44.255613 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 22:53:44.240961 => 22:53:44.255239
[0m22:53:44.256377 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m22:53:44.300791 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m22:53:44.307684 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m22:53:44.308719 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m22:53:44.309665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:45.965019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:53:46.003913 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 22:53:44.256897 => 22:53:46.003506
[0m22:53:46.005001 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m22:53:46.127278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b4177b2-c4c8-4df3-ba8d-d8521deb02f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18eac6bda0>]}
[0m22:53:46.128342 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.89s]
[0m22:53:46.129397 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m22:53:46.132305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:46.133069 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m22:53:46.133671 [info ] [MainThread]: 
[0m22:53:46.134235 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m22:53:46.135224 [debug] [MainThread]: Command end result
[0m22:53:46.152088 [info ] [MainThread]: 
[0m22:53:46.152913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:53:46.153679 [info ] [MainThread]: 
[0m22:53:46.154456 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:53:46.155897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.3205237, "process_user_time": 5.906354, "process_kernel_time": 1.266839, "process_mem_max_rss": "217504", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m22:53:46.156866 [debug] [MainThread]: Command `dbt run` succeeded at 22:53:46.156561 after 5.32 seconds
[0m22:53:46.158014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f191b7fea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1917394590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ebb30470>]}
[0m22:53:46.159034 [debug] [MainThread]: Flushing usage events
[0m22:53:51.730418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa10a7cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa10a7c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa10a7ce00>]}


============================== 22:53:51.738103 | 0a3b4250-204b-43ca-9712-eb8ad6f31d3d ==============================
[0m22:53:51.738103 [info ] [MainThread]: Running with dbt=1.7.19
[0m22:53:51.739003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:52.800329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a3b4250-204b-43ca-9712-eb8ad6f31d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9eaac9ca0>]}
[0m22:53:52.865004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a3b4250-204b-43ca-9712-eb8ad6f31d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e9172420>]}
[0m22:53:52.866138 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:53:52.876002 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m22:53:52.932947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:52.933662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:52.940592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a3b4250-204b-43ca-9712-eb8ad6f31d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e91a10a0>]}
[0m22:53:52.957229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a3b4250-204b-43ca-9712-eb8ad6f31d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e91ec200>]}
[0m22:53:52.957933 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:53:52.958649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3b4250-204b-43ca-9712-eb8ad6f31d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa10997f20>]}
[0m22:53:52.960932 [info ] [MainThread]: 
[0m22:53:52.961648 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:53:52.962458 [debug] [MainThread]: Command end result
[0m22:53:52.976265 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3064492, "process_user_time": 5.098859, "process_kernel_time": 0.725329, "process_mem_max_rss": "209060", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m22:53:52.977031 [debug] [MainThread]: Command `dbt test` succeeded at 22:53:52.976860 after 1.31 seconds
[0m22:53:52.977610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa151e6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e9448500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa10d89e20>]}
[0m22:53:52.978315 [debug] [MainThread]: Flushing usage events
[0m22:53:58.600132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b460df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b4961ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b56cac00>]}


============================== 22:53:58.607346 | 251c00c2-c3cb-4219-9bcd-ae24e90158a6 ==============================
[0m22:53:58.607346 [info ] [MainThread]: Running with dbt=1.7.19
[0m22:53:58.608301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:53:59.768862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '251c00c2-c3cb-4219-9bcd-ae24e90158a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58d5ad730>]}
[0m22:53:59.844370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '251c00c2-c3cb-4219-9bcd-ae24e90158a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ae98c8f0>]}
[0m22:53:59.845379 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:53:59.856970 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m22:53:59.916551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:59.917304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:59.925538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '251c00c2-c3cb-4219-9bcd-ae24e90158a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58cd09940>]}
[0m22:53:59.941860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '251c00c2-c3cb-4219-9bcd-ae24e90158a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58cd8b530>]}
[0m22:53:59.942576 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:53:59.943312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '251c00c2-c3cb-4219-9bcd-ae24e90158a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58cfdbb60>]}
[0m22:53:59.946190 [info ] [MainThread]: 
[0m22:53:59.947412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:53:59.949382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m22:53:59.968923 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m22:53:59.969751 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m22:53:59.970430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:00.480280 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:54:00.483583 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m22:54:00.612016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m22:54:00.626261 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m22:54:00.627113 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m22:54:00.627825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:54:01.002374 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:54:01.005514 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m22:54:01.133772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m22:54:01.138064 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m22:54:01.138851 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m22:54:01.139557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:54:01.502597 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:54:01.507133 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m22:54:01.636440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '251c00c2-c3cb-4219-9bcd-ae24e90158a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f3cc350>]}
[0m22:54:01.637951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:54:01.638997 [info ] [MainThread]: 
[0m22:54:01.651301 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m22:54:01.652517 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m22:54:01.653835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m22:54:01.654849 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m22:54:01.668196 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 22:54:01.655383 => 22:54:01.667766
[0m22:54:01.669077 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m22:54:01.767476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:01.768439 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m22:54:01.769439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:02.379487 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:54:02.395417 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:02.396826 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m22:54:02.482851 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:54:02.494571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:02.495662 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m22:54:02.601823 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:54:02.657525 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:02.659425 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m22:54:04.017595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:54:04.022472 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:04.023347 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m22:54:04.102796 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m22:54:04.111339 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:04.112234 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m22:54:04.200483 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:54:04.207388 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:04.208315 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m22:54:04.309547 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m22:54:04.316847 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:04.317859 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m22:54:04.385556 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:54:04.397127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:04.398465 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m22:54:04.482639 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m22:54:04.515790 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:04.520718 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:04.522328 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m22:54:04.654639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:54:04.655538 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m22:54:04.656425 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m22:54:05.109581 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbde5e-0305-0c96-0004-59ff002a277a
[0m22:54:05.110503 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m22:54:05.111604 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 22:54:01.669693 => 22:54:05.111236
[0m22:54:05.112454 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m22:54:05.244158 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m22:54:05.245108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '251c00c2-c3cb-4219-9bcd-ae24e90158a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58c2d0d40>]}
[0m22:54:05.246386 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 3.59s]
[0m22:54:05.248116 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m22:54:05.252775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:05.253502 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m22:54:05.254260 [info ] [MainThread]: 
[0m22:54:05.255004 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m22:54:05.256257 [debug] [MainThread]: Command end result
[0m22:54:05.273203 [info ] [MainThread]: 
[0m22:54:05.274004 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:54:05.274674 [info ] [MainThread]: 
[0m22:54:05.275426 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m22:54:05.276444 [info ] [MainThread]: 
[0m22:54:05.277488 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:54:05.279051 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.736033, "process_user_time": 5.774444, "process_kernel_time": 0.79451, "process_mem_max_rss": "219844", "process_out_blocks": "1755", "command_success": false, "process_in_blocks": "0"}
[0m22:54:05.280010 [debug] [MainThread]: Command `dbt snapshot` failed at 22:54:05.279807 after 6.74 seconds
[0m22:54:05.280823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b4609ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b4a8d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58cd0a9f0>]}
[0m22:54:05.281757 [debug] [MainThread]: Flushing usage events
[0m23:17:55.308744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff13be0bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff13af14aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff13aeacaa0>]}


============================== 23:17:55.318408 | 07939344-825f-4c32-a097-ee95d387b7b3 ==============================
[0m23:17:55.318408 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:17:55.319881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:17:56.699154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07939344-825f-4c32-a097-ee95d387b7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f675130>]}
[0m23:17:56.767944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07939344-825f-4c32-a097-ee95d387b7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff120b36180>]}
[0m23:17:56.768850 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:17:56.778813 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:17:56.840485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:17:56.841090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:17:56.847709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07939344-825f-4c32-a097-ee95d387b7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f674410>]}
[0m23:17:56.863640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07939344-825f-4c32-a097-ee95d387b7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f418140>]}
[0m23:17:56.864248 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:17:56.865203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07939344-825f-4c32-a097-ee95d387b7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10fd04b90>]}
[0m23:17:56.867510 [info ] [MainThread]: 
[0m23:17:56.868791 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:17:56.870486 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:17:56.888898 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:17:56.889566 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:17:56.890074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:57.478996 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:17:57.481863 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:17:57.627042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:17:57.640779 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:17:57.641716 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:17:57.642552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:17:58.038155 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:17:58.040817 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:17:58.165822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:17:58.169911 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:17:58.170697 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:17:58.171424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:17:58.614356 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:17:58.616895 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:17:58.736008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07939344-825f-4c32-a097-ee95d387b7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f556d50>]}
[0m23:17:58.737420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:17:58.738556 [info ] [MainThread]: 
[0m23:17:58.750420 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:17:58.751805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m23:17:58.752767 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:17:58.765369 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:17:58.769437 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:17:58.753369 => 23:17:58.768967
[0m23:17:58.771110 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:17:58.772284 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:17:58.773593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:17:58.774290 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:17:58.779703 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:17:58.782234 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:17:58.774908 => 23:17:58.781856
[0m23:17:58.783829 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:17:58.784765 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:17:58.785957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:17:58.786688 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:17:58.791140 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:17:58.793860 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:17:58.787195 => 23:17:58.793376
[0m23:17:58.795372 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:17:58.796201 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:17:58.797300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:17:58.798051 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:17:58.802627 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:17:58.805658 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:17:58.798537 => 23:17:58.805132
[0m23:17:58.807305 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:17:58.808189 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:17:58.809546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:17:58.810430 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:17:58.815009 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:17:58.817889 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:17:58.811088 => 23:17:58.817493
[0m23:17:58.819307 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:17:58.820950 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:17:58.821866 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:17:58.822989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:17:58.823664 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:17:58.836503 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:17:58.839707 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:17:58.824154 => 23:17:58.839197
[0m23:17:58.840470 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:17:58.885743 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:17:58.891224 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:17:58.892185 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:17:58.893376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:00.634055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m23:18:00.670067 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:17:58.841093 => 23:18:00.669721
[0m23:18:00.670982 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:18:00.835812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07939344-825f-4c32-a097-ee95d387b7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f41b500>]}
[0m23:18:00.837111 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.01s]
[0m23:18:00.839567 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:18:00.843356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:00.844120 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:18:00.844832 [info ] [MainThread]: 
[0m23:18:00.845584 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m23:18:00.847048 [debug] [MainThread]: Command end result
[0m23:18:00.866551 [info ] [MainThread]: 
[0m23:18:00.867686 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:00.868442 [info ] [MainThread]: 
[0m23:18:00.869454 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:18:00.871272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.625696, "process_user_time": 6.78461, "process_kernel_time": 1.130222, "process_mem_max_rss": "217152", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m23:18:00.872246 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:00.872029 after 5.63 seconds
[0m23:18:00.873067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff13af14aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10fdc9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff13b29e030>]}
[0m23:18:00.873742 [debug] [MainThread]: Flushing usage events
[0m23:18:06.372457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3531bf1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3531bf37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3531bf1b20>]}


============================== 23:18:06.378361 | b2a7a75d-c8fe-4448-8c34-06c75594f1e1 ==============================
[0m23:18:06.378361 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:18:06.379054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:07.489011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2a7a75d-c8fe-4448-8c34-06c75594f1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350a3c1a00>]}
[0m23:18:07.554737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2a7a75d-c8fe-4448-8c34-06c75594f1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350a8dac00>]}
[0m23:18:07.555837 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:18:07.565173 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:18:07.621272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:18:07.621837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:18:07.628868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2a7a75d-c8fe-4448-8c34-06c75594f1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350a3fd7c0>]}
[0m23:18:07.645967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2a7a75d-c8fe-4448-8c34-06c75594f1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350a34c1a0>]}
[0m23:18:07.646600 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:18:07.647268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2a7a75d-c8fe-4448-8c34-06c75594f1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3531c915b0>]}
[0m23:18:07.649219 [info ] [MainThread]: 
[0m23:18:07.649775 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:18:07.650586 [debug] [MainThread]: Command end result
[0m23:18:07.662435 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.334714, "process_user_time": 4.583426, "process_kernel_time": 0.818505, "process_mem_max_rss": "208692", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m23:18:07.663210 [debug] [MainThread]: Command `dbt test` succeeded at 23:18:07.663068 after 1.34 seconds
[0m23:18:07.663840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3536352a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3532f0ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3531bf37d0>]}
[0m23:18:07.664410 [debug] [MainThread]: Flushing usage events
[0m23:18:13.760776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e93165d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e935aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e991a6c0>]}


============================== 23:18:13.766891 | 338c2c4a-ac91-4a01-ae81-33563a590d51 ==============================
[0m23:18:13.766891 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:18:13.767642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:14.975711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '338c2c4a-ac91-4a01-ae81-33563a590d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c21765a0>]}
[0m23:18:15.058777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '338c2c4a-ac91-4a01-ae81-33563a590d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e93c7020>]}
[0m23:18:15.059990 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:18:15.071042 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:18:15.135103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:18:15.135899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:18:15.144942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '338c2c4a-ac91-4a01-ae81-33563a590d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c1c83fb0>]}
[0m23:18:15.163957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '338c2c4a-ac91-4a01-ae81-33563a590d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c1a841a0>]}
[0m23:18:15.164878 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:18:15.165722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338c2c4a-ac91-4a01-ae81-33563a590d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c17d2d50>]}
[0m23:18:15.168645 [info ] [MainThread]: 
[0m23:18:15.169945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:18:15.171675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:18:15.193406 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:18:15.194218 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:18:15.194925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:15.838015 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:18:15.840271 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:18:15.985453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:18:15.999685 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:18:16.000549 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:18:16.001288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:16.433214 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:18:16.436011 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:18:16.560721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:18:16.565436 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:18:16.566387 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:18:16.567530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:16.936744 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:18:16.939854 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:18:17.067003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338c2c4a-ac91-4a01-ae81-33563a590d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c1df08c0>]}
[0m23:18:17.068379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:17.069143 [info ] [MainThread]: 
[0m23:18:17.081530 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:18:17.082594 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:18:17.083971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m23:18:17.084805 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m23:18:17.099430 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 23:18:17.085358 => 23:18:17.099006
[0m23:18:17.100309 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m23:18:17.189761 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:17.190566 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m23:18:17.191283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:17.612531 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:18:17.626764 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:17.628146 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:18:17.703312 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:18:17.714488 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:17.715419 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:18:17.826970 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:18:17.880720 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:17.882581 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:18:18.997501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:18:19.002739 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:19.003870 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:18:19.103783 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:18:19.110758 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:19.111678 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:18:19.182078 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:18:19.188585 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:19.189631 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:18:19.361798 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:18:19.369395 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:19.370344 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:18:19.456165 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:18:19.471617 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:19.472564 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:18:19.561458 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:18:19.575182 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:19.580546 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:19.581343 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m23:18:19.724600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:18:19.725750 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:18:19.727038 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m23:18:20.342447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbde76-0305-0c98-0004-59ff0029edbe
[0m23:18:20.343378 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m23:18:20.344435 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 23:18:17.100853 => 23:18:20.344054
[0m23:18:20.345253 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m23:18:20.486259 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m23:18:20.487306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338c2c4a-ac91-4a01-ae81-33563a590d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c0e11490>]}
[0m23:18:20.488620 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 3.40s]
[0m23:18:20.490046 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:18:20.494576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:20.495392 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m23:18:20.496217 [info ] [MainThread]: 
[0m23:18:20.497255 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m23:18:20.498688 [debug] [MainThread]: Command end result
[0m23:18:20.517444 [info ] [MainThread]: 
[0m23:18:20.518357 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:18:20.519279 [info ] [MainThread]: 
[0m23:18:20.520234 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m23:18:20.521930 [info ] [MainThread]: 
[0m23:18:20.522731 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:18:20.524182 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.8095207, "process_user_time": 5.564741, "process_kernel_time": 0.854718, "process_mem_max_rss": "218712", "process_out_blocks": "1755", "command_success": false, "process_in_blocks": "0"}
[0m23:18:20.525054 [debug] [MainThread]: Command `dbt snapshot` failed at 23:18:20.524874 after 6.81 seconds
[0m23:18:20.525735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80eb52e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c0ec35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ed8c1be0>]}
[0m23:18:20.526535 [debug] [MainThread]: Flushing usage events
[0m23:20:58.275490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97348cc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97348cf410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97348ccb00>]}


============================== 23:20:58.282839 | 3dfdf8fb-58e2-454e-b0a7-5a77574f3169 ==============================
[0m23:20:58.282839 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:20:58.283687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:20:59.372698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dfdf8fb-58e2-454e-b0a7-5a77574f3169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970dee40b0>]}
[0m23:20:59.446194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dfdf8fb-58e2-454e-b0a7-5a77574f3169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970d794650>]}
[0m23:20:59.447474 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:20:59.462646 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:20:59.567141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:20:59.568290 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m23:20:59.576840 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "session_summary') }}
  {% endsnapshot %}"
[0m23:20:59.579263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3594357, "process_user_time": 5.048091, "process_kernel_time": 0.563788, "process_mem_max_rss": "208228", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m23:20:59.580969 [debug] [MainThread]: Command `dbt run` failed at 23:20:59.580761 after 1.36 seconds
[0m23:20:59.581927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97359e1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9734c25760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972f3a4c80>]}
[0m23:20:59.582761 [debug] [MainThread]: Flushing usage events
[0m23:21:51.292702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6646f8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd664d83c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6657e1f10>]}


============================== 23:21:51.301062 | f91b7013-ff8a-4ce3-a288-e74daf8f8f26 ==============================
[0m23:21:51.301062 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:21:51.301884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:21:52.385302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f91b7013-ff8a-4ce3-a288-e74daf8f8f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d0ca6c0>]}
[0m23:21:52.449394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f91b7013-ff8a-4ce3-a288-e74daf8f8f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d0ca720>]}
[0m23:21:52.450315 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:21:52.460585 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:21:52.525044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:21:52.526055 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m23:21:52.691620 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  expected token ',', got '_'
    line 5
      unique_key='symbol || '_' || TO_VARCHAR(date)',
[0m23:21:52.692987 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4505504, "process_user_time": 4.920195, "process_kernel_time": 0.858622, "process_mem_max_rss": "209588", "process_in_blocks": "16", "process_out_blocks": "21", "command_success": false}
[0m23:21:52.693844 [debug] [MainThread]: Command `dbt run` failed at 23:21:52.693674 after 1.45 seconds
[0m23:21:52.694559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd668de2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63cbbfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63cbbfdd0>]}
[0m23:21:52.695209 [debug] [MainThread]: Flushing usage events
[0m23:23:30.006707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bbc560fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bbc560770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bbc560c20>]}


============================== 23:23:30.014706 | 9e0edd62-a922-4363-aca5-e1d5f85cabf7 ==============================
[0m23:23:30.014706 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:23:30.015651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:23:31.141085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e0edd62-a922-4363-aca5-e1d5f85cabf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b94dc3d40>]}
[0m23:23:31.203058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e0edd62-a922-4363-aca5-e1d5f85cabf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b96f16330>]}
[0m23:23:31.203956 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:23:31.213525 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:23:31.269330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:23:31.270352 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m23:23:31.446980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e0edd62-a922-4363-aca5-e1d5f85cabf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9499ce30>]}
[0m23:23:31.466982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e0edd62-a922-4363-aca5-e1d5f85cabf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b94aafc80>]}
[0m23:23:31.467849 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:23:31.468551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e0edd62-a922-4363-aca5-e1d5f85cabf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b95f951f0>]}
[0m23:23:31.470915 [info ] [MainThread]: 
[0m23:23:31.472036 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:23:31.473790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:23:31.492906 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:23:31.493618 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:23:31.494220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:32.098489 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:23:32.101475 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:23:32.243931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m23:23:32.257627 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:23:32.258409 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:23:32.259081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:32.644224 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:23:32.647528 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:23:32.803804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m23:23:32.807931 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:23:32.808702 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:23:32.809388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:33.238499 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:23:33.241213 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:23:33.431612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e0edd62-a922-4363-aca5-e1d5f85cabf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b94ecacf0>]}
[0m23:23:33.432874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:33.433879 [info ] [MainThread]: 
[0m23:23:33.445228 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:23:33.446563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m23:23:33.447495 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:23:33.459613 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:23:33.465104 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:23:33.448036 => 23:23:33.464685
[0m23:23:33.466769 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:23:33.467572 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:23:33.468613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:23:33.469335 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:23:33.473503 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:23:33.475915 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:23:33.469826 => 23:23:33.475551
[0m23:23:33.477404 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:23:33.478243 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:23:33.479309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:23:33.479966 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:23:33.484157 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:23:33.486503 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:23:33.480499 => 23:23:33.486162
[0m23:23:33.487859 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:23:33.488615 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:23:33.489614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:23:33.490312 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:23:33.494183 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:23:33.496358 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:23:33.490758 => 23:23:33.495960
[0m23:23:33.497794 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:23:33.498552 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:23:33.499592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:23:33.500212 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:23:33.503914 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:23:33.506030 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:23:33.500696 => 23:23:33.505704
[0m23:23:33.507407 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:23:33.508607 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:23:33.509554 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:23:33.510578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:23:33.511262 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:23:33.524002 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:23:33.526685 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:23:33.511694 => 23:23:33.526344
[0m23:23:33.527315 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:23:33.568338 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:23:33.573983 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:23:33.575116 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:23:33.576177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:34.796012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:23:34.830834 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:23:33.527743 => 23:23:34.830471
[0m23:23:34.831678 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:23:34.943866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e0edd62-a922-4363-aca5-e1d5f85cabf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8feaec00>]}
[0m23:23:34.945195 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.43s]
[0m23:23:34.946685 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:23:34.950089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:34.950825 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:23:34.951525 [info ] [MainThread]: 
[0m23:23:34.952543 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m23:23:34.953889 [debug] [MainThread]: Command end result
[0m23:23:34.970192 [info ] [MainThread]: 
[0m23:23:34.971241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:34.972015 [info ] [MainThread]: 
[0m23:23:34.973192 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:23:34.974861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0248914, "process_user_time": 5.515109, "process_kernel_time": 0.741778, "process_mem_max_rss": "220468", "process_out_blocks": "2618", "process_in_blocks": "0"}
[0m23:23:34.976046 [debug] [MainThread]: Command `dbt run` succeeded at 23:23:34.975811 after 5.03 seconds
[0m23:23:34.976939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bbc560fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b94905d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bbc8a7770>]}
[0m23:23:34.977774 [debug] [MainThread]: Flushing usage events
[0m23:23:41.370003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffab0d053a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffab0d056a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffab0d05100>]}


============================== 23:23:41.376203 | 39de17f4-6925-4f83-873b-f79d62883442 ==============================
[0m23:23:41.376203 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:23:41.376974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:23:42.422682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39de17f4-6925-4f83-873b-f79d62883442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa894bb1d0>]}
[0m23:23:42.485378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39de17f4-6925-4f83-873b-f79d62883442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa89817a70>]}
[0m23:23:42.486277 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:23:42.495539 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:23:42.554337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:23:42.555068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:23:42.563000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39de17f4-6925-4f83-873b-f79d62883442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa89c22360>]}
[0m23:23:42.581443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39de17f4-6925-4f83-873b-f79d62883442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa8947fcb0>]}
[0m23:23:42.582620 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:23:42.584019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39de17f4-6925-4f83-873b-f79d62883442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa8af52ae0>]}
[0m23:23:42.587280 [info ] [MainThread]: 
[0m23:23:42.588084 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:23:42.589317 [debug] [MainThread]: Command end result
[0m23:23:42.603062 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2827188, "process_user_time": 4.84287, "process_kernel_time": 0.772786, "process_mem_max_rss": "209148", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m23:23:42.604005 [debug] [MainThread]: Command `dbt test` succeeded at 23:23:42.603822 after 1.28 seconds
[0m23:23:42.604673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffab1009e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffab0c376e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffab10f45c0>]}
[0m23:23:42.605274 [debug] [MainThread]: Flushing usage events
[0m23:23:47.675424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64531049b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6453105df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6453104a70>]}


============================== 23:23:47.681758 | 8d90f61b-ad58-40af-8d77-7046c98e2e8a ==============================
[0m23:23:47.681758 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:23:47.682657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:23:48.681090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d90f61b-ad58-40af-8d77-7046c98e2e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64278ae870>]}
[0m23:23:48.744315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d90f61b-ad58-40af-8d77-7046c98e2e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6427bd5520>]}
[0m23:23:48.745241 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:23:48.754975 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:23:48.804294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:23:48.804855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:23:48.814979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d90f61b-ad58-40af-8d77-7046c98e2e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6427c22540>]}
[0m23:23:48.831005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d90f61b-ad58-40af-8d77-7046c98e2e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6427834080>]}
[0m23:23:48.831822 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:23:48.832961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d90f61b-ad58-40af-8d77-7046c98e2e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642c0a61e0>]}
[0m23:23:48.835468 [info ] [MainThread]: 
[0m23:23:48.836796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:23:48.838244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:23:48.857473 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:23:48.858259 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:23:48.858884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:49.399444 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:23:49.402300 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:23:49.546951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:23:49.567330 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:23:49.568231 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:23:49.569055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:49.910533 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:23:49.913244 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:23:50.028306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:23:50.032325 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:23:50.033183 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:23:50.033830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:50.409267 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:23:50.411824 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:23:50.553209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d90f61b-ad58-40af-8d77-7046c98e2e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642eefd5b0>]}
[0m23:23:50.554620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:50.555655 [info ] [MainThread]: 
[0m23:23:50.568261 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:23:50.569266 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:23:50.570521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m23:23:50.571375 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m23:23:50.585620 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 23:23:50.572002 => 23:23:50.585217
[0m23:23:50.586732 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m23:23:50.667869 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:23:50.668612 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m23:23:50.669188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:51.091041 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:23:51.106218 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:23:51.107656 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:23:51.208798 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:23:51.220511 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:23:51.221604 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:23:51.296078 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:23:51.349432 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:23:51.351182 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol ~ "_" ~ TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol ~ "_" ~ TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol ~ "_" ~ TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol ~ "_" ~ TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol ~ "_" ~ TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:23:51.455978 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbde7b-0305-0be2-0004-59ff0029fd1a
[0m23:23:51.457175 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 19 unexpected '~'.
syntax error line 14 at position 38 unexpected 'date'.
syntax error line 14 at position 44 unexpected 'as'.
syntax error line 64 at position 44 unexpected 'snapshotted_data'.
[0m23:23:51.458461 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 23:23:50.587309 => 23:23:51.457900
[0m23:23:51.459397 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m23:23:51.580572 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 19 unexpected '~'.
  syntax error line 14 at position 38 unexpected 'date'.
  syntax error line 14 at position 44 unexpected 'as'.
  syntax error line 64 at position 44 unexpected 'snapshotted_data'.
[0m23:23:51.581822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d90f61b-ad58-40af-8d77-7046c98e2e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64277bf710>]}
[0m23:23:51.583351 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 1.01s]
[0m23:23:51.584766 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:23:51.589240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:51.589965 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m23:23:51.590718 [info ] [MainThread]: 
[0m23:23:51.591615 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m23:23:51.593118 [debug] [MainThread]: Command end result
[0m23:23:51.610972 [info ] [MainThread]: 
[0m23:23:51.612190 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:23:51.613028 [info ] [MainThread]: 
[0m23:23:51.614069 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 19 unexpected '~'.
  syntax error line 14 at position 38 unexpected 'date'.
  syntax error line 14 at position 44 unexpected 'as'.
  syntax error line 64 at position 44 unexpected 'snapshotted_data'.
[0m23:23:51.615795 [info ] [MainThread]: 
[0m23:23:51.616620 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:23:51.617947 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.9916077, "process_user_time": 5.181689, "process_kernel_time": 0.783029, "process_mem_max_rss": "218676", "process_out_blocks": "1746", "command_success": false, "process_in_blocks": "0"}
[0m23:23:51.619349 [debug] [MainThread]: Command `dbt snapshot` failed at 23:23:51.619161 after 3.99 seconds
[0m23:23:51.620107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f645786a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64278dc680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642d9f42f0>]}
[0m23:23:51.620948 [debug] [MainThread]: Flushing usage events
[0m23:26:39.290077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec4719b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec47196d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec4719640>]}


============================== 23:26:39.301706 | 4448f536-1875-4192-9428-8bd97252c7b6 ==============================
[0m23:26:39.301706 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:26:39.303174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:40.472169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4448f536-1875-4192-9428-8bd97252c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9d228290>]}
[0m23:26:40.574065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4448f536-1875-4192-9428-8bd97252c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9d0b79e0>]}
[0m23:26:40.576264 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:26:40.609706 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:26:40.770855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:26:40.772180 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m23:26:41.019673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4448f536-1875-4192-9428-8bd97252c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9cb5c920>]}
[0m23:26:41.041853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4448f536-1875-4192-9428-8bd97252c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9ce93980>]}
[0m23:26:41.042666 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:26:41.043448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4448f536-1875-4192-9428-8bd97252c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eae9ed910>]}
[0m23:26:41.045876 [info ] [MainThread]: 
[0m23:26:41.047002 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:26:41.048631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:26:41.069686 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:26:41.070508 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:26:41.071175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:41.671038 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:26:41.674296 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:26:41.810939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:26:41.824532 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:26:41.825332 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:26:41.825898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:42.212391 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:26:42.215414 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:26:42.341828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:26:42.346327 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:26:42.347048 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:26:42.347859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:42.702242 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:26:42.705098 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:26:42.814028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4448f536-1875-4192-9428-8bd97252c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9d41af60>]}
[0m23:26:42.815468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:42.816371 [info ] [MainThread]: 
[0m23:26:42.829746 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:26:42.831108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m23:26:42.831976 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:26:42.844012 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:26:42.847081 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:26:42.832554 => 23:26:42.846624
[0m23:26:42.848653 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:26:42.849583 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:26:42.851040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:26:42.851845 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:26:42.856508 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:26:42.859662 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:26:42.852358 => 23:26:42.859246
[0m23:26:42.861280 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:26:42.862134 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:26:42.863228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:26:42.863962 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:26:42.868280 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:26:42.871084 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:26:42.864495 => 23:26:42.870706
[0m23:26:42.872565 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:26:42.873316 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:26:42.874411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:26:42.875095 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:26:42.879331 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:26:42.881914 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:26:42.875560 => 23:26:42.881441
[0m23:26:42.883477 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:26:42.884370 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:26:42.885453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:26:42.886166 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:26:42.890147 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:26:42.892574 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:26:42.886639 => 23:26:42.892187
[0m23:26:42.894094 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:26:42.895472 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:26:42.896487 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:26:42.897594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:26:42.898339 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:26:42.910850 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:26:42.913415 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:26:42.898831 => 23:26:42.913080
[0m23:26:42.914090 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:26:42.959426 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:26:42.965589 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:26:42.966687 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:26:42.967964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:44.339642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:26:44.374689 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:26:42.914729 => 23:26:44.374331
[0m23:26:44.375630 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:26:44.492455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4448f536-1875-4192-9428-8bd97252c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9c18dac0>]}
[0m23:26:44.493579 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.60s]
[0m23:26:44.494961 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:26:44.498424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:44.499130 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:26:44.499920 [info ] [MainThread]: 
[0m23:26:44.500870 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m23:26:44.502406 [debug] [MainThread]: Command end result
[0m23:26:44.519626 [info ] [MainThread]: 
[0m23:26:44.520899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:44.521639 [info ] [MainThread]: 
[0m23:26:44.522509 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:26:44.524347 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.3303924, "process_user_time": 6.65728, "process_kernel_time": 1.083641, "process_mem_max_rss": "219220", "process_out_blocks": "2618", "process_in_blocks": "0"}
[0m23:26:44.525337 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:44.525141 after 5.33 seconds
[0m23:26:44.526024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec4781f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec4a54770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9e5ee480>]}
[0m23:26:44.526702 [debug] [MainThread]: Flushing usage events
[0m23:26:50.838007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83f7859d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83f785b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83f7858800>]}


============================== 23:26:50.845134 | ace6c8f3-1e26-45df-bb82-4d72ddd0a8d6 ==============================
[0m23:26:50.845134 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:26:50.846010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:26:52.042564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ace6c8f3-1e26-45df-bb82-4d72ddd0a8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ed98a780>]}
[0m23:26:52.142466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ace6c8f3-1e26-45df-bb82-4d72ddd0a8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ed98a780>]}
[0m23:26:52.143684 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:26:52.155940 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:26:52.219810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:26:52.220478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:26:52.228567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ace6c8f3-1e26-45df-bb82-4d72ddd0a8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83d039e090>]}
[0m23:26:52.245833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ace6c8f3-1e26-45df-bb82-4d72ddd0a8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83cbee3ce0>]}
[0m23:26:52.246589 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:26:52.247306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace6c8f3-1e26-45df-bb82-4d72ddd0a8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83d1a226c0>]}
[0m23:26:52.250070 [info ] [MainThread]: 
[0m23:26:52.250787 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:26:52.251661 [debug] [MainThread]: Command end result
[0m23:26:52.265279 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4846547, "process_user_time": 4.861097, "process_kernel_time": 0.814997, "process_mem_max_rss": "208484", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m23:26:52.266108 [debug] [MainThread]: Command `dbt test` succeeded at 23:26:52.265940 after 1.49 seconds
[0m23:26:52.266807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83fb524770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83f7e7e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ea6ece30>]}
[0m23:26:52.267442 [debug] [MainThread]: Flushing usage events
[0m23:26:58.695574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c630c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c699bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c630c830>]}


============================== 23:26:58.702991 | 61324a32-c28e-4b78-bbcb-f4b53c3d373a ==============================
[0m23:26:58.702991 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:26:58.704044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:59.958933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61324a32-c28e-4b78-bbcb-f4b53c3d373a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f279b28dca0>]}
[0m23:27:00.026273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61324a32-c28e-4b78-bbcb-f4b53c3d373a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27a01d5550>]}
[0m23:27:00.028045 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:27:00.039446 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:27:00.103533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:00.104280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:00.112402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61324a32-c28e-4b78-bbcb-f4b53c3d373a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f279aa1e3f0>]}
[0m23:27:00.130151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61324a32-c28e-4b78-bbcb-f4b53c3d373a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f279a8bc140>]}
[0m23:27:00.130995 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:27:00.132020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61324a32-c28e-4b78-bbcb-f4b53c3d373a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f279aec0710>]}
[0m23:27:00.134993 [info ] [MainThread]: 
[0m23:27:00.136377 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:27:00.138102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:27:00.158456 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:27:00.159281 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:27:00.160004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:00.735267 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:27:00.737885 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:27:00.878477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m23:27:00.903520 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:27:00.904305 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:27:00.904939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:01.221339 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:27:01.224247 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:27:01.346304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m23:27:01.350615 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:27:01.351349 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:27:01.352053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:01.742477 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:27:01.745279 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:27:01.855123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61324a32-c28e-4b78-bbcb-f4b53c3d373a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f279aaafcb0>]}
[0m23:27:01.856630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:01.857609 [info ] [MainThread]: 
[0m23:27:01.869416 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:27:01.870439 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:27:01.871690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m23:27:01.872589 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m23:27:01.886472 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 23:27:01.873282 => 23:27:01.885982
[0m23:27:01.887676 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m23:27:01.977742 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:27:01.978569 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m23:27:01.979259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:02.436267 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:27:02.451971 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:27:02.453626 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:27:02.545968 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:27:02.560032 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:27:02.561112 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:27:02.652329 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:27:02.715708 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:27:02.717718 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol ~ '_' ~ TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol ~ '_' ~ TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol ~ '_' ~ TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol ~ '_' ~ TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol ~ '_' ~ TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:27:02.818049 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbde7f-0305-0bd9-0004-59ff002a0c4a
[0m23:27:02.819070 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 19 unexpected '~'.
syntax error line 14 at position 38 unexpected 'date'.
syntax error line 14 at position 44 unexpected 'as'.
syntax error line 64 at position 44 unexpected 'snapshotted_data'.
[0m23:27:02.820261 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 23:27:01.888336 => 23:27:02.819870
[0m23:27:02.821044 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m23:27:02.932445 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 19 unexpected '~'.
  syntax error line 14 at position 38 unexpected 'date'.
  syntax error line 14 at position 44 unexpected 'as'.
  syntax error line 64 at position 44 unexpected 'snapshotted_data'.
[0m23:27:02.933603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61324a32-c28e-4b78-bbcb-f4b53c3d373a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2799f50ad0>]}
[0m23:27:02.935287 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 1.06s]
[0m23:27:02.936545 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:27:02.941187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:02.941852 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m23:27:02.942457 [info ] [MainThread]: 
[0m23:27:02.943390 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m23:27:02.945090 [debug] [MainThread]: Command end result
[0m23:27:02.962905 [info ] [MainThread]: 
[0m23:27:02.963953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:27:02.964828 [info ] [MainThread]: 
[0m23:27:02.965611 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 19 unexpected '~'.
  syntax error line 14 at position 38 unexpected 'date'.
  syntax error line 14 at position 44 unexpected 'as'.
  syntax error line 64 at position 44 unexpected 'snapshotted_data'.
[0m23:27:02.966541 [info ] [MainThread]: 
[0m23:27:02.967494 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:27:02.969673 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.3338375, "process_user_time": 5.800524, "process_kernel_time": 0.890585, "process_mem_max_rss": "219108", "process_out_blocks": "1746", "command_success": false, "process_in_blocks": "0"}
[0m23:27:02.970827 [debug] [MainThread]: Command `dbt snapshot` failed at 23:27:02.970563 after 4.34 seconds
[0m23:27:02.971535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27caa729f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c62261b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c699bc80>]}
[0m23:27:02.972285 [debug] [MainThread]: Flushing usage events
[0m23:29:22.526933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2b6e4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2bbecc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2bc0b620>]}


============================== 23:29:22.533462 | 6052f60a-d080-4fce-8748-77db0e81a2c2 ==============================
[0m23:29:22.533462 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:29:22.534339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:23.614952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6052f60a-d080-4fce-8748-77db0e81a2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e040e3c80>]}
[0m23:29:23.680758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6052f60a-d080-4fce-8748-77db0e81a2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0455c0b0>]}
[0m23:29:23.681636 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:29:23.693061 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:29:23.760161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:23.760966 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m23:29:23.870498 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  expected token ',', got 'strategy'
    line 6
      strategy='check',
[0m23:29:23.871733 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.400895, "process_user_time": 4.710392, "process_kernel_time": 0.919455, "process_mem_max_rss": "209608", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:29:23.872986 [debug] [MainThread]: Command `dbt snapshot` failed at 23:29:23.872417 after 1.40 seconds
[0m23:29:23.874007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2fe2e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dffdb2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dfff5bec0>]}
[0m23:29:23.874575 [debug] [MainThread]: Flushing usage events
[0m23:29:53.490143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8fe22090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf90214500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8fe215e0>]}


============================== 23:29:53.496918 | 664e1519-1eb9-4b68-b0ec-ceb9a99c1d51 ==============================
[0m23:29:53.496918 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:29:53.497640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:29:54.479997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '664e1519-1eb9-4b68-b0ec-ceb9a99c1d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf686a9d30>]}
[0m23:29:54.548325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '664e1519-1eb9-4b68-b0ec-ceb9a99c1d51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf68740620>]}
[0m23:29:54.549497 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:29:54.561615 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:29:54.633115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:54.634174 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m23:29:54.755745 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  expected token ',', got 'strategy'
    line 6
      strategy='check',
[0m23:29:54.757096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3138022, "process_user_time": 4.494702, "process_kernel_time": 0.776731, "process_mem_max_rss": "210232", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:29:54.757895 [debug] [MainThread]: Command `dbt run` failed at 23:29:54.757737 after 1.31 seconds
[0m23:29:54.758646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8fe22090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf68513da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6853ad50>]}
[0m23:29:54.759396 [debug] [MainThread]: Flushing usage events
[0m23:30:25.062044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf7c6f8c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf7ca441d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf7c6f9be0>]}


============================== 23:30:25.068776 | bebe7e8d-9e15-4de4-b5db-0bfac218f873 ==============================
[0m23:30:25.068776 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:30:25.069567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:30:26.076358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bebe7e8d-9e15-4de4-b5db-0bfac218f873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf55d08590>]}
[0m23:30:26.139146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bebe7e8d-9e15-4de4-b5db-0bfac218f873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6a1eeab0>]}
[0m23:30:26.140050 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:30:26.149235 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:30:26.200986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:30:26.201919 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m23:30:26.389414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bebe7e8d-9e15-4de4-b5db-0bfac218f873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf54bee420>]}
[0m23:30:26.408539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bebe7e8d-9e15-4de4-b5db-0bfac218f873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf54ca0200>]}
[0m23:30:26.409550 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:30:26.410919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bebe7e8d-9e15-4de4-b5db-0bfac218f873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf551e4110>]}
[0m23:30:26.413712 [info ] [MainThread]: 
[0m23:30:26.414927 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:30:26.416631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:30:26.437275 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:30:26.438055 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:30:26.438717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:26.917381 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:30:26.919326 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:30:27.065902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:30:27.078788 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:30:27.079587 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:30:27.080250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:27.454893 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:30:27.457513 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:30:27.604798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:30:27.609135 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:30:27.609908 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:30:27.610572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:28.467941 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:30:28.470904 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:30:28.593647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bebe7e8d-9e15-4de4-b5db-0bfac218f873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5554d880>]}
[0m23:30:28.595047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:30:28.595899 [info ] [MainThread]: 
[0m23:30:28.607946 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:30:28.609272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m23:30:28.610164 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:30:28.622161 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:30:28.626049 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:30:28.610754 => 23:30:28.625677
[0m23:30:28.627675 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:30:28.628623 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:30:28.629817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:30:28.630790 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:30:28.635121 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:30:28.638118 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:30:28.631340 => 23:30:28.637735
[0m23:30:28.639726 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:30:28.640598 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:30:28.641670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:30:28.642436 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:30:28.646906 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:30:28.649277 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:30:28.643077 => 23:30:28.648936
[0m23:30:28.650807 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:30:28.651625 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:30:28.652693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:30:28.653390 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:30:28.657395 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:30:28.660004 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:30:28.653842 => 23:30:28.659620
[0m23:30:28.661354 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:30:28.662165 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:30:28.663181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:30:28.663892 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:30:28.667615 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:30:28.669862 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:30:28.664352 => 23:30:28.669440
[0m23:30:28.671208 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:30:28.672815 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:30:28.673605 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:30:28.674666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:30:28.675282 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:30:28.687946 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:30:28.690622 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:30:28.675884 => 23:30:28.690287
[0m23:30:28.691255 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:30:28.735221 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:30:28.740161 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:30:28.740949 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:30:28.742016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:30.426839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m23:30:30.465650 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:30:28.691733 => 23:30:30.465267
[0m23:30:30.466589 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:30:30.576629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bebe7e8d-9e15-4de4-b5db-0bfac218f873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf54112000>]}
[0m23:30:30.577985 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.90s]
[0m23:30:30.579201 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:30:30.583173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:30.583984 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:30:30.584705 [info ] [MainThread]: 
[0m23:30:30.585539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m23:30:30.586922 [debug] [MainThread]: Command end result
[0m23:30:30.602901 [info ] [MainThread]: 
[0m23:30:30.603754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:30:30.604469 [info ] [MainThread]: 
[0m23:30:30.605171 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:30:30.606650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.593145, "process_user_time": 5.135397, "process_kernel_time": 0.799886, "process_mem_max_rss": "220044", "process_out_blocks": "2618", "process_in_blocks": "0"}
[0m23:30:30.607637 [debug] [MainThread]: Command `dbt run` succeeded at 23:30:30.607399 after 5.59 seconds
[0m23:30:30.608643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf80de69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5506c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf566d1670>]}
[0m23:30:30.609432 [debug] [MainThread]: Flushing usage events
[0m23:30:36.392710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3759bf650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3765e8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd375d0d1f0>]}


============================== 23:30:36.398637 | 5e503620-43af-4777-9735-7fc780c5f88a ==============================
[0m23:30:36.398637 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:30:36.399462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:30:37.445275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e503620-43af-4777-9735-7fc780c5f88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34eb9dc10>]}
[0m23:30:37.514170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e503620-43af-4777-9735-7fc780c5f88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34e234920>]}
[0m23:30:37.515033 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:30:37.524439 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:30:37.575551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:30:37.576302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:30:37.582691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e503620-43af-4777-9735-7fc780c5f88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34e1fb4d0>]}
[0m23:30:37.596012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e503620-43af-4777-9735-7fc780c5f88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34e100a10>]}
[0m23:30:37.596595 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:30:37.597129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e503620-43af-4777-9735-7fc780c5f88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34e69e600>]}
[0m23:30:37.598954 [info ] [MainThread]: 
[0m23:30:37.599436 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:30:37.600321 [debug] [MainThread]: Command end result
[0m23:30:37.612746 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.268916, "process_user_time": 4.530987, "process_kernel_time": 0.831239, "process_mem_max_rss": "208604", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m23:30:37.613567 [debug] [MainThread]: Command `dbt test` succeeded at 23:30:37.613329 after 1.27 seconds
[0m23:30:37.614199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3765e8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3510b3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34dff40e0>]}
[0m23:30:37.615108 [debug] [MainThread]: Flushing usage events
[0m23:30:43.395939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27eb0e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27eb0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27eb12e0>]}


============================== 23:30:43.401985 | e713b772-e734-47fd-b24e-234c354c253e ==============================
[0m23:30:43.401985 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:30:43.402720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:30:44.398456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e713b772-e734-47fd-b24e-234c354c253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a008a13d0>]}
[0m23:30:44.476238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e713b772-e734-47fd-b24e-234c354c253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a01eb5d90>]}
[0m23:30:44.477385 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:30:44.489091 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:30:44.555885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:30:44.556613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:30:44.564810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e713b772-e734-47fd-b24e-234c354c253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00dbc0b0>]}
[0m23:30:44.581841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e713b772-e734-47fd-b24e-234c354c253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a007e4b90>]}
[0m23:30:44.582609 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:30:44.583298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e713b772-e734-47fd-b24e-234c354c253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0bd1e0f0>]}
[0m23:30:44.586068 [info ] [MainThread]: 
[0m23:30:44.587624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:30:44.589244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:30:44.609456 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:30:44.610273 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:30:44.610969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:45.270103 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:30:45.273520 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:30:45.388004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m23:30:45.401617 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:30:45.402507 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:30:45.403167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:45.802864 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:30:45.805950 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:30:45.919628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m23:30:45.922592 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:30:45.923069 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:30:45.923515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:46.781446 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:30:46.784856 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:30:46.900927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e713b772-e734-47fd-b24e-234c354c253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0bd1c350>]}
[0m23:30:46.902348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:30:46.903311 [info ] [MainThread]: 
[0m23:30:46.919990 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:30:46.921622 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:30:46.923894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m23:30:46.924930 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m23:30:46.940921 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 23:30:46.926100 => 23:30:46.940329
[0m23:30:46.941924 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m23:30:47.031827 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:47.032520 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m23:30:47.033217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:47.904644 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m23:30:47.920445 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:47.921747 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:30:48.001744 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:30:48.013337 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:48.015163 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:30:48.135307 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:30:48.189530 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:48.191371 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:30:49.524841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:30:49.529923 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:49.530753 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:30:49.606067 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:30:49.614291 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:49.615211 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:30:49.729241 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:30:49.736197 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:49.741569 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:30:49.841319 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:30:49.847501 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:49.848375 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:30:49.955754 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:30:49.967432 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:49.968338 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:30:50.061343 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:30:50.075033 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:50.082323 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:50.083193 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m23:30:50.226837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:30:50.227875 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:30:50.228952 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m23:30:51.024243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbde82-0305-0be2-0004-59ff0029fe5e
[0m23:30:51.025310 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m23:30:51.026669 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 23:30:46.942903 => 23:30:51.026196
[0m23:30:51.027586 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m23:30:51.177748 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m23:30:51.178740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e713b772-e734-47fd-b24e-234c354c253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0036a4e0>]}
[0m23:30:51.180144 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 4.26s]
[0m23:30:51.181548 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:30:51.186083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:51.186774 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m23:30:51.187543 [info ] [MainThread]: 
[0m23:30:51.188336 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m23:30:51.189733 [debug] [MainThread]: Command end result
[0m23:30:51.205009 [info ] [MainThread]: 
[0m23:30:51.205878 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:30:51.206584 [info ] [MainThread]: 
[0m23:30:51.207267 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m23:30:51.208030 [info ] [MainThread]: 
[0m23:30:51.208825 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:30:51.210241 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.861733, "process_user_time": 5.087161, "process_kernel_time": 0.830875, "process_mem_max_rss": "218772", "process_out_blocks": "1755", "command_success": false, "process_in_blocks": "0"}
[0m23:30:51.211280 [debug] [MainThread]: Command `dbt snapshot` failed at 23:30:51.211094 after 7.86 seconds
[0m23:30:51.212041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a28116510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a283f8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a283f85f0>]}
[0m23:30:51.212708 [debug] [MainThread]: Flushing usage events
[0m23:35:51.493261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78001a0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78001a38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78001a0c80>]}


============================== 23:35:51.500660 | 739a8f2a-dca8-4dfd-b2e6-c0c2eabfea19 ==============================
[0m23:35:51.500660 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:35:51.501451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:35:52.833472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '739a8f2a-dca8-4dfd-b2e6-c0c2eabfea19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f33f2150>]}
[0m23:35:52.909179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '739a8f2a-dca8-4dfd-b2e6-c0c2eabfea19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77daa6e000>]}
[0m23:35:52.910396 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:35:52.922737 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:35:53.001387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:35:53.001954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:35:53.009110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '739a8f2a-dca8-4dfd-b2e6-c0c2eabfea19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d88a5880>]}
[0m23:35:53.024442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '739a8f2a-dca8-4dfd-b2e6-c0c2eabfea19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d891fd70>]}
[0m23:35:53.025113 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:35:53.025723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '739a8f2a-dca8-4dfd-b2e6-c0c2eabfea19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d919d970>]}
[0m23:35:53.028267 [info ] [MainThread]: 
[0m23:35:53.030446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:35:53.033817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:35:53.064062 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:35:53.064797 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:35:53.065529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:53.762560 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:35:53.765210 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:35:53.993731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m23:35:54.008217 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:35:54.009070 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:35:54.009754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:54.345239 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:54.347954 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:35:54.473252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m23:35:54.477047 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:35:54.477701 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:35:54.478423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:54.817763 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:54.820785 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:35:54.935763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '739a8f2a-dca8-4dfd-b2e6-c0c2eabfea19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77da3cdee0>]}
[0m23:35:54.937492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:54.938343 [info ] [MainThread]: 
[0m23:35:54.950793 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:35:54.952149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m23:35:54.952902 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:35:54.964482 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:35:54.969020 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:35:54.953500 => 23:35:54.968516
[0m23:35:54.970826 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:35:54.971761 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:35:54.972922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:35:54.973780 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:35:54.978269 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:35:54.980925 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:35:54.974435 => 23:35:54.980560
[0m23:35:54.982487 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:35:54.983305 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:35:54.984419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:35:54.985088 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:35:54.989189 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:35:54.991537 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:35:54.985558 => 23:35:54.991177
[0m23:35:54.992902 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:35:54.993766 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:35:54.994890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:35:54.995615 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:35:54.999573 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:35:55.002668 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:35:54.996085 => 23:35:55.002338
[0m23:35:55.003963 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:35:55.004826 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:35:55.006190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:35:55.006847 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:35:55.010621 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:35:55.012793 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:35:55.007369 => 23:35:55.012482
[0m23:35:55.014265 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:35:55.015527 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:35:55.016649 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:35:55.017703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:35:55.018360 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:35:55.029931 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:35:55.032792 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:35:55.018775 => 23:35:55.032459
[0m23:35:55.033530 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:35:55.071499 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:35:55.076516 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:35:55.077275 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:35:55.078090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:56.363760 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:56.403500 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:35:55.034009 => 23:35:56.403148
[0m23:35:56.404527 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:35:56.524854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739a8f2a-dca8-4dfd-b2e6-c0c2eabfea19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d843d4f0>]}
[0m23:35:56.526073 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.51s]
[0m23:35:56.527297 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:35:56.531050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:56.531986 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:35:56.533216 [info ] [MainThread]: 
[0m23:35:56.534814 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m23:35:56.536849 [debug] [MainThread]: Command end result
[0m23:35:56.557977 [info ] [MainThread]: 
[0m23:35:56.559155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:35:56.559927 [info ] [MainThread]: 
[0m23:35:56.560846 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:35:56.562593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.129853, "process_user_time": 6.345725, "process_kernel_time": 0.561797, "process_mem_max_rss": "217088", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m23:35:56.563496 [debug] [MainThread]: Command `dbt run` succeeded at 23:35:56.563290 after 5.13 seconds
[0m23:35:56.564193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7804902a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78004a5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7800199a60>]}
[0m23:35:56.564893 [debug] [MainThread]: Flushing usage events
[0m23:36:02.422416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464dfa9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464e4f4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464dfab3b0>]}


============================== 23:36:02.428723 | b4fe183e-a626-4784-803d-4eeeb3e2175d ==============================
[0m23:36:02.428723 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:36:02.429533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:36:03.549931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4fe183e-a626-4784-803d-4eeeb3e2175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46229fff80>]}
[0m23:36:03.623601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4fe183e-a626-4784-803d-4eeeb3e2175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464f282030>]}
[0m23:36:03.624518 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:36:03.634951 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:36:03.694691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:03.695412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:03.703095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4fe183e-a626-4784-803d-4eeeb3e2175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4633f93530>]}
[0m23:36:03.719184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4fe183e-a626-4784-803d-4eeeb3e2175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4622917fe0>]}
[0m23:36:03.719870 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:36:03.720633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4fe183e-a626-4784-803d-4eeeb3e2175d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4622991460>]}
[0m23:36:03.723032 [info ] [MainThread]: 
[0m23:36:03.724101 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:36:03.725134 [debug] [MainThread]: Command end result
[0m23:36:03.738639 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3643755, "process_user_time": 4.918315, "process_kernel_time": 0.772817, "process_mem_max_rss": "208688", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m23:36:03.739526 [debug] [MainThread]: Command `dbt test` succeeded at 23:36:03.739343 after 1.37 seconds
[0m23:36:03.740385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4652882a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4623728ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4633faad50>]}
[0m23:36:03.741139 [debug] [MainThread]: Flushing usage events
[0m23:36:10.408423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016d80cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016d87b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f016d80cce0>]}


============================== 23:36:10.416855 | c64f6f34-8db7-4899-af93-3493eec6ecee ==============================
[0m23:36:10.416855 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:36:10.417883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:36:11.562753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c64f6f34-8db7-4899-af93-3493eec6ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01479f6090>]}
[0m23:36:11.633741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c64f6f34-8db7-4899-af93-3493eec6ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01476858e0>]}
[0m23:36:11.634965 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:36:11.646064 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:36:11.698603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:11.699170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:11.705910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c64f6f34-8db7-4899-af93-3493eec6ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01461ea3f0>]}
[0m23:36:11.720484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c64f6f34-8db7-4899-af93-3493eec6ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0145f5bc80>]}
[0m23:36:11.721209 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:36:11.722588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c64f6f34-8db7-4899-af93-3493eec6ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01639f6c30>]}
[0m23:36:11.725429 [info ] [MainThread]: 
[0m23:36:11.726671 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:36:11.728240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:36:11.746933 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:36:11.747610 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:36:11.748234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:12.304208 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:36:12.307004 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:36:12.421564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:36:12.435580 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:36:12.436467 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:36:12.437166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:12.783812 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:12.786357 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:36:12.918413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:36:12.922577 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:36:12.923428 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:36:12.924092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:13.298332 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:13.301276 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:36:13.420151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c64f6f34-8db7-4899-af93-3493eec6ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014600be60>]}
[0m23:36:13.421937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:36:13.422729 [info ] [MainThread]: 
[0m23:36:13.434538 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:36:13.435569 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:36:13.436826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m23:36:13.437865 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m23:36:13.450485 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 23:36:13.438422 => 23:36:13.450047
[0m23:36:13.451377 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m23:36:13.557050 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:13.558264 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m23:36:13.559248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:14.045193 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:36:14.059354 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:14.060650 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:36:14.137134 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:36:14.148724 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:14.150073 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:36:14.230206 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:36:14.279495 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:14.280980 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:36:15.319390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:15.324655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:15.325555 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:36:15.507115 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:36:15.514895 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:15.515785 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:36:15.597025 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:36:15.602889 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:15.603747 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:36:15.691227 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:36:15.697861 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:15.698737 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:36:15.776940 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:36:15.788823 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:15.790265 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:36:15.869732 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:36:15.890601 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:15.895564 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:15.896593 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m23:36:16.003062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:16.004243 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:36:16.005250 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m23:36:16.436992 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbde88-0305-0be2-0004-59ff0029ff1e
[0m23:36:16.438275 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m23:36:16.439971 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 23:36:13.451915 => 23:36:16.439571
[0m23:36:16.440906 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m23:36:16.565171 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m23:36:16.566209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c64f6f34-8db7-4899-af93-3493eec6ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01452e4f50>]}
[0m23:36:16.567794 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 3.13s]
[0m23:36:16.568943 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:36:16.573705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:16.574397 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m23:36:16.575058 [info ] [MainThread]: 
[0m23:36:16.575866 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m23:36:16.577234 [debug] [MainThread]: Command end result
[0m23:36:16.592990 [info ] [MainThread]: 
[0m23:36:16.593954 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:36:16.594852 [info ] [MainThread]: 
[0m23:36:16.595656 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/lab2_dbt/snapshots/snapshot_session_summary.sql
[0m23:36:16.596403 [info ] [MainThread]: 
[0m23:36:16.597033 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:36:16.598829 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.2551827, "process_user_time": 5.89193, "process_kernel_time": 0.773655, "process_mem_max_rss": "218964", "process_out_blocks": "1755", "command_success": false, "process_in_blocks": "0"}
[0m23:36:16.600053 [debug] [MainThread]: Command `dbt snapshot` failed at 23:36:16.599842 after 6.26 seconds
[0m23:36:16.600933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0171ef69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0171cf2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0145eb7200>]}
[0m23:36:16.601770 [debug] [MainThread]: Flushing usage events
[0m23:39:22.866877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6e2018e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dd9ad040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6df7f40e0>]}


============================== 23:39:22.875284 | 5c447d63-ca87-46d6-bbf6-630da7141946 ==============================
[0m23:39:22.875284 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:39:22.876544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:39:24.102288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c447d63-ca87-46d6-bbf6-630da7141946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b620bf80>]}
[0m23:39:24.188311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c447d63-ca87-46d6-bbf6-630da7141946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6ded8bbf0>]}
[0m23:39:24.189579 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:39:24.201668 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:39:24.267587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:24.268291 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:24.276290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c447d63-ca87-46d6-bbf6-630da7141946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b93c4e90>]}
[0m23:39:24.297586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c447d63-ca87-46d6-bbf6-630da7141946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b6018b90>]}
[0m23:39:24.298468 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:39:24.299640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c447d63-ca87-46d6-bbf6-630da7141946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b6ee47a0>]}
[0m23:39:24.302389 [info ] [MainThread]: 
[0m23:39:24.303673 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:39:24.305540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:39:24.326313 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:39:24.327174 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:39:24.327953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:24.933604 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:39:24.936349 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:39:25.127165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m23:39:25.139371 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:39:25.140149 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:39:25.140834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:25.578916 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:39:25.581456 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:39:25.698439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m23:39:25.702833 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:39:25.703566 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:39:25.704192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:26.064957 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:39:26.067570 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:39:26.190988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c447d63-ca87-46d6-bbf6-630da7141946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b61a4bf0>]}
[0m23:39:26.192382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:39:26.193202 [info ] [MainThread]: 
[0m23:39:26.207759 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:39:26.209004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m23:39:26.209775 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:39:26.221980 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:39:26.225879 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:39:26.210366 => 23:39:26.225450
[0m23:39:26.227675 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:39:26.228648 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:39:26.229836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:39:26.230608 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:39:26.236851 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:39:26.239722 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:39:26.231214 => 23:39:26.239324
[0m23:39:26.241215 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:39:26.242113 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:39:26.243274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:39:26.244087 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:39:26.248484 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:39:26.251569 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:39:26.244650 => 23:39:26.251047
[0m23:39:26.253140 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:39:26.254017 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:39:26.255125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:39:26.255903 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:39:26.260432 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:39:26.263082 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:39:26.256474 => 23:39:26.262690
[0m23:39:26.264550 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:39:26.265454 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:39:26.266809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:39:26.267809 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:39:26.275422 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:39:26.278042 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:39:26.268809 => 23:39:26.277570
[0m23:39:26.279744 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:39:26.281611 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:39:26.282541 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:39:26.283990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:39:26.285566 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:39:26.299682 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:39:26.303306 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:39:26.286192 => 23:39:26.302863
[0m23:39:26.304144 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:39:26.352001 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:39:26.358184 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:39:26.359271 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:39:26.360568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:27.603662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:39:27.640298 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:39:26.304707 => 23:39:27.639955
[0m23:39:27.641208 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:39:27.753284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c447d63-ca87-46d6-bbf6-630da7141946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b5523fb0>]}
[0m23:39:27.754536 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.47s]
[0m23:39:27.755812 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:39:27.759151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:27.759866 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:39:27.760491 [info ] [MainThread]: 
[0m23:39:27.761245 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m23:39:27.762840 [debug] [MainThread]: Command end result
[0m23:39:27.783069 [info ] [MainThread]: 
[0m23:39:27.784000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:27.784706 [info ] [MainThread]: 
[0m23:39:27.785475 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:39:27.788243 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.96732, "process_user_time": 6.25321, "process_kernel_time": 0.913512, "process_mem_max_rss": "217080", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m23:39:27.790516 [debug] [MainThread]: Command `dbt run` succeeded at 23:39:27.790016 after 4.97 seconds
[0m23:39:27.791606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dddc97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b5f0ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dd98e2a0>]}
[0m23:39:27.792680 [debug] [MainThread]: Flushing usage events
[0m23:39:33.425257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6699d289b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6699d2a060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6699d28b90>]}


============================== 23:39:33.431118 | e9bd7643-bc33-4c4d-85f6-d40339c3dbd1 ==============================
[0m23:39:33.431118 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:39:33.431929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:39:34.474580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9bd7643-bc33-4c4d-85f6-d40339c3dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6674ba2090>]}
[0m23:39:34.556246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9bd7643-bc33-4c4d-85f6-d40339c3dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6699d31dc0>]}
[0m23:39:34.557343 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:39:34.568294 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:39:34.620669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:34.621271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:34.628021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9bd7643-bc33-4c4d-85f6-d40339c3dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666ec40080>]}
[0m23:39:34.641751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9bd7643-bc33-4c4d-85f6-d40339c3dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666e4e8170>]}
[0m23:39:34.642429 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:39:34.643173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9bd7643-bc33-4c4d-85f6-d40339c3dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666fbfe2d0>]}
[0m23:39:34.645284 [info ] [MainThread]: 
[0m23:39:34.646023 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:39:34.646966 [debug] [MainThread]: Command end result
[0m23:39:34.660232 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2817433, "process_user_time": 4.697124, "process_kernel_time": 0.847522, "process_mem_max_rss": "209768", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m23:39:34.661322 [debug] [MainThread]: Command `dbt test` succeeded at 23:39:34.661147 after 1.28 seconds
[0m23:39:34.662048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f669a24ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666f188a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f668b788b90>]}
[0m23:39:34.662631 [debug] [MainThread]: Flushing usage events
[0m23:39:40.704268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f4d867e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f5280c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f4d87170>]}


============================== 23:39:40.711765 | a9779677-2e88-4999-8184-5322e7d65f1d ==============================
[0m23:39:40.711765 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:39:40.712805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:39:41.709375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9779677-2e88-4999-8184-5322e7d65f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d0738ce0>]}
[0m23:39:41.778145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9779677-2e88-4999-8184-5322e7d65f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f1562750>]}
[0m23:39:41.779018 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:39:41.788374 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:39:41.836605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:41.837137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:41.843441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9779677-2e88-4999-8184-5322e7d65f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd77b530>]}
[0m23:39:41.858190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9779677-2e88-4999-8184-5322e7d65f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd6c0590>]}
[0m23:39:41.858777 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:39:41.859353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9779677-2e88-4999-8184-5322e7d65f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cde07e30>]}
[0m23:39:41.861622 [info ] [MainThread]: 
[0m23:39:41.862926 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:39:41.864530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:39:41.880100 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:39:41.880804 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:39:41.881324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:42.383892 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:39:42.386962 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:39:42.500412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:39:42.514241 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:39:42.515058 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:39:42.515776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:42.903345 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:39:42.906632 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:39:43.022488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:39:43.026500 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:39:43.027296 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:39:43.027990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:43.419821 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:39:43.422966 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:39:43.544750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9779677-2e88-4999-8184-5322e7d65f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ce3cf950>]}
[0m23:39:43.546262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:39:43.547257 [info ] [MainThread]: 
[0m23:39:43.559388 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:39:43.560422 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:39:43.561862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m23:39:43.562756 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m23:39:43.576804 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 23:39:43.563347 => 23:39:43.576344
[0m23:39:43.577696 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m23:39:43.655664 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:43.656290 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m23:39:43.656989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:44.178514 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m23:39:44.193473 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:44.194847 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:39:44.285699 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:39:44.297537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:44.298610 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:39:44.392390 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:39:44.449010 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:44.450922 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:39:45.420324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:39:45.425020 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:45.425872 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:39:45.512540 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:39:45.519878 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:45.520815 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:39:45.610439 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:39:45.617056 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:45.617933 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:39:45.718565 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:39:45.726070 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:45.726935 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:39:45.793292 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:39:45.804450 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:45.805360 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:39:45.910110 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:39:45.923166 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:45.927780 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:45.928565 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m23:39:46.017664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:39:46.018850 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:46.019910 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m23:39:46.761813 [debug] [Thread-1 (]: SQL status: SUCCESS 1110 in 1.0 seconds
[0m23:39:46.763208 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:39:46.764269 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m23:39:47.099773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:39:47.140758 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 23:39:43.578261 => 23:39:47.140073
[0m23:39:47.141669 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m23:39:47.267612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9779677-2e88-4999-8184-5322e7d65f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cca701a0>]}
[0m23:39:47.269475 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 1110[0m in 3.71s]
[0m23:39:47.271143 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:39:47.274674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:47.275371 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m23:39:47.276100 [info ] [MainThread]: 
[0m23:39:47.276957 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m23:39:47.278186 [debug] [MainThread]: Command end result
[0m23:39:47.294471 [info ] [MainThread]: 
[0m23:39:47.295353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:47.296202 [info ] [MainThread]: 
[0m23:39:47.297008 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:39:47.298361 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.653477, "process_user_time": 5.738778, "process_kernel_time": 0.805971, "process_mem_max_rss": "217240", "process_out_blocks": "1754", "process_in_blocks": "0"}
[0m23:39:47.300233 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:39:47.299816 after 6.66 seconds
[0m23:39:47.301189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f5280c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f5a727e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f502c230>]}
[0m23:39:47.302045 [debug] [MainThread]: Flushing usage events
[0m23:45:17.000464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae07c8cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0818ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae07c8d220>]}


============================== 23:45:17.007403 | 5ec49243-6b26-4a99-a024-aa75f455c4f6 ==============================
[0m23:45:17.007403 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:45:17.008144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:45:18.041396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ec49243-6b26-4a99-a024-aa75f455c4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade068fe90>]}
[0m23:45:18.104089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ec49243-6b26-4a99-a024-aa75f455c4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade3774860>]}
[0m23:45:18.105084 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:45:18.113912 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:45:18.171627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:18.172349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:18.178634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ec49243-6b26-4a99-a024-aa75f455c4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade068d7c0>]}
[0m23:45:18.194632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ec49243-6b26-4a99-a024-aa75f455c4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade05e7b30>]}
[0m23:45:18.195376 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:45:18.195950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec49243-6b26-4a99-a024-aa75f455c4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade050bdd0>]}
[0m23:45:18.198491 [info ] [MainThread]: 
[0m23:45:18.200379 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:18.201936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:45:18.220753 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:45:18.221522 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:45:18.222214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:19.086740 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:45:19.089680 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:45:19.419437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:45:19.432489 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:45:19.433263 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:45:19.433992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:19.800668 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:45:19.803726 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:45:19.958886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:45:19.963564 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:45:19.964531 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:45:19.965269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:20.414756 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:45:20.417723 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:45:20.576879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec49243-6b26-4a99-a024-aa75f455c4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade36d2de0>]}
[0m23:45:20.578427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:20.579180 [info ] [MainThread]: 
[0m23:45:20.591676 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:45:20.593081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m23:45:20.593936 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:45:20.606083 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:45:20.610131 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:45:20.594465 => 23:45:20.609632
[0m23:45:20.611593 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:45:20.612520 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:45:20.613766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:45:20.614539 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:45:20.619167 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:45:20.622251 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:45:20.615119 => 23:45:20.621832
[0m23:45:20.623831 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:45:20.624677 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:45:20.625964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:45:20.626670 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:45:20.631503 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:45:20.634522 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:45:20.627288 => 23:45:20.634019
[0m23:45:20.636145 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:45:20.637060 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:45:20.638238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:45:20.638979 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:45:20.643397 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:45:20.645992 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:45:20.639501 => 23:45:20.645485
[0m23:45:20.647561 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:45:20.648590 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:45:20.649965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:45:20.650651 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:45:20.654857 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:45:20.657355 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:45:20.651225 => 23:45:20.656993
[0m23:45:20.658659 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:45:20.660024 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:45:20.660946 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:45:20.662187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:45:20.662849 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:45:20.674933 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:45:20.677971 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:45:20.663293 => 23:45:20.677531
[0m23:45:20.678653 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:45:20.720844 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:45:20.725756 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:45:20.726532 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:45:20.727355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:22.018782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:45:22.053803 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:45:20.679213 => 23:45:22.053460
[0m23:45:22.054945 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:45:22.175596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ec49243-6b26-4a99-a024-aa75f455c4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade0544290>]}
[0m23:45:22.176691 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.51s]
[0m23:45:22.178009 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:45:22.181201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:22.181877 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:45:22.182538 [info ] [MainThread]: 
[0m23:45:22.183362 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m23:45:22.184656 [debug] [MainThread]: Command end result
[0m23:45:22.202316 [info ] [MainThread]: 
[0m23:45:22.203075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:22.203967 [info ] [MainThread]: 
[0m23:45:22.204693 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:45:22.206142 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.260359, "process_user_time": 5.116567, "process_kernel_time": 0.782932, "process_mem_max_rss": "217136", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m23:45:22.207043 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:22.206847 after 5.26 seconds
[0m23:45:22.207892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0c5daa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade0b8fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae07c891f0>]}
[0m23:45:22.208617 [debug] [MainThread]: Flushing usage events
[0m23:45:27.515583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486d29c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486d29c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486d29c7a0>]}


============================== 23:45:27.522804 | 3ace92a9-b2a5-48d8-b342-952e43054c2d ==============================
[0m23:45:27.522804 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:45:27.523715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:45:28.572471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ace92a9-b2a5-48d8-b342-952e43054c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4845e941d0>]}
[0m23:45:28.644069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ace92a9-b2a5-48d8-b342-952e43054c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f484641d940>]}
[0m23:45:28.645020 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:45:28.654497 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:45:28.703206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:28.704005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:28.710683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ace92a9-b2a5-48d8-b342-952e43054c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48459b2150>]}
[0m23:45:28.726208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ace92a9-b2a5-48d8-b342-952e43054c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4845a04110>]}
[0m23:45:28.726894 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:45:28.727560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ace92a9-b2a5-48d8-b342-952e43054c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4845bfb860>]}
[0m23:45:28.729973 [info ] [MainThread]: 
[0m23:45:28.730819 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:45:28.731980 [debug] [MainThread]: Command end result
[0m23:45:28.746021 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2864854, "process_user_time": 4.636592, "process_kernel_time": 0.729043, "process_mem_max_rss": "208924", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m23:45:28.746913 [debug] [MainThread]: Command `dbt test` succeeded at 23:45:28.746751 after 1.29 seconds
[0m23:45:28.747554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487198aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4845f8acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4845e32810>]}
[0m23:45:28.748337 [debug] [MainThread]: Flushing usage events
[0m23:45:33.868370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f523a0024b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f523a6228a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f523a33fa70>]}


============================== 23:45:33.874865 | e873bd27-cdd2-4bbf-97b2-2bb367bc68ca ==============================
[0m23:45:33.874865 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:45:33.875767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:35.000952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e873bd27-cdd2-4bbf-97b2-2bb367bc68ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520f139820>]}
[0m23:45:35.064089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e873bd27-cdd2-4bbf-97b2-2bb367bc68ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52147e5550>]}
[0m23:45:35.065527 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:45:35.075024 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:45:35.123446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:35.124022 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:35.130446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e873bd27-cdd2-4bbf-97b2-2bb367bc68ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5214709fd0>]}
[0m23:45:35.145902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e873bd27-cdd2-4bbf-97b2-2bb367bc68ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520e5901a0>]}
[0m23:45:35.146539 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:45:35.147204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e873bd27-cdd2-4bbf-97b2-2bb367bc68ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520ef5e0f0>]}
[0m23:45:35.150264 [info ] [MainThread]: 
[0m23:45:35.151480 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:35.153017 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:45:35.172067 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:45:35.172853 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:45:35.173451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:35.732992 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:45:35.735520 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:45:35.861440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:45:35.875306 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:45:35.876094 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:45:35.876770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:36.269626 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:45:36.272088 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:45:36.394169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:45:36.398503 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:45:36.399235 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:45:36.399973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:36.724360 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:45:36.727383 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:45:36.847770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e873bd27-cdd2-4bbf-97b2-2bb367bc68ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520e85f020>]}
[0m23:45:36.849659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:36.850534 [info ] [MainThread]: 
[0m23:45:36.862702 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:45:36.863695 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:45:36.865148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m23:45:36.866005 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m23:45:36.879960 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 23:45:36.866550 => 23:45:36.879514
[0m23:45:36.880773 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m23:45:36.965874 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:36.966739 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m23:45:36.967341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:37.443456 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:45:37.459101 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:37.460362 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:45:37.535144 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:45:37.546391 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:37.547270 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:45:37.619755 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:45:37.675298 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:37.677215 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:45:38.860318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:45:38.865475 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:38.866340 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:45:38.943314 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:45:38.950014 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:38.950962 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:45:39.032742 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:45:39.039819 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:39.040678 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:45:39.141648 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:45:39.149532 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:39.150368 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:45:39.241612 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:45:39.253905 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:39.255265 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:45:39.343172 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:45:39.356101 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:39.360574 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:39.361362 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m23:45:39.479217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:45:39.480349 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:39.481700 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m23:45:40.260060 [debug] [Thread-1 (]: SQL status: SUCCESS 1110 in 1.0 seconds
[0m23:45:40.261616 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:45:40.262721 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m23:45:40.548121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:45:40.582704 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 23:45:36.881460 => 23:45:40.582349
[0m23:45:40.583607 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m23:45:40.705779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e873bd27-cdd2-4bbf-97b2-2bb367bc68ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520da96150>]}
[0m23:45:40.707453 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 1110[0m in 3.84s]
[0m23:45:40.708691 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:45:40.712323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:40.712987 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m23:45:40.713698 [info ] [MainThread]: 
[0m23:45:40.714644 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m23:45:40.716265 [debug] [MainThread]: Command end result
[0m23:45:40.731359 [info ] [MainThread]: 
[0m23:45:40.732235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:40.733006 [info ] [MainThread]: 
[0m23:45:40.733692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:45:40.735090 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.920221, "process_user_time": 5.349837, "process_kernel_time": 0.809086, "process_mem_max_rss": "217564", "process_out_blocks": "1754", "process_in_blocks": "0"}
[0m23:45:40.735960 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:45:40.735707 after 6.92 seconds
[0m23:45:40.736930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f523a33fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f523a5fa840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521471e960>]}
[0m23:45:40.737901 [debug] [MainThread]: Flushing usage events
[0m23:51:38.201003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c68c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c68eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c68ca40>]}


============================== 23:51:38.208057 | 5dcf9f57-1828-467a-985c-14b189afa7f4 ==============================
[0m23:51:38.208057 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:51:38.209216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:51:39.248119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dcf9f57-1828-467a-985c-14b189afa7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c681b20>]}
[0m23:51:39.308437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dcf9f57-1828-467a-985c-14b189afa7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7251a72c0>]}
[0m23:51:39.309337 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:51:39.318572 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:51:39.376171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:39.376703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:39.383150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dcf9f57-1828-467a-985c-14b189afa7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa724d6e000>]}
[0m23:51:39.400989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dcf9f57-1828-467a-985c-14b189afa7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa724de7b30>]}
[0m23:51:39.402144 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:51:39.403219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dcf9f57-1828-467a-985c-14b189afa7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7254e2900>]}
[0m23:51:39.405988 [info ] [MainThread]: 
[0m23:51:39.407459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:51:39.409068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:51:39.429343 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:51:39.430046 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:51:39.430661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:39.929229 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:51:39.932332 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:51:40.044665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:51:40.057735 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:51:40.058479 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:51:40.059266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:40.416462 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:51:40.419338 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:51:40.533171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:51:40.537533 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:51:40.538427 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:51:40.539069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:40.853050 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:51:40.855359 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:51:40.975019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dcf9f57-1828-467a-985c-14b189afa7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa730391730>]}
[0m23:51:40.976608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:51:40.977993 [info ] [MainThread]: 
[0m23:51:40.989592 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:51:40.990717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m23:51:40.991523 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:51:41.003095 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:51:41.007638 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:51:40.992062 => 23:51:41.007188
[0m23:51:41.009153 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:51:41.009966 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:51:41.011155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:51:41.012100 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:51:41.016348 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:51:41.019219 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:51:41.012647 => 23:51:41.018793
[0m23:51:41.020588 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:51:41.021329 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:51:41.022287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:51:41.022978 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:51:41.026813 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:51:41.029344 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:51:41.023410 => 23:51:41.029005
[0m23:51:41.030635 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:51:41.031381 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:51:41.032345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:51:41.032992 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:51:41.036725 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:51:41.038663 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:51:41.033423 => 23:51:41.038375
[0m23:51:41.039903 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:51:41.040969 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:51:41.041978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:51:41.042625 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:51:41.046265 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:51:41.048460 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:51:41.043051 => 23:51:41.048151
[0m23:51:41.049599 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:51:41.050821 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:51:41.051671 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:51:41.052672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:51:41.053360 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:51:41.064417 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:51:41.067799 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:51:41.053798 => 23:51:41.067387
[0m23:51:41.068588 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:51:41.104619 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:51:41.110142 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:51:41.111094 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:51:41.112118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:42.435434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:51:42.471527 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:51:41.069105 => 23:51:42.471175
[0m23:51:42.472381 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:51:42.589483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dcf9f57-1828-467a-985c-14b189afa7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa724150500>]}
[0m23:51:42.590641 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.54s]
[0m23:51:42.592209 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:51:42.595771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:42.596571 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:51:42.597372 [info ] [MainThread]: 
[0m23:51:42.598172 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m23:51:42.599992 [debug] [MainThread]: Command end result
[0m23:51:42.619032 [info ] [MainThread]: 
[0m23:51:42.620231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:42.621304 [info ] [MainThread]: 
[0m23:51:42.622719 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:51:42.624720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4761868, "process_user_time": 4.919054, "process_kernel_time": 0.750542, "process_mem_max_rss": "217428", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m23:51:42.626035 [debug] [MainThread]: Command `dbt run` succeeded at 23:51:42.625728 after 4.48 seconds
[0m23:51:42.626742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa750d7ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa725cb96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa742786cc0>]}
[0m23:51:42.627682 [debug] [MainThread]: Flushing usage events
[0m23:51:49.111043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e5e9ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e62c9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e64c2f60>]}


============================== 23:51:49.119607 | 8748231a-4430-4cb9-9ce6-19b68b7c6fec ==============================
[0m23:51:49.119607 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:51:49.120639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:51:50.403234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8748231a-4430-4cb9-9ce6-19b68b7c6fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ba7280b0>]}
[0m23:51:50.494779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8748231a-4430-4cb9-9ce6-19b68b7c6fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e2556150>]}
[0m23:51:50.496062 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:51:50.508224 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:51:50.576417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:50.577118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:50.585212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8748231a-4430-4cb9-9ce6-19b68b7c6fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c0da50a0>]}
[0m23:51:50.602708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8748231a-4430-4cb9-9ce6-19b68b7c6fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ba650410>]}
[0m23:51:50.603574 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:51:50.604443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8748231a-4430-4cb9-9ce6-19b68b7c6fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1baa69820>]}
[0m23:51:50.607135 [info ] [MainThread]: 
[0m23:51:50.607798 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:51:50.608783 [debug] [MainThread]: Command end result
[0m23:51:50.622311 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5798466, "process_user_time": 5.422225, "process_kernel_time": 0.743159, "process_mem_max_rss": "209528", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m23:51:50.623373 [debug] [MainThread]: Command `dbt test` succeeded at 23:51:50.623185 after 1.58 seconds
[0m23:51:50.624129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea656a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e61ec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1bbe762d0>]}
[0m23:51:50.625144 [debug] [MainThread]: Flushing usage events
[0m23:51:55.450560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e115cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e11fdca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e115c5c0>]}


============================== 23:51:55.456457 | 714a01cc-5a17-4bcb-9ae6-019722ad18fc ==============================
[0m23:51:55.456457 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:51:55.457136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:51:56.371145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '714a01cc-5a17-4bcb-9ae6-019722ad18fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d937e4e0>]}
[0m23:51:56.429718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '714a01cc-5a17-4bcb-9ae6-019722ad18fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b98f2630>]}
[0m23:51:56.430536 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:51:56.439060 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:51:56.485297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:56.485871 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:56.492121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '714a01cc-5a17-4bcb-9ae6-019722ad18fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b9860740>]}
[0m23:51:56.504954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '714a01cc-5a17-4bcb-9ae6-019722ad18fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b9700320>]}
[0m23:51:56.505502 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:51:56.506399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714a01cc-5a17-4bcb-9ae6-019722ad18fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b9c9d160>]}
[0m23:51:56.508188 [info ] [MainThread]: 
[0m23:51:56.509678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:51:56.511944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:51:56.528248 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:51:56.528899 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:51:56.529409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:57.048080 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:51:57.051168 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:51:57.170584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m23:51:57.184109 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:51:57.184927 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:51:57.185634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:57.545308 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:51:57.548150 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:51:57.685025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m23:51:57.689137 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:51:57.690067 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:51:57.690796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:58.056380 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:51:58.059406 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:51:58.199557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714a01cc-5a17-4bcb-9ae6-019722ad18fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b97d8e30>]}
[0m23:51:58.201178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:51:58.202406 [info ] [MainThread]: 
[0m23:51:58.227180 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:51:58.258520 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:51:58.279838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m23:51:58.282361 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m23:51:58.307311 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 23:51:58.283255 => 23:51:58.306810
[0m23:51:58.308285 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m23:51:58.404403 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:51:58.405329 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m23:51:58.406083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:58.861294 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:51:58.876750 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:51:58.878167 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:51:59.152994 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:51:59.164729 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:51:59.165548 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:51:59.254639 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:51:59.308775 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:51:59.310466 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:52:00.389954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:52:00.401334 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:52:00.402043 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:52:00.493802 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:52:00.500727 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:52:00.501642 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:52:00.585053 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:52:00.602397 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:52:00.604351 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:52:00.697683 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:52:00.705098 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:52:00.706117 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:52:00.798722 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:52:00.810547 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:52:00.811409 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:52:00.915167 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:52:00.928817 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:52:00.933593 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:52:00.934630 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m23:52:01.048191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:52:01.049248 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:52:01.050356 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m23:52:01.748214 [debug] [Thread-1 (]: SQL status: SUCCESS 754 in 1.0 seconds
[0m23:52:01.749193 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:52:01.750033 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m23:52:02.058844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:52:02.093877 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 23:51:58.308868 => 23:52:02.093462
[0m23:52:02.094831 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m23:52:02.225118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '714a01cc-5a17-4bcb-9ae6-019722ad18fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b8c292b0>]}
[0m23:52:02.226773 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 754[0m in 3.96s]
[0m23:52:02.228175 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:52:02.231852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:02.232536 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m23:52:02.233266 [info ] [MainThread]: 
[0m23:52:02.234269 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m23:52:02.235723 [debug] [MainThread]: Command end result
[0m23:52:02.251271 [info ] [MainThread]: 
[0m23:52:02.252522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:52:02.253556 [info ] [MainThread]: 
[0m23:52:02.254652 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:52:02.256554 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.851631, "process_user_time": 4.932898, "process_kernel_time": 0.800681, "process_mem_max_rss": "217668", "process_out_blocks": "1754", "process_in_blocks": "0"}
[0m23:52:02.257624 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:52:02.257400 after 6.85 seconds
[0m23:52:02.258440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e584a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bc9662d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e115dcd0>]}
[0m23:52:02.259139 [debug] [MainThread]: Flushing usage events
[0m23:59:05.994106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b410950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b410a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b4106e0>]}


============================== 23:59:06.001020 | 0c2ccffc-5f5a-490d-a936-abcc22329c79 ==============================
[0m23:59:06.001020 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:59:06.001743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:59:07.064611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c2ccffc-5f5a-490d-a936-abcc22329c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6efe43f80>]}
[0m23:59:07.128550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c2ccffc-5f5a-490d-a936-abcc22329c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b657860>]}
[0m23:59:07.129476 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:59:07.138386 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:59:07.207023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:07.207782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:07.215916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c2ccffc-5f5a-490d-a936-abcc22329c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f542cf50>]}
[0m23:59:07.236753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c2ccffc-5f5a-490d-a936-abcc22329c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6efba08f0>]}
[0m23:59:07.237784 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:59:07.238942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c2ccffc-5f5a-490d-a936-abcc22329c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b410f80>]}
[0m23:59:07.242395 [info ] [MainThread]: 
[0m23:59:07.243781 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:07.245561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:59:07.267845 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:59:07.268673 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:59:07.269410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:07.781131 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:59:07.783979 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:59:07.928759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m23:59:07.942356 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:59:07.943200 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:59:07.943846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:08.310432 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:59:08.313096 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:59:08.439646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m23:59:08.444464 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:59:08.445447 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:59:08.446153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:08.890557 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:59:08.893853 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:59:09.029004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c2ccffc-5f5a-490d-a936-abcc22329c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f43679b0>]}
[0m23:59:09.030572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:59:09.031370 [info ] [MainThread]: 
[0m23:59:09.043962 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:59:09.045271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m23:59:09.046019 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:59:09.057947 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:59:09.063495 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:59:09.046613 => 23:59:09.063107
[0m23:59:09.065005 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:59:09.065916 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:59:09.067155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:59:09.067892 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:59:09.072155 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:59:09.075381 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:59:09.068361 => 23:59:09.074729
[0m23:59:09.076957 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:59:09.077783 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:59:09.078831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:59:09.079583 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:59:09.083703 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:59:09.086260 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:59:09.080045 => 23:59:09.085815
[0m23:59:09.087633 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:59:09.088431 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:59:09.089509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:59:09.090278 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:59:09.094711 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:59:09.097156 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:59:09.090781 => 23:59:09.096732
[0m23:59:09.098505 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:59:09.099285 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:59:09.100321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:59:09.100962 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:59:09.104778 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:59:09.106953 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:59:09.101454 => 23:59:09.106598
[0m23:59:09.108510 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:59:09.110175 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:59:09.110923 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:59:09.111993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:59:09.112674 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:59:09.124216 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:59:09.127189 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:59:09.113096 => 23:59:09.126779
[0m23:59:09.127857 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:59:09.169077 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:59:09.174710 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:59:09.175670 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:59:09.176522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:10.262666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:59:10.304510 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:59:09.128333 => 23:59:10.304121
[0m23:59:10.305580 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:59:10.463080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c2ccffc-5f5a-490d-a936-abcc22329c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef0906e0>]}
[0m23:59:10.464652 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.35s]
[0m23:59:10.465853 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:59:10.469243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:10.469895 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:59:10.470629 [info ] [MainThread]: 
[0m23:59:10.471419 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m23:59:10.472689 [debug] [MainThread]: Command end result
[0m23:59:10.490948 [info ] [MainThread]: 
[0m23:59:10.492217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:10.492905 [info ] [MainThread]: 
[0m23:59:10.493876 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:10.495830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5556626, "process_user_time": 5.609092, "process_kernel_time": 0.830585, "process_mem_max_rss": "216636", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m23:59:10.496813 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:10.496596 after 4.56 seconds
[0m23:59:10.497615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71fd66a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b5262a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6efcdfa10>]}
[0m23:59:10.498358 [debug] [MainThread]: Flushing usage events
[0m23:59:16.230549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ae66090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ae65cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ae649e0>]}


============================== 23:59:16.238396 | f4e1e969-ca5f-4f37-94ec-fd3d49df2f6c ==============================
[0m23:59:16.238396 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:59:16.239441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:17.587559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4e1e969-ca5f-4f37-94ec-fd3d49df2f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ff6370e0>]}
[0m23:59:17.693851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4e1e969-ca5f-4f37-94ec-fd3d49df2f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ae66420>]}
[0m23:59:17.695027 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:59:17.706603 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:59:17.772479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:17.773267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:17.783340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4e1e969-ca5f-4f37-94ec-fd3d49df2f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ff7ab4a0>]}
[0m23:59:17.804008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4e1e969-ca5f-4f37-94ec-fd3d49df2f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ff3a0680>]}
[0m23:59:17.805713 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:59:17.807727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4e1e969-ca5f-4f37-94ec-fd3d49df2f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ffcac800>]}
[0m23:59:17.813102 [info ] [MainThread]: 
[0m23:59:17.814318 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:59:17.816651 [debug] [MainThread]: Command end result
[0m23:59:17.836936 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6663322, "process_user_time": 5.138313, "process_kernel_time": 0.765722, "process_mem_max_rss": "208424", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m23:59:17.838698 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:17.838278 after 1.67 seconds
[0m23:59:17.839887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752f552a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750674ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750674d850>]}
[0m23:59:17.841358 [debug] [MainThread]: Flushing usage events
[0m23:59:23.633319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9840ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9d03620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9840890>]}


============================== 23:59:23.639493 | 7c002776-1005-4446-b44e-2c090425932e ==============================
[0m23:59:23.639493 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:59:23.640340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:59:24.841092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c002776-1005-4446-b44e-2c090425932e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda923d9850>]}
[0m23:59:24.903900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c002776-1005-4446-b44e-2c090425932e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda92cb8a10>]}
[0m23:59:24.904831 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:59:24.915210 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:59:24.982294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:24.983094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:24.992210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c002776-1005-4446-b44e-2c090425932e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda91f2b470>]}
[0m23:59:25.013783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c002776-1005-4446-b44e-2c090425932e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda91fa3f50>]}
[0m23:59:25.014755 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:59:25.015482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c002776-1005-4446-b44e-2c090425932e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab3b8e450>]}
[0m23:59:25.019176 [info ] [MainThread]: 
[0m23:59:25.020549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:25.022319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:59:25.044923 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:59:25.045827 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:59:25.046695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:25.593767 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:59:25.596518 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:59:25.747876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m23:59:25.762678 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:59:25.763502 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:59:25.764230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:26.121842 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:59:26.126802 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:59:26.260876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m23:59:26.265548 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:59:26.266300 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:59:26.267003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:26.654560 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:59:26.658086 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:59:26.786748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c002776-1005-4446-b44e-2c090425932e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda92054650>]}
[0m23:59:26.787912 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:59:26.788763 [info ] [MainThread]: 
[0m23:59:26.802644 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:59:26.803860 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:59:26.805189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m23:59:26.806266 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m23:59:26.821175 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 23:59:26.806887 => 23:59:26.820775
[0m23:59:26.822153 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m23:59:26.909305 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:26.910108 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m23:59:26.910729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:27.312691 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:59:27.327428 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:27.328691 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:59:27.406228 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:59:27.417953 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:27.418889 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:59:27.489354 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:59:27.564728 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:27.566847 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:59:28.641818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:59:28.651724 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:28.652648 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:59:28.790781 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:59:28.797637 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:28.798510 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:59:28.899913 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:59:28.906894 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:28.907865 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:59:28.987763 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:59:28.996288 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:28.997293 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:59:29.076760 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m23:59:29.088476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:29.089478 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m23:59:29.188712 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m23:59:29.202856 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:29.209399 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:29.210299 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m23:59:29.342093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:59:29.343162 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:29.344067 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m23:59:30.078539 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m23:59:30.079680 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m23:59:30.080602 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m23:59:30.586061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:59:30.620444 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 23:59:26.822727 => 23:59:30.620037
[0m23:59:30.621294 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m23:59:30.743031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c002776-1005-4446-b44e-2c090425932e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9132c8c0>]}
[0m23:59:30.744792 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 0[0m in 3.94s]
[0m23:59:30.746194 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m23:59:30.749618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:30.750316 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m23:59:30.751015 [info ] [MainThread]: 
[0m23:59:30.751912 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m23:59:30.753360 [debug] [MainThread]: Command end result
[0m23:59:30.769220 [info ] [MainThread]: 
[0m23:59:30.770023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:30.770807 [info ] [MainThread]: 
[0m23:59:30.771613 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:30.773321 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.1882267, "process_user_time": 5.55979, "process_kernel_time": 0.918809, "process_mem_max_rss": "217780", "process_out_blocks": "1754", "process_in_blocks": "0"}
[0m23:59:30.774333 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:59:30.773991 after 7.19 seconds
[0m23:59:30.775424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabde7d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab3ba4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab9cf7bc0>]}
[0m23:59:30.776211 [debug] [MainThread]: Flushing usage events
[0m23:59:49.906543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e62d2c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e62d2dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e62d2ca70>]}


============================== 23:59:49.913755 | 74b9a2bc-aba7-478b-af17-a2fc0a55edce ==============================
[0m23:59:49.913755 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:59:49.914546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:59:50.970182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74b9a2bc-aba7-478b-af17-a2fc0a55edce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e37533c20>]}
[0m23:59:51.033663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74b9a2bc-aba7-478b-af17-a2fc0a55edce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3cbf6690>]}
[0m23:59:51.034538 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:59:51.046122 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:59:51.101044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:51.101653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:51.108231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74b9a2bc-aba7-478b-af17-a2fc0a55edce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3773dac0>]}
[0m23:59:51.122231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74b9a2bc-aba7-478b-af17-a2fc0a55edce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e37438cb0>]}
[0m23:59:51.122863 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:59:51.123637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b9a2bc-aba7-478b-af17-a2fc0a55edce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e376a3950>]}
[0m23:59:51.126411 [info ] [MainThread]: 
[0m23:59:51.127710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:51.129135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m23:59:51.147705 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m23:59:51.148403 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m23:59:51.149042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:51.685223 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:59:51.688139 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m23:59:51.808763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m23:59:51.821601 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m23:59:51.822356 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m23:59:51.823048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:52.156443 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:59:52.159987 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m23:59:52.300311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m23:59:52.304750 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m23:59:52.305581 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m23:59:52.306305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:52.662347 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:59:52.665323 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m23:59:52.804602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b9a2bc-aba7-478b-af17-a2fc0a55edce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e371cdb80>]}
[0m23:59:52.806284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:59:52.807112 [info ] [MainThread]: 
[0m23:59:52.819644 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m23:59:52.820861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m23:59:52.821719 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m23:59:52.834211 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m23:59:52.837832 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 23:59:52.822432 => 23:59:52.837470
[0m23:59:52.839473 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m23:59:52.840414 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m23:59:52.841599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m23:59:52.842629 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m23:59:52.847003 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m23:59:52.849927 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 23:59:52.843151 => 23:59:52.849539
[0m23:59:52.851741 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m23:59:52.852555 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m23:59:52.853605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m23:59:52.854313 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m23:59:52.858744 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m23:59:52.861530 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 23:59:52.854792 => 23:59:52.861160
[0m23:59:52.862856 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m23:59:52.863712 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m23:59:52.864829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m23:59:52.865608 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m23:59:52.869635 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m23:59:52.872237 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 23:59:52.866085 => 23:59:52.871836
[0m23:59:52.873574 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m23:59:52.874332 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m23:59:52.875588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m23:59:52.876287 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m23:59:52.880276 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m23:59:52.882926 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 23:59:52.876766 => 23:59:52.882578
[0m23:59:52.884365 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m23:59:52.885659 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m23:59:52.886526 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:59:52.887563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m23:59:52.888243 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m23:59:52.900491 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m23:59:52.903485 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 23:59:52.888700 => 23:59:52.903142
[0m23:59:52.904186 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m23:59:52.945135 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m23:59:52.949826 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m23:59:52.950642 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m23:59:52.951672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:54.140079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:59:54.177649 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 23:59:52.904625 => 23:59:54.177298
[0m23:59:54.178485 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m23:59:54.290900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b9a2bc-aba7-478b-af17-a2fc0a55edce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3743a1e0>]}
[0m23:59:54.292275 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.40s]
[0m23:59:54.293482 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m23:59:54.296813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:54.297496 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m23:59:54.298087 [info ] [MainThread]: 
[0m23:59:54.298768 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m23:59:54.300089 [debug] [MainThread]: Command end result
[0m23:59:54.318842 [info ] [MainThread]: 
[0m23:59:54.319763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:54.320521 [info ] [MainThread]: 
[0m23:59:54.321213 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:54.322610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4648113, "process_user_time": 5.079385, "process_kernel_time": 0.831402, "process_mem_max_rss": "217140", "process_out_blocks": "1763", "process_in_blocks": "0"}
[0m23:59:54.323485 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:54.323285 after 4.47 seconds
[0m23:59:54.324207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e67492a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e621ece30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e37533e90>]}
[0m23:59:54.325208 [debug] [MainThread]: Flushing usage events
[0m00:00:00.940871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36552faf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36552fb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36552f8e00>]}


============================== 00:00:00.948800 | 53869152-7404-409b-b812-840a25914619 ==============================
[0m00:00:00.948800 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:00:00.950094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:00:02.031945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53869152-7404-409b-b812-840a25914619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362deb48f0>]}
[0m00:00:02.107690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53869152-7404-409b-b812-840a25914619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362db68c20>]}
[0m00:00:02.108711 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:00:02.117793 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:00:02.169604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:02.170185 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:02.177115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53869152-7404-409b-b812-840a25914619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362e05cc80>]}
[0m00:00:02.191074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53869152-7404-409b-b812-840a25914619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362d9ffbf0>]}
[0m00:00:02.191875 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:00:02.192603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53869152-7404-409b-b812-840a25914619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362dac40e0>]}
[0m00:00:02.194402 [info ] [MainThread]: 
[0m00:00:02.195044 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:00:02.195812 [debug] [MainThread]: Command end result
[0m00:00:02.208706 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3166997, "process_user_time": 5.386662, "process_kernel_time": 0.753009, "process_mem_max_rss": "208832", "process_out_blocks": "1707", "process_in_blocks": "0"}
[0m00:00:02.209574 [debug] [MainThread]: Command `dbt test` succeeded at 00:00:02.209416 after 1.32 seconds
[0m00:00:02.210163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362dfe6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3656607aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362f18b3b0>]}
[0m00:00:02.210734 [debug] [MainThread]: Flushing usage events
[0m00:00:07.834241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8575aa8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8575ea3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8575aa8ad0>]}


============================== 00:00:07.840901 | e0e7b47a-815d-452c-8eac-00c1ca8b99cf ==============================
[0m00:00:07.840901 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:00:07.841860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:00:08.962396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0e7b47a-815d-452c-8eac-00c1ca8b99cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854e5b17f0>]}
[0m00:00:09.031386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0e7b47a-815d-452c-8eac-00c1ca8b99cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8560deef90>]}
[0m00:00:09.032519 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:00:09.043451 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:00:09.097545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:09.098256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:09.105296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0e7b47a-815d-452c-8eac-00c1ca8b99cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854e80c920>]}
[0m00:00:09.118980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0e7b47a-815d-452c-8eac-00c1ca8b99cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854e068110>]}
[0m00:00:09.119726 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:00:09.120698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0e7b47a-815d-452c-8eac-00c1ca8b99cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854e303c50>]}
[0m00:00:09.122853 [info ] [MainThread]: 
[0m00:00:09.124088 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:09.125772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m00:00:09.144601 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m00:00:09.145349 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m00:00:09.145951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:09.821575 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m00:00:09.824134 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m00:00:09.953949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m00:00:09.968080 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m00:00:09.969236 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m00:00:09.969926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:10.462430 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:10.465327 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m00:00:10.616849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m00:00:10.621074 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m00:00:10.621828 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m00:00:10.622604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:11.021080 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:11.023916 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m00:00:11.170266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0e7b47a-815d-452c-8eac-00c1ca8b99cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85512d6b10>]}
[0m00:00:11.171694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:11.172734 [info ] [MainThread]: 
[0m00:00:11.184933 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m00:00:11.185982 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m00:00:11.187458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m00:00:11.188344 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m00:00:11.202315 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 00:00:11.188929 => 00:00:11.201772
[0m00:00:11.203352 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m00:00:11.329767 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:11.330905 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m00:00:11.331921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:11.793569 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:00:11.808605 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:11.809935 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m00:00:11.891893 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m00:00:11.904034 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:11.905011 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m00:00:11.986176 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m00:00:12.040040 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:12.041981 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:00:14.098218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:00:14.103806 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:14.104730 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m00:00:14.196533 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m00:00:14.205456 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:14.206445 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m00:00:14.303057 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m00:00:14.309585 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:14.310467 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m00:00:14.400351 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m00:00:14.406993 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:14.407925 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m00:00:14.483665 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m00:00:14.494974 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:14.495936 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m00:00:14.671693 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m00:00:14.685624 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:14.691040 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:14.691953 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m00:00:14.785112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:14.786369 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:14.787328 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:00:15.375523 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:00:15.376926 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:00:15.377813 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m00:00:15.822753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:15.854747 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 00:00:11.203996 => 00:00:15.854403
[0m00:00:15.855492 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m00:00:16.010803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0e7b47a-815d-452c-8eac-00c1ca8b99cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854e05fbf0>]}
[0m00:00:16.012236 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 0[0m in 4.82s]
[0m00:00:16.013405 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m00:00:16.017028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:16.017741 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m00:00:16.018438 [info ] [MainThread]: 
[0m00:00:16.019333 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.89 seconds (6.89s).
[0m00:00:16.020601 [debug] [MainThread]: Command end result
[0m00:00:16.035340 [info ] [MainThread]: 
[0m00:00:16.036493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:16.037491 [info ] [MainThread]: 
[0m00:00:16.038351 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:00:16.039751 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.261784, "process_user_time": 5.448164, "process_kernel_time": 0.742244, "process_mem_max_rss": "218060", "process_out_blocks": "1754", "process_in_blocks": "0"}
[0m00:00:16.040716 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:00:16.040464 after 8.26 seconds
[0m00:00:16.041453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8575ea3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8575aab2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8575aa8ad0>]}
[0m00:00:16.042224 [debug] [MainThread]: Flushing usage events
[0m00:12:39.255016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc3c55f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc3c56d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc3c54b60>]}


============================== 00:12:39.262253 | 95bbe41c-7b31-41fd-997d-800dad128764 ==============================
[0m00:12:39.262253 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:12:39.263180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:12:40.317464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95bbe41c-7b31-41fd-997d-800dad128764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca79e5550>]}
[0m00:12:40.384415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95bbe41c-7b31-41fd-997d-800dad128764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9c91f0e0>]}
[0m00:12:40.385441 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:12:40.395567 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:12:40.472656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:12:40.474274 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models/source.yml
[0m00:12:41.180908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95bbe41c-7b31-41fd-997d-800dad128764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9691bf50>]}
[0m00:12:41.195774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95bbe41c-7b31-41fd-997d-800dad128764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9c337a40>]}
[0m00:12:41.196463 [info ] [MainThread]: Found 6 models, 1 snapshot, 4 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:12:41.197042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95bbe41c-7b31-41fd-997d-800dad128764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c969ab8c0>]}
[0m00:12:41.199189 [info ] [MainThread]: 
[0m00:12:41.200383 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:12:41.201775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m00:12:41.218007 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m00:12:41.218614 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m00:12:41.219306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:41.732764 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m00:12:41.736008 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m00:12:41.856694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m00:12:41.870563 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m00:12:41.871443 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m00:12:41.872164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:42.273757 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:12:42.276781 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m00:12:42.414010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m00:12:42.418019 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m00:12:42.418786 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m00:12:42.419591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:42.752714 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:12:42.756299 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m00:12:42.886549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95bbe41c-7b31-41fd-997d-800dad128764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c967e7e30>]}
[0m00:12:42.888449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:42.889680 [info ] [MainThread]: 
[0m00:12:42.901788 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m00:12:42.903401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m00:12:42.904337 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m00:12:42.916213 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m00:12:42.921137 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 00:12:42.904951 => 00:12:42.920457
[0m00:12:42.922958 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m00:12:42.923840 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m00:12:42.925082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m00:12:42.925795 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m00:12:42.930155 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m00:12:42.932818 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 00:12:42.926360 => 00:12:42.932423
[0m00:12:42.934378 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m00:12:42.935188 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m00:12:42.936483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m00:12:42.937246 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m00:12:42.941588 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m00:12:42.944310 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 00:12:42.937762 => 00:12:42.943905
[0m00:12:42.945752 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m00:12:42.946549 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m00:12:42.947563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m00:12:42.948233 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m00:12:42.952278 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m00:12:42.955219 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 00:12:42.948693 => 00:12:42.954771
[0m00:12:42.956713 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m00:12:42.957475 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m00:12:42.958472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m00:12:42.959128 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m00:12:42.963039 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m00:12:42.965652 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 00:12:42.959599 => 00:12:42.965314
[0m00:12:42.967056 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m00:12:42.968557 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m00:12:42.969368 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m00:12:42.970590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m00:12:42.971273 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m00:12:42.982879 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m00:12:42.985515 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 00:12:42.971732 => 00:12:42.985182
[0m00:12:42.986384 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m00:12:43.029899 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m00:12:43.035501 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m00:12:43.036516 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from user_db_lobster1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from user_db_lobster1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from user_db_lobster1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from user_db_lobster1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from user_db_lobster1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m00:12:43.037540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:44.501232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:12:44.546439 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 00:12:42.986921 => 00:12:44.545936
[0m00:12:44.547254 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m00:12:44.654915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95bbe41c-7b31-41fd-997d-800dad128764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c95c91580>]}
[0m00:12:44.656462 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.68s]
[0m00:12:44.657687 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m00:12:44.661955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:44.662840 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m00:12:44.663615 [info ] [MainThread]: 
[0m00:12:44.664420 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m00:12:44.665535 [debug] [MainThread]: Command end result
[0m00:12:44.681560 [info ] [MainThread]: 
[0m00:12:44.682409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:12:44.683052 [info ] [MainThread]: 
[0m00:12:44.683781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:12:44.685269 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.481653, "process_user_time": 6.283616, "process_kernel_time": 0.711202, "process_mem_max_rss": "224812", "process_out_blocks": "2667", "process_in_blocks": "0"}
[0m00:12:44.686332 [debug] [MainThread]: Command `dbt run` succeeded at 00:12:44.686067 after 5.48 seconds
[0m00:12:44.687227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc4e0a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc3f55d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c95c91580>]}
[0m00:12:44.688012 [debug] [MainThread]: Flushing usage events
[0m00:12:49.885277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef811ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef8618bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef8118230>]}


============================== 00:12:49.892545 | 6a4a802e-31f2-4419-b573-25520996c6b7 ==============================
[0m00:12:49.892545 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:12:49.893366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:12:51.005207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a4a802e-31f2-4419-b573-25520996c6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed1041580>]}
[0m00:12:51.081194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a4a802e-31f2-4419-b573-25520996c6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed2812f90>]}
[0m00:12:51.082126 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:12:51.092012 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:12:51.147877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:12:51.148479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:12:51.155192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a4a802e-31f2-4419-b573-25520996c6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed0953890>]}
[0m00:12:51.172285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a4a802e-31f2-4419-b573-25520996c6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed087c050>]}
[0m00:12:51.173151 [info ] [MainThread]: Found 6 models, 1 snapshot, 4 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:12:51.173897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a4a802e-31f2-4419-b573-25520996c6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed16d03e0>]}
[0m00:12:51.176437 [info ] [MainThread]: 
[0m00:12:51.177426 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:12:51.179048 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m00:12:51.200244 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m00:12:51.201009 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m00:12:51.201633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:51.691927 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:12:51.694945 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m00:12:51.825661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m00:12:51.830351 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m00:12:51.831109 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m00:12:51.831819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:52.215690 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:12:52.218694 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m00:12:52.391084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a4a802e-31f2-4419-b573-25520996c6b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed120d5b0>]}
[0m00:12:52.392606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:52.393499 [info ] [MainThread]: 
[0m00:12:52.405806 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b
[0m00:12:52.407014 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_raw_market_price_close ....................... [RUN]
[0m00:12:52.410014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b)
[0m00:12:52.410943 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b
[0m00:12:52.439248 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b"
[0m00:12:52.443208 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b (compile): 00:12:52.411496 => 00:12:52.442709
[0m00:12:52.444035 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b
[0m00:12:52.480301 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b"
[0m00:12:52.485207 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b"
[0m00:12:52.486113 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from user_db_lobster1.raw.market_price
where close is null



      
    ) dbt_internal_test
[0m00:12:52.487044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:52.844119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:12:52.860413 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b (execute): 00:12:52.444540 => 00:12:52.859964
[0m00:12:52.861288 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b: Close
[0m00:12:52.995288 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_raw_market_price_close ............................. [[32mPASS[0m in 0.59s]
[0m00:12:52.996948 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b
[0m00:12:52.997959 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5
[0m00:12:52.998812 [info ] [Thread-1 (]: 2 of 4 START test source_not_null_raw_market_price_date ........................ [RUN]
[0m00:12:53.000226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b, now test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5)
[0m00:12:53.001101 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5
[0m00:12:53.008454 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5"
[0m00:12:53.011600 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5 (compile): 00:12:53.001681 => 00:12:53.011176
[0m00:12:53.012471 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5
[0m00:12:53.016767 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5"
[0m00:12:53.019854 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5"
[0m00:12:53.020744 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from user_db_lobster1.raw.market_price
where date is null



      
    ) dbt_internal_test
[0m00:12:53.021617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:53.499556 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:12:53.503584 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5 (execute): 00:12:53.013032 => 00:12:53.503087
[0m00:12:53.504342 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5: Close
[0m00:12:53.613282 [info ] [Thread-1 (]: 2 of 4 PASS source_not_null_raw_market_price_date .............................. [[32mPASS[0m in 0.61s]
[0m00:12:53.614746 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5
[0m00:12:53.615808 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4
[0m00:12:53.616845 [info ] [Thread-1 (]: 3 of 4 START test source_not_null_raw_market_price_open ........................ [RUN]
[0m00:12:53.618483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5, now test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4)
[0m00:12:53.619583 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4
[0m00:12:53.626564 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4"
[0m00:12:53.628934 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4 (compile): 00:12:53.620083 => 00:12:53.628488
[0m00:12:53.629736 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4
[0m00:12:53.634009 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4"
[0m00:12:53.636640 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4"
[0m00:12:53.637390 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from user_db_lobster1.raw.market_price
where open is null



      
    ) dbt_internal_test
[0m00:12:53.638163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:54.020222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:12:54.024032 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4 (execute): 00:12:53.630315 => 00:12:54.023541
[0m00:12:54.024851 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4: Close
[0m00:12:54.165680 [info ] [Thread-1 (]: 3 of 4 PASS source_not_null_raw_market_price_open .............................. [[32mPASS[0m in 0.55s]
[0m00:12:54.167023 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4
[0m00:12:54.167953 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf
[0m00:12:54.168735 [info ] [Thread-1 (]: 4 of 4 START test source_not_null_raw_market_price_symbol ...................... [RUN]
[0m00:12:54.170315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4, now test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf)
[0m00:12:54.171173 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf
[0m00:12:54.177831 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf"
[0m00:12:54.180042 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf (compile): 00:12:54.171655 => 00:12:54.179572
[0m00:12:54.180731 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf
[0m00:12:54.185106 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf"
[0m00:12:54.187498 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf"
[0m00:12:54.188280 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from user_db_lobster1.raw.market_price
where symbol is null



      
    ) dbt_internal_test
[0m00:12:54.189175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:54.594308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:12:54.597713 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf (execute): 00:12:54.181288 => 00:12:54.597351
[0m00:12:54.598515 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf: Close
[0m00:12:54.734485 [info ] [Thread-1 (]: 4 of 4 PASS source_not_null_raw_market_price_symbol ............................ [[32mPASS[0m in 0.56s]
[0m00:12:54.736081 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf
[0m00:12:54.739757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:54.740579 [debug] [MainThread]: Connection 'test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf' was properly closed.
[0m00:12:54.741323 [info ] [MainThread]: 
[0m00:12:54.742331 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m00:12:54.744337 [debug] [MainThread]: Command end result
[0m00:12:54.761148 [info ] [MainThread]: 
[0m00:12:54.762485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:12:54.763661 [info ] [MainThread]: 
[0m00:12:54.765064 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:12:54.767109 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.9293613, "process_user_time": 5.122689, "process_kernel_time": 0.807351, "process_mem_max_rss": "217352", "process_out_blocks": "1792", "process_in_blocks": "0"}
[0m00:12:54.768129 [debug] [MainThread]: Command `dbt test` succeeded at 00:12:54.767916 after 4.93 seconds
[0m00:12:54.769007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef8637aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef85306e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed1278da0>]}
[0m00:12:54.769962 [debug] [MainThread]: Flushing usage events
[0m00:13:00.152390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc1444d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc14fb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc103c170>]}


============================== 00:13:00.161032 | 1f306d56-3319-4b15-b5c4-e231978e6e52 ==============================
[0m00:13:00.161032 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:13:00.161889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:13:01.417855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f306d56-3319-4b15-b5c4-e231978e6e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9af25730>]}
[0m00:13:01.524481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f306d56-3319-4b15-b5c4-e231978e6e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9b830a10>]}
[0m00:13:01.530038 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:13:01.552876 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:13:01.633150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:13:01.633818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:13:01.642215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f306d56-3319-4b15-b5c4-e231978e6e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9984b470>]}
[0m00:13:01.660066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f306d56-3319-4b15-b5c4-e231978e6e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec997e8590>]}
[0m00:13:01.660882 [info ] [MainThread]: Found 6 models, 1 snapshot, 4 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:13:01.661639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f306d56-3319-4b15-b5c4-e231978e6e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbb316750>]}
[0m00:13:01.664584 [info ] [MainThread]: 
[0m00:13:01.665901 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:13:01.667571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m00:13:01.687542 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m00:13:01.688295 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m00:13:01.688918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:02.128563 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:13:02.131132 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m00:13:02.276367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m00:13:02.290744 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m00:13:02.291620 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m00:13:02.292403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:02.702664 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:13:02.706244 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m00:13:02.813391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m00:13:02.817479 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m00:13:02.818175 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m00:13:02.818969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:03.311526 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:13:03.314615 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m00:13:03.432240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f306d56-3319-4b15-b5c4-e231978e6e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9963fd70>]}
[0m00:13:03.433741 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:03.434981 [info ] [MainThread]: 
[0m00:13:03.448203 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m00:13:03.449257 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m00:13:03.450500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m00:13:03.451314 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m00:13:03.464413 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 00:13:03.451877 => 00:13:03.463913
[0m00:13:03.465309 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m00:13:03.548229 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:03.549016 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m00:13:03.549605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:03.997435 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:13:04.012770 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:04.014629 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m00:13:04.106266 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m00:13:04.124099 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:04.125024 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m00:13:04.212067 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m00:13:04.271692 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:04.273620 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:13:05.186266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:13:05.191849 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:05.192796 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m00:13:05.279613 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m00:13:05.287867 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:05.288810 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m00:13:05.376232 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m00:13:05.382113 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:05.382989 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m00:13:05.474607 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m00:13:05.481489 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:05.482474 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m00:13:05.559908 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m00:13:05.571531 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:05.572444 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m00:13:05.653680 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m00:13:05.667403 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:05.672465 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:05.673675 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m00:13:05.819017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:13:05.820485 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:05.821757 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:13:06.379452 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:13:06.380524 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m00:13:06.381483 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m00:13:06.704134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:13:06.739264 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 00:13:03.465874 => 00:13:06.738861
[0m00:13:06.740126 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m00:13:06.849128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f306d56-3319-4b15-b5c4-e231978e6e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec98c8cb90>]}
[0m00:13:06.850733 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 0[0m in 3.40s]
[0m00:13:06.852068 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m00:13:06.855652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:06.856444 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m00:13:06.857159 [info ] [MainThread]: 
[0m00:13:06.858212 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.19 seconds (5.19s).
[0m00:13:06.860224 [debug] [MainThread]: Command end result
[0m00:13:06.877722 [info ] [MainThread]: 
[0m00:13:06.878641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:13:06.879592 [info ] [MainThread]: 
[0m00:13:06.880530 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:13:06.882500 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.82275, "process_user_time": 5.732245, "process_kernel_time": 0.683105, "process_mem_max_rss": "217888", "process_out_blocks": "1795", "process_in_blocks": "0"}
[0m00:13:06.883590 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:13:06.883380 after 6.82 seconds
[0m00:13:06.884518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc1444d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec99a5e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec98c77da0>]}
[0m00:13:06.885318 [debug] [MainThread]: Flushing usage events
[0m01:10:49.927596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0787fd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb078b552b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb078c4ca70>]}


============================== 01:10:49.937730 | 0fed1eff-fef6-46b4-9e6f-0eee96c135d0 ==============================
[0m01:10:49.937730 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:10:49.938584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:10:51.113327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fed1eff-fef6-46b4-9e6f-0eee96c135d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0787293d0>]}
[0m01:10:51.176608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fed1eff-fef6-46b4-9e6f-0eee96c135d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0733a4e30>]}
[0m01:10:51.177526 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m01:10:51.188552 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:10:51.266090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:10:51.266999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:10:51.276229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fed1eff-fef6-46b4-9e6f-0eee96c135d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06b72ac00>]}
[0m01:10:51.297208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fed1eff-fef6-46b4-9e6f-0eee96c135d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb050f94350>]}
[0m01:10:51.298080 [info ] [MainThread]: Found 6 models, 1 snapshot, 4 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:10:51.298817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fed1eff-fef6-46b4-9e6f-0eee96c135d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05119c350>]}
[0m01:10:51.302160 [info ] [MainThread]: 
[0m01:10:51.303455 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:10:51.305067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m01:10:51.324137 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m01:10:51.324925 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m01:10:51.325584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:51.966353 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m01:10:51.969339 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m01:10:52.163748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m01:10:52.177243 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m01:10:52.178102 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m01:10:52.178800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:52.642982 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:10:52.645612 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m01:10:52.788229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m01:10:52.792352 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m01:10:52.793200 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m01:10:52.793933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:53.232638 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:10:53.235862 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m01:10:53.402024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fed1eff-fef6-46b4-9e6f-0eee96c135d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0504f9b20>]}
[0m01:10:53.403622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:10:53.404555 [info ] [MainThread]: 
[0m01:10:53.416428 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m01:10:53.417607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m01:10:53.418415 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m01:10:53.429961 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m01:10:53.436692 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.gap_analysis (compile): 01:10:53.418984 => 01:10:53.436331
[0m01:10:53.438103 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m01:10:53.438905 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m01:10:53.439986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m01:10:53.440730 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m01:10:53.444713 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m01:10:53.447647 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.moving_average (compile): 01:10:53.441199 => 01:10:53.447210
[0m01:10:53.449280 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m01:10:53.450140 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m01:10:53.451143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m01:10:53.451810 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m01:10:53.455602 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m01:10:53.458231 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rolling_volatality (compile): 01:10:53.452250 => 01:10:53.457655
[0m01:10:53.459695 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m01:10:53.460414 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m01:10:53.461428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m01:10:53.462029 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m01:10:53.465996 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m01:10:53.468475 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.rsi (compile): 01:10:53.462525 => 01:10:53.468162
[0m01:10:53.469718 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m01:10:53.470409 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m01:10:53.471401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m01:10:53.472123 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m01:10:53.475878 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m01:10:53.478327 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.volatility (compile): 01:10:53.472595 => 01:10:53.477938
[0m01:10:53.479647 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m01:10:53.481340 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m01:10:53.482156 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m01:10:53.483208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m01:10:53.483804 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m01:10:53.494862 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m01:10:53.498313 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (compile): 01:10:53.484262 => 01:10:53.497893
[0m01:10:53.499007 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m01:10:53.537783 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m01:10:53.543283 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m01:10:53.544201 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from user_db_lobster1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from user_db_lobster1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from user_db_lobster1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from user_db_lobster1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from user_db_lobster1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m01:10:53.545182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:55.124044 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m01:10:55.159521 [debug] [Thread-1 (]: Timing info for model.lab2_dbt.session_summary (execute): 01:10:53.499534 => 01:10:55.159194
[0m01:10:55.160329 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m01:10:55.284934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fed1eff-fef6-46b4-9e6f-0eee96c135d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb050efe690>]}
[0m01:10:55.286330 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.80s]
[0m01:10:55.287601 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m01:10:55.290997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:55.291693 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m01:10:55.292402 [info ] [MainThread]: 
[0m01:10:55.293168 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m01:10:55.294352 [debug] [MainThread]: Command end result
[0m01:10:55.312748 [info ] [MainThread]: 
[0m01:10:55.313682 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:10:55.314472 [info ] [MainThread]: 
[0m01:10:55.315191 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:10:55.317052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4488673, "process_user_time": 5.399051, "process_kernel_time": 0.918819, "process_mem_max_rss": "217580", "process_out_blocks": "1803", "process_in_blocks": "0"}
[0m01:10:55.317986 [debug] [MainThread]: Command `dbt run` succeeded at 01:10:55.317808 after 5.45 seconds
[0m01:10:55.318767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb078c0e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb051e9a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07cfba9f0>]}
[0m01:10:55.319534 [debug] [MainThread]: Flushing usage events
[0m01:11:01.675244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab644c4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab644c71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab644c4e00>]}


============================== 01:11:01.683229 | 86473d8f-de75-47a1-95ff-d88430b02b84 ==============================
[0m01:11:01.683229 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:11:01.684227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:11:02.826166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86473d8f-de75-47a1-95ff-d88430b02b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3d1c2ed0>]}
[0m01:11:02.920376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86473d8f-de75-47a1-95ff-d88430b02b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3e392360>]}
[0m01:11:02.921689 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m01:11:02.935139 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:11:03.009683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:11:03.010423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:11:03.019856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86473d8f-de75-47a1-95ff-d88430b02b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3d985010>]}
[0m01:11:03.045527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86473d8f-de75-47a1-95ff-d88430b02b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3cc24770>]}
[0m01:11:03.046612 [info ] [MainThread]: Found 6 models, 1 snapshot, 4 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:11:03.047452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86473d8f-de75-47a1-95ff-d88430b02b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3cec4410>]}
[0m01:11:03.051675 [info ] [MainThread]: 
[0m01:11:03.053796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:11:03.055952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m01:11:03.083031 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m01:11:03.083951 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m01:11:03.084680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:03.729529 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:11:03.732662 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m01:11:03.877986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m01:11:03.882640 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m01:11:03.883585 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m01:11:03.884239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:04.300461 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:11:04.303461 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m01:11:04.479940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86473d8f-de75-47a1-95ff-d88430b02b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3cec6330>]}
[0m01:11:04.481764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:04.482691 [info ] [MainThread]: 
[0m01:11:04.499198 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b
[0m01:11:04.500270 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_raw_market_price_close ....................... [RUN]
[0m01:11:04.503173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b)
[0m01:11:04.504017 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b
[0m01:11:04.529817 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b"
[0m01:11:04.533829 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b (compile): 01:11:04.504668 => 01:11:04.533432
[0m01:11:04.534608 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b
[0m01:11:04.566625 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b"
[0m01:11:04.570192 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b"
[0m01:11:04.571010 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from user_db_lobster1.raw.market_price
where close is null



      
    ) dbt_internal_test
[0m01:11:04.571783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:04.980649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:11:04.991405 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b (execute): 01:11:04.535143 => 01:11:04.991010
[0m01:11:04.992442 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b: Close
[0m01:11:05.136271 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_raw_market_price_close ............................. [[32mPASS[0m in 0.63s]
[0m01:11:05.137947 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b
[0m01:11:05.138894 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5
[0m01:11:05.139783 [info ] [Thread-1 (]: 2 of 4 START test source_not_null_raw_market_price_date ........................ [RUN]
[0m01:11:05.141144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_market_price_close.a0b330a68b, now test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5)
[0m01:11:05.142172 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5
[0m01:11:05.149735 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5"
[0m01:11:05.153463 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5 (compile): 01:11:05.143089 => 01:11:05.152982
[0m01:11:05.154268 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5
[0m01:11:05.158786 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5"
[0m01:11:05.161720 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5"
[0m01:11:05.162627 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from user_db_lobster1.raw.market_price
where date is null



      
    ) dbt_internal_test
[0m01:11:05.163613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:05.812361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:11:05.816257 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5 (execute): 01:11:05.155057 => 01:11:05.815880
[0m01:11:05.817245 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5: Close
[0m01:11:05.955983 [info ] [Thread-1 (]: 2 of 4 PASS source_not_null_raw_market_price_date .............................. [[32mPASS[0m in 0.82s]
[0m01:11:05.957301 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5
[0m01:11:05.958442 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4
[0m01:11:05.959286 [info ] [Thread-1 (]: 3 of 4 START test source_not_null_raw_market_price_open ........................ [RUN]
[0m01:11:05.960653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_market_price_date.dcc334c7e5, now test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4)
[0m01:11:05.961510 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4
[0m01:11:05.968507 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4"
[0m01:11:05.971081 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4 (compile): 01:11:05.962056 => 01:11:05.970711
[0m01:11:05.971850 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4
[0m01:11:05.976221 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4"
[0m01:11:05.978963 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4"
[0m01:11:05.979795 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from user_db_lobster1.raw.market_price
where open is null



      
    ) dbt_internal_test
[0m01:11:05.980717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:06.323721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:11:06.327535 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4 (execute): 01:11:05.972409 => 01:11:06.327104
[0m01:11:06.328623 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4: Close
[0m01:11:06.461991 [info ] [Thread-1 (]: 3 of 4 PASS source_not_null_raw_market_price_open .............................. [[32mPASS[0m in 0.50s]
[0m01:11:06.463848 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4
[0m01:11:06.464929 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf
[0m01:11:06.465994 [info ] [Thread-1 (]: 4 of 4 START test source_not_null_raw_market_price_symbol ...................... [RUN]
[0m01:11:06.467468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_market_price_open.4a7eb326b4, now test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf)
[0m01:11:06.468234 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf
[0m01:11:06.474940 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf"
[0m01:11:06.477658 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf (compile): 01:11:06.468835 => 01:11:06.477214
[0m01:11:06.478473 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf
[0m01:11:06.482773 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf"
[0m01:11:06.485513 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf"
[0m01:11:06.486402 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from user_db_lobster1.raw.market_price
where symbol is null



      
    ) dbt_internal_test
[0m01:11:06.487277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:07.030317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:11:07.034194 [debug] [Thread-1 (]: Timing info for test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf (execute): 01:11:06.478982 => 01:11:07.033803
[0m01:11:07.035107 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf: Close
[0m01:11:07.166009 [info ] [Thread-1 (]: 4 of 4 PASS source_not_null_raw_market_price_symbol ............................ [[32mPASS[0m in 0.70s]
[0m01:11:07.167738 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf
[0m01:11:07.171190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:07.171960 [debug] [MainThread]: Connection 'test.lab2_dbt.source_not_null_raw_market_price_symbol.c66c27f9bf' was properly closed.
[0m01:11:07.172689 [info ] [MainThread]: 
[0m01:11:07.173513 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m01:11:07.175737 [debug] [MainThread]: Command end result
[0m01:11:07.191691 [info ] [MainThread]: 
[0m01:11:07.192517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:07.193198 [info ] [MainThread]: 
[0m01:11:07.194028 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:11:07.195562 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.5812054, "process_user_time": 6.087778, "process_kernel_time": 0.833234, "process_mem_max_rss": "217788", "process_out_blocks": "1792", "process_in_blocks": "0"}
[0m01:11:07.196528 [debug] [MainThread]: Command `dbt test` succeeded at 01:11:07.196221 after 5.58 seconds
[0m01:11:07.197847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab647b3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3ca90320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3cce4ec0>]}
[0m01:11:07.198841 [debug] [MainThread]: Flushing usage events
[0m01:11:14.180914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9b11cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9b11f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9b11dc10>]}


============================== 01:11:14.188163 | 789f9205-fdda-4c06-b83f-29fde778d4a7 ==============================
[0m01:11:14.188163 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:11:14.189133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:11:15.247288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '789f9205-fdda-4c06-b83f-29fde778d4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9b124bf0>]}
[0m01:11:15.315155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '789f9205-fdda-4c06-b83f-29fde778d4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9b71e540>]}
[0m01:11:15.316101 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m01:11:15.325523 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:11:15.376555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:11:15.377132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:11:15.383886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '789f9205-fdda-4c06-b83f-29fde778d4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6f8fd310>]}
[0m01:11:15.400220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '789f9205-fdda-4c06-b83f-29fde778d4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6f83ca10>]}
[0m01:11:15.401025 [info ] [MainThread]: Found 6 models, 1 snapshot, 4 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:11:15.401837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '789f9205-fdda-4c06-b83f-29fde778d4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b74fe2de0>]}
[0m01:11:15.404053 [info ] [MainThread]: 
[0m01:11:15.404982 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:11:15.406348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m01:11:15.424185 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m01:11:15.425146 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m01:11:15.425753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:16.042828 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m01:11:16.045399 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m01:11:16.188975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m01:11:16.202563 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m01:11:16.203474 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show terse objects in user_db_lobster1.snapshot limit 10000
[0m01:11:16.204168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:16.721910 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:11:16.724359 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m01:11:16.853321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m01:11:16.857162 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m01:11:16.857899 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show terse objects in user_db_lobster1.analytics limit 10000
[0m01:11:16.858692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:17.354307 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:11:17.357594 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m01:11:17.485452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '789f9205-fdda-4c06-b83f-29fde778d4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b81533410>]}
[0m01:11:17.486762 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:17.487490 [info ] [MainThread]: 
[0m01:11:17.501135 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m01:11:17.502166 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m01:11:17.503518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m01:11:17.504384 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m01:11:17.517418 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (compile): 01:11:17.504967 => 01:11:17.516930
[0m01:11:17.518247 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m01:11:17.600785 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:17.601490 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m01:11:17.602071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:18.052734 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m01:11:18.067370 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:18.068689 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m01:11:18.170124 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m01:11:18.182010 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:18.182930 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m01:11:18.280435 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m01:11:18.337180 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:18.339061 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:11:19.681722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:11:19.687023 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:19.688085 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m01:11:19.769487 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m01:11:19.775488 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:19.776377 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m01:11:19.862160 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m01:11:19.868546 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:19.869492 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m01:11:19.978582 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m01:11:19.985849 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:19.986794 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m01:11:20.077378 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m01:11:20.090662 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:20.091636 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m01:11:20.183995 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m01:11:20.198150 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:20.203283 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:20.204221 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m01:11:20.325254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:11:20.326238 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:20.327278 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:11:21.091310 [debug] [Thread-1 (]: SQL status: SUCCESS 1436 in 1.0 seconds
[0m01:11:21.092635 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m01:11:21.093607 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m01:11:21.460320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:11:21.495030 [debug] [Thread-1 (]: Timing info for snapshot.lab2_dbt.snapshot_session_summary (execute): 01:11:17.518851 => 01:11:21.494669
[0m01:11:21.495913 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m01:11:21.712246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '789f9205-fdda-4c06-b83f-29fde778d4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6ed651f0>]}
[0m01:11:21.713961 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 1436[0m in 4.21s]
[0m01:11:21.715706 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m01:11:21.719331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:21.720054 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m01:11:21.720813 [info ] [MainThread]: 
[0m01:11:21.721582 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m01:11:21.722896 [debug] [MainThread]: Command end result
[0m01:11:21.738427 [info ] [MainThread]: 
[0m01:11:21.739162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:21.739873 [info ] [MainThread]: 
[0m01:11:21.740743 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:11:21.742269 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.61887, "process_user_time": 6.05882, "process_kernel_time": 0.929026, "process_mem_max_rss": "218256", "process_out_blocks": "1795", "process_in_blocks": "0"}
[0m01:11:21.743242 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:11:21.743055 after 7.62 seconds
[0m01:11:21.744230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9b5da810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9b1cef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6ffe9bb0>]}
[0m01:11:21.745281 [debug] [MainThread]: Flushing usage events
