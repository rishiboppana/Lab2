[0m19:55:12.179615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e517ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea11880>]}


============================== 19:55:12.186929 | e06c8474-27a3-443e-95bf-054879509097 ==============================
[0m19:55:12.186929 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:55:12.187732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:55:13.984546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a71fc50>]}
[0m19:55:14.049736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea13a40>]}
[0m19:55:14.050922 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:55:14.220193 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:55:14.221357 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:55:14.221937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99b920>]}
[0m19:55:15.797907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b30e060>]}
[0m19:55:15.883305 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:55:15.884838 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:55:15.918057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b39cda0>]}
[0m19:55:15.918722 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m19:55:15.919315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b3a82c0>]}
[0m19:55:15.922040 [info ] [MainThread]: 
[0m19:55:15.922526 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m19:55:15.922939 [info ] [MainThread]: 
[0m19:55:15.923570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:55:15.929534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m19:55:16.072467 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m19:55:16.072851 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m19:55:16.073174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:16.810650 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.737 seconds
[0m19:55:16.814100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m19:55:16.827418 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m19:55:16.827916 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m19:55:16.946179 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.118 seconds
[0m19:55:16.948490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c903aa0>]}
[0m19:55:16.953790 [debug] [Thread-1 (]: Began running node model.homework7.my_first_dbt_model
[0m19:55:16.954666 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m19:55:16.955495 [debug] [Thread-2 (]: Began running node model.homework7.session_timestamp
[0m19:55:16.956272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.my_first_dbt_model)
[0m19:55:16.956772 [debug] [Thread-3 (]: Began running node model.homework7.user_session_channel
[0m19:55:16.957392 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.homework7.session_timestamp'
[0m19:55:16.957877 [debug] [Thread-1 (]: Began compiling node model.homework7.my_first_dbt_model
[0m19:55:16.958477 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m19:55:16.958979 [debug] [Thread-2 (]: Began compiling node model.homework7.session_timestamp
[0m19:55:16.969943 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.my_first_dbt_model"
[0m19:55:16.970581 [debug] [Thread-3 (]: Began compiling node model.homework7.user_session_channel
[0m19:55:16.973930 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m19:55:16.977308 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m19:55:16.978997 [debug] [Thread-3 (]: Finished running node model.homework7.user_session_channel
[0m19:55:16.979790 [debug] [Thread-2 (]: Finished running node model.homework7.session_timestamp
[0m19:55:16.980416 [debug] [Thread-1 (]: Began executing node model.homework7.my_first_dbt_model
[0m19:55:17.004452 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m19:55:17.011371 [info ] [Thread-5 (]: 2 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m19:55:17.019630 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m19:55:17.020793 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.my_first_dbt_model"
[0m19:55:17.021271 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m19:55:17.026461 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m19:55:17.027351 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m19:55:17.030696 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m19:55:17.031875 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.my_first_dbt_model"
[0m19:55:17.032336 [debug] [Thread-1 (]: On model.homework7.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.my_first_dbt_model"} */
create or replace transient table user_db_lobster.analytics.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:55:17.033463 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m19:55:17.034603 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (with __dbt__cte__user_session_channel as (
SELECT
 userId,
 sessionId,
 channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
),  __dbt__cte__session_timestamp as (
SELECT
 sessionId,
 ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
) SELECT u.userId, u.sessionId, u.channel, st.ts
FROM __dbt__cte__user_session_channel u
JOIN __dbt__cte__session_timestamp st ON u.sessionId = st.sessionId
        );
[0m19:55:17.035053 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m19:55:18.144621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m19:55:18.174721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c845670>]}
[0m19:55:18.175610 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.my_first_dbt_model ................. [[32mSUCCESS 1[0m in 1.22s]
[0m19:55:18.176424 [debug] [Thread-1 (]: Finished running node model.homework7.my_first_dbt_model
[0m19:55:18.177086 [debug] [Thread-3 (]: Began running node model.homework7.my_second_dbt_model
[0m19:55:18.177777 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m19:55:18.178359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.homework7.user_session_channel, now model.homework7.my_second_dbt_model)
[0m19:55:18.178826 [debug] [Thread-3 (]: Began compiling node model.homework7.my_second_dbt_model
[0m19:55:18.182227 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.my_second_dbt_model"
[0m19:55:18.183047 [debug] [Thread-3 (]: Began executing node model.homework7.my_second_dbt_model
[0m19:55:18.209689 [debug] [Thread-3 (]: Writing runtime sql for node "model.homework7.my_second_dbt_model"
[0m19:55:18.210875 [debug] [Thread-3 (]: Using snowflake connection "model.homework7.my_second_dbt_model"
[0m19:55:18.211330 [debug] [Thread-3 (]: On model.homework7.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.my_second_dbt_model"} */
create or replace   view user_db_lobster.analytics.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from user_db_lobster.analytics.my_first_dbt_model
where id = 1
  );
[0m19:55:18.211754 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:55:18.753705 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m19:55:18.757526 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8d7ef0>]}
[0m19:55:18.758429 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics.my_second_dbt_model ................. [[32mSUCCESS 1[0m in 0.58s]
[0m19:55:18.759358 [debug] [Thread-3 (]: Finished running node model.homework7.my_second_dbt_model
[0m19:55:19.002112 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.967 seconds
[0m19:55:19.005224 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06c8474-27a3-443e-95bf-054879509097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f9cd0>]}
[0m19:55:19.006020 [info ] [Thread-5 (]: 2 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.99s]
[0m19:55:19.006823 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m19:55:19.008534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:19.008940 [debug] [MainThread]: Connection 'model.homework7.my_first_dbt_model' was left open.
[0m19:55:19.009394 [debug] [MainThread]: On model.homework7.my_first_dbt_model: Close
[0m19:55:19.129271 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was properly closed.
[0m19:55:19.129753 [debug] [MainThread]: Connection 'model.homework7.my_second_dbt_model' was left open.
[0m19:55:19.130171 [debug] [MainThread]: On model.homework7.my_second_dbt_model: Close
[0m19:55:19.258674 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m19:55:19.259180 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m19:55:19.384631 [info ] [MainThread]: 
[0m19:55:19.385271 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m19:55:19.386941 [debug] [MainThread]: Command end result
[0m19:55:19.414577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:55:19.416391 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:55:19.424349 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m19:55:19.424803 [info ] [MainThread]: 
[0m19:55:19.425290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:55:19.425829 [info ] [MainThread]: 
[0m19:55:19.426286 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:55:19.428866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3337502, "process_in_blocks": "0", "process_kernel_time": 1.117654, "process_mem_max_rss": "195088384", "process_out_blocks": "0", "process_user_time": 5.872046}
[0m19:55:19.429520 [debug] [MainThread]: Command `dbt run` succeeded at 19:55:19.429366 after 7.33 seconds
[0m19:55:19.430023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e517ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b1c30b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b1677d0>]}
[0m19:55:19.430508 [debug] [MainThread]: Flushing usage events
[0m19:55:19.798078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:58:23.965512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127491c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132bf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113325c70>]}


============================== 19:58:23.972267 | 429e1f80-c50e-43c6-a8e8-b41cdba8d774 ==============================
[0m19:58:23.972267 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:58:23.973061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select input', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:58:25.335475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11346a1b0>]}
[0m19:58:25.400804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f58bdd0>]}
[0m19:58:25.401682 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:58:25.553780 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:58:25.728073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:58:25.728449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:58:25.775002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f7773e0>]}
[0m19:58:25.864132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:58:25.865978 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:58:25.880901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9d01a0>]}
[0m19:58:25.881456 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m19:58:25.881880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fad6c90>]}
[0m19:58:25.883938 [info ] [MainThread]: 
[0m19:58:25.884376 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m19:58:25.884791 [info ] [MainThread]: 
[0m19:58:25.885484 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:58:25.891004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m19:58:25.966191 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m19:58:25.966576 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m19:58:25.966886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:26.793772 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb8552-0104-e645-0004-59ff001a11da
[0m19:58:26.794285 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:58:26.794831 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:58:26.795252 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:58:26.796026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429e1f80-c50e-43c6-a8e8-b41cdba8d774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9a6ba0>]}
[0m19:58:26.798964 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m19:58:26.799495 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m19:58:26.800033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m19:58:26.800674 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m19:58:26.801165 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m19:58:26.801675 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m19:58:26.812012 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m19:58:26.815029 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m19:58:26.816339 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m19:58:26.817197 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m19:58:26.818665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:26.819045 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m19:58:26.819428 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m19:58:26.938584 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was properly closed.
[0m19:58:26.939273 [info ] [MainThread]: 
[0m19:58:26.939896 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m19:58:26.940716 [debug] [MainThread]: Command end result
[0m19:58:27.049482 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:58:27.051333 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:58:27.055663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m19:58:27.059055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1718254, "process_in_blocks": "0", "process_kernel_time": 0.86305, "process_mem_max_rss": "188960768", "process_out_blocks": "0", "process_user_time": 3.960714}
[0m19:58:27.059793 [debug] [MainThread]: Command `dbt run` succeeded at 19:58:27.059636 after 3.17 seconds
[0m19:58:27.060328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11828a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9f5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9f45c0>]}
[0m19:58:27.060842 [debug] [MainThread]: Flushing usage events
[0m19:58:27.430290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:12.522910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110357290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110885b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110885760>]}


============================== 19:59:12.528458 | 45f36b96-f4cd-44d0-b854-84dd613a4944 ==============================
[0m19:59:12.528458 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:59:12.529218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select input', 'send_anonymous_usage_stats': 'True'}
[0m19:59:13.725940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c7bf920>]}
[0m19:59:13.790066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4450a0>]}
[0m19:59:13.790865 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:59:13.940141 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:59:14.095659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:14.096039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:14.141823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cc1b740>]}
[0m19:59:14.226429 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:59:14.228342 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:59:14.243856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cf73020>]}
[0m19:59:14.244393 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m19:59:14.244811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ce798b0>]}
[0m19:59:14.246719 [info ] [MainThread]: 
[0m19:59:14.247142 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m19:59:14.247505 [info ] [MainThread]: 
[0m19:59:14.248088 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:59:14.253446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m19:59:14.329444 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m19:59:14.329834 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m19:59:14.330144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:14.973237 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.643 seconds
[0m19:59:14.976032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f36b96-f4cd-44d0-b854-84dd613a4944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cad16d0>]}
[0m19:59:14.979010 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m19:59:14.979590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m19:59:14.980084 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m19:59:14.986002 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m19:59:14.990761 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m19:59:14.991451 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m19:59:14.992227 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m19:59:14.995724 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m19:59:14.996761 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m19:59:14.997826 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m19:59:14.999383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:14.999786 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m19:59:15.000196 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m19:59:15.150492 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was properly closed.
[0m19:59:15.150987 [info ] [MainThread]: 
[0m19:59:15.151448 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m19:59:15.152262 [debug] [MainThread]: Command end result
[0m19:59:15.338563 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m19:59:15.340529 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m19:59:15.344666 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m19:59:15.347174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8970356, "process_in_blocks": "0", "process_kernel_time": 0.832286, "process_mem_max_rss": "188100608", "process_out_blocks": "0", "process_user_time": 3.797138}
[0m19:59:15.347829 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:15.347679 after 2.90 seconds
[0m19:59:15.348335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c90e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c90c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105192b0>]}
[0m19:59:15.348818 [debug] [MainThread]: Flushing usage events
[0m19:59:15.683641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:25.604612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11281c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11298dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11298d880>]}


============================== 20:01:25.610013 | 04373792-94bb-4cdd-a227-00737c900e62 ==============================
[0m20:01:25.610013 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:01:25.610723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select output', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:01:26.774320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177c3170>]}
[0m20:01:26.839640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c2b8c0>]}
[0m20:01:26.840483 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:01:26.990153 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:01:27.146621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:27.147134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:27.193875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112968740>]}
[0m20:01:27.277177 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:01:27.279084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:01:27.292974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ef2b710>]}
[0m20:01:27.293433 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m20:01:27.293784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b3f80>]}
[0m20:01:27.295438 [info ] [MainThread]: 
[0m20:01:27.295799 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:01:27.296111 [info ] [MainThread]: 
[0m20:01:27.296649 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:01:27.297479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m20:01:27.375768 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m20:01:27.376232 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m20:01:27.376607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:27.957263 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.581 seconds
[0m20:01:27.965871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m20:01:27.979233 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:01:27.979738 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:01:28.099894 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.120 seconds
[0m20:01:28.102171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ef29460>]}
[0m20:01:28.105370 [debug] [Thread-1 (]: Began running node model.homework7.session_summary
[0m20:01:28.106038 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m20:01:28.106739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_summary)
[0m20:01:28.107331 [debug] [Thread-1 (]: Began compiling node model.homework7.session_summary
[0m20:01:28.120549 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m20:01:28.124541 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m20:01:28.127037 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m20:01:28.127790 [debug] [Thread-1 (]: Began executing node model.homework7.session_summary
[0m20:01:28.166927 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m20:01:28.168511 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_summary"
[0m20:01:28.168989 [debug] [Thread-1 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (with __dbt__cte__user_session_channel as (
SELECT
 userId,
 sessionId,
 channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
),  __dbt__cte__session_timestamp as (
SELECT
 sessionId,
 ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
) SELECT u.userId, u.sessionId, u.channel, st.ts
FROM __dbt__cte__user_session_channel u
JOIN __dbt__cte__session_timestamp st ON u.sessionId = st.sessionId
        );
[0m20:01:29.483793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.314 seconds
[0m20:01:29.513699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04373792-94bb-4cdd-a227-00737c900e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de5940>]}
[0m20:01:29.514498 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.41s]
[0m20:01:29.515285 [debug] [Thread-1 (]: Finished running node model.homework7.session_summary
[0m20:01:29.516862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:29.517283 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m20:01:29.517762 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m20:01:29.638349 [info ] [MainThread]: 
[0m20:01:29.639068 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m20:01:29.640304 [debug] [MainThread]: Command end result
[0m20:01:29.750423 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:01:29.752344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:01:29.760163 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:01:29.760594 [info ] [MainThread]: 
[0m20:01:29.761107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:29.761551 [info ] [MainThread]: 
[0m20:01:29.762001 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:01:29.764583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.233984, "process_in_blocks": "0", "process_kernel_time": 0.812591, "process_mem_max_rss": "187310080", "process_out_blocks": "0", "process_user_time": 3.92447}
[0m20:01:29.765224 [debug] [MainThread]: Command `dbt run` succeeded at 20:01:29.765073 after 4.23 seconds
[0m20:01:29.765722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8cf5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d07a0>]}
[0m20:01:29.766198 [debug] [MainThread]: Flushing usage events
[0m20:01:30.135358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:13.194940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107286de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109579ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109579910>]}


============================== 20:03:13.200499 | 912167af-477b-450e-bfc8-5cb4bf361ead ==============================
[0m20:03:13.200499 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:03:13.201215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select input', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:03:14.396026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a150d0>]}
[0m20:03:14.460643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457742c0>]}
[0m20:03:14.461448 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:03:14.608594 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:03:14.739409 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:03:14.739884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908b2c0>]}
[0m20:03:16.234342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145bce630>]}
[0m20:03:16.314579 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:03:16.316167 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:03:16.329619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c536f30>]}
[0m20:03:16.330067 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m20:03:16.330413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107463dd0>]}
[0m20:03:16.331922 [info ] [MainThread]: 
[0m20:03:16.332268 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:03:16.332571 [info ] [MainThread]: 
[0m20:03:16.333045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:16.337309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m20:03:16.400551 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m20:03:16.400931 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m20:03:16.401224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:16.961980 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.561 seconds
[0m20:03:16.965400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m20:03:16.978794 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:03:16.979428 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:03:17.110364 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m20:03:17.113785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145dbedb0>]}
[0m20:03:17.118050 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m20:03:17.118745 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.session_timestamp ........................ [RUN]
[0m20:03:17.119336 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m20:03:17.119869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m20:03:17.120503 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics.user_session_channel ..................... [RUN]
[0m20:03:17.121120 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m20:03:17.121784 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m20:03:17.131742 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m20:03:17.132293 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m20:03:17.135687 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m20:03:17.136513 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m20:03:17.143369 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m20:03:17.197920 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m20:03:17.194759 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m20:03:17.199217 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m20:03:17.199673 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    SELECT
 userId,
 sessionId,
 channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
  );
[0m20:03:17.200121 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:03:17.201579 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m20:03:17.202009 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    SELECT
 sessionId,
 ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
  );
[0m20:03:17.489257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m20:03:17.518517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a9490>]}
[0m20:03:17.519318 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.40s]
[0m20:03:17.522178 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m20:03:17.753462 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m20:03:17.757388 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912167af-477b-450e-bfc8-5cb4bf361ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1463ed9a0>]}
[0m20:03:17.758337 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.64s]
[0m20:03:17.759144 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m20:03:17.760908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:17.761334 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m20:03:17.761744 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m20:03:17.884783 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m20:03:17.885459 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m20:03:18.004418 [info ] [MainThread]: 
[0m20:03:18.004972 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m20:03:18.006139 [debug] [MainThread]: Command end result
[0m20:03:18.032300 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:03:18.034018 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:03:18.041246 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:03:18.041742 [info ] [MainThread]: 
[0m20:03:18.042301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:03:18.042720 [info ] [MainThread]: 
[0m20:03:18.043162 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:03:18.045587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9229636, "process_in_blocks": "0", "process_kernel_time": 0.816385, "process_mem_max_rss": "193069056", "process_out_blocks": "0", "process_user_time": 5.301402}
[0m20:03:18.046197 [debug] [MainThread]: Command `dbt run` succeeded at 20:03:18.046053 after 4.92 seconds
[0m20:03:18.046679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109550aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459f40b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145d8d670>]}
[0m20:03:18.047137 [debug] [MainThread]: Flushing usage events
[0m20:03:18.426016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:57.738358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e195d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaf9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaf98e0>]}


============================== 20:21:57.746513 | 3ae17d70-d540-4f72-8ecd-19ca7a6a951c ==============================
[0m20:21:57.746513 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:21:57.747527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:22:00.026337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc0500>]}
[0m20:22:00.092026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d675f0>]}
[0m20:22:00.093416 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:22:00.276588 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:22:00.482116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:22:00.482704 [debug] [MainThread]: Partial parsing: added file: homework7://snapshots/snapshot_session_summary.sql
[0m20:22:00.605565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14af1b9e0>]}
[0m20:22:00.705563 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:22:00.707424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:22:00.743406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b1321e0>]}
[0m20:22:00.744087 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 474 macros
[0m20:22:00.744651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae17d70-d540-4f72-8ecd-19ca7a6a951c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113228920>]}
[0m20:22:00.747023 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:22:00.748327 [debug] [MainThread]: Command end result
[0m20:22:00.773540 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:22:00.775253 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:22:00.779169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:22:00.785428 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 3.1397839, "process_in_blocks": "0", "process_kernel_time": 0.934806, "process_mem_max_rss": "179912704", "process_out_blocks": "0", "process_user_time": 3.880532}
[0m20:22:00.786159 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:22:00.786010 after 3.14 seconds
[0m20:22:00.786687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e79a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df90290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14af1bda0>]}
[0m20:22:00.787159 [debug] [MainThread]: Flushing usage events
[0m20:22:01.224538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:00.493479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e640e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9759d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a975670>]}


============================== 20:26:00.500745 | 49ecf855-b297-481b-be1c-153ff6c0df57 ==============================
[0m20:26:00.500745 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:26:00.501576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:26:02.471973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9771a0>]}
[0m20:26:02.537301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9037d0>]}
[0m20:26:02.538787 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:26:02.708681 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:26:02.910539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:02.911263 [debug] [MainThread]: Partial parsing: updated file: homework7://snapshots/snapshot_session_summary.sql
[0m20:26:03.272788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472fba10>]}
[0m20:26:03.374773 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:26:03.376599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:26:03.408518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472a7c50>]}
[0m20:26:03.409147 [info ] [MainThread]: Found 5 models, 4 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:26:03.409618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472a0320>]}
[0m20:26:03.412091 [info ] [MainThread]: 
[0m20:26:03.412584 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:26:03.412997 [info ] [MainThread]: 
[0m20:26:03.413654 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:26:03.414830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m20:26:03.628671 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m20:26:03.629051 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m20:26:03.629354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:04.334326 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.705 seconds
[0m20:26:04.337126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now create_user_db_lobster_snapshot)
[0m20:26:04.337820 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster"
schema: "snapshot"
"
[0m20:26:04.343696 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster_snapshot"
[0m20:26:04.344200 [debug] [ThreadPool]: On create_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster_snapshot"} */
create schema if not exists user_db_lobster.snapshot
[0m20:26:04.473531 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m20:26:04.481803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster_snapshot, now list_user_db_lobster_snapshot)
[0m20:26:04.482569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:26:04.502468 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:26:04.507168 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:26:04.507595 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:26:04.508090 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:26:04.509334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:04.633510 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.125 seconds
[0m20:26:04.943573 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.434 seconds
[0m20:26:04.947491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f89c9b0>]}
[0m20:26:04.952230 [debug] [Thread-1 (]: Began running node snapshot.homework7.snapshot_session_summary
[0m20:26:04.952973 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:26:04.953603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now snapshot.homework7.snapshot_session_summary)
[0m20:26:04.954095 [debug] [Thread-1 (]: Began compiling node snapshot.homework7.snapshot_session_summary
[0m20:26:04.964243 [debug] [Thread-1 (]: Began executing node snapshot.homework7.snapshot_session_summary
[0m20:26:05.057022 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:26:05.057469 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to
from (
        

SELECT * FROM user_db_lobster.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m20:26:05.733006 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.675 seconds
[0m20:26:05.741396 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:26:05.741945 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:26:05.825649 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m20:26:05.826801 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.homework7.snapshot_session_summary"
[0m20:26:05.828742 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:26:05.829349 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
create or replace transient table user_db_lobster.snapshot.snapshot_session_summary
         as
        (
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to
from (
        

SELECT * FROM user_db_lobster.analytics.session_summary
    ) sbq



        );
[0m20:26:07.619305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m20:26:07.654338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ecf855-b297-481b-be1c-153ff6c0df57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a951c10>]}
[0m20:26:07.655459 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 1[0m in 2.70s]
[0m20:26:07.656313 [debug] [Thread-1 (]: Finished running node snapshot.homework7.snapshot_session_summary
[0m20:26:07.658080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:07.658482 [debug] [MainThread]: Connection 'snapshot.homework7.snapshot_session_summary' was left open.
[0m20:26:07.658886 [debug] [MainThread]: On snapshot.homework7.snapshot_session_summary: Close
[0m20:26:07.779222 [debug] [MainThread]: Connection 'list_user_db_lobster_analytics' was left open.
[0m20:26:07.779738 [debug] [MainThread]: On list_user_db_lobster_analytics: Close
[0m20:26:07.906472 [info ] [MainThread]: 
[0m20:26:07.907029 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m20:26:07.908040 [debug] [MainThread]: Command end result
[0m20:26:07.933575 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:26:07.935628 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:26:07.943467 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:26:07.943991 [info ] [MainThread]: 
[0m20:26:07.944655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:07.945084 [info ] [MainThread]: 
[0m20:26:07.945610 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:26:07.950059 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.5475793, "process_in_blocks": "0", "process_kernel_time": 1.136979, "process_mem_max_rss": "191938560", "process_out_blocks": "0", "process_user_time": 4.915972}
[0m20:26:07.950921 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:26:07.950602 after 7.55 seconds
[0m20:26:07.951467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a522600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e16510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e14500>]}
[0m20:26:07.951953 [debug] [MainThread]: Flushing usage events
[0m20:26:08.330210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:12.164436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9ef680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce15b0>]}


============================== 20:28:12.169885 | 83541a4a-aee2-46d3-bd6e-0757d9fb8402 ==============================
[0m20:28:12.169885 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:28:12.170651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:28:13.383337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e08ac00>]}
[0m20:28:13.447783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c94b60>]}
[0m20:28:13.448584 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:28:13.610494 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:28:13.797343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:13.797738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:13.858278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a125c70>]}
[0m20:28:13.957133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:28:13.959196 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:28:13.975477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3499d0>]}
[0m20:28:13.976020 [info ] [MainThread]: Found 5 models, 4 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:28:13.976446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcbd190>]}
[0m20:28:13.978558 [info ] [MainThread]: 
[0m20:28:13.978986 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:28:13.979348 [info ] [MainThread]: 
[0m20:28:13.979937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:13.980835 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m20:28:14.050377 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m20:28:14.050777 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m20:28:14.051094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:14.664496 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.613 seconds
[0m20:28:14.672704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_snapshot)
[0m20:28:14.673481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:28:14.688414 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:28:14.689290 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:28:14.689704 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:28:14.690146 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:28:14.690559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:14.819240 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m20:28:15.175801 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.485 seconds
[0m20:28:15.179059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a74eb10>]}
[0m20:28:15.181973 [debug] [Thread-1 (]: Began running node snapshot.homework7.snapshot_session_summary
[0m20:28:15.182661 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m20:28:15.183322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now snapshot.homework7.snapshot_session_summary)
[0m20:28:15.183823 [debug] [Thread-1 (]: Began compiling node snapshot.homework7.snapshot_session_summary
[0m20:28:15.196099 [debug] [Thread-1 (]: Began executing node snapshot.homework7.snapshot_session_summary
[0m20:28:15.347405 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:15.347953 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:28:15.435445 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.087 seconds
[0m20:28:15.512752 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:15.513386 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        

SELECT * FROM user_db_lobster.analytics.session_summary

    ),

    snapshotted_data as (

        select *, 
    
        sessionId as dbt_unique_key
    

        from "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    
,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    
,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            ts as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.ts))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.ts)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:28:16.750696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.237 seconds
[0m20:28:16.754470 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:16.754999 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:28:16.857028 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.101 seconds
[0m20:28:16.861994 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:16.862550 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:28:16.977731 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.115 seconds
[0m20:28:16.982657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:16.983309 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:28:17.085409 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.101 seconds
[0m20:28:17.090916 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.092792 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m20:28:17.181216 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.088 seconds
[0m20:28:17.190477 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.191029 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m20:28:17.289128 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.098 seconds
[0m20:28:17.320345 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.321064 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
select * from (
        
    
    with snapshot_query as (

        

SELECT * FROM user_db_lobster.analytics.session_summary

    ),

    snapshotted_data as (

        select *, 
    
        sessionId as dbt_unique_key
    

        from "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    
,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    
,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            ts as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        sessionId as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.ts))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.ts)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m20:28:17.776265 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.454 seconds
[0m20:28:17.781381 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.781899 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:28:17.880675 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m20:28:17.881772 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.883730 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.884322 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
BEGIN
[0m20:28:17.993808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m20:28:17.994539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:17.995183 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("USERID", "SESSIONID", "CHANNEL", "TS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("USERID", "SESSIONID", "CHANNEL", "TS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:28:19.330062 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.334 seconds
[0m20:28:19.330770 [debug] [Thread-1 (]: Using snowflake connection "snapshot.homework7.snapshot_session_summary"
[0m20:28:19.331259 [debug] [Thread-1 (]: On snapshot.homework7.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "snapshot.homework7.snapshot_session_summary"} */
COMMIT
[0m20:28:19.568808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m20:28:19.599358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83541a4a-aee2-46d3-bd6e-0757d9fb8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d125970>]}
[0m20:28:19.600388 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 2[0m in 4.41s]
[0m20:28:19.601231 [debug] [Thread-1 (]: Finished running node snapshot.homework7.snapshot_session_summary
[0m20:28:19.603015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:19.603426 [debug] [MainThread]: Connection 'snapshot.homework7.snapshot_session_summary' was left open.
[0m20:28:19.603834 [debug] [MainThread]: On snapshot.homework7.snapshot_session_summary: Close
[0m20:28:19.917138 [debug] [MainThread]: Connection 'list_user_db_lobster_analytics' was left open.
[0m20:28:19.917709 [debug] [MainThread]: On list_user_db_lobster_analytics: Close
[0m20:28:20.047489 [info ] [MainThread]: 
[0m20:28:20.048057 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m20:28:20.049018 [debug] [MainThread]: Command end result
[0m20:28:20.076040 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:28:20.077915 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:28:20.119248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:28:20.120520 [info ] [MainThread]: 
[0m20:28:20.139621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:20.140409 [info ] [MainThread]: 
[0m20:28:20.158277 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:20.161069 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.06887, "process_in_blocks": "0", "process_kernel_time": 0.839272, "process_mem_max_rss": "189124608", "process_out_blocks": "0", "process_user_time": 4.317846}
[0m20:28:20.161748 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:28:20.161592 after 8.07 seconds
[0m20:28:20.162259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddf1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a51e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a51e210>]}
[0m20:28:20.162744 [debug] [MainThread]: Flushing usage events
[0m20:28:20.552400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:39.247166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c0ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a9940>]}


============================== 20:42:39.253597 | 9babcdda-a3fe-4665-81ac-818a51af218d ==============================
[0m20:42:39.253597 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:42:39.254462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:42:41.277831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111036690>]}
[0m20:42:41.346414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161e7170>]}
[0m20:42:41.347732 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:42:41.518891 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:42:41.740609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:42:41.741367 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m20:42:41.961684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8dcef0>]}
[0m20:42:42.053798 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:42:42.055531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:42:42.104649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fc0d9a0>]}
[0m20:42:42.105330 [info ] [MainThread]: Found 5 models, 4 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:42:42.105812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fa450a0>]}
[0m20:42:42.108652 [info ] [MainThread]: 
[0m20:42:42.109155 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:42:42.109574 [info ] [MainThread]: 
[0m20:42:42.110339 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:42:42.116682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:42:42.123740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m20:42:42.302885 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:42:42.303514 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:42:42.303891 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:42:42.304285 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:42:42.304665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:42.305036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:42.955896 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.651 seconds
[0m20:42:42.960671 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.656 seconds
[0m20:42:42.963948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9babcdda-a3fe-4665-81ac-818a51af218d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f7e00>]}
[0m20:42:42.969008 [debug] [Thread-1 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:42:42.969675 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:42:42.970182 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:42:42.970754 [debug] [Thread-3 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:42:42.971235 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:42:42.971796 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:42:42.972347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:42:42.972893 [info ] [Thread-3 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:42:42.973475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m20:42:42.973995 [info ] [Thread-4 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:42:42.974533 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:42:42.975432 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m20:42:42.975944 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:42:42.976568 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493'
[0m20:42:42.988975 [debug] [Thread-3 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:42:42.999032 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:42:43.003728 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:42:43.004334 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:42:43.012171 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:42:43.017020 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:42:43.018137 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:42:43.024028 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:42:43.036023 [debug] [Thread-3 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:42:43.043826 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:42:43.060255 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:42:43.070318 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:42:43.073000 [debug] [Thread-4 (]: Writing runtime sql for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:42:43.073705 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:42:43.075220 [debug] [Thread-4 (]: Using snowflake connection "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:42:43.075644 [debug] [Thread-4 (]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:42:43.076044 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:42:43.076809 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:42:43.077245 [debug] [Thread-2 (]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:42:43.079702 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:42:43.080237 [debug] [Thread-1 (]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:42:43.082823 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:42:43.083488 [debug] [Thread-3 (]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:42:43.083980 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:42:43.185312 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb857e-0104-e06d-0004-59ff001873f6
[0m20:42:43.185762 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:42:43.189907 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:42:43.190412 [error] [Thread-2 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.22s]
[0m20:42:43.191023 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:42:43.192186 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m20:42:43.193390 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb857e-0104-e06c-0004-59ff00198352
[0m20:42:43.193755 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:42:43.196897 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:42:43.197370 [error] [Thread-1 (]: 1 of 4 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.23s]
[0m20:42:43.197946 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:42:43.198459 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m20:42:43.483772 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb857e-0104-e072-0004-59ff0018b3aa
[0m20:42:43.484455 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:42:43.488624 [debug] [Thread-4 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:42:43.489272 [error] [Thread-4 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.51s]
[0m20:42:43.490092 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:42:43.490865 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m20:42:43.496300 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bb857e-0104-e5e9-0004-59ff0019f28e
[0m20:42:43.497005 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:42:43.501000 [debug] [Thread-3 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:42:43.501635 [error] [Thread-3 (]: 3 of 4 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.53s]
[0m20:42:43.502428 [debug] [Thread-3 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:42:43.503211 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m20:42:43.504877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:43.505301 [debug] [MainThread]: Connection 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' was left open.
[0m20:42:43.505712 [debug] [MainThread]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:42:43.638433 [debug] [MainThread]: Connection 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' was left open.
[0m20:42:43.638960 [debug] [MainThread]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:42:43.756615 [debug] [MainThread]: Connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321' was left open.
[0m20:42:43.757291 [debug] [MainThread]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:42:43.881700 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m20:42:43.882218 [debug] [MainThread]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:42:44.003540 [info ] [MainThread]: 
[0m20:42:44.004289 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m20:42:44.005946 [debug] [MainThread]: Command end result
[0m20:42:44.033913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:42:44.035755 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:42:44.044821 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:42:44.045293 [info ] [MainThread]: 
[0m20:42:44.045821 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m20:42:44.046277 [info ] [MainThread]: 
[0m20:42:44.046923 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:42:44.047368 [info ] [MainThread]: 
[0m20:42:44.047876 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:42:44.048304 [info ] [MainThread]: 
[0m20:42:44.048800 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:42:44.049225 [info ] [MainThread]: 
[0m20:42:44.049723 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:42:44.050147 [info ] [MainThread]: 
[0m20:42:44.050605 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m20:42:44.053013 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.881109, "process_in_blocks": "0", "process_kernel_time": 0.991156, "process_mem_max_rss": "194392064", "process_out_blocks": "0", "process_user_time": 4.573567}
[0m20:42:44.053771 [debug] [MainThread]: Command `dbt test` failed at 20:42:44.053620 after 4.88 seconds
[0m20:42:44.054272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113037a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eece00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbc44d0>]}
[0m20:42:44.054740 [debug] [MainThread]: Flushing usage events
[0m20:42:44.417811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:59.198031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111058200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a99a0>]}


============================== 20:47:59.205667 | b7ef86d6-bd6b-4356-bffb-52ce43f86010 ==============================
[0m20:47:59.205667 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:47:59.206571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:48:01.231414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7ef86d6-bd6b-4356-bffb-52ce43f86010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef36720>]}
[0m20:48:01.305772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7ef86d6-bd6b-4356-bffb-52ce43f86010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c8290>]}
[0m20:48:01.307206 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:48:01.477660 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:48:01.645078 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading homework7: output/schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | models:
    3  |  - name: session_summary
    4  |  description: "Analytics model for session data"
    5  |  columns:
    6  |  - name: sessionId
    7  |  description: "Unique identifier for each stock price record"
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 2
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 2
[0m20:48:01.649016 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.5315037, "process_in_blocks": "0", "process_kernel_time": 1.000244, "process_mem_max_rss": "177188864", "process_out_blocks": "0", "process_user_time": 3.784936}
[0m20:48:01.649817 [debug] [MainThread]: Command `dbt test` failed at 20:48:01.649653 after 2.53 seconds
[0m20:48:01.650403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c29040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d714050>]}
[0m20:48:01.650950 [debug] [MainThread]: Flushing usage events
[0m20:48:02.027631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:48.498106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a9970>]}


============================== 20:49:48.503333 | 37b504b3-c28e-46e1-897b-a8aad0dcc056 ==============================
[0m20:49:48.503333 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:49:48.504125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m20:49:49.711247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b9a20c0>]}
[0m20:49:49.776970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8708c0>]}
[0m20:49:49.777831 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:49:49.929270 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:49:50.139078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:49:50.139800 [debug] [MainThread]: Partial parsing: added file: homework7://models/output/schema.yml
[0m20:49:50.443786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bcdbf80>]}
[0m20:49:50.539891 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:49:50.541678 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:49:50.675397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bf2fcb0>]}
[0m20:49:50.676106 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:49:50.676638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101dd010>]}
[0m20:49:50.679565 [info ] [MainThread]: 
[0m20:49:50.680101 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:49:50.680562 [info ] [MainThread]: 
[0m20:49:50.681253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:50.687506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m20:49:50.694696 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:49:50.798082 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:49:50.798688 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:49:50.799080 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:49:50.799473 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:49:50.799853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:50.800221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:51.423868 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.624 seconds
[0m20:49:51.439727 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.640 seconds
[0m20:49:51.443239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37b504b3-c28e-46e1-897b-a8aad0dcc056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bf2f710>]}
[0m20:49:51.447463 [debug] [Thread-1 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:51.448054 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:51.448577 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:49:51.449183 [debug] [Thread-3 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:49:51.449663 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:49:51.450124 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:49:51.450691 [debug] [Thread-5 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:51.451235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:49:51.451793 [info ] [Thread-3 (]: 3 of 6 START test not_null_session_summary_sessionId ........................... [RUN]
[0m20:49:51.452377 [info ] [Thread-4 (]: 4 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:49:51.453262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m20:49:51.453795 [info ] [Thread-5 (]: 5 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:49:51.454385 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:51.455034 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6'
[0m20:49:51.455681 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m20:49:51.456319 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:51.456964 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493'
[0m20:49:51.469204 [debug] [Thread-3 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:49:51.480239 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:51.480826 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:49:51.485512 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:51.486223 [debug] [Thread-5 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:51.491279 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:49:51.499063 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:51.503522 [debug] [Thread-5 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:51.504341 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:51.505041 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:51.505652 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:49:51.537234 [debug] [Thread-5 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:51.542453 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:51.545277 [debug] [Thread-5 (]: Writing runtime sql for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:51.552949 [debug] [Thread-4 (]: Writing runtime sql for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:51.561051 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:51.561847 [debug] [Thread-3 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:49:51.563184 [debug] [Thread-5 (]: Using snowflake connection "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:49:51.563910 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:49:51.564950 [debug] [Thread-4 (]: Using snowflake connection "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:49:51.567685 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:49:51.568225 [debug] [Thread-5 (]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:49:51.569019 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:49:51.569447 [debug] [Thread-2 (]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:49:51.569919 [debug] [Thread-4 (]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:49:51.570561 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:49:51.571102 [debug] [Thread-1 (]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:49:51.572454 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:49:51.573459 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:49:51.579547 [debug] [Thread-3 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m20:49:51.580510 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:49:51.671740 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb8585-0104-e06c-0004-59ff00198366
[0m20:49:51.672202 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:49:51.674985 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb8585-0104-e13d-0004-59ff0019142e
[0m20:49:51.675395 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:49:51.679643 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:49:51.680151 [error] [Thread-1 (]: 1 of 6 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.23s]
[0m20:49:51.680776 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:49:51.681203 [debug] [Thread-1 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:49:51.681581 [info ] [Thread-1 (]: 6 of 6 START test unique_session_summary_sessionId ............................. [RUN]
[0m20:49:51.682208 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m20:49:51.683835 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:49:51.684247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_first_dbt_model_id.5fb22c2710, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m20:49:51.685423 [error] [Thread-2 (]: 2 of 6 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.23s]
[0m20:49:51.685873 [debug] [Thread-1 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:49:51.686444 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:49:51.690504 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:49:51.691144 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m20:49:51.691809 [debug] [Thread-1 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:49:51.694039 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:49:51.695001 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:49:51.695383 [debug] [Thread-1 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m20:49:52.013222 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb8585-0104-e113-0004-59ff00189dde
[0m20:49:52.013924 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:49:52.017968 [debug] [Thread-5 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:49:52.018610 [error] [Thread-5 (]: 5 of 6 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.56s]
[0m20:49:52.019432 [debug] [Thread-5 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:49:52.020128 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m20:49:52.021897 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb8585-0104-e078-0004-59ff0019d2fe
[0m20:49:52.022469 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:49:52.026328 [debug] [Thread-4 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:49:52.026920 [error] [Thread-4 (]: 4 of 6 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.57s]
[0m20:49:52.027702 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:49:52.028467 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m20:49:52.400055 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m20:49:52.412617 [info ] [Thread-3 (]: 3 of 6 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.96s]
[0m20:49:52.413455 [debug] [Thread-3 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:49:52.596069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m20:49:52.599487 [info ] [Thread-1 (]: 6 of 6 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.92s]
[0m20:49:52.600453 [debug] [Thread-1 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:49:52.602179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:52.602596 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m20:49:52.603024 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m20:49:52.734451 [debug] [MainThread]: Connection 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' was left open.
[0m20:49:52.734911 [debug] [MainThread]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:49:52.871118 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m20:49:52.871710 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m20:49:52.995720 [debug] [MainThread]: Connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321' was left open.
[0m20:49:52.996309 [debug] [MainThread]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:49:53.114096 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m20:49:53.114678 [debug] [MainThread]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:49:53.243508 [info ] [MainThread]: 
[0m20:49:53.244151 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m20:49:53.246393 [debug] [MainThread]: Command end result
[0m20:49:53.274849 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:49:53.276692 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:49:53.285618 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:49:53.286069 [info ] [MainThread]: 
[0m20:49:53.286556 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m20:49:53.286989 [info ] [MainThread]: 
[0m20:49:53.287605 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:49:53.288058 [info ] [MainThread]: 
[0m20:49:53.288561 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:49:53.289115 [info ] [MainThread]: 
[0m20:49:53.289644 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:49:53.290144 [info ] [MainThread]: 
[0m20:49:53.290727 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:49:53.291168 [info ] [MainThread]: 
[0m20:49:53.291613 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m20:49:53.294367 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.8683653, "process_in_blocks": "0", "process_kernel_time": 0.87867, "process_mem_max_rss": "196186112", "process_out_blocks": "0", "process_user_time": 4.823345}
[0m20:49:53.295001 [debug] [MainThread]: Command `dbt test` failed at 20:49:53.294852 after 4.87 seconds
[0m20:49:53.295510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f433ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecd3b90>]}
[0m20:49:53.295972 [debug] [MainThread]: Flushing usage events
[0m20:49:53.667620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:13.423865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d463c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a5970>]}


============================== 20:50:13.429595 | b9100d30-c01d-4e99-bc64-ae97c4ccc94d ==============================
[0m20:50:13.429595 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:13.430350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:50:14.669232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adb500>]}
[0m20:50:14.734193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a21520>]}
[0m20:50:14.734978 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:50:14.885217 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:50:15.064604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:50:15.064981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:50:15.126420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764a000>]}
[0m20:50:15.225394 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:50:15.227284 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:50:15.254121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b15ca0>]}
[0m20:50:15.254724 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:50:15.255151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108187ad0>]}
[0m20:50:15.257767 [info ] [MainThread]: 
[0m20:50:15.258229 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:50:15.258606 [info ] [MainThread]: 
[0m20:50:15.259204 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:50:15.264888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:50:15.265567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m20:50:15.347328 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:50:15.347857 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:50:15.348233 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:50:15.348568 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:50:15.348886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:15.349186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:15.957009 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.608 seconds
[0m20:50:15.977752 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.628 seconds
[0m20:50:15.980709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9100d30-c01d-4e99-bc64-ae97c4ccc94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443f9b80>]}
[0m20:50:15.983980 [debug] [Thread-1 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:15.984523 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:50:15.985111 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:15.985642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:50:15.986124 [debug] [Thread-3 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:50:15.986647 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:50:15.987130 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:50:15.987758 [debug] [Thread-5 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:15.988240 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:15.988749 [info ] [Thread-3 (]: 3 of 6 START test not_null_session_summary_sessionId ........................... [RUN]
[0m20:50:15.989300 [info ] [Thread-4 (]: 4 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:50:16.068255 [info ] [Thread-5 (]: 5 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:50:16.071086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m20:50:16.078369 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6'
[0m20:50:16.096610 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m20:50:16.097271 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:16.097945 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493'
[0m20:50:16.098472 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:16.098988 [debug] [Thread-3 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:50:16.099491 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:50:16.100165 [debug] [Thread-5 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:16.105611 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:50:16.110660 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:50:16.117330 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:16.118961 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:16.123903 [debug] [Thread-5 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:16.142505 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:16.149874 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:16.150381 [debug] [Thread-3 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:50:16.153263 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:50:16.153747 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:50:16.154230 [debug] [Thread-5 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:16.157240 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:50:16.160143 [debug] [Thread-4 (]: Writing runtime sql for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:16.162492 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:16.165151 [debug] [Thread-5 (]: Writing runtime sql for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:16.166143 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m20:50:16.166790 [debug] [Thread-1 (]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:50:16.167589 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:50:16.168227 [debug] [Thread-2 (]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:50:16.169085 [debug] [Thread-4 (]: Using snowflake connection "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:16.169949 [debug] [Thread-5 (]: Using snowflake connection "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:50:16.171196 [debug] [Thread-3 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m20:50:16.172694 [debug] [Thread-4 (]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:50:16.173573 [debug] [Thread-5 (]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:50:16.174433 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:16.175230 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:16.175758 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:50:16.267661 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb8586-0104-e06d-0004-59ff0018741e
[0m20:50:16.268189 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:50:16.272086 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:50:16.272694 [error] [Thread-1 (]: 1 of 6 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.29s]
[0m20:50:16.273658 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:16.274162 [debug] [Thread-1 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:50:16.274616 [info ] [Thread-1 (]: 6 of 6 START test unique_session_summary_sessionId ............................. [RUN]
[0m20:50:16.275271 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m20:50:16.275742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_first_dbt_model_id.5fb22c2710, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m20:50:16.277619 [debug] [Thread-1 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:50:16.281712 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:50:16.282522 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb8586-0104-e072-0004-59ff0018b3c6
[0m20:50:16.283063 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:50:16.284768 [debug] [Thread-1 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:50:16.287097 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:50:16.289561 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:50:16.290358 [error] [Thread-2 (]: 2 of 6 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.30s]
[0m20:50:16.291177 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:16.291802 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m20:50:16.292628 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:50:16.293000 [debug] [Thread-1 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m20:50:16.425380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m20:50:16.437123 [info ] [Thread-1 (]: 6 of 6 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.16s]
[0m20:50:16.438009 [debug] [Thread-1 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:50:16.626397 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb8586-0104-e06c-0004-59ff0019836a
[0m20:50:16.626960 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m20:50:16.630855 [debug] [Thread-5 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:50:16.631471 [error] [Thread-5 (]: 5 of 6 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.53s]
[0m20:50:16.632259 [debug] [Thread-5 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:16.632958 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m20:50:16.634477 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb8586-0104-e383-0004-59ff001963d2
[0m20:50:16.634972 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m20:50:16.638918 [debug] [Thread-4 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:50:16.640385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m20:50:16.640994 [error] [Thread-4 (]: 4 of 6 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.54s]
[0m20:50:16.643831 [info ] [Thread-3 (]: 3 of 6 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.57s]
[0m20:50:16.644741 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m20:50:16.645498 [debug] [Thread-3 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:50:16.646246 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m20:50:16.648047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:16.648458 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m20:50:16.648928 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m20:50:16.784616 [debug] [MainThread]: Connection 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' was left open.
[0m20:50:16.785311 [debug] [MainThread]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:50:16.906171 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m20:50:16.906690 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m20:50:17.036724 [debug] [MainThread]: Connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321' was left open.
[0m20:50:17.037251 [debug] [MainThread]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:50:17.154964 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m20:50:17.155661 [debug] [MainThread]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:50:17.285666 [info ] [MainThread]: 
[0m20:50:17.286359 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m20:50:17.288792 [debug] [MainThread]: Command end result
[0m20:50:17.319013 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:50:17.321393 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:50:17.330610 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:50:17.331080 [info ] [MainThread]: 
[0m20:50:17.331577 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m20:50:17.332042 [info ] [MainThread]: 
[0m20:50:17.332633 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:50:17.333071 [info ] [MainThread]: 
[0m20:50:17.333579 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m20:50:17.334008 [info ] [MainThread]: 
[0m20:50:17.334517 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m20:50:17.334944 [info ] [MainThread]: 
[0m20:50:17.335440 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m20:50:17.335869 [info ] [MainThread]: 
[0m20:50:17.336325 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m20:50:17.338759 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.9895093, "process_in_blocks": "0", "process_kernel_time": 0.872816, "process_mem_max_rss": "193208320", "process_out_blocks": "0", "process_user_time": 4.481191}
[0m20:50:17.339383 [debug] [MainThread]: Command `dbt test` failed at 20:50:17.339233 after 3.99 seconds
[0m20:50:17.339951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14413f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fab560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fab0e0>]}
[0m20:50:17.340522 [debug] [MainThread]: Flushing usage events
[0m20:50:17.677838 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:24.307173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ef1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b92dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b92d910>]}


============================== 20:51:24.314585 | 5129956c-088a-49a3-9dc1-e567fe48e648 ==============================
[0m20:51:24.314585 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:51:24.315401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select session_summary', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:51:26.343054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107ddf70>]}
[0m20:51:26.408489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a31d0>]}
[0m20:51:26.409932 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:51:26.579331 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:51:26.801706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:26.802177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:26.868565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d826c0>]}
[0m20:51:26.966357 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:51:26.968138 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:51:27.019185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1482a9430>]}
[0m20:51:27.019810 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m20:51:27.020289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e93e5a0>]}
[0m20:51:27.022484 [info ] [MainThread]: 
[0m20:51:27.023030 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m20:51:27.023460 [info ] [MainThread]: 
[0m20:51:27.024145 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:51:27.030527 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m20:51:27.031247 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m20:51:27.137015 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m20:51:27.137617 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m20:51:27.137971 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m20:51:27.138339 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m20:51:27.138716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:27.139061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:27.792825 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.654 seconds
[0m20:51:27.815351 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.676 seconds
[0m20:51:27.819388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5129956c-088a-49a3-9dc1-e567fe48e648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10988bc50>]}
[0m20:51:27.824258 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:51:27.824885 [debug] [Thread-2 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:51:27.825583 [info ] [Thread-1 (]: 1 of 2 START test not_null_session_summary_sessionId ........................... [RUN]
[0m20:51:27.826185 [info ] [Thread-2 (]: 2 of 2 START test unique_session_summary_sessionId ............................. [RUN]
[0m20:51:27.826839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m20:51:27.827387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m20:51:27.827906 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:51:27.828400 [debug] [Thread-2 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:51:27.946453 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:51:27.947100 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:51:27.948040 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:51:27.954859 [debug] [Thread-2 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:51:27.990683 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:51:27.992509 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:51:27.993840 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m20:51:27.994413 [debug] [Thread-1 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m20:51:27.995689 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m20:51:27.996173 [debug] [Thread-2 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m20:51:28.099356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m20:51:28.113277 [info ] [Thread-1 (]: 1 of 2 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.29s]
[0m20:51:28.114245 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m20:51:28.135954 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m20:51:28.138473 [info ] [Thread-2 (]: 2 of 2 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.31s]
[0m20:51:28.139345 [debug] [Thread-2 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m20:51:28.141042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:28.141466 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m20:51:28.141959 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m20:51:28.278905 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m20:51:28.279507 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m20:51:28.398733 [info ] [MainThread]: 
[0m20:51:28.399392 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m20:51:28.400775 [debug] [MainThread]: Command end result
[0m20:51:28.429871 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m20:51:28.431750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m20:51:28.440476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m20:51:28.440915 [info ] [MainThread]: 
[0m20:51:28.441402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:28.441821 [info ] [MainThread]: 
[0m20:51:28.442443 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:51:28.445886 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.2290583, "process_in_blocks": "0", "process_kernel_time": 1.152994, "process_mem_max_rss": "191164416", "process_out_blocks": "0", "process_user_time": 4.59933}
[0m20:51:28.446584 [debug] [MainThread]: Command `dbt test` succeeded at 20:51:28.446431 after 4.23 seconds
[0m20:51:28.447092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147a0b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3caf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14870ed50>]}
[0m20:51:28.447569 [debug] [MainThread]: Flushing usage events
[0m20:51:28.810958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:08.952692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d57c0>]}


============================== 11:22:08.961120 | 20bad376-dfc5-4bc2-9961-f992a643adc8 ==============================
[0m11:22:08.961120 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:22:08.962013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:22:11.751493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4827b0>]}
[0m11:22:11.813770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f09ba10>]}
[0m11:22:11.815033 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:22:11.986307 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:22:12.223204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:22:12.224084 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m11:22:12.224987 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/schema.yml
[0m11:22:12.991886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e7de80>]}
[0m11:22:13.092142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:22:13.093797 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:22:13.150644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e1f380>]}
[0m11:22:13.151259 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m11:22:13.151733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e3f980>]}
[0m11:22:13.154382 [info ] [MainThread]: 
[0m11:22:13.154838 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:22:13.155247 [info ] [MainThread]: 
[0m11:22:13.155870 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:13.162000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:22:13.162716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:22:13.348409 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:22:13.348914 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:22:13.349220 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:22:13.349861 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:22:13.350186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:13.350495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:15.896117 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.545 seconds
[0m11:22:15.902661 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.552 seconds
[0m11:22:15.905631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20bad376-dfc5-4bc2-9961-f992a643adc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e1db50>]}
[0m11:22:15.910739 [debug] [Thread-1 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:22:15.911337 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:22:15.911876 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m11:22:15.912483 [debug] [Thread-3 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:15.912990 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m11:22:15.913573 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:22:15.914139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:22:15.914633 [debug] [Thread-5 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:22:15.915146 [info ] [Thread-3 (]: 3 of 6 START test not_null_session_summary_sessionId ........................... [RUN]
[0m11:22:15.916014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m11:22:15.916550 [info ] [Thread-4 (]: 4 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m11:22:15.917332 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:22:15.917872 [info ] [Thread-5 (]: 5 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m11:22:15.918603 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6'
[0m11:22:15.919127 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:22:15.919779 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m11:22:15.931986 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493'
[0m11:22:15.941734 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:22:15.942279 [debug] [Thread-3 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:15.947095 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m11:22:15.947607 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:22:15.948098 [debug] [Thread-5 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:22:15.953322 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:15.960439 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:22:15.962169 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m11:22:15.966792 [debug] [Thread-5 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:22:15.967495 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:22:15.992591 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:22:15.993159 [debug] [Thread-3 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:15.996008 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m11:22:15.996760 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:22:15.999301 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:16.000133 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:22:16.000671 [debug] [Thread-5 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:22:16.003199 [debug] [Thread-4 (]: Writing runtime sql for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m11:22:16.003940 [debug] [Thread-1 (]: On test.homework7.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m11:22:16.004774 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m11:22:16.007258 [debug] [Thread-5 (]: Writing runtime sql for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:22:16.008012 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:16.008971 [debug] [Thread-2 (]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from user_db_lobster.analytics.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m11:22:16.010242 [debug] [Thread-4 (]: Using snowflake connection "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m11:22:16.010766 [debug] [Thread-3 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m11:22:16.011664 [debug] [Thread-4 (]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:22:16.012403 [debug] [Thread-5 (]: Using snowflake connection "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:22:16.013328 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:22:16.013893 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:22:16.014272 [debug] [Thread-5 (]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:22:16.016207 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m11:22:16.158556 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb88ee-0104-e078-0004-59ff0019d3d6
[0m11:22:16.159321 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb88ee-0104-e068-0004-59ff0018c53a
[0m11:22:16.159944 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m11:22:16.160496 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m11:22:16.167836 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m11:22:16.168893 [error] [Thread-1 (]: 1 of 6 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.25s]
[0m11:22:16.169756 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:22:16.171691 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m11:22:16.172187 [debug] [Thread-1 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:16.172769 [error] [Thread-2 (]: 2 of 6 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.26s]
[0m11:22:16.173476 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m11:22:16.174613 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:22:16.173949 [info ] [Thread-1 (]: 6 of 6 START test unique_session_summary_sessionId ............................. [RUN]
[0m11:22:16.176109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_first_dbt_model_id.5fb22c2710, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m11:22:16.176732 [debug] [Thread-8 (]: Marking all children of 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m11:22:16.177164 [debug] [Thread-1 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:16.181927 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:16.182703 [debug] [Thread-1 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:16.185619 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:16.186929 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:16.187561 [debug] [Thread-1 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m11:22:16.345182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m11:22:16.358925 [info ] [Thread-1 (]: 6 of 6 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.18s]
[0m11:22:16.359819 [debug] [Thread-1 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:16.458638 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb88ee-0104-e692-0004-59ff001a500e
[0m11:22:16.459484 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m11:22:16.464063 [debug] [Thread-5 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m11:22:16.464711 [error] [Thread-5 (]: 5 of 6 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.53s]
[0m11:22:16.465525 [debug] [Thread-5 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:22:16.466227 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m11:22:16.541195 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb88ee-0104-e383-0004-59ff0019649a
[0m11:22:16.542024 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m11:22:16.546623 [debug] [Thread-4 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m11:22:16.547260 [error] [Thread-4 (]: 4 of 6 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.63s]
[0m11:22:16.548065 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:22:16.548768 [debug] [Thread-8 (]: Marking all children of 'test.homework7.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m11:22:16.559795 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m11:22:16.563120 [info ] [Thread-3 (]: 3 of 6 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.64s]
[0m11:22:16.564055 [debug] [Thread-3 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:16.565856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:16.566273 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:22:16.566703 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:22:16.753964 [debug] [MainThread]: Connection 'test.homework7.not_null_my_second_dbt_model_id.151b76d778' was left open.
[0m11:22:16.754545 [debug] [MainThread]: On test.homework7.not_null_my_second_dbt_model_id.151b76d778: Close
[0m11:22:16.883488 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m11:22:16.884131 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m11:22:17.036776 [debug] [MainThread]: Connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321' was left open.
[0m11:22:17.037358 [debug] [MainThread]: On test.homework7.unique_my_first_dbt_model_id.16e066b321: Close
[0m11:22:17.151069 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m11:22:17.151730 [debug] [MainThread]: On test.homework7.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m11:22:17.292454 [info ] [MainThread]: 
[0m11:22:17.293199 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m11:22:17.295218 [debug] [MainThread]: Command end result
[0m11:22:17.330242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:22:17.332974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:22:17.346914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:22:17.347532 [info ] [MainThread]: 
[0m11:22:17.348377 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m11:22:17.348959 [info ] [MainThread]: 
[0m11:22:17.349694 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m11:22:17.350770 [info ] [MainThread]: 
[0m11:22:17.351604 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m11:22:17.352286 [info ] [MainThread]: 
[0m11:22:17.353096 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m11:22:17.353905 [info ] [MainThread]: 
[0m11:22:17.354603 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_LOBSTER.ANALYTICS.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/homework7/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m11:22:17.355183 [info ] [MainThread]: 
[0m11:22:17.355762 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m11:22:17.360731 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 8.508303, "process_in_blocks": "0", "process_kernel_time": 1.347572, "process_mem_max_rss": "198070272", "process_out_blocks": "0", "process_user_time": 5.716901}
[0m11:22:17.361965 [debug] [MainThread]: Command `dbt test` failed at 11:22:17.361735 after 8.51 seconds
[0m11:22:17.362897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1468140b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f780e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3c170>]}
[0m11:22:17.363589 [debug] [MainThread]: Flushing usage events
[0m11:22:17.730004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:33.026278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095140b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109565c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095657f0>]}


============================== 11:22:33.031705 | 5df65113-52c7-4003-8d0e-02609660d788 ==============================
[0m11:22:33.031705 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:22:33.032416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select session_summary', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:22:34.190254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458349b0>]}
[0m11:22:34.253932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1456e4ec0>]}
[0m11:22:34.254693 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:22:34.412776 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:22:34.596389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:34.596759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:34.657996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458fbbc0>]}
[0m11:22:34.756487 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:22:34.758272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:22:34.785407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e6cdd0>]}
[0m11:22:34.785992 [info ] [MainThread]: Found 5 models, 6 data tests, 1 snapshot, 3 sources, 474 macros
[0m11:22:34.786473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145837aa0>]}
[0m11:22:34.788492 [info ] [MainThread]: 
[0m11:22:34.788918 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:22:34.789283 [info ] [MainThread]: 
[0m11:22:34.789881 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:34.795407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:22:34.805171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:22:34.881944 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:22:34.882492 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:22:34.882828 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:22:34.883204 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:22:34.883561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:34.883902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:36.152591 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.269 seconds
[0m11:22:36.156593 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.273 seconds
[0m11:22:36.159828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df65113-52c7-4003-8d0e-02609660d788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e38230>]}
[0m11:22:36.162776 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:36.163342 [info ] [Thread-1 (]: 1 of 2 START test not_null_session_summary_sessionId ........................... [RUN]
[0m11:22:36.163941 [debug] [Thread-2 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:36.164481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m11:22:36.165018 [info ] [Thread-2 (]: 2 of 2 START test unique_session_summary_sessionId ............................. [RUN]
[0m11:22:36.165601 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:36.166159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m11:22:36.251702 [debug] [Thread-2 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:36.280755 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:36.282284 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:36.283232 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:36.290304 [debug] [Thread-2 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:36.326530 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:36.327064 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:36.328347 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:22:36.328818 [debug] [Thread-2 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m11:22:36.329608 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:22:36.330838 [debug] [Thread-1 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m11:22:36.524478 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m11:22:36.525830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m11:22:36.544396 [info ] [Thread-2 (]: 2 of 2 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.38s]
[0m11:22:36.545418 [info ] [Thread-1 (]: 1 of 2 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.38s]
[0m11:22:36.546317 [debug] [Thread-2 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:22:36.547068 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:22:36.548822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:36.549248 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m11:22:36.549672 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m11:22:37.027776 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:22:37.028439 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:22:37.334505 [info ] [MainThread]: 
[0m11:22:37.335074 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m11:22:37.336074 [debug] [MainThread]: Command end result
[0m11:22:37.362950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:22:37.364945 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:22:37.373825 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:22:37.374178 [info ] [MainThread]: 
[0m11:22:37.374547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:37.374866 [info ] [MainThread]: 
[0m11:22:37.375212 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:22:37.377964 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.429436, "process_in_blocks": "0", "process_kernel_time": 0.815429, "process_mem_max_rss": "189771776", "process_out_blocks": "0", "process_user_time": 4.158757}
[0m11:22:37.378899 [debug] [MainThread]: Command `dbt test` succeeded at 11:22:37.378735 after 4.43 seconds
[0m11:22:37.379410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462e6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462e7bf0>]}
[0m11:22:37.379945 [debug] [MainThread]: Flushing usage events
[0m11:22:38.031973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:33.841771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b04ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b56dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b56d940>]}


============================== 11:25:33.847060 | d91b51c6-20ee-4f09-a3c1-eb848eb680fb ==============================
[0m11:25:33.847060 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:25:33.847765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select session_summary', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:25:35.060329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5937d0>]}
[0m11:25:35.123301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e53ab70>]}
[0m11:25:35.124075 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:25:35.267707 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:25:35.438673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:25:35.439373 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/schema.yml
[0m11:25:35.902653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147cdf740>]}
[0m11:25:36.091833 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:25:36.093756 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:25:36.121858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c63bc0>]}
[0m11:25:36.122383 [info ] [MainThread]: Found 5 models, 7 data tests, 1 snapshot, 3 sources, 474 macros
[0m11:25:36.122795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d95100>]}
[0m11:25:36.124681 [info ] [MainThread]: 
[0m11:25:36.125092 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:25:36.125457 [info ] [MainThread]: 
[0m11:25:36.126015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:25:36.131304 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:25:36.138340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:25:36.211287 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:25:36.211816 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:25:36.212122 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:25:36.212452 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:25:36.212813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:36.213115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:36.871504 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.659 seconds
[0m11:25:37.062047 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.849 seconds
[0m11:25:37.066139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91b51c6-20ee-4f09-a3c1-eb848eb680fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094738f0>]}
[0m11:25:37.069323 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:25:37.069887 [debug] [Thread-2 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:25:37.070402 [info ] [Thread-1 (]: 1 of 3 START test not_null_session_summary_channel ............................. [RUN]
[0m11:25:37.071005 [debug] [Thread-3 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:25:37.071508 [info ] [Thread-2 (]: 2 of 3 START test not_null_session_summary_sessionId ........................... [RUN]
[0m11:25:37.072123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_session_summary_channel.816a14d150)
[0m11:25:37.072643 [info ] [Thread-3 (]: 3 of 3 START test unique_session_summary_sessionId ............................. [RUN]
[0m11:25:37.073230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m11:25:37.073740 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:25:37.074379 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0'
[0m11:25:37.074875 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:25:37.081081 [debug] [Thread-3 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:25:37.096942 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:25:37.101537 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:25:37.108722 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:25:37.109701 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:25:37.129380 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:25:37.139530 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:25:37.140114 [debug] [Thread-3 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:25:37.142709 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:25:37.149832 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:25:37.150800 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:25:37.151217 [debug] [Thread-3 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m11:25:37.151595 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:25:37.153222 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:25:37.153596 [debug] [Thread-1 (]: On test.homework7.not_null_session_summary_channel.816a14d150: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_channel.816a14d150"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel
from user_db_lobster.analytics.session_summary
where channel is null



      
    ) dbt_internal_test
[0m11:25:37.155388 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:25:37.155797 [debug] [Thread-2 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m11:25:37.270019 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m11:25:37.280083 [info ] [Thread-2 (]: 2 of 3 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.21s]
[0m11:25:37.281201 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:25:37.633486 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m11:25:37.636043 [info ] [Thread-3 (]: 3 of 3 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.56s]
[0m11:25:37.636852 [debug] [Thread-3 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:25:37.697196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m11:25:37.700591 [info ] [Thread-1 (]: 1 of 3 PASS not_null_session_summary_channel ................................... [[32mPASS[0m in 0.63s]
[0m11:25:37.701601 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:25:37.703321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:37.703728 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_channel.816a14d150' was left open.
[0m11:25:37.704123 [debug] [MainThread]: On test.homework7.not_null_session_summary_channel.816a14d150: Close
[0m11:25:37.830991 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m11:25:37.831581 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m11:25:37.958660 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:25:37.959354 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:25:38.078197 [info ] [MainThread]: 
[0m11:25:38.078920 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m11:25:38.080556 [debug] [MainThread]: Command end result
[0m11:25:38.108654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:25:38.110457 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:25:38.119308 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:25:38.119760 [info ] [MainThread]: 
[0m11:25:38.120253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:38.120681 [info ] [MainThread]: 
[0m11:25:38.121139 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:25:38.123654 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.354272, "process_in_blocks": "0", "process_kernel_time": 0.827647, "process_mem_max_rss": "195416064", "process_out_blocks": "0", "process_user_time": 4.477512}
[0m11:25:38.124313 [debug] [MainThread]: Command `dbt test` succeeded at 11:25:38.124159 after 4.35 seconds
[0m11:25:38.124823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4043e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14744e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ea5d90>]}
[0m11:25:38.125308 [debug] [MainThread]: Flushing usage events
[0m11:25:38.487220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:16.680917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8920f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd4f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdc1940>]}


============================== 11:29:16.687920 | d26fdc75-8fea-48a3-8609-c6de2b200009 ==============================
[0m11:29:16.687920 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:29:16.688670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:29:17.930840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147aa2c00>]}
[0m11:29:17.995362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b0080>]}
[0m11:29:17.996350 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:29:18.152468 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:29:18.328995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:29:18.329376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:29:18.389294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd4f710>]}
[0m11:29:18.406952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148589970>]}
[0m11:29:18.407550 [info ] [MainThread]: Found 5 models, 7 data tests, 1 snapshot, 3 sources, 474 macros
[0m11:29:18.407973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1480e20f0>]}
[0m11:29:18.410515 [info ] [MainThread]: 
[0m11:29:18.410955 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:29:18.411322 [info ] [MainThread]: 
[0m11:29:18.411915 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:29:18.417546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:29:18.418239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:29:18.499205 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:29:18.499830 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:29:18.500371 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:29:18.500766 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:29:18.501115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:18.501431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:19.239933 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.739 seconds
[0m11:29:19.264899 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.763 seconds
[0m11:29:19.268487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26fdc75-8fea-48a3-8609-c6de2b200009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148811d90>]}
[0m11:29:19.271534 [debug] [Thread-1 (]: Began running node model.homework7.my_first_dbt_model
[0m11:29:19.272095 [debug] [Thread-2 (]: Began running node model.homework7.session_timestamp
[0m11:29:19.272650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.my_first_dbt_model)
[0m11:29:19.273147 [debug] [Thread-3 (]: Began running node model.homework7.user_session_channel
[0m11:29:19.273696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.session_timestamp)
[0m11:29:19.274212 [debug] [Thread-1 (]: Began compiling node model.homework7.my_first_dbt_model
[0m11:29:19.274851 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.user_session_channel'
[0m11:29:19.275429 [debug] [Thread-2 (]: Began compiling node model.homework7.session_timestamp
[0m11:29:19.285649 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.my_first_dbt_model"
[0m11:29:19.286195 [debug] [Thread-3 (]: Began compiling node model.homework7.user_session_channel
[0m11:29:19.289338 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:29:19.292481 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:29:19.294219 [debug] [Thread-1 (]: Began executing node model.homework7.my_first_dbt_model
[0m11:29:19.296958 [debug] [Thread-1 (]: Finished running node model.homework7.my_first_dbt_model
[0m11:29:19.297613 [debug] [Thread-2 (]: Began executing node model.homework7.session_timestamp
[0m11:29:19.298693 [debug] [Thread-2 (]: Finished running node model.homework7.session_timestamp
[0m11:29:19.299197 [debug] [Thread-3 (]: Began executing node model.homework7.user_session_channel
[0m11:29:19.300287 [debug] [Thread-3 (]: Finished running node model.homework7.user_session_channel
[0m11:29:19.300856 [debug] [Thread-5 (]: Began running node model.homework7.my_second_dbt_model
[0m11:29:19.301453 [debug] [Thread-3 (]: Began running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:19.301921 [debug] [Thread-4 (]: Began running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:29:19.302681 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.my_second_dbt_model'
[0m11:29:19.303158 [debug] [Thread-1 (]: Began running node model.homework7.session_summary
[0m11:29:19.303692 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.homework7.user_session_channel, now test.homework7.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:29:19.304335 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.homework7.unique_my_first_dbt_model_id.16e066b321'
[0m11:29:19.304853 [debug] [Thread-5 (]: Began compiling node model.homework7.my_second_dbt_model
[0m11:29:19.305383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.homework7.my_first_dbt_model, now model.homework7.session_summary)
[0m11:29:19.305886 [debug] [Thread-3 (]: Began compiling node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:19.306366 [debug] [Thread-4 (]: Began compiling node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:29:19.309646 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.my_second_dbt_model"
[0m11:29:19.310226 [debug] [Thread-1 (]: Began compiling node model.homework7.session_summary
[0m11:29:19.330735 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:29:19.335014 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.unique_my_first_dbt_model_id.16e066b321"
[0m11:29:19.338408 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:29:19.339166 [debug] [Thread-5 (]: Began executing node model.homework7.my_second_dbt_model
[0m11:29:19.339813 [debug] [Thread-3 (]: Began executing node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:19.340698 [debug] [Thread-5 (]: Finished running node model.homework7.my_second_dbt_model
[0m11:29:19.341585 [debug] [Thread-3 (]: Finished running node test.homework7.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:19.342296 [debug] [Thread-1 (]: Began executing node model.homework7.session_summary
[0m11:29:19.342723 [debug] [Thread-4 (]: Began executing node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:29:19.343203 [debug] [Thread-2 (]: Began running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:19.343654 [debug] [Thread-3 (]: Began running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:19.344555 [debug] [Thread-1 (]: Finished running node model.homework7.session_summary
[0m11:29:19.345344 [debug] [Thread-4 (]: Finished running node test.homework7.unique_my_first_dbt_model_id.16e066b321
[0m11:29:19.345818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.homework7.session_timestamp, now test.homework7.not_null_my_second_dbt_model_id.151b76d778)
[0m11:29:19.346296 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_first_dbt_model_id.5fb22c2710, now test.homework7.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:29:19.347086 [debug] [Thread-5 (]: Began running node snapshot.homework7.snapshot_session_summary
[0m11:29:19.347510 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:19.347931 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:29:19.348391 [debug] [Thread-4 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:29:19.348813 [debug] [Thread-3 (]: Began compiling node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:19.349440 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.homework7.my_second_dbt_model, now snapshot.homework7.snapshot_session_summary)
[0m11:29:19.353949 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_my_second_dbt_model_id.151b76d778"
[0m11:29:19.354428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.homework7.session_summary, now test.homework7.not_null_session_summary_channel.816a14d150)
[0m11:29:19.354892 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.homework7.unique_my_first_dbt_model_id.16e066b321, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m11:29:19.358887 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:29:19.359337 [debug] [Thread-5 (]: Began compiling node snapshot.homework7.snapshot_session_summary
[0m11:29:19.359890 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:29:19.360421 [debug] [Thread-4 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:29:19.361019 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:19.364287 [debug] [Thread-5 (]: Began executing node snapshot.homework7.snapshot_session_summary
[0m11:29:19.368317 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:29:19.371915 [debug] [Thread-4 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:29:19.372307 [debug] [Thread-3 (]: Began executing node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:19.372948 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:19.373575 [debug] [Thread-5 (]: Finished running node snapshot.homework7.snapshot_session_summary
[0m11:29:19.374426 [debug] [Thread-3 (]: Finished running node test.homework7.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:19.374876 [debug] [Thread-2 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:29:19.375318 [debug] [Thread-4 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:29:19.375808 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:29:19.376210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.homework7.not_null_my_second_dbt_model_id.151b76d778, now test.homework7.unique_session_summary_sessionId.9c5e5661a0)
[0m11:29:19.376902 [debug] [Thread-4 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:29:19.377537 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:29:19.377893 [debug] [Thread-2 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:29:19.381473 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:29:19.382057 [debug] [Thread-2 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:29:19.382745 [debug] [Thread-2 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:29:19.384292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:19.384606 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_channel.816a14d150' was left open.
[0m11:29:19.384920 [debug] [MainThread]: On test.homework7.not_null_session_summary_channel.816a14d150: Close
[0m11:29:19.504731 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:29:19.505327 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:29:19.629208 [debug] [MainThread]: Connection 'test.homework7.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:29:19.629776 [debug] [MainThread]: Connection 'snapshot.homework7.snapshot_session_summary' was properly closed.
[0m11:29:19.630234 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was properly closed.
[0m11:29:19.633902 [debug] [MainThread]: Command end result
[0m11:29:19.840401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:29:19.843197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:29:19.856310 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:29:19.860912 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:29:19.861625 [info ] [MainThread]: Building catalog
[0m11:29:19.879651 [debug] [ThreadPool]: Acquiring new snowflake connection 'user_db_lobster.information_schema'
[0m11:29:19.880613 [debug] [ThreadPool]: Acquiring new snowflake connection 'USER_DB_LOBSTER.information_schema'
[0m11:29:19.924716 [debug] [ThreadPool]: Using snowflake connection "USER_DB_LOBSTER.information_schema"
[0m11:29:19.925414 [debug] [ThreadPool]: Using snowflake connection "user_db_lobster.information_schema"
[0m11:29:19.926405 [debug] [ThreadPool]: On USER_DB_LOBSTER.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "USER_DB_LOBSTER.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from USER_DB_LOBSTER.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from USER_DB_LOBSTER.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m11:29:19.927989 [debug] [ThreadPool]: On user_db_lobster.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "user_db_lobster.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from user_db_lobster.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_session_summary' and upper("table_name") = upper('snapshot_session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'my_second_dbt_model' and upper("table_name") = upper('my_second_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from user_db_lobster.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_session_summary' and upper("table_name") = upper('snapshot_session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'my_second_dbt_model' and upper("table_name") = upper('my_second_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m11:29:19.929139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:19.929740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:22.613863 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.685 seconds
[0m11:29:23.246569 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 3.317 seconds
[0m11:29:23.275283 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/homework7/target/catalog.json
[0m11:29:23.301528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:29:23.303364 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:29:23.303757 [info ] [MainThread]: Catalog written to /Users/user/homework7/target/catalog.json
[0m11:29:23.308980 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.699813, "process_in_blocks": "0", "process_kernel_time": 0.832356, "process_mem_max_rss": "190144512", "process_out_blocks": "0", "process_user_time": 4.471943}
[0m11:29:23.309791 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:29:23.309627 after 6.70 seconds
[0m11:29:23.310242 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:29:23.310629 [debug] [MainThread]: Connection 'user_db_lobster.information_schema' was left open.
[0m11:29:23.311031 [debug] [MainThread]: On user_db_lobster.information_schema: Close
[0m11:29:23.443247 [debug] [MainThread]: Connection 'USER_DB_LOBSTER.information_schema' was left open.
[0m11:29:23.443800 [debug] [MainThread]: On USER_DB_LOBSTER.information_schema: Close
[0m11:29:23.617997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdc1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ff7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1489f9610>]}
[0m11:29:23.618690 [debug] [MainThread]: Flushing usage events
[0m11:29:23.986353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:16.335939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140be930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147e1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147e1910>]}


============================== 11:32:16.342773 | 1dc59887-dfb4-410b-b3d5-79f4042a8185 ==============================
[0m11:32:16.342773 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:32:16.343563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:18.127304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dc59887-dfb4-410b-b3d5-79f4042a8185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150b4e4b0>]}
[0m11:32:18.195001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dc59887-dfb4-410b-b3d5-79f4042a8185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11375dd60>]}
[0m11:49:06.270335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105170980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a1880>]}


============================== 11:49:06.278546 | f782131e-5a06-4087-a1e9-e87f23132e13 ==============================
[0m11:49:06.278546 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:49:06.279445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:08.625724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaaca10>]}
[0m11:49:08.690240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d5a00>]}
[0m11:49:08.691545 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:49:08.865325 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:49:09.096654 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m11:49:09.097526 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m11:49:09.098174 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/example/my_first_dbt_model.sql
[0m11:49:09.098503 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/example/my_second_dbt_model.sql
[0m11:49:09.227888 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:49:09.243603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141f16b40>]}
[0m11:49:09.340264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:49:09.342125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:49:09.380798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141e90050>]}
[0m11:49:09.381744 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m11:49:09.382432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141e8ffe0>]}
[0m11:49:09.384946 [info ] [MainThread]: 
[0m11:49:09.385462 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:49:09.385955 [info ] [MainThread]: 
[0m11:49:09.386766 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:49:09.392476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:49:09.530175 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:49:09.530667 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:49:09.531022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:10.368457 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.836 seconds
[0m11:49:10.372469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_snapshot)
[0m11:49:10.373303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:49:10.391898 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:49:10.397889 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:49:10.397747 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:49:10.399513 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:49:10.399937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:10.619504 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.221 seconds
[0m11:49:10.850615 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.451 seconds
[0m11:49:10.854679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141eec6b0>]}
[0m11:49:10.860762 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:49:10.861461 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:49:10.862213 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:49:10.863030 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:49:10.863937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.session_timestamp)
[0m11:49:10.864509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.user_session_channel)
[0m11:49:10.865044 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:49:10.865563 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:49:10.875690 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:49:10.878940 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:49:10.880529 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:49:10.881101 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:49:10.952184 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:49:10.952974 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:49:10.954205 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:49:10.954722 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    SELECT
 sessionId,
 ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
  );
[0m11:49:10.955822 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:49:10.956274 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    SELECT
 userId,
 sessionId,
 channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
  );
[0m11:49:11.467271 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m11:49:11.468346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m11:49:11.515204 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104acdbe0>]}
[0m11:49:11.515727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a65280>]}
[0m11:49:11.516497 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.65s]
[0m11:49:11.517290 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.65s]
[0m11:49:11.518108 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:49:11.518819 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:49:11.519885 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:49:11.520502 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:49:11.521296 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:49:11.521789 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:49:11.525475 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:49:11.526331 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:49:11.554918 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:49:11.556521 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:49:11.557011 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:49:11.557446 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:49:14.763557 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.206 seconds
[0m11:49:14.767827 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f782131e-5a06-4087-a1e9-e87f23132e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421d2c60>]}
[0m11:49:14.768737 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 3.25s]
[0m11:49:14.769554 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:49:14.771280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:14.771704 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:49:14.772132 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:49:14.975293 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:49:14.976043 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:49:15.156054 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:49:15.156725 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:49:15.295910 [info ] [MainThread]: 
[0m11:49:15.296716 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.91 seconds (5.91s).
[0m11:49:15.298361 [debug] [MainThread]: Command end result
[0m11:49:15.327064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:49:15.328888 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:49:15.337593 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:49:15.338088 [info ] [MainThread]: 
[0m11:49:15.338588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:15.339096 [info ] [MainThread]: 
[0m11:49:15.339772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:49:15.343198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.167012, "process_in_blocks": "0", "process_kernel_time": 1.25409, "process_mem_max_rss": "188628992", "process_out_blocks": "0", "process_user_time": 4.953983}
[0m11:49:15.343858 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:15.343712 after 9.17 seconds
[0m11:49:15.344365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0c410>]}
[0m11:49:15.344843 [debug] [MainThread]: Flushing usage events
[0m11:49:15.737791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:52.184427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a371d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3719d0>]}


============================== 11:53:52.191672 | bebbb6c8-5f99-465c-8bd8-f0f5bdc17555 ==============================
[0m11:53:52.191672 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:53:52.192601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:53:54.337212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bebbb6c8-5f99-465c-8bd8-f0f5bdc17555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14652bd10>]}
[0m11:53:54.415922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bebbb6c8-5f99-465c-8bd8-f0f5bdc17555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4d7b30>]}
[0m11:55:43.172569 [error] [MainThread]: Encountered an error:

[0m11:55:43.181967 [error] [MainThread]: Traceback (most recent call last):
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Applications/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:55:43.186677 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 111.09314, "process_in_blocks": "0", "process_kernel_time": 1.086063, "process_mem_max_rss": "171642880", "process_out_blocks": "0", "process_user_time": 3.675928}
[0m11:55:43.187624 [debug] [MainThread]: Command `dbt docs serve` failed at 11:55:43.187440 after 111.09 seconds
[0m11:55:43.188340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e83560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2062a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1467c6c00>]}
[0m11:55:43.189250 [debug] [MainThread]: Flushing usage events
[0m11:55:43.581306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:01.182171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113865ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113865940>]}


============================== 11:56:01.189343 | e07c5cc2-a849-4565-9668-85601f07e8a7 ==============================
[0m11:56:01.189343 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:56:01.190129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:03.210987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf9250>]}
[0m11:56:03.273155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f523c50>]}
[0m11:56:03.274560 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:56:03.434648 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:56:03.661773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:03.662224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:03.668535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:56:03.722159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fe1cdd0>]}
[0m11:56:03.814964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:56:03.817420 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:56:03.869790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1501afaa0>]}
[0m11:56:03.870514 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m11:56:03.871005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113812b70>]}
[0m11:56:03.873598 [info ] [MainThread]: 
[0m11:56:03.874089 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:56:03.874502 [info ] [MainThread]: 
[0m11:56:03.875166 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:03.881564 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:56:03.882303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:56:03.991518 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:56:03.992111 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:56:03.992462 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:56:03.992841 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:56:03.993203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:03.993540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:04.733442 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.740 seconds
[0m11:56:04.777130 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.783 seconds
[0m11:56:04.783809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07c5cc2-a849-4565-9668-85601f07e8a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbaf500>]}
[0m11:56:04.788732 [debug] [Thread-1 (]: Began running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:56:04.789335 [debug] [Thread-2 (]: Began running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:56:04.789843 [debug] [Thread-3 (]: Began running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:56:04.790362 [info ] [Thread-1 (]: 1 of 3 START test not_null_session_summary_channel ............................. [RUN]
[0m11:56:04.790984 [info ] [Thread-2 (]: 2 of 3 START test not_null_session_summary_sessionId ........................... [RUN]
[0m11:56:04.791549 [info ] [Thread-3 (]: 3 of 3 START test unique_session_summary_sessionId ............................. [RUN]
[0m11:56:04.792172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now test.homework7.not_null_session_summary_channel.816a14d150)
[0m11:56:04.792711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now test.homework7.not_null_session_summary_sessionId.e6aec1a6c6)
[0m11:56:04.793357 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0'
[0m11:56:04.793855 [debug] [Thread-1 (]: Began compiling node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:56:04.794334 [debug] [Thread-2 (]: Began compiling node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:56:04.794813 [debug] [Thread-3 (]: Began compiling node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:56:04.908445 [debug] [Thread-1 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:56:04.911611 [debug] [Thread-2 (]: Writing injected SQL for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:56:04.919757 [debug] [Thread-3 (]: Writing injected SQL for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:56:04.921668 [debug] [Thread-1 (]: Began executing node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:56:04.949116 [debug] [Thread-1 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:56:04.949765 [debug] [Thread-3 (]: Began executing node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:56:04.950395 [debug] [Thread-2 (]: Began executing node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:56:04.953508 [debug] [Thread-3 (]: Writing runtime sql for node "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:56:04.954407 [debug] [Thread-1 (]: Using snowflake connection "test.homework7.not_null_session_summary_channel.816a14d150"
[0m11:56:04.957167 [debug] [Thread-2 (]: Writing runtime sql for node "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:56:04.957867 [debug] [Thread-1 (]: On test.homework7.not_null_session_summary_channel.816a14d150: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_channel.816a14d150"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel
from user_db_lobster.analytics.session_summary
where channel is null



      
    ) dbt_internal_test
[0m11:56:04.959077 [debug] [Thread-3 (]: Using snowflake connection "test.homework7.unique_session_summary_sessionId.9c5e5661a0"
[0m11:56:04.960029 [debug] [Thread-3 (]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from user_db_lobster.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m11:56:04.960531 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:56:04.963323 [debug] [Thread-2 (]: Using snowflake connection "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"
[0m11:56:04.964257 [debug] [Thread-2 (]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "test.homework7.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from user_db_lobster.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m11:56:05.313478 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m11:56:05.329602 [info ] [Thread-2 (]: 2 of 3 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.54s]
[0m11:56:05.330531 [debug] [Thread-2 (]: Finished running node test.homework7.not_null_session_summary_sessionId.e6aec1a6c6
[0m11:56:05.346030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m11:56:05.349480 [info ] [Thread-1 (]: 1 of 3 PASS not_null_session_summary_channel ................................... [[32mPASS[0m in 0.56s]
[0m11:56:05.350455 [debug] [Thread-1 (]: Finished running node test.homework7.not_null_session_summary_channel.816a14d150
[0m11:56:05.703695 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m11:56:05.706620 [info ] [Thread-3 (]: 3 of 3 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.91s]
[0m11:56:05.707478 [debug] [Thread-3 (]: Finished running node test.homework7.unique_session_summary_sessionId.9c5e5661a0
[0m11:56:05.710229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:05.710713 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_channel.816a14d150' was left open.
[0m11:56:05.711137 [debug] [MainThread]: On test.homework7.not_null_session_summary_channel.816a14d150: Close
[0m11:56:05.839326 [debug] [MainThread]: Connection 'test.homework7.not_null_session_summary_sessionId.e6aec1a6c6' was left open.
[0m11:56:05.839904 [debug] [MainThread]: On test.homework7.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m11:56:05.979686 [debug] [MainThread]: Connection 'test.homework7.unique_session_summary_sessionId.9c5e5661a0' was left open.
[0m11:56:05.980355 [debug] [MainThread]: On test.homework7.unique_session_summary_sessionId.9c5e5661a0: Close
[0m11:56:06.112210 [info ] [MainThread]: 
[0m11:56:06.113036 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m11:56:06.114985 [debug] [MainThread]: Command end result
[0m11:56:06.142591 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:56:06.144578 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:56:06.154336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:56:06.154795 [info ] [MainThread]: 
[0m11:56:06.155289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:06.155860 [info ] [MainThread]: 
[0m11:56:06.156446 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:56:06.159008 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.0645742, "process_in_blocks": "0", "process_kernel_time": 1.142826, "process_mem_max_rss": "190873600", "process_out_blocks": "0", "process_user_time": 4.837632}
[0m11:56:06.159640 [debug] [MainThread]: Command `dbt test` succeeded at 11:56:06.159495 after 5.07 seconds
[0m11:56:06.160135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f768bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150662d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150662cc0>]}
[0m11:56:06.160609 [debug] [MainThread]: Flushing usage events
[0m11:56:06.497817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:23.718771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c99ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bdbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bd850>]}


============================== 12:15:23.725881 | d6539130-c352-4331-a193-08ac10a26bf6 ==============================
[0m12:15:23.725881 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:15:23.726667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:15:25.919384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6539130-c352-4331-a193-08ac10a26bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104865280>]}
[0m12:15:25.991892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6539130-c352-4331-a193-08ac10a26bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d79dc0>]}
[0m12:28:07.010024 [error] [MainThread]: Encountered an error:

[0m12:28:07.025920 [error] [MainThread]: Traceback (most recent call last):
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Applications/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:28:07.035091 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 763.4001, "process_in_blocks": "0", "process_kernel_time": 1.059505, "process_mem_max_rss": "171917312", "process_out_blocks": "0", "process_user_time": 3.731515}
[0m12:28:07.036973 [debug] [MainThread]: Command `dbt docs serve` failed at 12:28:07.036676 after 763.40 seconds
[0m12:28:07.038631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141724560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141875370>]}
[0m12:28:07.039748 [debug] [MainThread]: Flushing usage events
[0m12:28:07.475755 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:37.097021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112239a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112731b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127317c0>]}


============================== 11:38:37.102592 | d0365f89-baf8-4690-83e5-3e2143f69013 ==============================
[0m11:38:37.102592 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:38:37.103422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:38:49.385272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0365f89-baf8-4690-83e5-3e2143f69013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df00e0>]}
[0m11:38:49.453058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0365f89-baf8-4690-83e5-3e2143f69013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb138c0>]}
[0m11:44:15.848169 [error] [MainThread]: Encountered an error:

[0m11:44:15.857000 [error] [MainThread]: Traceback (most recent call last):
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Applications/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:44:15.860180 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 338.84485, "process_in_blocks": "0", "process_kernel_time": 0.853525, "process_mem_max_rss": "171712512", "process_out_blocks": "0", "process_user_time": 3.319986}
[0m11:44:15.861113 [debug] [MainThread]: Command `dbt docs serve` failed at 11:44:15.860946 after 338.85 seconds
[0m11:44:15.861780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112731a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c50110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb13f50>]}
[0m11:44:15.862377 [debug] [MainThread]: Flushing usage events
[0m11:44:16.254301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:46.401182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e961070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee75b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee75730>]}


============================== 11:47:46.408395 | ae6996f3-c3cf-49cf-8316-da9a6cee6e27 ==============================
[0m11:47:46.408395 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:47:46.409177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:47:48.308051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd029c0>]}
[0m11:47:48.368418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e266bd0>]}
[0m11:47:48.369799 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:47:48.534766 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:47:48.747441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:47:48.748132 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/user_session_channel.sql
[0m11:47:48.748626 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/session_timestamp.sql
[0m11:47:49.033671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:47:49.045304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b636fc0>]}
[0m11:47:49.141691 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:47:49.144201 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:47:49.168260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4ae600>]}
[0m11:47:49.168723 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 2 sources, 474 macros
[0m11:47:49.169064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cbfaa0>]}
[0m11:47:49.171450 [info ] [MainThread]: 
[0m11:47:49.171825 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:47:49.172164 [info ] [MainThread]: 
[0m11:47:49.172724 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:49.177194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:47:49.395456 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:47:49.395891 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:47:49.396236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:50.938994 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.543 seconds
[0m11:47:50.942958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_snapshot)
[0m11:47:50.943813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_analytics'
[0m11:47:50.963526 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:47:50.967894 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:47:50.968303 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:47:50.968737 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:47:50.969972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:51.241928 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.273 seconds
[0m11:47:51.514793 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.545 seconds
[0m11:47:51.518836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b75a810>]}
[0m11:47:51.525006 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:47:51.525968 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:47:51.526734 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:47:51.527582 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:47:51.528228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.session_timestamp)
[0m11:47:51.528765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.user_session_channel)
[0m11:47:51.529271 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:47:51.529757 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:47:51.539568 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:47:51.542708 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:47:51.543747 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:47:51.550554 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:47:51.600379 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:47:51.601789 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:47:51.602742 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:47:51.603099 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
  );
[0m11:47:51.604030 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:47:51.604391 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
  );
[0m11:47:52.065441 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m11:47:52.072921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m11:47:52.121554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ece450>]}
[0m11:47:52.122088 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd01850>]}
[0m11:47:52.122878 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.59s]
[0m11:47:52.123620 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.59s]
[0m11:47:52.124369 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:47:52.125029 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:47:52.125979 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:47:52.126600 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:47:52.127268 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:47:52.127705 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:47:52.131059 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:47:52.131883 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:47:52.156902 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:47:52.157916 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:47:52.158266 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:47:52.158595 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:47:55.035339 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.877 seconds
[0m11:47:55.039073 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae6996f3-c3cf-49cf-8316-da9a6cee6e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed06d50>]}
[0m11:47:55.039969 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.91s]
[0m11:47:55.040877 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:47:55.042639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:55.043074 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:47:55.043508 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:47:55.154689 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:47:55.155400 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:47:55.280452 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:47:55.281160 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:47:55.427953 [info ] [MainThread]: 
[0m11:47:55.428705 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m11:47:55.430335 [debug] [MainThread]: Command end result
[0m11:47:55.456902 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:47:55.458689 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:47:55.466855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:47:55.467294 [info ] [MainThread]: 
[0m11:47:55.467875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:55.468380 [info ] [MainThread]: 
[0m11:47:55.468851 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:47:55.471342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.156489, "process_in_blocks": "0", "process_kernel_time": 1.264549, "process_mem_max_rss": "193368064", "process_out_blocks": "0", "process_user_time": 5.401274}
[0m11:47:55.471969 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:55.471824 after 9.16 seconds
[0m11:47:55.472506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9607a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e997fe0>]}
[0m11:47:55.472998 [debug] [MainThread]: Flushing usage events
[0m11:47:55.829098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:50:49.744309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dcaab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122b09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129e1790>]}


============================== 11:50:49.749479 | 855ff77f-aff6-458f-9ca7-dc9e1c7b9879 ==============================
[0m11:50:49.749479 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:50:49.750175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:50:50.807617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ed14c20>]}
[0m11:50:50.867910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dff2c0>]}
[0m11:50:50.868628 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:50:51.003923 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:50:51.163729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:51.164080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:51.169193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:50:51.219866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e522570>]}
[0m11:50:51.309671 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:50:51.312065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:50:51.325838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ee5dac0>]}
[0m11:50:51.326283 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 2 sources, 474 macros
[0m11:50:51.326635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f173e90>]}
[0m11:50:51.328406 [info ] [MainThread]: 
[0m11:50:51.328760 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:50:51.329059 [info ] [MainThread]: 
[0m11:50:51.329549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:50:51.333701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:50:51.394323 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:50:51.394708 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:50:51.395012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:51.954758 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.560 seconds
[0m11:50:51.957873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now create_user_db_lobster_analytics)
[0m11:50:51.958645 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster"
schema: "analytics"
"
[0m11:50:51.964427 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster_analytics"
[0m11:50:51.964830 [debug] [ThreadPool]: On create_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster_analytics"} */
create schema if not exists user_db_lobster.analytics
[0m11:50:52.078152 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m11:50:52.081289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster_analytics, now list_user_db_lobster_analytics)
[0m11:50:52.082181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:50:52.102468 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:50:52.107430 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:50:52.107859 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:50:52.108301 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:50:52.109517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:52.206214 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.097 seconds
[0m11:50:52.619753 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.510 seconds
[0m11:50:52.623202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ece1700>]}
[0m11:50:52.626515 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:50:52.627069 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:50:52.627722 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:50:52.628415 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:50:52.629045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m11:50:52.629592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m11:50:52.630115 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:50:52.630613 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:50:52.641548 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:50:52.719588 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:50:52.721909 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:50:52.722648 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:50:52.790250 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:50:52.792418 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:50:52.794781 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:50:52.795652 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:50:52.796085 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
  );
[0m11:50:52.796550 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
  );
[0m11:50:53.006176 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m11:50:53.036939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m11:50:53.039671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108152e0>]}
[0m11:50:53.040435 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.41s]
[0m11:50:53.040939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bd0d0>]}
[0m11:50:53.041652 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:50:53.042353 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.41s]
[0m11:50:53.043262 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:50:53.043993 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:50:53.044668 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:50:53.045411 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:50:53.045867 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:50:53.049176 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:50:53.049923 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:50:53.075856 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:50:53.077431 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:50:53.077850 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:50:53.078203 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:50:54.819990 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.742 seconds
[0m11:50:54.823416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '855ff77f-aff6-458f-9ca7-dc9e1c7b9879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f63b9b0>]}
[0m11:50:54.824326 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.78s]
[0m11:50:54.825255 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:50:54.827011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:54.827448 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:50:54.827860 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:50:54.934547 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:50:54.935248 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:50:55.059867 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:50:55.060607 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:50:55.170406 [info ] [MainThread]: 
[0m11:50:55.171121 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m11:50:55.172752 [debug] [MainThread]: Command end result
[0m11:50:55.199102 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:50:55.202105 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:50:55.210176 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:50:55.210613 [info ] [MainThread]: 
[0m11:50:55.211109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:55.211538 [info ] [MainThread]: 
[0m11:50:55.212160 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:50:55.214682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.538956, "process_in_blocks": "0", "process_kernel_time": 0.740321, "process_mem_max_rss": "189628416", "process_out_blocks": "0", "process_user_time": 3.944396}
[0m11:50:55.215341 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:55.215193 after 5.54 seconds
[0m11:50:55.215844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e1cd220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0f440>]}
[0m11:50:55.216322 [debug] [MainThread]: Flushing usage events
[0m11:50:55.562201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:15.608401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7510a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d795d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7959a0>]}


============================== 11:51:15.613368 | 4fe1203a-33b5-4fa9-8c92-2e76b514c6c6 ==============================
[0m11:51:15.613368 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:51:15.614035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:16.677770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b3cc20>]}
[0m11:51:16.737767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14989cc20>]}
[0m11:51:16.738497 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:51:16.876338 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:51:17.043606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:17.044023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:17.049451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:51:17.100432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8b1ee0>]}
[0m11:51:17.193324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:51:17.195071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:51:17.207896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149f51e80>]}
[0m11:51:17.208315 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 2 sources, 474 macros
[0m11:51:17.208639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149a55fd0>]}
[0m11:51:17.210377 [info ] [MainThread]: 
[0m11:51:17.210828 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:51:17.211113 [info ] [MainThread]: 
[0m11:51:17.211647 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:17.215632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:51:17.274388 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:51:17.274755 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:51:17.275057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:17.823927 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.549 seconds
[0m11:51:17.826989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now create_user_db_lobster_analytics)
[0m11:51:17.827778 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster"
schema: "analytics"
"
[0m11:51:17.833744 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster_analytics"
[0m11:51:17.834174 [debug] [ThreadPool]: On create_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster_analytics"} */
create schema if not exists user_db_lobster.analytics
[0m11:51:17.936199 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m11:51:17.939287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster_analytics, now list_user_db_lobster_analytics)
[0m11:51:17.940113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:51:17.963514 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:51:17.964361 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:51:17.964771 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:51:17.965205 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:51:17.965615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:18.152906 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.187 seconds
[0m11:51:18.393492 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.428 seconds
[0m11:51:18.397033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149a896a0>]}
[0m11:51:18.400155 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:51:18.400718 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:51:18.401363 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:51:18.402052 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:51:18.402683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m11:51:18.403260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m11:51:18.403796 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:51:18.404306 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:51:18.415361 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:51:18.498006 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:51:18.499209 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:51:18.519037 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:51:18.554402 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:51:18.557871 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:51:18.559147 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:51:18.559637 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
  );
[0m11:51:18.561216 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:51:18.561685 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
  );
[0m11:51:18.747826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m11:51:18.755250 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m11:51:18.795688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d77d1f0>]}
[0m11:51:18.796135 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbcd130>]}
[0m11:51:18.796821 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.39s]
[0m11:51:18.797551 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.39s]
[0m11:51:18.798295 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:51:18.798969 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:51:18.799916 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:51:18.800457 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:51:18.801051 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:51:18.801467 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:51:18.804660 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:51:18.805362 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:51:18.828746 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:51:18.829659 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:51:18.830010 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:51:18.830340 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:51:20.649786 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.819 seconds
[0m11:51:20.653293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe1203a-33b5-4fa9-8c92-2e76b514c6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a39fc20>]}
[0m11:51:20.654200 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.85s]
[0m11:51:20.655140 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:51:20.656931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:20.657373 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:51:20.657815 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:51:20.778531 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:51:20.779222 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:51:20.913948 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:51:20.914641 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:51:21.029848 [info ] [MainThread]: 
[0m11:51:21.030545 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m11:51:21.032165 [debug] [MainThread]: Command end result
[0m11:51:21.058492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:51:21.060205 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:51:21.067874 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:51:21.068321 [info ] [MainThread]: 
[0m11:51:21.068804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:21.069223 [info ] [MainThread]: 
[0m11:51:21.069672 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:51:21.072137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5289373, "process_in_blocks": "0", "process_kernel_time": 0.727422, "process_mem_max_rss": "189067264", "process_out_blocks": "0", "process_user_time": 3.928096}
[0m11:51:21.072754 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:21.072612 after 5.53 seconds
[0m11:51:21.073254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d72fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3e3890>]}
[0m11:51:21.073721 [debug] [MainThread]: Flushing usage events
[0m11:51:21.453336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:09.691678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbb7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0779b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e9c40>]}


============================== 11:53:09.696654 | 70fe3fbf-0856-45e3-8b38-6a0b4b336f6f ==============================
[0m11:53:09.696654 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:53:09.697454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:10.753487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70fe3fbf-0856-45e3-8b38-6a0b4b336f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a1eea80>]}
[0m11:53:10.813151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70fe3fbf-0856-45e3-8b38-6a0b4b336f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a4080e0>]}
[0m11:53:10.813886 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:53:10.956354 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:53:11.117858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:11.118677 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m11:53:11.754617 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.user_session_channel' (models/input/user_session_channel.sql) depends on a source named 'raw.user_session_channel' which was not found
[0m11:53:11.756669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1311536, "process_in_blocks": "0", "process_kernel_time": 0.660979, "process_mem_max_rss": "181518336", "process_out_blocks": "0", "process_user_time": 3.743632}
[0m11:53:11.757159 [debug] [MainThread]: Command `dbt run` failed at 11:53:11.757046 after 2.13 seconds
[0m11:53:11.757549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0779b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d283920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a96dca0>]}
[0m11:53:11.757926 [debug] [MainThread]: Flushing usage events
[0m11:53:12.132568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:43.080508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cae9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938dbb0>]}


============================== 11:53:43.085433 | afa10642-ee70-44ff-ba9d-f68d6bd9c12f ==============================
[0m11:53:43.085433 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:53:43.086100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:53:44.139757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b894c0>]}
[0m11:53:44.198903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1455a2ab0>]}
[0m11:53:44.199609 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:53:44.334006 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:53:44.494241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:44.494864 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/schema.yml
[0m11:53:44.765224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m11:53:44.777229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457459d0>]}
[0m11:53:44.851421 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:53:44.853149 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:53:44.865351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145c03b30>]}
[0m11:53:44.865762 [info ] [MainThread]: Found 1 snapshot, 3 models, 2 sources, 474 macros
[0m11:53:44.866084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14541b9b0>]}
[0m11:53:44.867765 [info ] [MainThread]: 
[0m11:53:44.868456 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:53:44.868872 [info ] [MainThread]: 
[0m11:53:44.869373 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:53:44.873407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m11:53:45.025125 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m11:53:45.025587 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m11:53:45.025960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:45.677380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.651 seconds
[0m11:53:45.680500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now create_user_db_lobster_analytics)
[0m11:53:45.681293 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster"
schema: "analytics"
"
[0m11:53:45.687263 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster_analytics"
[0m11:53:45.687719 [debug] [ThreadPool]: On create_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster_analytics"} */
create schema if not exists user_db_lobster.analytics
[0m11:53:45.813395 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m11:53:45.816625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster_analytics, now list_user_db_lobster_analytics)
[0m11:53:45.817458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m11:53:45.836782 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m11:53:45.837248 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m11:53:45.842448 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m11:53:45.843790 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m11:53:45.844315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:45.930405 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.093 seconds
[0m11:53:46.299717 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.455 seconds
[0m11:53:46.303212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd99be0>]}
[0m11:53:46.306542 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m11:53:46.307135 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m11:53:46.307819 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.session_timestamp ........................ [RUN]
[0m11:53:46.308575 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics.user_session_channel ..................... [RUN]
[0m11:53:46.309251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m11:53:46.309822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m11:53:46.310350 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m11:53:46.310840 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m11:53:46.321061 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m11:53:46.324261 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m11:53:46.325133 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m11:53:46.331570 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m11:53:46.389726 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_timestamp"
[0m11:53:46.390292 [debug] [Thread-2 (]: Writing runtime sql for node "model.homework7.user_session_channel"
[0m11:53:46.391363 [debug] [Thread-2 (]: Using snowflake connection "model.homework7.user_session_channel"
[0m11:53:46.391727 [debug] [Thread-2 (]: On model.homework7.user_session_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.user_session_channel"} */
create or replace   view user_db_lobster.analytics.user_session_channel
  
   as (
    with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
  );
[0m11:53:46.392637 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_timestamp"
[0m11:53:46.393000 [debug] [Thread-1 (]: On model.homework7.session_timestamp: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_timestamp"} */
create or replace   view user_db_lobster.analytics.session_timestamp
  
   as (
    with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
  );
[0m11:53:46.670400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.277 seconds
[0m11:53:46.700938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107219910>]}
[0m11:53:46.701748 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 0.39s]
[0m11:53:46.702563 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m11:53:46.707767 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m11:53:46.710530 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e22420>]}
[0m11:53:46.711282 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.40s]
[0m11:53:46.712074 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m11:53:46.712948 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m11:53:46.713553 [info ] [Thread-4 (]: 3 of 3 START sql table model analytics.session_summary ......................... [RUN]
[0m11:53:46.714280 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m11:53:46.714779 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m11:53:46.718326 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m11:53:46.719185 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m11:53:46.747283 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m11:53:46.748537 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m11:53:46.749001 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (SELECT u.userId, u.sessionId, u.channel, st.ts
FROM user_db_lobster.analytics.user_session_channel u
JOIN user_db_lobster.analytics.session_timestamp st ON u.sessionId = st.sessionId
        );
[0m11:53:46.749547 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:53:48.410957 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.661 seconds
[0m11:53:48.414400 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afa10642-ee70-44ff-ba9d-f68d6bd9c12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145f51610>]}
[0m11:53:48.415341 [info ] [Thread-4 (]: 3 of 3 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.70s]
[0m11:53:48.416242 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m11:53:48.417931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:48.418349 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m11:53:48.418769 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m11:53:48.549436 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m11:53:48.550101 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m11:53:48.673655 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m11:53:48.674335 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m11:53:48.809214 [info ] [MainThread]: 
[0m11:53:48.809946 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m11:53:48.811567 [debug] [MainThread]: Command end result
[0m11:53:48.837021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m11:53:48.838672 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m11:53:48.846203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m11:53:48.846615 [info ] [MainThread]: 
[0m11:53:48.847099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:48.847520 [info ] [MainThread]: 
[0m11:53:48.848049 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:53:48.850796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.837704, "process_in_blocks": "0", "process_kernel_time": 0.736893, "process_mem_max_rss": "190857216", "process_out_blocks": "0", "process_user_time": 4.121493}
[0m11:53:48.851444 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:48.851299 after 5.84 seconds
[0m11:53:48.851937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0ef920>]}
[0m11:53:48.852414 [debug] [MainThread]: Flushing usage events
[0m11:53:49.256364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:48.526800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d2eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112215e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112215b20>]}


============================== 12:01:48.535035 | 65ac24f7-7af2-4a2c-a49a-bbcaa3078e87 ==============================
[0m12:01:48.535035 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:01:48.535936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:01:50.700659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65ac24f7-7af2-4a2c-a49a-bbcaa3078e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11763ca10>]}
[0m12:01:50.764329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65ac24f7-7af2-4a2c-a49a-bbcaa3078e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117619a0>]}
[0m12:05:55.544732 [error] [MainThread]: Encountered an error:

[0m12:05:55.553755 [error] [MainThread]: Traceback (most recent call last):
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Applications/anaconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Applications/anaconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:05:55.558556 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 247.11655, "process_in_blocks": "0", "process_kernel_time": 0.988685, "process_mem_max_rss": "171667456", "process_out_blocks": "0", "process_user_time": 3.726048}
[0m12:05:55.559556 [debug] [MainThread]: Command `dbt docs serve` failed at 12:05:55.559380 after 247.12 seconds
[0m12:05:55.560239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d2eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3ec110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121d3740>]}
[0m12:05:55.560812 [debug] [MainThread]: Flushing usage events
[0m12:05:55.958904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:27.490259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b605f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba59d0>]}


============================== 18:32:27.498699 | 00436a86-ff5e-48b8-a97f-a80144c98245 ==============================
[0m18:32:27.498699 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:32:27.499643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:32:30.189839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c0fda0>]}
[0m18:32:30.252645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ded4d10>]}
[0m18:32:30.253970 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:32:30.406765 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:32:30.533154 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:32:30.533754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116cf800>]}
[0m18:32:32.163182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m18:32:32.175308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11104a810>]}
[0m18:32:32.270222 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:32:32.271788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:32:32.310542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3fbe90>]}
[0m18:32:32.311202 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m18:32:32.311676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3324b0>]}
[0m18:32:32.314062 [info ] [MainThread]: 
[0m18:32:32.314535 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m18:32:32.314955 [info ] [MainThread]: 
[0m18:32:32.315597 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:32:32.321327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m18:32:32.484752 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m18:32:32.485129 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m18:32:32.485485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:33.094364 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.609 seconds
[0m18:32:33.098187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m18:32:33.099013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m18:32:33.110775 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m18:32:33.113174 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m18:32:33.113601 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m18:32:33.113990 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m18:32:33.114499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:33.262836 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.148 seconds
[0m18:32:33.556028 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.441 seconds
[0m18:32:33.559369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e4d0470>]}
[0m18:32:33.563882 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m18:32:33.564419 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m18:32:33.565030 [info ] [Thread-1 (]: 1 of 3 START sql empheral model analytics.session_timestamp .................... [RUN]
[0m18:32:33.565687 [info ] [Thread-2 (]: 2 of 3 START sql empheral model analytics.user_session_channel ................. [RUN]
[0m18:32:33.566269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m18:32:33.566789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m18:32:33.567226 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m18:32:33.567646 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m18:32:33.576402 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m18:32:33.579449 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m18:32:33.580411 [debug] [Thread-2 (]: Began executing node model.homework7.user_session_channel
[0m18:32:33.582854 [debug] [Thread-1 (]: Began executing node model.homework7.session_timestamp
[0m18:32:33.588093 [debug] [Thread-1 (]: Compilation Error in model session_timestamp (models/input/session_timestamp.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m18:32:33.588874 [debug] [Thread-2 (]: Compilation Error in model user_session_channel (models/input/user_session_channel.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m18:32:33.591035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e40e300>]}
[0m18:32:33.591504 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00436a86-ff5e-48b8-a97f-a80144c98245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ea0cbf0>]}
[0m18:32:33.592388 [error] [Thread-2 (]: 2 of 3 ERROR creating sql empheral model analytics.user_session_channel ........ [[31mERROR[0m in 0.02s]
[0m18:32:33.594059 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m18:32:33.592950 [error] [Thread-1 (]: 1 of 3 ERROR creating sql empheral model analytics.session_timestamp ........... [[31mERROR[0m in 0.02s]
[0m18:32:33.595205 [debug] [Thread-8 (]: Marking all children of 'model.homework7.user_session_channel' to be skipped because of status 'error'.  Reason: Compilation Error in model user_session_channel (models/input/user_session_channel.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake').
[0m18:32:33.596079 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m18:32:33.597593 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_timestamp' to be skipped because of status 'error'.  Reason: Compilation Error in model session_timestamp (models/input/session_timestamp.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake').
[0m18:32:33.598578 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m18:32:33.599088 [info ] [Thread-4 (]: 3 of 3 SKIP relation analytics.session_summary ................................. [[33mSKIP[0m]
[0m18:32:33.599611 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m18:32:33.600930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:33.601298 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m18:32:33.601659 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m18:32:33.786049 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m18:32:33.786781 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m18:32:33.911338 [info ] [MainThread]: 
[0m18:32:33.912036 [info ] [MainThread]: Finished running 2 empheral models, 1 table model in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m18:32:33.913432 [debug] [MainThread]: Command end result
[0m18:32:33.936840 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:32:33.938518 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:32:33.945745 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m18:32:33.946185 [info ] [MainThread]: 
[0m18:32:33.946643 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:32:33.947043 [info ] [MainThread]: 
[0m18:32:33.947512 [error] [MainThread]:   Compilation Error in model user_session_channel (models/input/user_session_channel.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m18:32:33.948026 [info ] [MainThread]: 
[0m18:32:33.948489 [error] [MainThread]:   Compilation Error in model session_timestamp (models/input/session_timestamp.sql)
  No materialization 'empheral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m18:32:33.948871 [info ] [MainThread]: 
[0m18:32:33.949284 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m18:32:33.952310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5529375, "process_in_blocks": "0", "process_kernel_time": 1.205898, "process_mem_max_rss": "195276800", "process_out_blocks": "0", "process_user_time": 5.815993}
[0m18:32:33.952892 [debug] [MainThread]: Command `dbt run` failed at 18:32:33.952759 after 6.55 seconds
[0m18:32:33.953352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e63f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de2a060>]}
[0m18:32:33.953787 [debug] [MainThread]: Flushing usage events
[0m18:32:34.311566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:18.516382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f18c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112119a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121196d0>]}


============================== 18:34:18.522878 | 2c5e60eb-3baa-482b-8101-8412123729d9 ==============================
[0m18:34:18.522878 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:34:18.523593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:20.540101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f0680>]}
[0m18:34:20.600726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11152e270>]}
[0m18:34:20.602120 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:34:20.767111 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:34:20.916486 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:34:20.917015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c1f620>]}
[0m18:34:22.615576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m18:34:22.625977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ebbbc20>]}
[0m18:34:22.713977 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:34:22.715411 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:34:22.752821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ec380e0>]}
[0m18:34:22.753495 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m18:34:22.753972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e72a5a0>]}
[0m18:34:22.756373 [info ] [MainThread]: 
[0m18:34:22.756843 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m18:34:22.757260 [info ] [MainThread]: 
[0m18:34:22.757902 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:34:22.758904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m18:34:22.841278 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m18:34:22.841746 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m18:34:22.842115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:23.423016 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.580 seconds
[0m18:34:23.426581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m18:34:23.427310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m18:34:23.441883 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m18:34:23.442472 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m18:34:23.442879 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m18:34:23.443318 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m18:34:23.443742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:23.573730 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.129 seconds
[0m18:34:23.926169 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.482 seconds
[0m18:34:23.929559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ec221e0>]}
[0m18:34:23.935321 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m18:34:23.936011 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m18:34:23.936666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m18:34:23.937324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m18:34:23.937912 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m18:34:23.938524 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m18:34:23.948745 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m18:34:23.951974 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m18:34:23.953198 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m18:34:23.954212 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m18:34:23.955073 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m18:34:23.955770 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m18:34:23.956463 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m18:34:23.956923 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m18:34:23.961887 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m18:34:23.962651 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m18:34:24.007044 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m18:34:24.008752 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m18:34:24.009231 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (with __dbt__cte__user_session_channel as (
with user_session_channel_cte as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
)

select * from user_session_channel_cte
),  __dbt__cte__session_timestamp as (
with session_timestamp_cte as (SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
)

select * from session_timestamp_cte
) SELECT u.userId, u.sessionId, u.channel, st.ts
FROM __dbt__cte__user_session_channel u
JOIN __dbt__cte__session_timestamp st ON u.sessionId = st.sessionId
        );
[0m18:34:24.009694 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:34:27.467784 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.458 seconds
[0m18:34:27.498099 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c5e60eb-3baa-482b-8101-8412123729d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115518b0>]}
[0m18:34:27.498740 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 3.54s]
[0m18:34:27.499333 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m18:34:27.500966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:27.501278 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m18:34:27.501577 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m18:34:27.644154 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m18:34:27.644552 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m18:34:27.772613 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m18:34:27.773084 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m18:34:27.907082 [info ] [MainThread]: 
[0m18:34:27.907497 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m18:34:27.908156 [debug] [MainThread]: Command end result
[0m18:34:27.947257 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:34:27.949084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:34:27.955876 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m18:34:27.956267 [info ] [MainThread]: 
[0m18:34:27.956746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:27.957137 [info ] [MainThread]: 
[0m18:34:27.957554 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:27.961045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.517253, "process_in_blocks": "0", "process_kernel_time": 1.111896, "process_mem_max_rss": "199045120", "process_out_blocks": "0", "process_user_time": 5.879602}
[0m18:34:27.961630 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:27.961499 after 9.52 seconds
[0m18:34:27.962159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111979220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e23350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e9dcad0>]}
[0m18:34:27.962616 [debug] [MainThread]: Flushing usage events
[0m18:34:28.342108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:47:42.240036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0dd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b18e0>]}


============================== 18:47:42.247558 | 08e4755f-8f37-4807-b2b1-ba0ea08470fd ==============================
[0m18:47:42.247558 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:47:42.248350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:47:44.305765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149adcf50>]}
[0m18:47:44.368999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149746330>]}
[0m18:47:44.370218 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:47:44.525566 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:47:44.733121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:47:44.733833 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/user_session_channel.sql
[0m18:47:44.734327 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/session_timestamp.sql
[0m18:47:45.020261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m18:47:45.033658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a076ab0>]}
[0m18:47:45.124962 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:47:45.126607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:47:45.162559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a0c6bd0>]}
[0m18:47:45.163181 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m18:47:45.163654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a076660>]}
[0m18:47:45.166104 [info ] [MainThread]: 
[0m18:47:45.166596 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m18:47:45.167017 [info ] [MainThread]: 
[0m18:47:45.167678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:47:45.168722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster'
[0m18:47:45.333829 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster"
[0m18:47:45.334484 [debug] [ThreadPool]: On list_user_db_lobster: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster"} */
show terse schemas in database user_db_lobster
    limit 10000
[0m18:47:45.335028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:46.182465 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.847 seconds
[0m18:47:46.186257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster, now list_user_db_lobster_analytics)
[0m18:47:46.187108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster_snapshot'
[0m18:47:46.207054 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_analytics"
[0m18:47:46.211677 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster_snapshot"
[0m18:47:46.212093 [debug] [ThreadPool]: On list_user_db_lobster_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_analytics"} */
show objects in user_db_lobster.analytics limit 10000;
[0m18:47:46.212523 [debug] [ThreadPool]: On list_user_db_lobster_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster_snapshot"} */
show objects in user_db_lobster.snapshot limit 10000;
[0m18:47:46.213769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:46.394583 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.182 seconds
[0m18:47:46.767378 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.554 seconds
[0m18:47:46.770834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149e538f0>]}
[0m18:47:46.776629 [debug] [Thread-1 (]: Began running node model.homework7.session_timestamp
[0m18:47:46.777316 [debug] [Thread-2 (]: Began running node model.homework7.user_session_channel
[0m18:47:46.777967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_analytics, now model.homework7.session_timestamp)
[0m18:47:46.778614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster_snapshot, now model.homework7.user_session_channel)
[0m18:47:46.779211 [debug] [Thread-1 (]: Began compiling node model.homework7.session_timestamp
[0m18:47:46.779778 [debug] [Thread-2 (]: Began compiling node model.homework7.user_session_channel
[0m18:47:46.790389 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_timestamp"
[0m18:47:46.793696 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.user_session_channel"
[0m18:47:46.794979 [debug] [Thread-1 (]: Finished running node model.homework7.session_timestamp
[0m18:47:46.795979 [debug] [Thread-2 (]: Finished running node model.homework7.user_session_channel
[0m18:47:46.796863 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m18:47:46.797517 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m18:47:46.798290 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m18:47:46.798800 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m18:47:46.804106 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m18:47:46.805036 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m18:47:46.857861 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m18:47:46.859842 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m18:47:46.860409 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster.analytics.session_summary
         as
        (with __dbt__cte__user_session_channel as (
SELECT userId,sessionId,channel
FROM USER_DB_LOBSTER.raw.user_session_channel
WHERE sessionId IS NOT NULL
),  __dbt__cte__session_timestamp as (
SELECT sessionId,ts
FROM USER_DB_LOBSTER.raw.session_timestamp
WHERE sessionId IS NOT NULL
) SELECT u.userId, u.sessionId, u.channel, st.ts
FROM __dbt__cte__user_session_channel u
JOIN __dbt__cte__session_timestamp st ON u.sessionId = st.sessionId
        );
[0m18:47:46.879931 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:47:49.815676 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.936 seconds
[0m18:47:49.853660 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08e4755f-8f37-4807-b2b1-ba0ea08470fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5e1580>]}
[0m18:47:49.854594 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 3.05s]
[0m18:47:49.855409 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m18:47:49.857026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:49.857426 [debug] [MainThread]: Connection 'model.homework7.session_timestamp' was left open.
[0m18:47:49.857826 [debug] [MainThread]: On model.homework7.session_timestamp: Close
[0m18:47:50.039950 [debug] [MainThread]: Connection 'model.homework7.user_session_channel' was left open.
[0m18:47:50.040647 [debug] [MainThread]: On model.homework7.user_session_channel: Close
[0m18:47:50.202771 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m18:47:50.203456 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m18:47:50.374722 [info ] [MainThread]: 
[0m18:47:50.375433 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m18:47:50.376571 [debug] [MainThread]: Command end result
[0m18:47:50.404227 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m18:47:50.405918 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m18:47:50.413091 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m18:47:50.413540 [info ] [MainThread]: 
[0m18:47:50.414080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:47:50.414508 [info ] [MainThread]: 
[0m18:47:50.414962 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:47:50.419613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.260412, "process_in_blocks": "0", "process_kernel_time": 1.131122, "process_mem_max_rss": "192610304", "process_out_blocks": "0", "process_user_time": 4.785747}
[0m18:47:50.420326 [debug] [MainThread]: Command `dbt run` succeeded at 18:47:50.420181 after 8.26 seconds
[0m18:47:50.420832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d624260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ac4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a05f020>]}
[0m18:47:50.421338 [debug] [MainThread]: Flushing usage events
[0m18:47:50.830179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:59.384453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c5a00>]}


============================== 14:49:59.392858 | bcb639bd-520e-4bb4-b8fe-1374084805e9 ==============================
[0m14:49:59.392858 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:49:59.393770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:01.909306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ffc1a0>]}
[0m14:50:01.970158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e6c2180>]}
[0m14:50:01.971374 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:50:02.134970 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:50:02.285796 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:50:02.286529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ea5fb60>]}
[0m14:50:03.885684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m14:50:03.899995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ec62780>]}
[0m14:50:03.989149 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m14:50:03.991339 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m14:50:04.028307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eebc0b0>]}
[0m14:50:04.028974 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 2 sources, 474 macros
[0m14:50:04.029459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb639bd-520e-4bb4-b8fe-1374084805e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eedf140>]}
[0m14:50:04.031879 [info ] [MainThread]: 
[0m14:50:04.032358 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m14:50:04.032782 [info ] [MainThread]: 
[0m14:50:04.033422 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:04.034422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m14:50:04.211835 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m14:50:04.212326 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m14:50:04.212679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:05.251917 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m14:50:05.252550 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:50:05.253171 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m14:50:05.253705 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:50:05.254920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:05.255363 [debug] [MainThread]: Connection 'list_user_db_lobster1' was left open.
[0m14:50:05.255794 [debug] [MainThread]: On list_user_db_lobster1: No close available on handle
[0m14:50:05.256213 [info ] [MainThread]: 
[0m14:50:05.256712 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m14:50:05.257334 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "user_db_lobster1"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m14:50:05.262158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.9691887, "process_in_blocks": "0", "process_kernel_time": 1.138938, "process_mem_max_rss": "193024000", "process_out_blocks": "0", "process_user_time": 5.47593}
[0m14:50:05.262947 [debug] [MainThread]: Command `dbt run` failed at 14:50:05.262792 after 5.97 seconds
[0m14:50:05.263473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ecad880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eedf140>]}
[0m14:50:05.263971 [debug] [MainThread]: Flushing usage events
[0m14:50:05.268151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:40.737751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142241d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114271ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114271940>]}


============================== 17:04:40.745655 | 91038138-ccb5-4469-9737-037cd10fa040 ==============================
[0m17:04:40.745655 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:04:40.746551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:04:43.044178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91038138-ccb5-4469-9737-037cd10fa040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117250530>]}
[0m17:04:43.103403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91038138-ccb5-4469-9737-037cd10fa040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1505c9520>]}
[0m17:04:43.104634 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:04:43.268097 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:04:43.485075 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m17:04:43.485705 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/moving_average.sql
[0m17:04:43.486137 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/gap_analysis.sql
[0m17:04:43.486688 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m17:04:43.487277 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/user_session_channel.sql
[0m17:04:43.487640 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/session_timestamp.sql
[0m17:04:43.488052 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:04:44.224813 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.moving_average' (models/input/moving_average.sql) depends on a source named 'raw.session_timestamp' which was not found
[0m17:04:44.229157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.581145, "process_in_blocks": "0", "process_kernel_time": 0.99234, "process_mem_max_rss": "182067200", "process_out_blocks": "0", "process_user_time": 4.471711}
[0m17:04:44.230235 [debug] [MainThread]: Command `dbt run` failed at 17:04:44.229977 after 3.58 seconds
[0m17:04:44.230885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c65a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150adfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150aefc50>]}
[0m17:04:44.231495 [debug] [MainThread]: Flushing usage events
[0m17:04:44.573555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:18.943775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148d790>]}


============================== 17:05:18.948747 | de609a81-ef1f-44de-a5ae-c340536260b9 ==============================
[0m17:05:18.948747 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:05:18.949408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:20.037224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de609a81-ef1f-44de-a5ae-c340536260b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d7ce360>]}
[0m17:05:20.100299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de609a81-ef1f-44de-a5ae-c340536260b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d6408f0>]}
[0m17:05:20.101084 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:05:20.240286 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:05:20.398677 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m17:05:20.399185 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/moving_average.sql
[0m17:05:20.399515 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/gap_analysis.sql
[0m17:05:20.399935 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m17:05:20.400385 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/session_timestamp.sql
[0m17:05:20.400675 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/user_session_channel.sql
[0m17:05:20.401001 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:05:21.159354 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.gap_analysis' (models/input/gap_analysis.sql) depends on a source named 'raw.user_session_channel' which was not found
[0m17:05:21.161442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.285344, "process_in_blocks": "0", "process_kernel_time": 0.6881, "process_mem_max_rss": "182714368", "process_out_blocks": "0", "process_user_time": 3.894451}
[0m17:05:21.161935 [debug] [MainThread]: Command `dbt run` failed at 17:05:21.161818 after 2.29 seconds
[0m17:05:21.162333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dc78c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dd6f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dd67a10>]}
[0m17:05:21.162718 [debug] [MainThread]: Flushing usage events
[0m17:05:21.614570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:37.922441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327d940>]}


============================== 17:05:37.927368 | 0e759921-0e2c-47bd-9656-fd0e159b409e ==============================
[0m17:05:37.927368 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:05:37.928035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:38.997967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184966c0>]}
[0m17:05:39.057716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f5d06e0>]}
[0m17:05:39.058447 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:05:39.195825 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:05:39.355039 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m17:05:39.355553 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/moving_average.sql
[0m17:05:39.355884 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/gap_analysis.sql
[0m17:05:39.356307 [debug] [MainThread]: Partial parsing: updated file: homework7://models/source.yml
[0m17:05:39.356759 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/user_session_channel.sql
[0m17:05:39.357049 [debug] [MainThread]: Partial parsing: deleted file: homework7://models/input/session_timestamp.sql
[0m17:05:39.357372 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:05:40.137424 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:05:40.147234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fafa6c0>]}
[0m17:05:40.236454 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:05:40.238159 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:05:40.275885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8cac90>]}
[0m17:05:40.276551 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 1 source, 474 macros
[0m17:05:40.277028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb5c8f0>]}
[0m17:05:40.279412 [info ] [MainThread]: 
[0m17:05:40.279900 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:05:40.280304 [info ] [MainThread]: 
[0m17:05:40.280924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:05:40.281892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:05:40.364007 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:05:40.364461 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:05:40.364811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:41.455083 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.090 seconds
[0m17:05:41.458070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now create_user_db_lobster1_analytics)
[0m17:05:41.459778 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster1"
schema: "analytics"
"
[0m17:05:41.466244 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster1_analytics"
[0m17:05:41.466724 [debug] [ThreadPool]: On create_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "create_user_db_lobster1_analytics"} */
create schema if not exists user_db_lobster1.analytics
[0m17:05:41.582561 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m17:05:41.585417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m17:05:41.586244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:05:41.605317 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:05:41.610280 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:05:41.610694 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:05:41.611131 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:05:41.611678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:41.731868 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9585-0304-eb6a-0004-59ff001ca22a
[0m17:05:41.732409 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:05:41.732958 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:05:41.733376 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:05:41.902985 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.291 seconds
[0m17:05:41.905928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f645670>]}
[0m17:05:41.912320 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:05:41.912994 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:05:41.913639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:05:41.914288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:05:41.914874 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:05:41.915442 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:05:41.925303 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:05:41.928367 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:05:41.929515 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:05:41.930394 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:05:41.931120 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:05:41.931744 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:05:41.932414 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:05:41.932869 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:05:41.937145 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:05:41.938118 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:05:41.975013 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:05:41.976550 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:05:41.977005 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap
        );
[0m17:05:41.977445 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:05:43.500893 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.523 seconds
[0m17:05:43.535373 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e759921-0e2c-47bd-9656-fd0e159b409e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b1460>]}
[0m17:05:43.536282 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.60s]
[0m17:05:43.537062 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:05:43.538607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:43.538997 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:05:43.539390 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:05:43.639229 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:05:43.639917 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:05:43.741876 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:05:43.742535 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:05:43.845312 [info ] [MainThread]: 
[0m17:05:43.846024 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m17:05:43.847115 [debug] [MainThread]: Command end result
[0m17:05:43.876154 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:05:43.878021 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:05:43.885189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:05:43.885636 [info ] [MainThread]: 
[0m17:05:43.886137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:43.886607 [info ] [MainThread]: 
[0m17:05:43.887051 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:05:43.889633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0349092, "process_in_blocks": "0", "process_kernel_time": 0.885148, "process_mem_max_rss": "199393280", "process_out_blocks": "0", "process_user_time": 4.891568}
[0m17:05:43.890295 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:43.890153 after 6.04 seconds
[0m17:05:43.890790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f968140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c30b0>]}
[0m17:05:43.891260 [debug] [MainThread]: Flushing usage events
[0m17:05:44.219461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:45.760648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104751730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1d970>]}


============================== 17:07:45.765628 | dc062e73-9558-497d-9cb9-d1271c2fdef1 ==============================
[0m17:07:45.765628 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:07:45.766285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:46.842935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140dff770>]}
[0m17:07:46.903835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140411940>]}
[0m17:07:46.904583 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:07:47.043758 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:07:47.205424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:07:47.205984 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/gap_analysis.sql
[0m17:07:47.206372 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/moving_average.sql
[0m17:07:47.483894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:07:47.495809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1414e6f60>]}
[0m17:07:47.586279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:07:47.588087 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:07:47.601053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141515ac0>]}
[0m17:07:47.601496 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 data tests, 1 source, 474 macros
[0m17:07:47.601838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1412bc2c0>]}
[0m17:07:47.603595 [info ] [MainThread]: 
[0m17:07:47.603945 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:07:47.604245 [info ] [MainThread]: 
[0m17:07:47.604725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:47.605476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:07:47.740948 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:07:47.741564 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:07:47.742095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:48.324586 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.582 seconds
[0m17:07:48.328545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:07:48.329283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:07:48.352978 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:07:48.353458 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:07:48.353868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:48.355847 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:07:48.356394 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:07:48.554991 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9587-0304-e858-0004-59ff001cb236
[0m17:07:48.555612 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:07:48.556148 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:07:48.556560 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:07:48.840998 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.487 seconds
[0m17:07:48.844458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141583f50>]}
[0m17:07:48.847720 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:07:48.848275 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:07:48.848807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:07:48.849359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:07:48.849853 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:07:48.850328 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:07:48.860519 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:07:48.863681 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:07:48.864900 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:07:48.865843 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:07:48.866664 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:07:48.867355 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:07:48.868062 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:07:48.868540 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:07:48.872896 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:07:48.873692 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:07:48.910723 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:07:48.912256 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:07:48.912718 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap
        );
[0m17:07:48.913156 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:07:50.245817 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.332 seconds
[0m17:07:50.280779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc062e73-9558-497d-9cb9-d1271c2fdef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a3d820>]}
[0m17:07:50.281465 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.41s]
[0m17:07:50.282156 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:07:50.283621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:50.283975 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:07:50.284331 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:07:50.393911 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:07:50.394595 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:07:50.548136 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:07:50.548849 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:07:50.636920 [info ] [MainThread]: 
[0m17:07:50.637590 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m17:07:50.638690 [debug] [MainThread]: Command end result
[0m17:07:50.665802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:07:50.667646 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:07:50.675515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:07:50.676031 [info ] [MainThread]: 
[0m17:07:50.676567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:50.677011 [info ] [MainThread]: 
[0m17:07:50.677461 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:07:50.680041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.98543, "process_in_blocks": "0", "process_kernel_time": 0.743435, "process_mem_max_rss": "193392640", "process_out_blocks": "0", "process_user_time": 4.139705}
[0m17:07:50.680700 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:50.680556 after 4.99 seconds
[0m17:07:50.681231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104723ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104723dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1419b6d50>]}
[0m17:07:50.681736 [debug] [MainThread]: Flushing usage events
[0m17:07:51.111766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:15.224828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b1a30>]}


============================== 17:09:15.232179 | 81757008-2ee8-494e-af1b-f755cbf54288 ==============================
[0m17:09:15.232179 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:09:15.233117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:17.333370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1446b6990>]}
[0m17:09:17.392972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14491d040>]}
[0m17:09:17.394698 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:09:17.564930 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:09:17.781247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:17.782017 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:09:18.215469 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:09:18.227392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d4db20>]}
[0m17:09:18.417913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:09:18.419696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:09:18.458080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e48f80>]}
[0m17:09:18.458691 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:09:18.459163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106528380>]}
[0m17:09:18.461483 [info ] [MainThread]: 
[0m17:09:18.461954 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:09:18.462380 [info ] [MainThread]: 
[0m17:09:18.463015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:09:18.464018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:09:18.551788 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:09:18.552314 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:09:18.552721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:19.361898 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.809 seconds
[0m17:09:19.365522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:09:19.366370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:09:19.385966 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:09:19.390311 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:09:19.390724 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:09:19.391160 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:09:19.392011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:19.535876 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m17:09:19.824677 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9589-0304-e858-0004-59ff001cb26e
[0m17:09:19.825300 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:09:19.825943 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:09:19.826446 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:09:19.827393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14524d2e0>]}
[0m17:09:19.831948 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:09:19.832533 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:09:19.833098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:09:19.833659 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:09:19.834173 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:09:19.834707 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:09:19.844769 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:09:19.847924 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:09:19.849262 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:09:19.850142 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:09:19.850956 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:09:19.851583 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:09:19.852308 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:09:19.852781 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:09:19.857336 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:09:19.858059 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:09:19.895673 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:09:19.897213 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:09:19.897667 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date
        );
[0m17:09:19.898109 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:09:21.051255 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.153 seconds
[0m17:09:21.089370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81757008-2ee8-494e-af1b-f755cbf54288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f59d0>]}
[0m17:09:21.090240 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.24s]
[0m17:09:21.091006 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:09:21.092499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:21.092875 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:09:21.093249 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:09:21.214042 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:09:21.214812 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:09:21.314062 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:09:21.314695 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:09:21.407010 [info ] [MainThread]: 
[0m17:09:21.407716 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m17:09:21.408831 [debug] [MainThread]: Command end result
[0m17:09:21.433349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:09:21.434914 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:09:21.441225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:09:21.441577 [info ] [MainThread]: 
[0m17:09:21.442027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:21.442402 [info ] [MainThread]: 
[0m17:09:21.442797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:21.446339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3019366, "process_in_blocks": "0", "process_kernel_time": 1.180201, "process_mem_max_rss": "193806336", "process_out_blocks": "0", "process_user_time": 5.047975}
[0m17:09:21.446998 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:21.446866 after 6.30 seconds
[0m17:09:21.447464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e5640>]}
[0m17:09:21.447900 [debug] [MainThread]: Flushing usage events
[0m17:09:21.775636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:05.701583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c965cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce2dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce2d8e0>]}


============================== 17:11:05.709070 | eacbaac8-54da-4031-a8cd-25138967942f ==============================
[0m17:11:05.709070 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:11:05.709857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:11:07.743804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac52a50>]}
[0m17:11:07.806935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe43260>]}
[0m17:11:07.808419 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:11:07.975792 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:11:08.193249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:11:08.193937 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/moving_average.sql
[0m17:11:08.194396 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/gap_analysis.sql
[0m17:11:08.194900 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:11:08.648194 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:11:08.660460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1495b2660>]}
[0m17:11:08.851682 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:11:08.853552 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:11:08.890356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149660230>]}
[0m17:11:08.890983 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:11:08.891457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149801370>]}
[0m17:11:08.893755 [info ] [MainThread]: 
[0m17:11:08.894230 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:11:08.894647 [info ] [MainThread]: 
[0m17:11:08.895276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:11:08.896266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:11:08.982758 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:11:08.983220 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:11:08.983602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:09.786075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.802 seconds
[0m17:11:09.789695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:11:09.790543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:11:09.809696 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:11:09.813991 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:11:09.814392 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:11:09.814822 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:11:09.816045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:10.068524 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.253 seconds
[0m17:11:10.373569 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb958b-0304-eb90-0004-59ff001c7da2
[0m17:11:10.374183 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:11:10.374833 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:11:10.375329 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:11:10.376284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1496339b0>]}
[0m17:11:10.381233 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:11:10.381930 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:11:10.382586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:11:10.383225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:11:10.383816 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:11:10.384383 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:11:10.394525 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:11:10.397648 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:11:10.399692 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:11:10.400546 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:11:10.401552 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:11:10.402215 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:11:10.402977 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:11:10.403471 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:11:10.408731 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:11:10.409915 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:11:10.448504 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:11:10.450093 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:11:10.450555 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol == gap.symbol
        );
[0m17:11:10.450996 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:11:11.659487 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb958b-0304-eb90-0004-59ff001c7da6
[0m17:11:11.660326 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function "=="
[0m17:11:11.666944 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:11:11.669555 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eacbaac8-54da-4031-a8cd-25138967942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c259ac0>]}
[0m17:11:11.670382 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 1.26s]
[0m17:11:11.671198 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:11:11.671914 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:11:11.674259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:11.674682 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:11:11.675081 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:11:11.788181 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:11:11.788872 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:11:11.900975 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:11:11.901662 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:11:12.556026 [info ] [MainThread]: 
[0m17:11:12.556665 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m17:11:12.557767 [debug] [MainThread]: Command end result
[0m17:11:12.583105 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:11:12.584817 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:11:12.591337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:11:12.591736 [info ] [MainThread]: 
[0m17:11:12.592195 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:11:12.592597 [info ] [MainThread]: 
[0m17:11:12.593065 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:11:12.593480 [info ] [MainThread]: 
[0m17:11:12.593905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:11:12.597720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.9856052, "process_in_blocks": "0", "process_kernel_time": 1.14177, "process_mem_max_rss": "194854912", "process_out_blocks": "0", "process_user_time": 5.054076}
[0m17:11:12.598379 [debug] [MainThread]: Command `dbt run` failed at 17:11:12.598243 after 6.99 seconds
[0m17:11:12.598844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb9b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c298350>]}
[0m17:11:12.599284 [debug] [MainThread]: Flushing usage events
[0m17:11:13.084386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:48.445833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112441460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113011910>]}


============================== 17:13:48.450850 | 6897dba8-96f9-4020-8a06-2f229c6b9268 ==============================
[0m17:13:48.450850 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:13:48.451527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:49.767204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea2360>]}
[0m17:13:49.826990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ecd1340>]}
[0m17:13:49.827723 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:13:49.973230 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:13:50.134798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:50.135383 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:13:50.561318 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:13:50.574282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fa04a40>]}
[0m17:13:50.771335 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:13:50.773094 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:13:50.788249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14faaae70>]}
[0m17:13:50.788772 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:13:50.789181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9a64b0>]}
[0m17:13:50.791185 [info ] [MainThread]: 
[0m17:13:50.791590 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:13:50.791957 [info ] [MainThread]: 
[0m17:13:50.792505 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:13:50.793380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:13:50.855246 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:13:50.855625 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:13:50.855920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:51.369960 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.514 seconds
[0m17:13:51.373576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:13:51.374436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:13:51.387430 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:13:51.389858 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:13:51.390297 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:13:51.390718 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:13:51.391270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:51.467780 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb958d-0304-eb8b-0004-59ff001c84e2
[0m17:13:51.468244 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:13:51.468720 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:13:51.469083 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:13:51.816008 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.425 seconds
[0m17:13:51.819501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8da960>]}
[0m17:13:51.822689 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:13:51.823255 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:13:51.823794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:13:51.824357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:13:51.824862 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:13:51.825351 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:13:51.835372 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:13:51.838481 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:13:51.839875 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:13:51.840784 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:13:51.841512 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:13:51.842292 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:13:51.843046 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:13:51.843532 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:13:51.848209 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:13:51.848972 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:13:51.887116 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:13:51.888699 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:13:51.889156 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.symbol == gap.symbol
        );
[0m17:13:51.889596 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:13:52.337308 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb958d-0304-eb6a-0004-59ff001ca34a
[0m17:13:52.337961 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function "=="
[0m17:13:52.342262 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:13:52.344246 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6897dba8-96f9-4020-8a06-2f229c6b9268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112441b20>]}
[0m17:13:52.345027 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.50s]
[0m17:13:52.345818 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:13:52.346502 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:13:52.348747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:52.349149 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:13:52.349629 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:13:52.458840 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:13:52.459354 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:13:52.563394 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:13:52.564087 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:13:52.830385 [info ] [MainThread]: 
[0m17:13:52.831028 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m17:13:52.832112 [debug] [MainThread]: Command end result
[0m17:13:52.856894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:13:52.858585 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:13:52.865121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:13:52.865507 [info ] [MainThread]: 
[0m17:13:52.865965 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:13:52.866395 [info ] [MainThread]: 
[0m17:13:52.866868 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:13:52.867287 [info ] [MainThread]: 
[0m17:13:52.867706 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:13:52.871039 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4930243, "process_in_blocks": "0", "process_kernel_time": 0.779382, "process_mem_max_rss": "193212416", "process_out_blocks": "0", "process_user_time": 4.322025}
[0m17:13:52.871755 [debug] [MainThread]: Command `dbt run` failed at 17:13:52.871609 after 4.49 seconds
[0m17:13:52.872288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124803e0>]}
[0m17:13:52.872787 [debug] [MainThread]: Flushing usage events
[0m17:13:53.298016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:15.265191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104992f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d8e0>]}


============================== 17:14:15.272690 | 632501b8-f80d-4225-92a0-56144f21ff3a ==============================
[0m17:14:15.272690 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:14:15.273613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:14:17.557912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aaa6f0>]}
[0m17:14:17.621165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7e600>]}
[0m17:14:17.622549 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:14:17.786510 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:14:17.997053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:17.997498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:18.003639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:14:18.057449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142feaf30>]}
[0m17:14:18.150603 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:14:18.152495 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:14:18.185951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142efac30>]}
[0m17:14:18.186588 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:14:18.187042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431383b0>]}
[0m17:14:18.189426 [info ] [MainThread]: 
[0m17:14:18.189898 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:14:18.190312 [info ] [MainThread]: 
[0m17:14:18.190936 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:14:18.191967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:14:18.276628 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:14:18.277082 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:14:18.277460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:18.842040 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.564 seconds
[0m17:14:18.845701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:14:18.846550 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:14:18.866219 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:14:18.870431 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:14:18.870847 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:14:18.871284 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:14:18.872509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:18.977232 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb958e-0304-eb6a-0004-59ff001ca34e
[0m17:14:18.977784 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:14:18.978340 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:14:18.978757 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:14:19.556243 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.684 seconds
[0m17:14:19.559698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142fea8d0>]}
[0m17:14:19.564850 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:14:19.565511 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:14:19.566116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:14:19.566696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:14:19.567226 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:14:19.567736 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:14:19.580053 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:14:19.581418 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:14:19.582529 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:14:19.583398 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:14:19.584227 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:14:19.584855 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:14:19.585712 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:14:19.586208 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:14:19.590999 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:14:19.591764 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:14:19.708063 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:14:19.710078 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:14:19.710677 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.symbol == gap.symbol
        );
[0m17:14:19.711275 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:14:20.102589 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb958e-0304-eb8b-0004-59ff001c84fa
[0m17:14:20.103278 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function "=="
[0m17:14:20.109490 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:14:20.111849 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '632501b8-f80d-4225-92a0-56144f21ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595d0a0>]}
[0m17:14:20.112683 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.52s]
[0m17:14:20.113514 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:14:20.114242 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:14:20.116538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:20.116937 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:14:20.117340 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:14:20.227743 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:14:20.228437 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:14:20.328565 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:14:20.329258 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:14:20.427085 [info ] [MainThread]: 
[0m17:14:20.427728 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m17:14:20.428818 [debug] [MainThread]: Command end result
[0m17:14:20.454521 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:14:20.456254 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:14:20.463099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:14:20.463460 [info ] [MainThread]: 
[0m17:14:20.463930 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:14:20.464378 [info ] [MainThread]: 
[0m17:14:20.464909 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  002140 (42601): SQL compilation error:
  Unknown function "=="
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:14:20.465302 [info ] [MainThread]: 
[0m17:14:20.465723 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:14:20.469824 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.293099, "process_in_blocks": "0", "process_kernel_time": 1.083994, "process_mem_max_rss": "188469248", "process_out_blocks": "0", "process_user_time": 4.457203}
[0m17:14:20.470551 [debug] [MainThread]: Command `dbt run` failed at 17:14:20.470406 after 5.29 seconds
[0m17:14:20.471036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143473fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104992f60>]}
[0m17:14:20.471489 [debug] [MainThread]: Flushing usage events
[0m17:14:20.792526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:44.250286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ee9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0d970>]}


============================== 17:15:44.255358 | 8322c274-f080-4611-9bd8-ddbb8e0acdc3 ==============================
[0m17:15:44.255358 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:15:44.256025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:45.349630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cc98ad0>]}
[0m17:15:45.417852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9d5430>]}
[0m17:15:45.418862 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:15:45.561543 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:15:45.723716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:15:45.724306 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:15:46.149693 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:15:46.161280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d349220>]}
[0m17:15:46.343936 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:15:46.345701 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:15:46.360575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d423f50>]}
[0m17:15:46.361092 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:15:46.361507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d348470>]}
[0m17:15:46.363522 [info ] [MainThread]: 
[0m17:15:46.363929 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:15:46.364292 [info ] [MainThread]: 
[0m17:15:46.364848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:15:46.365712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:15:46.430861 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:15:46.431237 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:15:46.431533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:46.964452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.533 seconds
[0m17:15:46.968125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:15:46.968960 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:15:46.987670 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:15:46.991405 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:15:46.991787 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:15:46.992186 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:15:46.993293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:47.095429 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m17:15:47.414309 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb958f-0304-eb8b-0004-59ff001c8522
[0m17:15:47.414905 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:15:47.415519 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:15:47.415943 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:15:47.416733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb612e0>]}
[0m17:15:47.419670 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:15:47.420230 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:15:47.420764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:15:47.421324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:15:47.421837 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:15:47.422327 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:15:47.432385 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:15:47.435491 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:15:47.436741 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:15:47.437748 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:15:47.438670 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:15:47.439312 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:15:47.439989 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:15:47.440459 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:15:47.445077 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:15:47.445807 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:15:47.483592 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:15:47.485163 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:15:47.485615 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.symbol = gap.symbol
        );
[0m17:15:47.486054 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:15:49.815475 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.329 seconds
[0m17:15:49.850585 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8322c274-f080-4611-9bd8-ddbb8e0acdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe79730>]}
[0m17:15:49.851315 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.41s]
[0m17:15:49.852017 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:15:49.853485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:49.853837 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:15:49.854194 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:15:49.944585 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:15:49.945275 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:15:50.038924 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:15:50.039604 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:15:50.158897 [info ] [MainThread]: 
[0m17:15:50.159532 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m17:15:50.160620 [debug] [MainThread]: Command end result
[0m17:15:50.186319 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:15:50.188177 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:15:50.195329 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:15:50.195770 [info ] [MainThread]: 
[0m17:15:50.196285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:50.196798 [info ] [MainThread]: 
[0m17:15:50.197396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:15:50.199971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.01698, "process_in_blocks": "0", "process_kernel_time": 0.753626, "process_mem_max_rss": "194883584", "process_out_blocks": "0", "process_user_time": 4.310293}
[0m17:15:50.200628 [debug] [MainThread]: Command `dbt run` succeeded at 17:15:50.200487 after 6.02 seconds
[0m17:15:50.201124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6ded20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d670350>]}
[0m17:15:50.201592 [debug] [MainThread]: Flushing usage events
[0m17:15:50.520192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:56.073926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a9550>]}


============================== 17:16:56.079494 | 53b7e899-4744-4b5d-8217-e4141ee93c24 ==============================
[0m17:16:56.079494 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:16:56.080288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:16:57.266783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14669be60>]}
[0m17:16:57.343851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7992b0>]}
[0m17:16:57.344716 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:16:57.555327 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:16:57.754858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:57.755599 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:16:58.216924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:16:58.229163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146c9c290>]}
[0m17:16:58.414264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:16:58.416086 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:16:58.430942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146d53dd0>]}
[0m17:16:58.431444 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:16:58.431853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146de5640>]}
[0m17:16:58.434636 [info ] [MainThread]: 
[0m17:16:58.435177 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:16:58.435584 [info ] [MainThread]: 
[0m17:16:58.436161 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:58.437094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:16:58.504947 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:16:58.505344 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:16:58.505651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:59.101464 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.596 seconds
[0m17:16:59.103786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:16:59.104346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:16:59.114759 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:16:59.116942 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:16:59.117298 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:16:59.117625 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:16:59.118592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:59.229559 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9590-0304-eb6a-0004-59ff001ca3a6
[0m17:16:59.229957 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:16:59.230429 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:16:59.230756 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:16:59.515161 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.397 seconds
[0m17:16:59.517697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f199a0>]}
[0m17:16:59.520379 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:16:59.520871 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:16:59.521354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:16:59.521872 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:16:59.522331 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:16:59.522761 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:16:59.532885 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:16:59.536325 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:16:59.537556 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:16:59.538385 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:16:59.539186 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:16:59.540082 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:16:59.540981 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:16:59.541436 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:16:59.546085 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:16:59.546855 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:16:59.590682 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:16:59.592488 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:16:59.593012 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,symbola
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date
        );
[0m17:16:59.593482 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:17:00.017767 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb9590-0304-eb6a-0004-59ff001ca3aa
[0m17:17:00.018293 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 26
invalid identifier 'SYMBOLA'
[0m17:17:00.021938 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  000904 (42000): SQL compilation error: error line 15 at position 26
  invalid identifier 'SYMBOLA'
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:17:00.023827 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b7e899-4744-4b5d-8217-e4141ee93c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d9af0>]}
[0m17:17:00.024630 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.48s]
[0m17:17:00.025614 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:17:00.026322 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  000904 (42000): SQL compilation error: error line 15 at position 26
  invalid identifier 'SYMBOLA'
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:17:00.028522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:00.028921 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:17:00.029300 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:17:00.147456 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:17:00.147909 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:17:00.234106 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:17:00.234793 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:17:00.326329 [info ] [MainThread]: 
[0m17:17:00.327071 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m17:17:00.328166 [debug] [MainThread]: Command end result
[0m17:17:00.354808 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:17:00.356688 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:17:00.364144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:17:00.364606 [info ] [MainThread]: 
[0m17:17:00.365319 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:17:00.366036 [info ] [MainThread]: 
[0m17:17:00.366607 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  000904 (42000): SQL compilation error: error line 15 at position 26
  invalid identifier 'SYMBOLA'
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:17:00.367089 [info ] [MainThread]: 
[0m17:17:00.367594 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:00.370456 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.383221, "process_in_blocks": "0", "process_kernel_time": 0.865388, "process_mem_max_rss": "193835008", "process_out_blocks": "0", "process_user_time": 4.58367}
[0m17:17:00.371337 [debug] [MainThread]: Command `dbt run` failed at 17:17:00.371168 after 4.38 seconds
[0m17:17:00.371889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43bf50>]}
[0m17:17:00.372398 [debug] [MainThread]: Flushing usage events
[0m17:17:00.672861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:42.829547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba3f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c061b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0617c0>]}


============================== 17:17:42.835450 | 5e2b6b3a-0b60-455a-93dc-e4cfbece88a4 ==============================
[0m17:17:42.835450 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:17:42.836204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:17:44.084067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f058710>]}
[0m17:17:44.147282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad86b0>]}
[0m17:17:44.148045 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:17:44.295350 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:17:44.461489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:44.462187 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:17:44.895552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:17:44.907345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1483ac9b0>]}
[0m17:17:45.099695 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:17:45.101471 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:17:45.116521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1488e6b70>]}
[0m17:17:45.117065 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:17:45.117479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148ab7710>]}
[0m17:17:45.119532 [info ] [MainThread]: 
[0m17:17:45.119937 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:17:45.120301 [info ] [MainThread]: 
[0m17:17:45.120854 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:17:45.121735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:17:45.190783 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:17:45.191185 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:17:45.191519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:45.857560 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.666 seconds
[0m17:17:45.861189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:17:45.862052 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:17:45.876662 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:17:45.877380 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:17:45.877785 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:17:45.878224 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:17:45.878634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:45.978407 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m17:17:46.312371 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9591-0304-eb6a-0004-59ff001ca3ae
[0m17:17:46.312967 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:17:46.313587 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:17:46.314029 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:17:46.314839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1488d8320>]}
[0m17:17:46.317824 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:17:46.318386 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:17:46.318917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:17:46.319468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:17:46.319966 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:17:46.320441 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:17:46.330322 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:17:46.333392 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:17:46.334702 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:17:46.335597 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:17:46.336318 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:17:46.337110 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:17:46.337857 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:17:46.338348 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:17:46.343081 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:17:46.343857 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:17:46.381352 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:17:46.382914 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:17:46.383375 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,symbol
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date
        );
[0m17:17:46.383810 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:17:46.761873 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb9591-0304-eb8b-0004-59ff001c8536
[0m17:17:46.762528 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'SYMBOL'
[0m17:17:46.766851 [debug] [Thread-4 (]: Database Error in model session_summary (models/output/session_summary.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'SYMBOL'
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:17:46.768869 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e2b6b3a-0b60-455a-93dc-e4cfbece88a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b49d8e0>]}
[0m17:17:46.769681 [error] [Thread-4 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.43s]
[0m17:17:46.770488 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:17:46.771194 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'SYMBOL'
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:17:46.773560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:46.773971 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:17:46.774383 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:17:46.926056 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:17:46.926654 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:17:47.019928 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:17:47.020613 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:17:47.250524 [info ] [MainThread]: 
[0m17:17:47.251237 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m17:17:47.252297 [debug] [MainThread]: Command end result
[0m17:17:47.277410 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:17:47.278980 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:17:47.285286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:17:47.285648 [info ] [MainThread]: 
[0m17:17:47.286104 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:17:47.286499 [info ] [MainThread]: 
[0m17:17:47.286966 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'SYMBOL'
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:17:47.287334 [info ] [MainThread]: 
[0m17:17:47.287854 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:47.290376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.536257, "process_in_blocks": "0", "process_kernel_time": 0.874429, "process_mem_max_rss": "195395584", "process_out_blocks": "0", "process_user_time": 4.594849}
[0m17:17:47.291071 [debug] [MainThread]: Command `dbt run` failed at 17:17:47.290930 after 4.54 seconds
[0m17:17:47.291558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b550140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11140be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beec2c0>]}
[0m17:17:47.291995 [debug] [MainThread]: Flushing usage events
[0m17:17:47.779324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:53.779777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a86e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d71cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d71940>]}


============================== 17:18:53.785130 | bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11 ==============================
[0m17:18:53.785130 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:18:53.786282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:18:54.943974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117debfe0>]}
[0m17:18:55.013854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d03d10>]}
[0m17:18:55.014813 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:18:55.164279 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:18:55.329275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:55.329977 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:18:55.767889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:18:55.780258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1505a4440>]}
[0m17:18:55.970735 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:18:55.972503 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:18:55.987627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1506493d0>]}
[0m17:18:55.988171 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:18:55.988580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150335850>]}
[0m17:18:55.990630 [info ] [MainThread]: 
[0m17:18:55.991043 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:18:55.991407 [info ] [MainThread]: 
[0m17:18:55.991957 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:18:55.993309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:18:56.061537 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:18:56.061923 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:18:56.062225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:56.842186 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.780 seconds
[0m17:18:56.845729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:18:56.846498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:18:56.865884 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:18:56.870053 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:18:56.870446 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:18:56.870863 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:18:56.872064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:56.965823 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m17:18:57.256195 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9592-0304-e849-0004-59ff001c9492
[0m17:18:57.256824 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:18:57.257460 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:18:57.257902 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:57.258710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150722fc0>]}
[0m17:18:57.261713 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:18:57.262297 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:18:57.262849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:18:57.263427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:18:57.263959 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:18:57.264451 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:18:57.274500 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:18:57.277629 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:18:57.278889 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:18:57.279899 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:18:57.280730 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:18:57.281415 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:18:57.282092 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:18:57.282566 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:18:57.287391 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:18:57.288143 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:18:57.325708 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:18:57.327428 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:18:57.327957 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,ma.symbol
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date
        );
[0m17:18:57.328398 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:18:58.818792 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.490 seconds
[0m17:18:58.855486 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc42c5b1-d8ac-47ed-9887-fb1cbe3f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a1c10>]}
[0m17:18:58.856246 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.57s]
[0m17:18:58.856986 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:18:58.858444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:58.858813 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:18:58.859183 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:18:59.008802 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:18:59.009477 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:18:59.107644 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:18:59.108315 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:18:59.234652 [info ] [MainThread]: 
[0m17:18:59.235366 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m17:18:59.236469 [debug] [MainThread]: Command end result
[0m17:18:59.262002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:18:59.263782 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:18:59.270608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:18:59.271025 [info ] [MainThread]: 
[0m17:18:59.271514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:59.271933 [info ] [MainThread]: 
[0m17:18:59.272387 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:18:59.275566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5667977, "process_in_blocks": "0", "process_kernel_time": 0.79893, "process_mem_max_rss": "193953792", "process_out_blocks": "0", "process_user_time": 4.375016}
[0m17:18:59.276248 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:59.276108 after 5.57 seconds
[0m17:18:59.276742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1507d48c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1508b52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d71a90>]}
[0m17:18:59.277209 [debug] [MainThread]: Flushing usage events
[0m17:18:59.728537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:28.708002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107085bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c1520>]}


============================== 17:21:28.715083 | 1a5a5258-e548-41df-a3c8-fc492cde0f0c ==============================
[0m17:21:28.715083 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:21:28.715832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:21:30.521579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2a3da0>]}
[0m17:21:30.594958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ea120>]}
[0m17:21:30.595751 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:21:30.735331 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:21:30.903122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:30.903777 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:21:31.333456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:21:31.345356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143e50110>]}
[0m17:21:31.540192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:21:31.541953 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:21:31.556846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143c6eba0>]}
[0m17:21:31.557352 [info ] [MainThread]: Found 1 snapshot, 3 models, 3 data tests, 1 source, 474 macros
[0m17:21:31.557757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143d094f0>]}
[0m17:21:31.559816 [info ] [MainThread]: 
[0m17:21:31.560230 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:21:31.560604 [info ] [MainThread]: 
[0m17:21:31.561159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:21:31.562030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:21:31.624161 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:21:31.624568 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:21:31.624861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:32.345251 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.720 seconds
[0m17:21:32.348893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:21:32.349764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:21:32.368925 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:21:32.373410 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:21:32.373805 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:21:32.374228 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:21:32.375388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:32.581885 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9595-0304-eb6a-0004-59ff001ca42e
[0m17:21:32.582384 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:21:32.582911 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:21:32.583319 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:21:32.882064 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.507 seconds
[0m17:21:32.885810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143c6d670>]}
[0m17:21:32.888922 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:21:32.889489 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:21:32.890039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:21:32.890686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:21:32.891416 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:21:32.891950 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:21:32.902582 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:21:32.905644 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:21:32.907089 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:21:32.908232 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:21:32.909113 [debug] [Thread-4 (]: Began running node model.homework7.session_summary
[0m17:21:32.909776 [info ] [Thread-4 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:21:32.910529 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:21:32.911017 [debug] [Thread-4 (]: Began compiling node model.homework7.session_summary
[0m17:21:32.916650 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:21:32.917483 [debug] [Thread-4 (]: Began executing node model.homework7.session_summary
[0m17:21:32.957473 [debug] [Thread-4 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:21:32.959099 [debug] [Thread-4 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:21:32.959551 [debug] [Thread-4 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,ma.symbol,ma.date
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
        );
[0m17:21:32.959985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:21:34.220766 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m17:21:34.258273 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a5a5258-e548-41df-a3c8-fc492cde0f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ed5e0>]}
[0m17:21:34.259062 [info ] [Thread-4 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.35s]
[0m17:21:34.259822 [debug] [Thread-4 (]: Finished running node model.homework7.session_summary
[0m17:21:34.261296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:34.261666 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:21:34.262047 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:21:34.363972 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:21:34.364655 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:21:34.550937 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:21:34.551608 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:21:34.649642 [info ] [MainThread]: 
[0m17:21:34.650316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m17:21:34.651423 [debug] [MainThread]: Command end result
[0m17:21:34.677844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:21:34.679653 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:21:34.686701 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:21:34.687130 [info ] [MainThread]: 
[0m17:21:34.687660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:34.688144 [info ] [MainThread]: 
[0m17:21:34.688692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:21:34.692114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0647745, "process_in_blocks": "0", "process_kernel_time": 1.076793, "process_mem_max_rss": "192348160", "process_out_blocks": "0", "process_user_time": 5.02097}
[0m17:21:34.692971 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:34.692803 after 6.07 seconds
[0m17:21:34.693506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143bc5b20>]}
[0m17:21:34.694001 [debug] [MainThread]: Flushing usage events
[0m17:21:35.267336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:09.588777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efeda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efed700>]}


============================== 17:27:09.597059 | b0fab347-54c5-4688-ab74-73125c36d947 ==============================
[0m17:27:09.597059 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:09.597989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:27:12.119292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0fab347-54c5-4688-ab74-73125c36d947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e983a70>]}
[0m17:27:12.179066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0fab347-54c5-4688-ab74-73125c36d947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139705f0>]}
[0m17:27:12.180677 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:27:12.347147 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:12.566893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m17:27:12.567536 [debug] [MainThread]: Partial parsing: added file: homework7://models/output/select.sql
[0m17:27:12.567950 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/volatility.sql
[0m17:27:12.568484 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:27:12.923278 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.select' (models/output/select.sql) depends on a source named 'ref.market_price' which was not found
[0m17:27:12.928175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4242203, "process_in_blocks": "0", "process_kernel_time": 1.067098, "process_mem_max_rss": "180142080", "process_out_blocks": "0", "process_user_time": 4.136104}
[0m17:27:12.928890 [debug] [MainThread]: Command `dbt run` failed at 17:27:12.928738 after 3.43 seconds
[0m17:27:12.929410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efeda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c0a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8cffe0>]}
[0m17:27:12.929874 [debug] [MainThread]: Flushing usage events
[0m17:27:13.269544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:38.650819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e03d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114065b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140657c0>]}


============================== 17:27:38.655868 | 2aa1eff0-c06f-40e4-bdc7-b43148ac7bc4 ==============================
[0m17:27:38.655868 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:38.656539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:27:39.730180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa1eff0-c06f-40e4-bdc7-b43148ac7bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140431a0>]}
[0m17:27:39.790211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa1eff0-c06f-40e4-bdc7-b43148ac7bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ee8d40>]}
[0m17:27:39.790974 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:27:39.927720 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:40.090286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:27:40.090777 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/volatility.sql
[0m17:27:40.091209 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:27:40.453890 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.volatility' (models/input/volatility.sql) depends on a source named 'ref.market_price' which was not found
[0m17:27:40.455950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8739976, "process_in_blocks": "0", "process_kernel_time": 0.696644, "process_mem_max_rss": "180326400", "process_out_blocks": "0", "process_user_time": 3.517618}
[0m17:27:40.456460 [debug] [MainThread]: Command `dbt run` failed at 17:27:40.456345 after 1.87 seconds
[0m17:27:40.456870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ff3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150429580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d33b00>]}
[0m17:27:40.457255 [debug] [MainThread]: Flushing usage events
[0m17:27:41.092944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:56.698347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ffcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf9910>]}


============================== 17:27:56.703961 | b3592141-ecbe-4a0c-b1e7-b53038f3e136 ==============================
[0m17:27:56.703961 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:56.704690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:27:57.907513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3592141-ecbe-4a0c-b1e7-b53038f3e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107519760>]}
[0m17:27:57.971239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3592141-ecbe-4a0c-b1e7-b53038f3e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142cf08c0>]}
[0m17:27:57.972014 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:27:58.128827 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:58.291766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:27:58.292277 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/volatility.sql
[0m17:27:58.292706 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:27:58.650446 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.homework7.session_summary' (models/output/session_summary.sql) depends on a node named 'volatality' which was not found
[0m17:27:58.652459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0261688, "process_in_blocks": "0", "process_kernel_time": 0.731172, "process_mem_max_rss": "181587968", "process_out_blocks": "0", "process_user_time": 3.749609}
[0m17:27:58.652964 [debug] [MainThread]: Command `dbt run` failed at 17:27:58.652848 after 2.03 seconds
[0m17:27:58.653372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142fbb170>]}
[0m17:27:58.653750 [debug] [MainThread]: Flushing usage events
[0m17:27:58.961614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:08.989826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6bbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a72d940>]}


============================== 17:29:08.996350 | c7c3782e-e542-4f85-8721-ec45ccc3fc60 ==============================
[0m17:29:08.996350 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:29:08.997052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:29:11.128450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465a80b0>]}
[0m17:29:11.188503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e78fa10>]}
[0m17:29:11.189940 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:29:11.343473 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:29:11.560928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:29:11.561547 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/volatility.sql
[0m17:29:11.562081 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:29:12.001943 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:29:12.014150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a93740>]}
[0m17:29:12.203745 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:29:12.205467 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:29:12.245142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147140ad0>]}
[0m17:29:12.245747 [info ] [MainThread]: Found 1 snapshot, 4 models, 3 data tests, 1 source, 474 macros
[0m17:29:12.246216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef827e0>]}
[0m17:29:12.248548 [info ] [MainThread]: 
[0m17:29:12.249016 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:29:12.249434 [info ] [MainThread]: 
[0m17:29:12.250065 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:29:12.251049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:29:12.432857 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:29:12.433235 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:29:12.433541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:13.114694 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.681 seconds
[0m17:29:13.118315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:29:13.119148 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:29:13.138399 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:29:13.142475 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:29:13.142863 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:29:13.143290 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:29:13.143800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:13.257207 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m17:29:13.634491 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb959d-0304-eb8b-0004-59ff001c861e
[0m17:29:13.635102 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:29:13.635764 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:29:13.636259 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:29:13.637094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147034d70>]}
[0m17:29:13.640953 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:29:13.641544 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:29:13.642105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:29:13.642594 [debug] [Thread-3 (]: Began running node model.homework7.volatility
[0m17:29:13.643163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:29:13.643723 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:29:13.644373 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:29:13.644879 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:29:13.655043 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:29:13.655552 [debug] [Thread-3 (]: Began compiling node model.homework7.volatility
[0m17:29:13.658629 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:29:13.661686 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:29:13.662867 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:29:13.664863 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:29:13.665737 [debug] [Thread-3 (]: Finished running node model.homework7.volatility
[0m17:29:13.666713 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:29:13.667363 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:29:13.668168 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:29:13.668655 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:29:13.675264 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:29:13.676078 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:29:13.713900 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:29:13.716293 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:29:13.716807 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,ma.symbol,ma.date,v.volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = gap.date and v.symbol = gap.symbol
        );
[0m17:29:13.717251 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:29:14.891342 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.174 seconds
[0m17:29:14.929512 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c3782e-e542-4f85-8721-ec45ccc3fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b719a0>]}
[0m17:29:14.930449 [info ] [Thread-5 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.26s]
[0m17:29:14.931266 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:29:14.932953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:14.933363 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:29:14.933774 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:29:15.072627 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:29:15.073221 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:29:15.164391 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:29:15.165048 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:29:15.165534 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:29:15.281566 [info ] [MainThread]: 
[0m17:29:15.282267 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m17:29:15.283366 [debug] [MainThread]: Command end result
[0m17:29:15.309484 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:29:15.311281 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:29:15.318204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:29:15.318596 [info ] [MainThread]: 
[0m17:29:15.319094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:15.319600 [info ] [MainThread]: 
[0m17:29:15.320065 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:29:15.324040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.405778, "process_in_blocks": "0", "process_kernel_time": 1.141673, "process_mem_max_rss": "194420736", "process_out_blocks": "0", "process_user_time": 4.996925}
[0m17:29:15.324716 [debug] [MainThread]: Command `dbt run` succeeded at 17:29:15.324577 after 6.41 seconds
[0m17:29:15.325199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6bbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a266510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fff20>]}
[0m17:29:15.325665 [debug] [MainThread]: Flushing usage events
[0m17:29:15.802393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:15.491021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d5f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111905cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111905940>]}


============================== 17:30:15.498832 | 7423849f-3fdf-456a-bd81-c5a9a3b12071 ==============================
[0m17:30:15.498832 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:30:15.499612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:30:16.920626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d73b8c0>]}
[0m17:30:16.981585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dce4f20>]}
[0m17:30:16.982336 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:30:17.122411 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:30:17.287838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:17.288436 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:30:17.722983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:30:17.734713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e37bb90>]}
[0m17:30:17.921641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:30:17.923527 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:30:17.938629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e225670>]}
[0m17:30:17.939142 [info ] [MainThread]: Found 1 snapshot, 4 models, 3 data tests, 1 source, 474 macros
[0m17:30:17.939551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e350b00>]}
[0m17:30:17.941600 [info ] [MainThread]: 
[0m17:30:17.942013 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:30:17.942384 [info ] [MainThread]: 
[0m17:30:17.942937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:17.943807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:30:18.005541 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:30:18.005918 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:30:18.006216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:18.614059 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.608 seconds
[0m17:30:18.617723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:30:18.618560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:30:18.637651 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:30:18.642540 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:30:18.642956 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:30:18.643376 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:30:18.644510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:18.721587 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb959e-0304-e858-0004-59ff001cb4b2
[0m17:30:18.722057 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:30:18.722548 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:30:18.722929 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:30:19.377974 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.733 seconds
[0m17:30:19.381529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3cf920>]}
[0m17:30:19.384733 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:30:19.385299 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:30:19.385837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:30:19.386318 [debug] [Thread-3 (]: Began running node model.homework7.volatility
[0m17:30:19.386863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:30:19.387378 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:30:19.388017 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:30:19.388519 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:30:19.395080 [debug] [Thread-3 (]: Began compiling node model.homework7.volatility
[0m17:30:19.399444 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:30:19.402521 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:30:19.405428 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:30:19.406706 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:30:19.407995 [debug] [Thread-3 (]: Finished running node model.homework7.volatility
[0m17:30:19.408878 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:30:19.409605 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:30:19.410417 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:30:19.411149 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:30:19.411621 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:30:19.419126 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:30:19.419943 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:30:19.456510 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:30:19.458388 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:30:19.458862 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.ma_10,gap.Gap,ma.symbol,ma.date,v.volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
        );
[0m17:30:19.459314 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:30:20.834556 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.375 seconds
[0m17:30:20.870716 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7423849f-3fdf-456a-bd81-c5a9a3b12071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f791790>]}
[0m17:30:20.871428 [info ] [Thread-5 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.46s]
[0m17:30:20.872131 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:30:20.873582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:20.873935 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:30:20.874285 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:30:20.994162 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:30:20.994823 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:30:21.198834 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:30:21.199491 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:30:21.199988 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:30:21.309175 [info ] [MainThread]: 
[0m17:30:21.309860 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m17:30:21.310975 [debug] [MainThread]: Command end result
[0m17:30:21.336714 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:30:21.338510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:30:21.345614 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:30:21.346016 [info ] [MainThread]: 
[0m17:30:21.346612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:21.347056 [info ] [MainThread]: 
[0m17:30:21.347502 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:30:21.350258 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9398546, "process_in_blocks": "0", "process_kernel_time": 1.001784, "process_mem_max_rss": "194416640", "process_out_blocks": "0", "process_user_time": 4.894569}
[0m17:30:21.350946 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:21.350804 after 5.94 seconds
[0m17:30:21.351439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111905ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111905cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dd7e270>]}
[0m17:30:21.351911 [debug] [MainThread]: Flushing usage events
[0m17:30:21.780620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:55.974790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fed3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112155c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121557c0>]}


============================== 17:30:55.980279 | 76172368-41aa-4c7d-b293-3e4e632c0529 ==============================
[0m17:30:55.980279 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:30:55.981013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:57.237524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116282c0>]}
[0m17:30:57.299067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fedeb0>]}
[0m17:30:57.299801 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:30:57.438945 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:30:57.617489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:57.618234 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:30:58.106382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:30:58.118524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e4e42c0>]}
[0m17:30:58.307217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:30:58.309071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:30:58.324257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eaf63f0>]}
[0m17:30:58.324799 [info ] [MainThread]: Found 1 snapshot, 4 models, 3 data tests, 1 source, 474 macros
[0m17:30:58.325216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e7083e0>]}
[0m17:30:58.327406 [info ] [MainThread]: 
[0m17:30:58.327870 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:30:58.328257 [info ] [MainThread]: 
[0m17:30:58.328818 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:58.329685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:30:58.393606 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:30:58.394095 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:30:58.394406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:58.891380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.497 seconds
[0m17:30:58.894975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:30:58.895813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:30:58.913493 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:30:58.918260 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:30:58.918641 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:30:58.919031 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:30:58.919521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:59.044012 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m17:30:59.365205 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb959e-0304-e849-0004-59ff001c95ca
[0m17:30:59.365822 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:30:59.366467 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:30:59.366917 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:30:59.367772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ed99970>]}
[0m17:30:59.370774 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:30:59.371332 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:30:59.371875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:30:59.372361 [debug] [Thread-3 (]: Began running node model.homework7.volatility
[0m17:30:59.372917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:30:59.373434 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:30:59.374067 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:30:59.374564 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:30:59.384806 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:30:59.385309 [debug] [Thread-3 (]: Began compiling node model.homework7.volatility
[0m17:30:59.388356 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:30:59.391423 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:30:59.392559 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:30:59.393837 [debug] [Thread-3 (]: Finished running node model.homework7.volatility
[0m17:30:59.394690 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:30:59.395532 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:30:59.396235 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:30:59.396910 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:30:59.397373 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:30:59.405003 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:30:59.405896 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:30:59.441783 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:30:59.443649 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:30:59.444121 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
        );
[0m17:30:59.444587 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:31:00.574536 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.130 seconds
[0m17:31:00.611132 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76172368-41aa-4c7d-b293-3e4e632c0529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffe9ac0>]}
[0m17:31:00.611882 [info ] [Thread-5 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.21s]
[0m17:31:00.612636 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:31:00.614217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:00.614587 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:31:00.614962 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:31:00.728290 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:31:00.728877 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:31:00.853840 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:31:00.854492 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:31:00.854984 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:31:00.959642 [info ] [MainThread]: 
[0m17:31:00.960342 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m17:31:00.961451 [debug] [MainThread]: Command end result
[0m17:31:00.987437 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:31:00.989188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:31:00.996140 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:31:00.996540 [info ] [MainThread]: 
[0m17:31:00.997119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:00.997537 [info ] [MainThread]: 
[0m17:31:00.997984 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:31:01.000821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0984726, "process_in_blocks": "0", "process_kernel_time": 0.839595, "process_mem_max_rss": "193773568", "process_out_blocks": "0", "process_user_time": 4.65356}
[0m17:31:01.001617 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:01.001421 after 5.10 seconds
[0m17:31:01.002133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a05400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a894c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112186570>]}
[0m17:31:01.002608 [debug] [MainThread]: Flushing usage events
[0m17:31:01.329127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:57.968190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae22210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d5910>]}


============================== 17:33:57.975621 | de250866-58b9-4c99-8274-3ce68bf8bef0 ==============================
[0m17:33:57.975621 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:33:57.976457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/homework7/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:33:59.187001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471a7bf0>]}
[0m17:33:59.246705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147aba420>]}
[0m17:33:59.247429 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:33:59.384323 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:33:59.550333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:33:59.551966 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/rolling_volatality.sql
[0m17:33:59.552524 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:33:59.987252 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:33:59.999067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148193980>]}
[0m17:34:00.185160 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:34:00.186927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:34:00.201875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1482470b0>]}
[0m17:34:00.202371 [info ] [MainThread]: Found 1 snapshot, 5 models, 3 data tests, 1 source, 474 macros
[0m17:34:00.202784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148267560>]}
[0m17:34:00.204862 [info ] [MainThread]: 
[0m17:34:00.205273 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:34:00.205641 [info ] [MainThread]: 
[0m17:34:00.206198 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:34:00.207055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:34:00.266182 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:34:00.266557 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:34:00.266855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:01.205997 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.939 seconds
[0m17:34:01.209655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:34:01.210487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:34:01.230245 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:34:01.234687 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:34:01.235092 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:34:01.235534 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:34:01.236764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:01.375467 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.139 seconds
[0m17:34:01.736959 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a2-0304-eb6a-0004-59ff001ca526
[0m17:34:01.737582 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:34:01.738222 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:34:01.738647 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:34:01.739427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148246e40>]}
[0m17:34:01.742282 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:34:01.742848 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:34:01.743373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:34:01.743848 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:34:01.744382 [debug] [Thread-4 (]: Began running node model.homework7.volatility
[0m17:34:01.744901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:34:01.745427 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:34:01.746579 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:34:01.747238 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:34:01.747762 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:34:01.758498 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:34:01.759016 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:34:01.759518 [debug] [Thread-4 (]: Began compiling node model.homework7.volatility
[0m17:34:01.762647 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:34:01.764838 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:34:01.767897 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:34:01.769148 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:34:01.770138 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:34:01.770897 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:34:01.772109 [debug] [Thread-4 (]: Finished running node model.homework7.volatility
[0m17:34:01.772906 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:34:01.773509 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:34:01.774225 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:34:01.774695 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:34:01.783398 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:34:01.784092 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:34:01.819337 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:34:01.821542 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:34:01.822015 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from source('raw','market_price')
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation;
[0m17:34:01.822460 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:34:02.284349 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb95a2-0304-e849-0004-59ff001c960a
[0m17:34:02.285163 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 11 unexpected '('.
syntax error line 27 at position 12 unexpected ''raw''.
syntax error line 27 at position 18 unexpected ''market_price''.
syntax error line 29 at position 0 unexpected 'select'.
[0m17:34:02.291934 [debug] [Thread-5 (]: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:34:02.294145 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de250866-58b9-4c99-8274-3ce68bf8bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae41910>]}
[0m17:34:02.294936 [error] [Thread-5 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.52s]
[0m17:34:02.295737 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:34:02.296435 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:34:02.298765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:02.299159 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:34:02.299553 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:34:02.565752 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:34:02.566433 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:34:02.797098 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:34:02.797643 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:34:02.798090 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:34:02.798564 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:34:03.013166 [info ] [MainThread]: 
[0m17:34:03.013872 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m17:34:03.014952 [debug] [MainThread]: Command end result
[0m17:34:03.041201 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:34:03.043108 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:34:03.049983 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:34:03.050376 [info ] [MainThread]: 
[0m17:34:03.050942 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:34:03.051357 [info ] [MainThread]: 
[0m17:34:03.051847 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:34:03.052289 [info ] [MainThread]: 
[0m17:34:03.052777 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:34:03.055846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.1691737, "process_in_blocks": "0", "process_kernel_time": 0.946255, "process_mem_max_rss": "195715072", "process_out_blocks": "0", "process_user_time": 4.792502}
[0m17:34:03.056494 [debug] [MainThread]: Command `dbt run` failed at 17:34:03.056352 after 5.17 seconds
[0m17:34:03.056966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1671a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b780800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1482ba750>]}
[0m17:34:03.057421 [debug] [MainThread]: Flushing usage events
[0m17:34:03.489789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:34.783457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce5970>]}


============================== 17:34:34.790703 | f6580335-efc4-41da-bf16-34168a74d278 ==============================
[0m17:34:34.790703 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:34:34.791442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:34:36.601749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccf7d10>]}
[0m17:34:36.663491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccf7d10>]}
[0m17:34:36.664777 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:34:36.839259 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:34:37.070889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:37.071609 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/rolling_volatality.sql
[0m17:34:37.370922 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:34:37.383298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465bade0>]}
[0m17:34:37.477901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:34:37.479704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:34:37.515993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146603440>]}
[0m17:34:37.516619 [info ] [MainThread]: Found 1 snapshot, 5 models, 3 data tests, 1 source, 474 macros
[0m17:34:37.517092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465bae70>]}
[0m17:34:37.519626 [info ] [MainThread]: 
[0m17:34:37.520118 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:34:37.520533 [info ] [MainThread]: 
[0m17:34:37.521196 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:34:37.522218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:34:37.694567 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:34:37.695222 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:34:37.695759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:38.238748 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.543 seconds
[0m17:34:38.242390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:34:38.243226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:34:38.257778 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:34:38.260305 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:34:38.260758 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:34:38.261196 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:34:38.261756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:38.397932 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m17:34:38.691343 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a2-0304-eb8b-0004-59ff001c86ce
[0m17:34:38.691983 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:34:38.692640 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:34:38.693158 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:34:38.694208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146399490>]}
[0m17:34:38.698245 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:34:38.698803 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:34:38.699311 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:34:38.699854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:34:38.700338 [debug] [Thread-4 (]: Began running node model.homework7.volatility
[0m17:34:38.700892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:34:38.701577 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:34:38.702102 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:34:38.702774 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:34:38.703282 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:34:38.703771 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:34:38.711697 [debug] [Thread-4 (]: Began compiling node model.homework7.volatility
[0m17:34:38.714629 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:34:38.717693 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:34:38.719695 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:34:38.722695 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:34:38.723925 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:34:38.725051 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:34:38.726004 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:34:38.726900 [debug] [Thread-4 (]: Finished running node model.homework7.volatility
[0m17:34:38.727671 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:34:38.728392 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:34:38.729123 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:34:38.729577 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:34:38.736981 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:34:38.737739 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:34:38.772270 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:34:38.774178 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:34:38.774576 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from source('raw','market_price')
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
        );
[0m17:34:38.774958 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:34:39.108005 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01bb95a2-0304-eb6a-0004-59ff001ca52a
[0m17:34:39.108690 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 11 unexpected '('.
syntax error line 27 at position 12 unexpected ''raw''.
syntax error line 27 at position 18 unexpected ''market_price''.
syntax error line 29 at position 0 unexpected 'select'.
[0m17:34:39.113746 [debug] [Thread-5 (]: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:34:39.116634 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6580335-efc4-41da-bf16-34168a74d278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466285f0>]}
[0m17:34:39.117920 [error] [Thread-5 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.39s]
[0m17:34:39.118916 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:34:39.119784 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:34:39.122463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:39.122886 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:34:39.123305 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:34:39.456045 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:34:39.456586 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:34:39.562342 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:34:39.562838 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:34:39.563193 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:34:39.563555 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:34:39.761607 [info ] [MainThread]: 
[0m17:34:39.762320 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m17:34:39.763415 [debug] [MainThread]: Command end result
[0m17:34:39.792082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:34:39.793894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:34:39.801989 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:34:39.802544 [info ] [MainThread]: 
[0m17:34:39.803075 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:34:39.803526 [info ] [MainThread]: 
[0m17:34:39.804055 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 11 unexpected '('.
  syntax error line 27 at position 12 unexpected ''raw''.
  syntax error line 27 at position 18 unexpected ''market_price''.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:34:39.804496 [info ] [MainThread]: 
[0m17:34:39.804961 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:34:39.809058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.106394, "process_in_blocks": "0", "process_kernel_time": 0.946746, "process_mem_max_rss": "192266240", "process_out_blocks": "0", "process_user_time": 4.546972}
[0m17:34:39.809705 [debug] [MainThread]: Command `dbt run` failed at 17:34:39.809557 after 5.11 seconds
[0m17:34:39.810224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099782c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e5fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c73620>]}
[0m17:34:39.810734 [debug] [MainThread]: Flushing usage events
[0m17:34:40.166431 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:41.264572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11352c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113571e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113571ac0>]}


============================== 17:35:41.271760 | b5277002-e659-4c06-9178-f1a2de7069e1 ==============================
[0m17:35:41.271760 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:35:41.272531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:35:42.542936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f800830>]}
[0m17:35:42.605427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e989b0>]}
[0m17:35:42.606183 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:35:42.744072 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:35:42.914391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:42.914984 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/rolling_volatality.sql
[0m17:35:43.198916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:35:43.210548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fe5ec00>]}
[0m17:35:43.304334 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:35:43.306001 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:35:43.318848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbb45c0>]}
[0m17:35:43.319288 [info ] [MainThread]: Found 1 snapshot, 5 models, 3 data tests, 1 source, 474 macros
[0m17:35:43.319628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f98de50>]}
[0m17:35:43.321439 [info ] [MainThread]: 
[0m17:35:43.321791 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:35:43.322095 [info ] [MainThread]: 
[0m17:35:43.322576 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:35:43.323326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:35:43.459933 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:35:43.460553 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:35:43.461072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:44.060869 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.600 seconds
[0m17:35:44.064523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:35:44.065389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:35:44.085091 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:35:44.089459 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:35:44.089872 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:35:44.090311 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:35:44.091526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:44.200637 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m17:35:44.424195 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a3-0304-eb8b-0004-59ff001c86da
[0m17:35:44.424805 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:35:44.425424 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:35:44.425862 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:35:44.426659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122ad250>]}
[0m17:35:44.429624 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:35:44.430206 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:35:44.430754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:35:44.431248 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:35:44.431788 [debug] [Thread-4 (]: Began running node model.homework7.volatility
[0m17:35:44.432301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:35:44.432827 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:35:44.433859 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:35:44.434512 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:35:44.435017 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:35:44.441903 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:35:44.445207 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:35:44.445701 [debug] [Thread-4 (]: Began compiling node model.homework7.volatility
[0m17:35:44.448793 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:35:44.451876 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:35:44.455067 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:35:44.456350 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:35:44.457487 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:35:44.459297 [debug] [Thread-4 (]: Finished running node model.homework7.volatility
[0m17:35:44.460366 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:35:44.461325 [debug] [Thread-5 (]: Began running node model.homework7.session_summary
[0m17:35:44.461950 [info ] [Thread-5 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:35:44.462657 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.session_summary'
[0m17:35:44.463120 [debug] [Thread-5 (]: Began compiling node model.homework7.session_summary
[0m17:35:44.470545 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:35:44.471312 [debug] [Thread-5 (]: Began executing node model.homework7.session_summary
[0m17:35:44.506930 [debug] [Thread-5 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:35:44.509380 [debug] [Thread-5 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:35:44.509920 [debug] [Thread-5 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
        );
[0m17:35:44.510385 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:35:45.681296 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.171 seconds
[0m17:35:45.718124 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5277002-e659-4c06-9178-f1a2de7069e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129d5b50>]}
[0m17:35:45.718859 [info ] [Thread-5 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.25s]
[0m17:35:45.719604 [debug] [Thread-5 (]: Finished running node model.homework7.session_summary
[0m17:35:45.721064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:45.721442 [debug] [MainThread]: Connection 'model.homework7.gap_analysis' was left open.
[0m17:35:45.721814 [debug] [MainThread]: On model.homework7.gap_analysis: Close
[0m17:35:45.836922 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:35:45.837621 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:35:45.989132 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:35:45.989782 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:35:45.990232 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:35:45.990718 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:35:46.109937 [info ] [MainThread]: 
[0m17:35:46.110581 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m17:35:46.111683 [debug] [MainThread]: Command end result
[0m17:35:46.137695 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:35:46.139370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:35:46.146539 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:35:46.146946 [info ] [MainThread]: 
[0m17:35:46.147447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:46.147861 [info ] [MainThread]: 
[0m17:35:46.148307 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:35:46.151075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.970337, "process_in_blocks": "0", "process_kernel_time": 0.859532, "process_mem_max_rss": "193744896", "process_out_blocks": "0", "process_user_time": 4.477894}
[0m17:35:46.151763 [debug] [MainThread]: Command `dbt run` succeeded at 17:35:46.151607 after 4.97 seconds
[0m17:35:46.152251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a14410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150279430>]}
[0m17:35:46.152734 [debug] [MainThread]: Flushing usage events
[0m17:35:46.471454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:00.024800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e61eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cd700>]}


============================== 17:39:00.029797 | d8e2b1ba-debd-4324-bf50-3aab4b26fb79 ==============================
[0m17:39:00.029797 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:39:00.030466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/homework7/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:39:01.131930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14596c830>]}
[0m17:39:01.198217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebd7f80>]}
[0m17:39:01.199021 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:39:01.354364 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:39:01.524514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:39:01.525024 [debug] [MainThread]: Partial parsing: added file: homework7://models/input/rsi.sql
[0m17:39:01.525473 [debug] [MainThread]: Partial parsing: updated file: homework7://models/output/session_summary.sql
[0m17:39:01.972607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:39:01.985168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14629a210>]}
[0m17:39:02.172220 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:39:02.174046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:39:02.189249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097431a0>]}
[0m17:39:02.189768 [info ] [MainThread]: Found 1 snapshot, 6 models, 3 data tests, 1 source, 474 macros
[0m17:39:02.190183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1463dd9a0>]}
[0m17:39:02.192322 [info ] [MainThread]: 
[0m17:39:02.192779 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:39:02.193226 [info ] [MainThread]: 
[0m17:39:02.193814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:39:02.194691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:39:02.257594 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:39:02.257968 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:39:02.258271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:03.062512 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.804 seconds
[0m17:39:03.066134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:39:03.066965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m17:39:03.086325 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:39:03.090511 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:39:03.090917 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:39:03.091340 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:39:03.092541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:03.213380 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.122 seconds
[0m17:39:03.718342 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a7-0304-eb90-0004-59ff001c7ff2
[0m17:39:03.718940 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:39:03.719576 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:39:03.720004 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:39:03.720798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14622dca0>]}
[0m17:39:03.723814 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:39:03.724376 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:39:03.724909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.gap_analysis)
[0m17:39:03.725400 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:39:03.725936 [debug] [Thread-4 (]: Began running node model.homework7.rsi
[0m17:39:03.726414 [debug] [Thread-5 (]: Began running node model.homework7.volatility
[0m17:39:03.727288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.moving_average)
[0m17:39:03.727818 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:39:03.728470 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:39:03.729090 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.rsi'
[0m17:39:03.729705 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:39:03.730189 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:39:03.739739 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:39:03.740247 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:39:03.740720 [debug] [Thread-4 (]: Began compiling node model.homework7.rsi
[0m17:39:03.741197 [debug] [Thread-5 (]: Began compiling node model.homework7.volatility
[0m17:39:03.744242 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:39:03.747369 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:39:03.751748 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.rsi"
[0m17:39:03.752517 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:39:03.755107 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:39:03.756510 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:39:03.757263 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:39:03.758007 [debug] [Thread-4 (]: Finished running node model.homework7.rsi
[0m17:39:03.759084 [debug] [Thread-5 (]: Finished running node model.homework7.volatility
[0m17:39:03.759759 [debug] [Thread-1 (]: Began running node model.homework7.session_summary
[0m17:39:03.760317 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:39:03.760819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.homework7.gap_analysis, now model.homework7.session_summary)
[0m17:39:03.761235 [debug] [Thread-1 (]: Began compiling node model.homework7.session_summary
[0m17:39:03.771357 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:39:03.772405 [debug] [Thread-1 (]: Began executing node model.homework7.session_summary
[0m17:39:03.812562 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:39:03.815878 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:39:03.816465 [debug] [Thread-1 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs;
[0m17:39:03.923607 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb95a7-0304-eb6a-0004-59ff001ca54e
[0m17:39:03.924375 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 62 at position 7 unexpected ';'.
[0m17:39:03.929750 [debug] [Thread-1 (]: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 7 unexpected ';'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:39:03.931846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8e2b1ba-debd-4324-bf50-3aab4b26fb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e318e0>]}
[0m17:39:03.932661 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.session_summary ................ [[31mERROR[0m in 0.17s]
[0m17:39:03.933488 [debug] [Thread-1 (]: Finished running node model.homework7.session_summary
[0m17:39:03.934215 [debug] [Thread-8 (]: Marking all children of 'model.homework7.session_summary' to be skipped because of status 'error'.  Reason: Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 7 unexpected ';'.
  compiled code at target/run/homework7/models/output/session_summary.sql.
[0m17:39:03.936606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:03.937021 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:39:03.937439 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:39:04.140495 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:39:04.141186 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:39:04.327130 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:39:04.327767 [debug] [MainThread]: Connection 'model.homework7.rsi' was properly closed.
[0m17:39:04.328218 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:39:04.328719 [info ] [MainThread]: 
[0m17:39:04.329275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m17:39:04.330345 [debug] [MainThread]: Command end result
[0m17:39:04.357222 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:39:04.358855 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:39:04.365543 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:39:04.365929 [info ] [MainThread]: 
[0m17:39:04.366399 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:39:04.366808 [info ] [MainThread]: 
[0m17:39:04.367290 [error] [MainThread]:   Database Error in model session_summary (models/output/session_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 7 unexpected ';'.
  compiled code at target/run/homework7/models/output/session_summary.sql
[0m17:39:04.367803 [info ] [MainThread]: 
[0m17:39:04.368299 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:39:04.371421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4150224, "process_in_blocks": "0", "process_kernel_time": 0.769356, "process_mem_max_rss": "193044480", "process_out_blocks": "0", "process_user_time": 4.268648}
[0m17:39:04.372060 [debug] [MainThread]: Command `dbt run` failed at 17:39:04.371927 after 4.42 seconds
[0m17:39:04.372532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14596ec30>]}
[0m17:39:04.372984 [debug] [MainThread]: Flushing usage events
[0m17:39:04.884305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:18.455347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134391c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11347dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11347d9d0>]}


============================== 17:39:18.460861 | d7158e11-d719-4e4d-895c-c62de4527b0e ==============================
[0m17:39:18.460861 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:39:18.461615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/homework7/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:39:19.701360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117650c50>]}
[0m17:39:19.772112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f5746e0>]}
[0m17:39:19.772963 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:39:19.959258 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:39:20.159014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:20.159667 [debug] [MainThread]: Partial parsing: updated file: homework7://models/input/rsi.sql
[0m17:39:20.459328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.homework7.example
[0m17:39:20.471865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fd2b080>]}
[0m17:39:20.563606 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:39:20.565295 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:39:20.578234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fd7a0f0>]}
[0m17:39:20.578667 [info ] [MainThread]: Found 1 snapshot, 6 models, 3 data tests, 1 source, 474 macros
[0m17:39:20.579006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fd1b320>]}
[0m17:39:20.580848 [info ] [MainThread]: 
[0m17:39:20.581202 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m17:39:20.581504 [info ] [MainThread]: 
[0m17:39:20.581990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:39:20.582733 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:39:20.720173 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:39:20.720791 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:39:20.721301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:21.264327 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.543 seconds
[0m17:39:21.267959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:39:21.268803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m17:39:21.288184 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:39:21.292323 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:39:21.292735 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m17:39:21.293183 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m17:39:21.294380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:21.378998 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb95a7-0304-eb6a-0004-59ff001ca552
[0m17:39:21.379449 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:39:21.379934 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:39:21.380296 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:39:21.713234 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.419 seconds
[0m17:39:21.716515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fa4bc50>]}
[0m17:39:21.719627 [debug] [Thread-1 (]: Began running node model.homework7.gap_analysis
[0m17:39:21.720185 [debug] [Thread-2 (]: Began running node model.homework7.moving_average
[0m17:39:21.720722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.homework7.gap_analysis)
[0m17:39:21.721214 [debug] [Thread-3 (]: Began running node model.homework7.rolling_volatality
[0m17:39:21.721747 [debug] [Thread-4 (]: Began running node model.homework7.rsi
[0m17:39:21.722226 [debug] [Thread-5 (]: Began running node model.homework7.volatility
[0m17:39:21.723162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.homework7.moving_average)
[0m17:39:21.723696 [debug] [Thread-1 (]: Began compiling node model.homework7.gap_analysis
[0m17:39:21.724345 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.homework7.rolling_volatality'
[0m17:39:21.724990 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.homework7.rsi'
[0m17:39:21.725628 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.homework7.volatility'
[0m17:39:21.726141 [debug] [Thread-2 (]: Began compiling node model.homework7.moving_average
[0m17:39:21.736059 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.gap_analysis"
[0m17:39:21.736527 [debug] [Thread-3 (]: Began compiling node model.homework7.rolling_volatality
[0m17:39:21.737011 [debug] [Thread-4 (]: Began compiling node model.homework7.rsi
[0m17:39:21.737491 [debug] [Thread-5 (]: Began compiling node model.homework7.volatility
[0m17:39:21.740546 [debug] [Thread-2 (]: Writing injected SQL for node "model.homework7.moving_average"
[0m17:39:21.743808 [debug] [Thread-3 (]: Writing injected SQL for node "model.homework7.rolling_volatality"
[0m17:39:21.747030 [debug] [Thread-4 (]: Writing injected SQL for node "model.homework7.rsi"
[0m17:39:21.747839 [debug] [Thread-1 (]: Finished running node model.homework7.gap_analysis
[0m17:39:21.750731 [debug] [Thread-5 (]: Writing injected SQL for node "model.homework7.volatility"
[0m17:39:21.752364 [debug] [Thread-4 (]: Finished running node model.homework7.rsi
[0m17:39:21.753120 [debug] [Thread-3 (]: Finished running node model.homework7.rolling_volatality
[0m17:39:21.753864 [debug] [Thread-2 (]: Finished running node model.homework7.moving_average
[0m17:39:21.754913 [debug] [Thread-5 (]: Finished running node model.homework7.volatility
[0m17:39:21.756167 [debug] [Thread-1 (]: Began running node model.homework7.session_summary
[0m17:39:21.756986 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:39:21.757625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.homework7.gap_analysis, now model.homework7.session_summary)
[0m17:39:21.758096 [debug] [Thread-1 (]: Began compiling node model.homework7.session_summary
[0m17:39:21.766605 [debug] [Thread-1 (]: Writing injected SQL for node "model.homework7.session_summary"
[0m17:39:21.767361 [debug] [Thread-1 (]: Began executing node model.homework7.session_summary
[0m17:39:21.804594 [debug] [Thread-1 (]: Writing runtime sql for node "model.homework7.session_summary"
[0m17:39:21.807401 [debug] [Thread-1 (]: Using snowflake connection "model.homework7.session_summary"
[0m17:39:21.807888 [debug] [Thread-1 (]: On model.homework7.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "homework7", "target_name": "dev", "node_id": "model.homework7.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m17:39:22.823635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.015 seconds
[0m17:39:22.860405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7158e11-d719-4e4d-895c-c62de4527b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cd8b0>]}
[0m17:39:22.861143 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.10s]
[0m17:39:22.861886 [debug] [Thread-1 (]: Finished running node model.homework7.session_summary
[0m17:39:22.863406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:22.863791 [debug] [MainThread]: Connection 'model.homework7.session_summary' was left open.
[0m17:39:22.864178 [debug] [MainThread]: On model.homework7.session_summary: Close
[0m17:39:22.985440 [debug] [MainThread]: Connection 'model.homework7.moving_average' was left open.
[0m17:39:22.986147 [debug] [MainThread]: On model.homework7.moving_average: Close
[0m17:39:23.105878 [debug] [MainThread]: Connection 'model.homework7.rolling_volatality' was properly closed.
[0m17:39:23.106497 [debug] [MainThread]: Connection 'model.homework7.rsi' was properly closed.
[0m17:39:23.106952 [debug] [MainThread]: Connection 'model.homework7.volatility' was properly closed.
[0m17:39:23.107467 [info ] [MainThread]: 
[0m17:39:23.108019 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m17:39:23.109116 [debug] [MainThread]: Command end result
[0m17:39:23.135186 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/homework7/target/manifest.json
[0m17:39:23.136903 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/homework7/target/semantic_manifest.json
[0m17:39:23.145580 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/homework7/target/run_results.json
[0m17:39:23.146173 [info ] [MainThread]: 
[0m17:39:23.147685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:39:23.148915 [info ] [MainThread]: 
[0m17:39:23.149856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:39:23.153587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.774929, "process_in_blocks": "0", "process_kernel_time": 0.822712, "process_mem_max_rss": "192315392", "process_out_blocks": "0", "process_user_time": 4.370629}
[0m17:39:23.154351 [debug] [MainThread]: Command `dbt run` succeeded at 17:39:23.154195 after 4.78 seconds
[0m17:39:23.154896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ba4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133142c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fd58f80>]}
[0m17:39:23.155404 [debug] [MainThread]: Flushing usage events
[0m17:39:23.467607 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:42.803071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec5b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b3ad0>]}


============================== 11:33:42.809906 | be0a454d-f42c-4237-ae74-d563b1d1a409 ==============================
[0m11:33:42.809906 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:33:42.810663 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'warn_error': 'None', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:33:42.814900 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'homework7'
[0m11:33:42.817715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.111121245, "process_in_blocks": "0", "process_kernel_time": 0.414683, "process_mem_max_rss": "103079936", "process_out_blocks": "0", "process_user_time": 1.970489}
[0m11:33:42.818485 [debug] [MainThread]: Command `dbt run` failed at 11:33:42.818322 after 0.11 seconds
[0m11:33:42.818984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecae000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecafad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecade50>]}
[0m11:33:42.819450 [debug] [MainThread]: Flushing usage events
[0m11:33:43.191537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:20.584907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f0f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114793fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114793d70>]}


============================== 11:34:20.590414 | 2ecb9113-7b83-4224-b180-8d28efcde8c4 ==============================
[0m11:34:20.590414 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:34:20.591156 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:34:20.595242 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'homework7'
[0m11:34:20.597871 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09020489, "process_in_blocks": "0", "process_kernel_time": 0.255686, "process_mem_max_rss": "102907904", "process_out_blocks": "0", "process_user_time": 1.592978}
[0m11:34:20.598616 [debug] [MainThread]: Command `dbt run` failed at 11:34:20.598454 after 0.09 seconds
[0m11:34:20.599117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114793f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114397c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11442faa0>]}
[0m11:34:20.599603 [debug] [MainThread]: Flushing usage events
[0m11:34:20.929659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:26.036558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fcb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b7c20>]}


============================== 11:35:26.041457 | 883c8297-110c-43bd-8586-763997de83cc ==============================
[0m11:35:26.041457 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:35:26.042127 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m11:35:26.045861 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'homework7'
[0m11:35:26.047501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.078052945, "process_in_blocks": "0", "process_kernel_time": 0.227375, "process_mem_max_rss": "102965248", "process_out_blocks": "0", "process_user_time": 1.50887}
[0m11:35:26.048134 [debug] [MainThread]: Command `dbt run` failed at 11:35:26.047996 after 0.08 seconds
[0m11:35:26.048563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a211f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961bb00>]}
[0m11:35:26.048994 [debug] [MainThread]: Flushing usage events
[0m11:35:26.415067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:01.334696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111faa870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112887fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112887c80>]}


============================== 11:37:01.339821 | 108d64ae-9b6a-465b-8f2b-fa9234d6a9d8 ==============================
[0m11:37:01.339821 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:37:01.340508 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'profiles_dir': '/Users/user/.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:37:03.610752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e112ea0>]}
[0m11:37:03.673027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e60ec90>]}
[0m11:37:03.674449 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:37:03.846247 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:37:03.995227 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m11:37:03.995739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ef06120>]}
[0m11:37:05.638821 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_dbt.example
[0m11:37:05.649835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f188920>]}
[0m11:37:05.742168 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:37:05.744501 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:37:05.783895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f10ba70>]}
[0m11:37:05.784585 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 data tests, 1 source, 474 macros
[0m11:37:05.785064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f3a88f0>]}
[0m11:37:05.787627 [info ] [MainThread]: 
[0m11:37:05.788108 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:37:05.788526 [info ] [MainThread]: 
[0m11:37:05.789175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:05.790192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m11:37:05.968268 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m11:37:05.968754 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m11:37:05.969155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:06.643124 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.674 seconds
[0m11:37:06.646911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m11:37:06.647763 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m11:37:06.663177 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m11:37:06.663636 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m11:37:06.664042 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m11:37:06.664483 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m11:37:06.664915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:06.829737 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.164 seconds
[0m11:37:07.042797 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb99dd-0304-eb8b-0004-59ff001d57a6
[0m11:37:07.043396 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:37:07.044028 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:37:07.044519 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:37:07.045447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f29a7b0>]}
[0m11:37:07.051608 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m11:37:07.052305 [debug] [Thread-2 (]: Began running node model.lab2_dbt.moving_average
[0m11:37:07.052940 [debug] [Thread-3 (]: Began running node model.lab2_dbt.rolling_volatality
[0m11:37:07.053599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m11:37:07.054164 [debug] [Thread-4 (]: Began running node model.lab2_dbt.rsi
[0m11:37:07.054697 [debug] [Thread-5 (]: Began running node model.lab2_dbt.volatility
[0m11:37:07.055221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.moving_average)
[0m11:37:07.055902 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.lab2_dbt.rolling_volatality'
[0m11:37:07.056416 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m11:37:07.057046 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.lab2_dbt.rsi'
[0m11:37:07.058143 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.lab2_dbt.volatility'
[0m11:37:07.058619 [debug] [Thread-2 (]: Began compiling node model.lab2_dbt.moving_average
[0m11:37:07.059132 [debug] [Thread-3 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m11:37:07.070163 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m11:37:07.070642 [debug] [Thread-4 (]: Began compiling node model.lab2_dbt.rsi
[0m11:37:07.071126 [debug] [Thread-5 (]: Began compiling node model.lab2_dbt.volatility
[0m11:37:07.074051 [debug] [Thread-2 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m11:37:07.077167 [debug] [Thread-3 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m11:37:07.080442 [debug] [Thread-4 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m11:37:07.083458 [debug] [Thread-5 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m11:37:07.085141 [debug] [Thread-2 (]: Finished running node model.lab2_dbt.moving_average
[0m11:37:07.086057 [debug] [Thread-4 (]: Finished running node model.lab2_dbt.rsi
[0m11:37:07.086894 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m11:37:07.087761 [debug] [Thread-5 (]: Finished running node model.lab2_dbt.volatility
[0m11:37:07.088465 [debug] [Thread-3 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m11:37:07.089420 [debug] [Thread-2 (]: Began running node model.lab2_dbt.session_summary
[0m11:37:07.090075 [info ] [Thread-2 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m11:37:07.090762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.session_summary)
[0m11:37:07.091235 [debug] [Thread-2 (]: Began compiling node model.lab2_dbt.session_summary
[0m11:37:07.099672 [debug] [Thread-2 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m11:37:07.100549 [debug] [Thread-2 (]: Began executing node model.lab2_dbt.session_summary
[0m11:37:07.135420 [debug] [Thread-2 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m11:37:07.139162 [debug] [Thread-2 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m11:37:07.139700 [debug] [Thread-2 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m11:37:09.191007 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.051 seconds
[0m11:37:09.229213 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '108d64ae-9b6a-465b-8f2b-fa9234d6a9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f73e0>]}
[0m11:37:09.230036 [info ] [Thread-2 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.14s]
[0m11:37:09.230810 [debug] [Thread-2 (]: Finished running node model.lab2_dbt.session_summary
[0m11:37:09.232371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:09.232762 [debug] [MainThread]: Connection 'model.lab2_dbt.gap_analysis' was left open.
[0m11:37:09.233155 [debug] [MainThread]: On model.lab2_dbt.gap_analysis: Close
[0m11:37:09.341246 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was left open.
[0m11:37:09.341943 [debug] [MainThread]: On model.lab2_dbt.session_summary: Close
[0m11:37:09.461798 [debug] [MainThread]: Connection 'model.lab2_dbt.rolling_volatality' was properly closed.
[0m11:37:09.462444 [debug] [MainThread]: Connection 'model.lab2_dbt.rsi' was properly closed.
[0m11:37:09.462898 [debug] [MainThread]: Connection 'model.lab2_dbt.volatility' was properly closed.
[0m11:37:09.463413 [info ] [MainThread]: 
[0m11:37:09.463954 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m11:37:09.465225 [debug] [MainThread]: Command end result
[0m11:37:09.494016 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:37:09.495881 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:37:09.504422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/airflow_setup/lab2_dbt/target/run_results.json
[0m11:37:09.504921 [info ] [MainThread]: 
[0m11:37:09.505468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:09.505896 [info ] [MainThread]: 
[0m11:37:09.506352 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:37:09.509083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.245608, "process_in_blocks": "0", "process_kernel_time": 1.012327, "process_mem_max_rss": "198705152", "process_out_blocks": "0", "process_user_time": 5.642897}
[0m11:37:09.509779 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:09.509635 after 8.25 seconds
[0m11:37:09.510282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1e99d0>]}
[0m11:37:09.510763 [debug] [MainThread]: Flushing usage events
[0m11:37:09.857965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:09.163879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1aee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db78500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db7bcb0>]}


============================== 11:45:09.172065 | 3e01dc4d-808b-4d2b-9661-b34a3001300c ==============================
[0m11:45:09.172065 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:45:09.172887 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/Users/user/.dbt', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m11:45:11.949292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a0edeb0>]}
[0m11:45:12.015896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c09f140>]}
[0m11:45:12.018618 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:45:12.222630 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:45:12.479273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:45:12.480037 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models/output/schema.yml
[0m11:45:12.817230 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_dbt.example
[0m11:45:12.832688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aff0860>]}
[0m11:45:12.937736 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:45:12.939918 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:45:13.069579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14adde8a0>]}
[0m11:45:13.070408 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 474 macros
[0m11:45:13.070965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14afddd30>]}
[0m11:45:13.073799 [info ] [MainThread]: 
[0m11:45:13.074335 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:45:13.074811 [info ] [MainThread]: 
[0m11:45:13.075527 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:45:13.076629 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m11:45:13.210823 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m11:45:13.211308 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m11:45:13.211705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:13.853852 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.642 seconds
[0m11:45:13.856870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m11:45:13.857621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_snapshot'
[0m11:45:13.877499 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m11:45:13.883285 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m11:45:13.883910 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m11:45:13.885195 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m11:45:13.885631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:14.046612 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.162 seconds
[0m11:45:14.300527 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb99e5-0304-efe8-0004-59ff001d77ea
[0m11:45:14.301074 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:45:14.301637 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:45:14.302070 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:45:14.302905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14addeb10>]}
[0m11:45:14.306701 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m11:45:14.307270 [debug] [Thread-2 (]: Began running node model.lab2_dbt.moving_average
[0m11:45:14.307830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m11:45:14.308330 [debug] [Thread-3 (]: Began running node model.lab2_dbt.rolling_volatality
[0m11:45:14.308860 [debug] [Thread-4 (]: Began running node model.lab2_dbt.rsi
[0m11:45:14.309376 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.moving_average)
[0m11:45:14.309857 [debug] [Thread-5 (]: Began running node model.lab2_dbt.volatility
[0m11:45:14.310833 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m11:45:14.311500 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.lab2_dbt.rolling_volatality'
[0m11:45:14.312141 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.lab2_dbt.rsi'
[0m11:45:14.312660 [debug] [Thread-2 (]: Began compiling node model.lab2_dbt.moving_average
[0m11:45:14.313304 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.lab2_dbt.volatility'
[0m11:45:14.324962 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m11:45:14.325540 [debug] [Thread-3 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m11:45:14.326029 [debug] [Thread-4 (]: Began compiling node model.lab2_dbt.rsi
[0m11:45:14.329078 [debug] [Thread-2 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m11:45:14.329641 [debug] [Thread-5 (]: Began compiling node model.lab2_dbt.volatility
[0m11:45:14.333689 [debug] [Thread-3 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m11:45:14.337186 [debug] [Thread-4 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m11:45:14.338218 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m11:45:14.341325 [debug] [Thread-5 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m11:45:14.342333 [debug] [Thread-2 (]: Finished running node model.lab2_dbt.moving_average
[0m11:45:14.343682 [debug] [Thread-4 (]: Finished running node model.lab2_dbt.rsi
[0m11:45:14.344619 [debug] [Thread-3 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m11:45:14.345588 [debug] [Thread-5 (]: Finished running node model.lab2_dbt.volatility
[0m11:45:14.346434 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m11:45:14.347081 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m11:45:14.347780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.session_summary)
[0m11:45:14.348347 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m11:45:14.358327 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m11:45:14.359283 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m11:45:14.401033 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m11:45:14.404628 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m11:45:14.405255 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m11:45:15.283402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.877 seconds
[0m11:45:15.323300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e01dc4d-808b-4d2b-9661-b34a3001300c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ff7a0>]}
[0m11:45:15.324277 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 0.97s]
[0m11:45:15.325100 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m11:45:15.326739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:15.327148 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was left open.
[0m11:45:15.327563 [debug] [MainThread]: On model.lab2_dbt.session_summary: Close
[0m11:45:15.444200 [debug] [MainThread]: Connection 'model.lab2_dbt.moving_average' was left open.
[0m11:45:15.444902 [debug] [MainThread]: On model.lab2_dbt.moving_average: Close
[0m11:45:15.553965 [debug] [MainThread]: Connection 'model.lab2_dbt.rolling_volatality' was properly closed.
[0m11:45:15.554455 [debug] [MainThread]: Connection 'model.lab2_dbt.rsi' was properly closed.
[0m11:45:15.554840 [debug] [MainThread]: Connection 'model.lab2_dbt.volatility' was properly closed.
[0m11:45:15.555277 [info ] [MainThread]: 
[0m11:45:15.555742 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m11:45:15.556679 [debug] [MainThread]: Command end result
[0m11:45:15.586265 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:45:15.588220 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:45:15.596214 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/airflow_setup/lab2_dbt/target/run_results.json
[0m11:45:15.596801 [info ] [MainThread]: 
[0m11:45:15.597348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:15.597788 [info ] [MainThread]: 
[0m11:45:15.598358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:45:15.602861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5453095, "process_in_blocks": "0", "process_kernel_time": 1.345645, "process_mem_max_rss": "191795200", "process_out_blocks": "0", "process_user_time": 5.289168}
[0m11:45:15.603582 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:15.603438 after 6.55 seconds
[0m11:45:15.604083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4d2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4d2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4d2ed0>]}
[0m11:45:15.604559 [debug] [MainThread]: Flushing usage events
[0m11:45:15.958631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:37.672703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108929100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ac2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0afb00>]}


============================== 11:46:37.678409 | 08f1b76e-9f68-4ea3-a71e-def843152987 ==============================
[0m11:46:37.678409 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:46:37.679392 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'profiles_dir': '/Users/user/.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:46:39.042841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a607a0>]}
[0m11:46:39.118995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110096b40>]}
[0m11:46:39.119844 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:46:39.297051 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:46:39.452740 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:46:39.453296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a751a60>]}
[0m11:46:41.135802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147565d60>]}
[0m11:46:41.232347 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:46:41.234786 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:46:41.251526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473d0e60>]}
[0m11:46:41.252107 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 474 macros
[0m11:46:41.252538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14727a8a0>]}
[0m11:46:41.254916 [info ] [MainThread]: 
[0m11:46:41.255467 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m11:46:41.255860 [info ] [MainThread]: 
[0m11:46:41.256457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:41.257385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m11:46:41.337432 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m11:46:41.337903 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m11:46:41.338298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:41.967928 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.629 seconds
[0m11:46:41.971130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m11:46:41.971841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1_analytics'
[0m11:46:41.991393 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m11:46:41.996120 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m11:46:41.996536 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000;
[0m11:46:41.996977 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000;
[0m11:46:41.997922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:42.084661 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb99e6-0304-eec0-0004-59ff001d845a
[0m11:46:42.085138 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:46:42.085628 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:46:42.086000 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:46:42.381381 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.383 seconds
[0m11:46:42.385608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147728620>]}
[0m11:46:42.388772 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m11:46:42.389346 [debug] [Thread-2 (]: Began running node model.lab2_dbt.moving_average
[0m11:46:42.389894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now model.lab2_dbt.gap_analysis)
[0m11:46:42.390385 [debug] [Thread-3 (]: Began running node model.lab2_dbt.rolling_volatality
[0m11:46:42.391000 [debug] [Thread-4 (]: Began running node model.lab2_dbt.rsi
[0m11:46:42.391548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.moving_average)
[0m11:46:42.392442 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m11:46:42.393063 [debug] [Thread-5 (]: Began running node model.lab2_dbt.volatility
[0m11:46:42.393725 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.lab2_dbt.rolling_volatality'
[0m11:46:42.394374 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.lab2_dbt.rsi'
[0m11:46:42.394886 [debug] [Thread-2 (]: Began compiling node model.lab2_dbt.moving_average
[0m11:46:42.405128 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m11:46:42.405863 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.lab2_dbt.volatility'
[0m11:46:42.406372 [debug] [Thread-3 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m11:46:42.406844 [debug] [Thread-4 (]: Began compiling node model.lab2_dbt.rsi
[0m11:46:42.411159 [debug] [Thread-2 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m11:46:42.411833 [debug] [Thread-5 (]: Began compiling node model.lab2_dbt.volatility
[0m11:46:42.415022 [debug] [Thread-3 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m11:46:42.419100 [debug] [Thread-4 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m11:46:42.420185 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m11:46:42.423359 [debug] [Thread-5 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m11:46:42.424515 [debug] [Thread-2 (]: Finished running node model.lab2_dbt.moving_average
[0m11:46:42.425800 [debug] [Thread-3 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m11:46:42.426567 [debug] [Thread-4 (]: Finished running node model.lab2_dbt.rsi
[0m11:46:42.427429 [debug] [Thread-5 (]: Finished running node model.lab2_dbt.volatility
[0m11:46:42.428293 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m11:46:42.429035 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m11:46:42.429610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.session_summary)
[0m11:46:42.430081 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m11:46:42.439820 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m11:46:42.440735 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m11:46:42.479926 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m11:46:42.483680 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m11:46:42.484562 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m11:46:43.650564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.165 seconds
[0m11:46:43.688859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f1b76e-9f68-4ea3-a71e-def843152987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c37da0>]}
[0m11:46:43.689703 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 1.26s]
[0m11:46:43.690499 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m11:46:43.692108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:43.692576 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was left open.
[0m11:46:43.693003 [debug] [MainThread]: On model.lab2_dbt.session_summary: Close
[0m11:46:43.835555 [debug] [MainThread]: Connection 'model.lab2_dbt.moving_average' was left open.
[0m11:46:43.836085 [debug] [MainThread]: On model.lab2_dbt.moving_average: Close
[0m11:46:43.949096 [debug] [MainThread]: Connection 'model.lab2_dbt.rolling_volatality' was properly closed.
[0m11:46:43.950140 [debug] [MainThread]: Connection 'model.lab2_dbt.rsi' was properly closed.
[0m11:46:43.951367 [debug] [MainThread]: Connection 'model.lab2_dbt.volatility' was properly closed.
[0m11:46:43.952095 [info ] [MainThread]: 
[0m11:46:43.952671 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m11:46:43.953724 [debug] [MainThread]: Command end result
[0m11:46:43.981561 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/manifest.json
[0m11:46:43.984274 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/airflow_setup/lab2_dbt/target/semantic_manifest.json
[0m11:46:43.992289 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/airflow_setup/lab2_dbt/target/run_results.json
[0m11:46:43.992778 [info ] [MainThread]: 
[0m11:46:43.993335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:43.993777 [info ] [MainThread]: 
[0m11:46:43.994248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:46:43.996883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.411817, "process_in_blocks": "0", "process_kernel_time": 0.961242, "process_mem_max_rss": "196149248", "process_out_blocks": "0", "process_user_time": 5.99042}
[0m11:46:43.997560 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:43.997409 after 6.41 seconds
[0m11:46:43.998081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108929100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473fef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a68b830>]}
[0m11:46:43.998581 [debug] [MainThread]: Flushing usage events
[0m11:46:44.365819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:50:11.689915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7c08f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35bd70>]}


============================== 11:50:11.697734 | 1a8ff2df-a50f-4ae9-b2db-9d0c3ad1d46c ==============================
[0m11:50:11.697734 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:50:11.698660 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/user/Desktop/airflow_setup/lab2_dbt', 'use_colors': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:50:11.705906 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m11:50:11.708519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.102116704, "process_in_blocks": "0", "process_kernel_time": 0.434719, "process_mem_max_rss": "103636992", "process_out_blocks": "0", "process_user_time": 1.941819}
[0m11:50:11.709344 [debug] [MainThread]: Command `dbt run` failed at 11:50:11.709183 after 0.10 seconds
[0m11:50:11.709860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd2ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc02660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe71c10>]}
[0m11:50:11.710378 [debug] [MainThread]: Flushing usage events
[0m11:50:12.355263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:02.536456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61ff7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61dc6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61fae8a0>]}


============================== 17:44:02.548740 | 07cc8b61-51cb-4dcd-b063-43f92d36f7ba ==============================
[0m17:44:02.548740 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:44:02.549897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m17:44:03.905039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e39fc9dc0>]}
[0m17:44:03.967249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4f1a4350>]}
[0m17:44:03.968432 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:44:04.124474 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:44:04.277968 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:44:04.278678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e625893a0>]}
[0m17:44:05.833045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3a25d340>]}
[0m17:44:06.061147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e381877a0>]}
[0m17:44:06.061955 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:44:06.062631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e39b3cf20>]}
[0m17:44:06.065019 [info ] [MainThread]: 
[0m17:44:06.065869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:44:06.067163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:44:06.087177 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:44:06.087928 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:44:06.088512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:06.863973 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.775 seconds
[0m17:44:06.867178 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:44:07.199818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:44:07.216808 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:44:07.217627 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:44:07.218344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:08.107776 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9f48-0304-eb6a-0004-59ff001dae76
[0m17:44:08.108701 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:44:08.109625 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:44:08.110329 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:44:08.111090 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:44:08.466128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:44:08.470770 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:44:08.471670 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:44:08.472596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:09.373497 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.901 seconds
[0m17:44:09.377139 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:44:09.706238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3815adb0>]}
[0m17:44:09.707409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:09.708237 [info ] [MainThread]: 
[0m17:44:09.720725 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m17:44:09.721645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m17:44:09.722411 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m17:44:09.735149 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m17:44:09.739893 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m17:44:09.741220 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m17:44:09.742023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m17:44:09.742814 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m17:44:09.746989 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m17:44:09.749837 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m17:44:09.750791 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m17:44:09.751621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m17:44:09.752259 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m17:44:09.756250 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m17:44:09.759919 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m17:44:09.761200 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m17:44:09.762699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m17:44:09.763589 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m17:44:09.768252 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m17:44:09.771351 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m17:44:09.772302 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m17:44:09.773148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m17:44:09.773921 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m17:44:09.778421 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m17:44:09.780804 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m17:44:09.782664 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m17:44:09.783532 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:44:09.784315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m17:44:09.784949 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m17:44:09.797685 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m17:44:09.801516 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m17:44:09.850384 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m17:44:09.857041 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m17:44:09.858198 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m17:44:09.859202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:12.116912 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.258 seconds
[0m17:44:12.159724 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m17:44:12.653285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07cc8b61-51cb-4dcd-b063-43f92d36f7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e6258a660>]}
[0m17:44:12.654485 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.87s]
[0m17:44:12.655647 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m17:44:12.658521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:12.659201 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m17:44:12.659932 [info ] [MainThread]: 
[0m17:44:12.660778 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.59 seconds (6.59s).
[0m17:44:12.662227 [debug] [MainThread]: Command end result
[0m17:44:12.730215 [info ] [MainThread]: 
[0m17:44:12.731318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:12.732351 [info ] [MainThread]: 
[0m17:44:12.733235 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:12.734793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.32809, "process_user_time": 6.634786, "process_kernel_time": 1.258536, "process_mem_max_rss": "222104", "process_in_blocks": "2448", "process_out_blocks": "5097"}
[0m17:44:12.735880 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:12.735711 after 10.33 seconds
[0m17:44:12.736706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61d38c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61ff7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61ff6ed0>]}
[0m17:44:12.737431 [debug] [MainThread]: Flushing usage events
[0m17:44:44.927480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd552718b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd549e0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5436b7a0>]}


============================== 17:44:44.935747 | 6f4ccac8-4252-4655-af16-f26a9ccd64a0 ==============================
[0m17:44:44.935747 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:44:44.936808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:44:46.120957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd54a7e570>]}
[0m17:44:46.191959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2cf38b00>]}
[0m17:44:46.193186 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:44:46.325300 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:44:46.498827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:46.499488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:46.549261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd27bd0f80>]}
[0m17:44:46.686168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd277557c0>]}
[0m17:44:46.686875 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:44:46.687518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2742a990>]}
[0m17:44:46.689830 [info ] [MainThread]: 
[0m17:44:46.690868 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:44:46.692415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:44:46.714622 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:44:46.715331 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:44:46.715935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:47.831940 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.116 seconds
[0m17:44:47.834863 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:44:48.174111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:44:48.189156 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:44:48.190154 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:44:48.191417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:48.899660 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb9f48-0304-eb6a-0004-59ff001dae7e
[0m17:44:48.900592 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:44:48.901548 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:44:48.902305 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:44:48.903115 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:44:49.227516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:44:49.232563 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:44:49.233574 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:44:49.234475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:49.951037 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.717 seconds
[0m17:44:49.954341 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:44:50.281723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd269bd010>]}
[0m17:44:50.282935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:50.283823 [info ] [MainThread]: 
[0m17:44:50.296472 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m17:44:50.297519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m17:44:50.298308 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m17:44:50.312900 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m17:44:50.315871 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m17:44:50.316807 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m17:44:50.317808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m17:44:50.318556 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m17:44:50.322509 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m17:44:50.325856 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m17:44:50.327734 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m17:44:50.328806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m17:44:50.329730 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m17:44:50.334444 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m17:44:50.337720 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m17:44:50.338587 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m17:44:50.339362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m17:44:50.340210 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m17:44:50.344695 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m17:44:50.347657 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m17:44:50.348490 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m17:44:50.349281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m17:44:50.349964 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m17:44:50.353851 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m17:44:50.356244 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m17:44:50.358231 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m17:44:50.359692 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:44:50.360921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m17:44:50.361811 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m17:44:50.374943 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m17:44:50.377279 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m17:44:50.422317 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m17:44:50.428347 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m17:44:50.429561 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m17:44:50.430678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:52.651625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.221 seconds
[0m17:44:52.694974 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m17:44:52.834425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f4ccac8-4252-4655-af16-f26a9ccd64a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd278166c0>]}
[0m17:44:52.835726 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.47s]
[0m17:44:52.836940 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m17:44:52.839651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:52.840398 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m17:44:52.841386 [info ] [MainThread]: 
[0m17:44:52.842192 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m17:44:52.843572 [debug] [MainThread]: Command end result
[0m17:44:52.910448 [info ] [MainThread]: 
[0m17:44:52.911237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:52.911888 [info ] [MainThread]: 
[0m17:44:52.912578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:52.913871 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.06056, "process_user_time": 5.344937, "process_kernel_time": 0.717456, "process_mem_max_rss": "218056", "process_out_blocks": "1886", "process_in_blocks": "0"}
[0m17:44:52.914664 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:52.914519 after 8.06 seconds
[0m17:44:52.915262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5325fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd542259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd27718320>]}
[0m17:44:52.915856 [debug] [MainThread]: Flushing usage events
[0m17:44:57.404521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9914711f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9933f2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe991472b10>]}


============================== 17:44:57.414662 | 1f96246b-70de-472d-9fe8-99e01d6ba371 ==============================
[0m17:44:57.414662 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:44:57.415897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:58.730498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9697dd460>]}
[0m17:44:58.804187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96a43b200>]}
[0m17:44:58.805388 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:44:58.942611 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:44:59.091906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:59.092539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:59.139807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe991060da0>]}
[0m17:44:59.278210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9691a3f50>]}
[0m17:44:59.278937 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:44:59.279614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f96246b-70de-472d-9fe8-99e01d6ba371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe969f3ab70>]}
[0m17:44:59.281703 [info ] [MainThread]: 
[0m17:44:59.282340 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:44:59.284744 [debug] [MainThread]: Command end result
[0m17:44:59.333677 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0087087, "process_user_time": 4.457289, "process_kernel_time": 0.794987, "process_mem_max_rss": "212016", "process_out_blocks": "1831", "process_in_blocks": "0"}
[0m17:44:59.334335 [debug] [MainThread]: Command `dbt test` succeeded at 17:44:59.334225 after 2.01 seconds
[0m17:44:59.334809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe992036900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9694e06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9694ef3e0>]}
[0m17:44:59.335271 [debug] [MainThread]: Flushing usage events
[0m17:45:04.082198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89aa803e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89acb62600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89aa8028a0>]}


============================== 17:45:04.089598 | 137ddd88-2a55-48ec-bff8-4dd0bbb4de0b ==============================
[0m17:45:04.089598 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:45:04.090445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:05.287423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a9e50830>]}
[0m17:45:05.358694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89aa59e3c0>]}
[0m17:45:05.359956 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:45:05.497702 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:45:05.665305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:05.665988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:05.719442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a217af90>]}
[0m17:45:05.881315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897e5d7890>]}
[0m17:45:05.882104 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:45:05.882730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897e699dc0>]}
[0m17:45:05.885003 [info ] [MainThread]: 
[0m17:45:05.885895 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:45:05.887295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:45:05.910068 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:45:05.910884 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:45:05.911591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:07.210882 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.299 seconds
[0m17:45:07.213754 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:45:07.574803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now create_user_db_lobster1_snapshot)
[0m17:45:07.575962 [debug] [ThreadPool]: Creating schema "database: "user_db_lobster1"
schema: "snapshot"
"
[0m17:45:07.582489 [debug] [ThreadPool]: Using snowflake connection "create_user_db_lobster1_snapshot"
[0m17:45:07.583177 [debug] [ThreadPool]: On create_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "create_user_db_lobster1_snapshot"} */
create schema if not exists user_db_lobster1.snapshot
[0m17:45:07.583789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:08.265330 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.681 seconds
[0m17:45:08.267345 [debug] [ThreadPool]: On create_user_db_lobster1_snapshot: Close
[0m17:45:08.627685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:45:08.643413 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:45:08.644278 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:45:08.644964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:09.319559 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.675 seconds
[0m17:45:09.322382 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:45:09.586205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m17:45:09.591127 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:45:09.591993 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:45:09.592772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:10.162433 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.570 seconds
[0m17:45:10.164906 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:45:10.320487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897e433ec0>]}
[0m17:45:10.321530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:10.322445 [info ] [MainThread]: 
[0m17:45:10.335138 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:45:10.336174 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m17:45:10.337089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m17:45:10.337848 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m17:45:10.351747 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m17:45:10.475659 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m17:45:10.476820 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m17:45:10.477596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:11.109750 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb9f49-0304-f117-0004-59ff001e1282
[0m17:45:11.110680 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 26
invalid identifier 'SESSIONID'
[0m17:45:11.111757 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m17:45:11.275299 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SESSIONID'
[0m17:45:11.278054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '137ddd88-2a55-48ec-bff8-4dd0bbb4de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897db4e4e0>]}
[0m17:45:11.279442 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 0.94s]
[0m17:45:11.280855 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:45:11.284856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:11.285552 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m17:45:11.286330 [info ] [MainThread]: 
[0m17:45:11.287154 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.40 seconds (5.40s).
[0m17:45:11.288499 [debug] [MainThread]: Command end result
[0m17:45:11.351742 [info ] [MainThread]: 
[0m17:45:11.352549 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:45:11.353326 [info ] [MainThread]: 
[0m17:45:11.354176 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SESSIONID'
[0m17:45:11.354858 [info ] [MainThread]: 
[0m17:45:11.355475 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:45:11.356767 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.348532, "process_user_time": 5.433128, "process_kernel_time": 0.845672, "process_mem_max_rss": "218492", "process_out_blocks": "1855", "command_success": false, "process_in_blocks": "0"}
[0m17:45:11.357698 [debug] [MainThread]: Command `dbt snapshot` failed at 17:45:11.357545 after 7.35 seconds
[0m17:45:11.358442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89aa8ab3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a217af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897e9c3080>]}
[0m17:45:11.359110 [debug] [MainThread]: Flushing usage events
[0m17:54:07.222026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eba83e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eb4b4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8eb4b7fb0>]}


============================== 17:54:07.229682 | 5e6b9f05-1eea-4896-9c64-e2fdae195843 ==============================
[0m17:54:07.229682 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:54:07.230582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:08.279919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c2066990>]}
[0m17:54:08.339277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c23158e0>]}
[0m17:54:08.340291 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:54:08.465400 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:54:08.638691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:08.639534 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m17:54:08.992067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c1bb0ec0>]}
[0m17:54:09.208960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c1d37350>]}
[0m17:54:09.209953 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:54:09.211250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c1f77da0>]}
[0m17:54:09.214366 [info ] [MainThread]: 
[0m17:54:09.215922 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:09.217894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:54:09.240166 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:54:09.240982 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:54:09.241653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:10.323430 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.082 seconds
[0m17:54:10.326001 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:54:10.658341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:54:10.672749 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:54:10.673552 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:54:10.674254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:11.388060 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.714 seconds
[0m17:54:11.391263 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:54:11.710008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:54:11.714703 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:54:11.715668 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:54:11.716450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:12.587121 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.870 seconds
[0m17:54:12.590681 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:54:12.883155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e5dcd460>]}
[0m17:54:12.884703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:12.886200 [info ] [MainThread]: 
[0m17:54:12.898639 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:54:12.899676 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m17:54:12.900698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now snapshot.lab2_dbt.snapshot_session_summary)
[0m17:54:12.901507 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m17:54:12.915259 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m17:54:13.054729 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m17:54:13.055995 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m17:54:13.056952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:13.784992 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb9f52-0304-f117-0004-59ff001e12ce
[0m17:54:13.786111 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'TS'
[0m17:54:13.787374 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m17:54:14.151005 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m17:54:14.153704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6b9f05-1eea-4896-9c64-e2fdae195843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ea4f9940>]}
[0m17:54:14.155500 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 1.25s]
[0m17:54:14.157043 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:54:14.160834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:14.161619 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m17:54:14.162373 [info ] [MainThread]: 
[0m17:54:14.163581 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m17:54:14.164949 [debug] [MainThread]: Command end result
[0m17:54:14.229815 [info ] [MainThread]: 
[0m17:54:14.231330 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:14.232374 [info ] [MainThread]: 
[0m17:54:14.233432 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m17:54:14.234172 [info ] [MainThread]: 
[0m17:54:14.234981 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:54:14.236898 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.087391, "process_user_time": 5.124285, "process_kernel_time": 0.836984, "process_mem_max_rss": "221112", "process_out_blocks": "2770", "command_success": false, "process_in_blocks": "0"}
[0m17:54:14.237974 [debug] [MainThread]: Command `dbt snapshot` failed at 17:54:14.237740 after 7.09 seconds
[0m17:54:14.238621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e9a73bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c1c70290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c19d3fb0>]}
[0m17:54:14.239328 [debug] [MainThread]: Flushing usage events
[0m17:55:08.474926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589b176e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589b9ab260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589c6945c0>]}


============================== 17:55:08.482098 | 8291b180-a1f9-4863-8221-adf80ae052b6 ==============================
[0m17:55:08.482098 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:55:08.483033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:55:09.556536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589ab59d60>]}
[0m17:55:09.629124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5883382210>]}
[0m17:55:09.630325 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:55:09.777529 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:55:10.043214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:10.056517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:10.116203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586efbcb00>]}
[0m17:55:10.265875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586edbac30>]}
[0m17:55:10.266606 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:55:10.267224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5894311850>]}
[0m17:55:10.269964 [info ] [MainThread]: 
[0m17:55:10.270958 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:55:10.272461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:55:10.294254 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:55:10.295000 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:55:10.295558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:11.299023 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.003 seconds
[0m17:55:11.301301 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:55:11.454539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m17:55:11.469270 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:55:11.470077 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:55:11.470822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:11.906835 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.436 seconds
[0m17:55:11.909294 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:55:12.056975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m17:55:12.061038 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:55:12.061826 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:55:12.062548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:12.552197 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.490 seconds
[0m17:55:12.555694 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:55:12.701416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586fe306b0>]}
[0m17:55:12.702744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:12.703644 [info ] [MainThread]: 
[0m17:55:12.715677 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m17:55:12.716633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m17:55:12.717437 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m17:55:12.730400 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m17:55:12.733354 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m17:55:12.734279 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m17:55:12.735159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m17:55:12.735958 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m17:55:12.740659 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m17:55:12.743057 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m17:55:12.743905 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m17:55:12.744670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m17:55:12.745859 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m17:55:12.750402 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m17:55:12.753078 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m17:55:12.753922 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m17:55:12.754758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m17:55:12.755459 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m17:55:12.759470 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m17:55:12.761753 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m17:55:12.762525 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m17:55:12.763186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m17:55:12.763871 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m17:55:12.767619 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m17:55:12.769875 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m17:55:12.771334 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m17:55:12.772263 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m17:55:12.773086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m17:55:12.773703 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m17:55:12.785194 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m17:55:12.787563 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m17:55:12.839620 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m17:55:12.850010 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m17:55:12.856724 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m17:55:12.859899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:14.615205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.755 seconds
[0m17:55:14.671888 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m17:55:14.818337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8291b180-a1f9-4863-8221-adf80ae052b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586f2aea20>]}
[0m17:55:14.819922 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.04s]
[0m17:55:14.821125 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m17:55:14.823914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:14.824615 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m17:55:14.825414 [info ] [MainThread]: 
[0m17:55:14.826175 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m17:55:14.827640 [debug] [MainThread]: Command end result
[0m17:55:14.892183 [info ] [MainThread]: 
[0m17:55:14.893043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:14.893767 [info ] [MainThread]: 
[0m17:55:14.894390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:55:14.895953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.488143, "process_user_time": 5.369087, "process_kernel_time": 0.906706, "process_mem_max_rss": "217404", "process_out_blocks": "1886", "process_in_blocks": "0"}
[0m17:55:14.896703 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:14.896559 after 6.49 seconds
[0m17:55:14.897316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589d48be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589a761160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589ae7ef30>]}
[0m17:55:14.898020 [debug] [MainThread]: Flushing usage events
[0m17:55:18.903874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ab0285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a9586330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a988efc0>]}


============================== 17:55:18.910044 | c4494c3c-7468-4c85-9ff6-cd7d155a4458 ==============================
[0m17:55:18.910044 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:55:18.910767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:55:19.865066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99aa4496a0>]}
[0m17:55:19.919495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9981b023f0>]}
[0m17:55:19.920515 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:55:20.043474 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:55:20.182950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:20.183478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:20.228878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99815cf500>]}
[0m17:55:20.400309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998135f9e0>]}
[0m17:55:20.401100 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:55:20.401797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4494c3c-7468-4c85-9ff6-cd7d155a4458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9981b254f0>]}
[0m17:55:20.403926 [info ] [MainThread]: 
[0m17:55:20.404550 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:55:20.406851 [debug] [MainThread]: Command end result
[0m17:55:20.455082 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6190332, "process_user_time": 3.969786, "process_kernel_time": 0.774335, "process_mem_max_rss": "212904", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m17:55:20.455712 [debug] [MainThread]: Command `dbt test` succeeded at 17:55:20.455600 after 1.62 seconds
[0m17:55:20.456205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a9e98a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a9522db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99aa2e16d0>]}
[0m17:55:20.456743 [debug] [MainThread]: Flushing usage events
[0m17:55:26.174824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce94a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce99d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccf35b3b0>]}


============================== 17:55:26.180668 | a3b5f857-e170-4e34-9c81-0d9dff34e3c3 ==============================
[0m17:55:26.180668 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:55:26.181681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:55:27.187446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2852510>]}
[0m17:55:27.241972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccdf243b0>]}
[0m17:55:27.242905 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:55:27.365737 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:55:27.503977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:27.504497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:27.549847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2cbfcb0>]}
[0m17:55:27.669784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2719580>]}
[0m17:55:27.670371 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m17:55:27.671058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2627440>]}
[0m17:55:27.673110 [info ] [MainThread]: 
[0m17:55:27.673866 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:55:27.675066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m17:55:27.693056 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m17:55:27.693607 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m17:55:27.694067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:29.147194 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.453 seconds
[0m17:55:29.149108 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m17:55:29.311375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m17:55:29.324267 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m17:55:29.325065 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m17:55:29.325854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:29.838537 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.513 seconds
[0m17:55:29.840709 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m17:55:30.058219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m17:55:30.065543 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m17:55:30.066699 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m17:55:30.067617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:30.517803 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.450 seconds
[0m17:55:30.520074 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m17:55:30.746569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca23e6cc0>]}
[0m17:55:30.747453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:30.748004 [info ] [MainThread]: 
[0m17:55:30.756655 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:55:30.757411 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m17:55:30.758179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m17:55:30.758795 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m17:55:30.769053 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m17:55:30.868317 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m17:55:30.869354 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m17:55:30.870032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:31.371714 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb9f53-0304-efe8-0004-59ff001dcd92
[0m17:55:31.372496 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'TS'
[0m17:55:31.373223 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m17:55:31.546991 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m17:55:31.548846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3b5f857-e170-4e34-9c81-0d9dff34e3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca1b7fdd0>]}
[0m17:55:31.550006 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 0.79s]
[0m17:55:31.551144 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m17:55:31.554273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:31.554855 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m17:55:31.555414 [info ] [MainThread]: 
[0m17:55:31.555986 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m17:55:31.556866 [debug] [MainThread]: Command end result
[0m17:55:31.610951 [info ] [MainThread]: 
[0m17:55:31.611583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:31.612056 [info ] [MainThread]: 
[0m17:55:31.612805 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m17:55:31.613297 [info ] [MainThread]: 
[0m17:55:31.613892 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:55:31.615021 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.5061603, "process_user_time": 4.404809, "process_kernel_time": 0.866931, "process_mem_max_rss": "219368", "process_out_blocks": "1853", "command_success": false, "process_in_blocks": "0"}
[0m17:55:31.615759 [debug] [MainThread]: Command `dbt snapshot` failed at 17:55:31.615642 after 5.51 seconds
[0m17:55:31.616307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcce977e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd1eba2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2829880>]}
[0m17:55:31.616862 [debug] [MainThread]: Flushing usage events
[0m17:56:43.238531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383e3a2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383f135790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383e61ffb0>]}


============================== 17:56:43.246106 | 4953d818-6b4c-4cd8-89ec-4c7757803c48 ==============================
[0m17:56:43.246106 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:56:43.247006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:56:44.300754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4953d818-6b4c-4cd8-89ec-4c7757803c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3814df6db0>]}
[0m17:56:44.358701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4953d818-6b4c-4cd8-89ec-4c7757803c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383cd2a3c0>]}
[0m17:56:44.359736 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:56:44.486945 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:56:44.657023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:44.658063 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m17:56:44.836416 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_session_summary (snapshots/snapshot_session_summary.sql)
  invalid syntax for function call expression
    line 3
      config(
[0m17:56:44.837535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6712099, "process_user_time": 4.398362, "process_kernel_time": 0.825021, "process_mem_max_rss": "210444", "process_in_blocks": "16", "process_out_blocks": "21", "command_success": false}
[0m17:56:44.838433 [debug] [MainThread]: Command `dbt run` failed at 17:56:44.838318 after 1.67 seconds
[0m17:56:44.838968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383d40aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3814d25880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38148587d0>]}
[0m17:56:44.839515 [debug] [MainThread]: Flushing usage events
[0m17:57:29.538789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa08ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48adb100e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa4a8d70>]}


============================== 17:57:29.546726 | 9e0d62b4-7b31-4e6a-9d26-59c49dff6f48 ==============================
[0m17:57:29.546726 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:57:29.547898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/lab2_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:57:30.880073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e0d62b4-7b31-4e6a-9d26-59c49dff6f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48822643e0>]}
[0m17:57:30.948983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e0d62b4-7b31-4e6a-9d26-59c49dff6f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa6e9970>]}
[0m17:57:30.950184 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:57:31.091514 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:57:31.268938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:31.269854 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m17:57:31.484948 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: A snapshot configured with the check strategy must specify a check_cols configuration.
[0m17:57:31.486806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0166278, "process_user_time": 4.581082, "process_kernel_time": 0.773429, "process_mem_max_rss": "210220", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m17:57:31.487602 [debug] [MainThread]: Command `dbt run` failed at 17:57:31.487465 after 2.02 seconds
[0m17:57:31.488364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa4a8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa5eb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48aa001eb0>]}
[0m17:57:31.489098 [debug] [MainThread]: Flushing usage events
[0m18:00:48.535361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e395de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e5437d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e3355310>]}


============================== 18:00:48.542856 | c0b79c99-6053-4ab5-aa1e-85496426f245 ==============================
[0m18:00:48.542856 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:00:48.543807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:00:49.637115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e4c466c0>]}
[0m18:00:49.694931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01bcf91940>]}
[0m18:00:49.695913 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:00:49.816990 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:00:49.969993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:49.970930 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://snapshots/snapshot_session_summary.sql
[0m18:00:50.260802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b7415220>]}
[0m18:00:50.408501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b7891af0>]}
[0m18:00:50.409242 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:00:50.409879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e3377a10>]}
[0m18:00:50.412526 [info ] [MainThread]: 
[0m18:00:50.413613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:50.415473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m18:00:50.439420 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m18:00:50.440212 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m18:00:50.440830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:51.693304 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.252 seconds
[0m18:00:51.696018 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m18:00:52.057119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m18:00:52.071793 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m18:00:52.072598 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m18:00:52.073299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:52.744422 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.671 seconds
[0m18:00:52.747624 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m18:00:53.107086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m18:00:53.111652 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m18:00:53.112471 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m18:00:53.113263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:53.797908 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.685 seconds
[0m18:00:53.800821 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m18:00:54.061898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b73c32c0>]}
[0m18:00:54.063020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:54.063792 [info ] [MainThread]: 
[0m18:00:54.075812 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m18:00:54.076749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m18:00:54.077561 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m18:00:54.091250 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m18:00:54.094533 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m18:00:54.095464 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m18:00:54.096344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m18:00:54.097004 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m18:00:54.101212 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m18:00:54.103710 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m18:00:54.104671 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m18:00:54.105491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m18:00:54.106163 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m18:00:54.110093 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m18:00:54.112899 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m18:00:54.113953 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m18:00:54.115297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m18:00:54.116557 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m18:00:54.121186 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m18:00:54.124494 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m18:00:54.125376 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m18:00:54.126105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m18:00:54.126995 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m18:00:54.131200 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m18:00:54.133992 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m18:00:54.136050 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m18:00:54.137097 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m18:00:54.137953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m18:00:54.138642 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m18:00:54.152732 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m18:00:54.155425 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m18:00:54.202514 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m18:00:54.208300 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m18:00:54.209350 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m18:00:54.210366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:56.421634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.211 seconds
[0m18:00:56.463019 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m18:00:56.785418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b79c99-6053-4ab5-aa1e-85496426f245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e3f519a0>]}
[0m18:00:56.787039 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.65s]
[0m18:00:56.788608 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m18:00:56.791685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:56.792451 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m18:00:56.793247 [info ] [MainThread]: 
[0m18:00:56.794042 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.38 seconds (6.38s).
[0m18:00:56.795497 [debug] [MainThread]: Command end result
[0m18:00:56.861852 [info ] [MainThread]: 
[0m18:00:56.862877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:56.863725 [info ] [MainThread]: 
[0m18:00:56.864499 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:00:56.865841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.40162, "process_user_time": 5.07091, "process_kernel_time": 0.679686, "process_mem_max_rss": "219736", "process_out_blocks": "2803", "process_in_blocks": "0"}
[0m18:00:56.866641 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:56.866486 after 8.40 seconds
[0m18:00:56.867378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e395de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01e39b60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b6974ce0>]}
[0m18:00:56.868027 [debug] [MainThread]: Flushing usage events
[0m18:01:01.557085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1267011c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb126703140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1296753a0>]}


============================== 18:01:01.564903 | 26a85b92-16ff-4d86-83e2-bd084402f344 ==============================
[0m18:01:01.564903 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:01:01.565877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:02.619362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb125b060f0>]}
[0m18:01:02.678728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb126de0e30>]}
[0m18:01:02.679670 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:01:02.805996 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:01:02.952414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:02.952961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:03.001790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fe46cef0>]}
[0m18:01:03.142266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fdc93fe0>]}
[0m18:01:03.142942 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:01:03.143523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a85b92-16ff-4d86-83e2-bd084402f344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fdffc980>]}
[0m18:01:03.145519 [info ] [MainThread]: 
[0m18:01:03.146187 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:01:03.148515 [debug] [MainThread]: Command end result
[0m18:01:03.196300 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7097229, "process_user_time": 4.099531, "process_kernel_time": 0.840263, "process_mem_max_rss": "212320", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m18:01:03.196955 [debug] [MainThread]: Command `dbt test` succeeded at 18:01:03.196845 after 1.71 seconds
[0m18:01:03.197490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb125b04f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fe76f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1103716d0>]}
[0m18:01:03.197958 [debug] [MainThread]: Flushing usage events
[0m18:01:07.186274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e52c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e52f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e52ed20>]}


============================== 18:01:07.195285 | ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8 ==============================
[0m18:01:07.195285 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:01:07.196444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:01:08.275155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59317ae70>]}
[0m18:01:08.334789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59eb2e660>]}
[0m18:01:08.335734 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:01:08.471730 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:01:08.658935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:08.659910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:08.720213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe575a0f5f0>]}
[0m18:01:08.877880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57554cbf0>]}
[0m18:01:08.878726 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:01:08.879775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe575442f00>]}
[0m18:01:08.882508 [info ] [MainThread]: 
[0m18:01:08.884607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:08.886484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m18:01:08.908935 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m18:01:08.909775 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m18:01:08.910415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:10.288445 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.378 seconds
[0m18:01:10.291825 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m18:01:10.796073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m18:01:10.810645 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m18:01:10.811503 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m18:01:10.812287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:11.662737 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.850 seconds
[0m18:01:11.666093 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m18:01:11.985161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m18:01:11.990621 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m18:01:11.991447 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m18:01:11.992231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:12.652655 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.660 seconds
[0m18:01:12.655706 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m18:01:13.022620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe576ec89b0>]}
[0m18:01:13.023913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:13.024683 [info ] [MainThread]: 
[0m18:01:13.036878 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m18:01:13.037967 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m18:01:13.039149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m18:01:13.039861 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m18:01:13.056419 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m18:01:13.186558 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:01:13.187631 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:01:13.188534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:13.939014 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.750 seconds
[0m18:01:13.944895 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:01:13.946033 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:01:14.089604 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.143 seconds
[0m18:01:14.091081 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:01:14.096140 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:01:14.097060 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace transient table user_db_lobster1.snapshot.snapshot_session_summary
         as
        (
    

    select *,
        md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) sbq



        );
[0m18:01:15.140819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.043 seconds
[0m18:01:15.184969 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m18:01:15.657410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce6c0cf7-bf3e-4c8f-9e43-ad3bc8d0e8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe575a42720>]}
[0m18:01:15.659480 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 1[0m in 2.62s]
[0m18:01:15.660879 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m18:01:15.663873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:15.664546 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m18:01:15.665261 [info ] [MainThread]: 
[0m18:01:15.666117 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.78 seconds (6.78s).
[0m18:01:15.667467 [debug] [MainThread]: Command end result
[0m18:01:15.737288 [info ] [MainThread]: 
[0m18:01:15.738260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:15.739119 [info ] [MainThread]: 
[0m18:01:15.739988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:01:15.741533 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.633961, "process_user_time": 4.867982, "process_kernel_time": 0.830086, "process_mem_max_rss": "217816", "process_out_blocks": "1858", "process_in_blocks": "0"}
[0m18:01:15.742740 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:01:15.742397 after 8.64 seconds
[0m18:01:15.743486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe576182ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59d661ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59d699040>]}
[0m18:01:15.744327 [debug] [MainThread]: Flushing usage events
[0m18:06:35.919192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc631d9e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc631d9fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc632074bf0>]}


============================== 18:06:35.927675 | b5002bc6-68de-4797-b966-153f788f587a ==============================
[0m18:06:35.927675 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:35.929100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:36.990670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60a9041a0>]}
[0m18:06:37.073096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc631de63c0>]}
[0m18:06:37.074670 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:06:37.242966 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:06:37.443873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:37.444734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:37.504722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc609ec0290>]}
[0m18:06:37.667133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc609ec1760>]}
[0m18:06:37.667857 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:06:37.668519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc609b94b00>]}
[0m18:06:37.670791 [info ] [MainThread]: 
[0m18:06:37.671718 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:37.673159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m18:06:37.697337 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m18:06:37.698146 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m18:06:37.698826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:38.840267 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.141 seconds
[0m18:06:38.843477 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m18:06:39.178866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_snapshot)
[0m18:06:39.194971 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m18:06:39.195717 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m18:06:39.196399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:40.075740 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.879 seconds
[0m18:06:40.079145 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m18:06:40.402422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now list_user_db_lobster1_analytics)
[0m18:06:40.406215 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m18:06:40.406801 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m18:06:40.407303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:41.154850 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.747 seconds
[0m18:06:41.158050 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m18:06:41.451620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60932c290>]}
[0m18:06:41.453057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:41.453849 [info ] [MainThread]: 
[0m18:06:41.465575 [debug] [Thread-1 (]: Began running node model.lab2_dbt.gap_analysis
[0m18:06:41.466530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now model.lab2_dbt.gap_analysis)
[0m18:06:41.467556 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.gap_analysis
[0m18:06:41.481978 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.gap_analysis"
[0m18:06:41.485477 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.gap_analysis
[0m18:06:41.486425 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average
[0m18:06:41.487326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.gap_analysis, now model.lab2_dbt.moving_average)
[0m18:06:41.488063 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average
[0m18:06:41.492415 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average"
[0m18:06:41.495420 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average
[0m18:06:41.496549 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rolling_volatality
[0m18:06:41.497451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average, now model.lab2_dbt.rolling_volatality)
[0m18:06:41.498278 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rolling_volatality
[0m18:06:41.502571 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rolling_volatality"
[0m18:06:41.505254 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rolling_volatality
[0m18:06:41.506092 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi
[0m18:06:41.507031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rolling_volatality, now model.lab2_dbt.rsi)
[0m18:06:41.507888 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi
[0m18:06:41.512791 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi"
[0m18:06:41.515910 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi
[0m18:06:41.516906 [debug] [Thread-1 (]: Began running node model.lab2_dbt.volatility
[0m18:06:41.517783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.rsi, now model.lab2_dbt.volatility)
[0m18:06:41.518532 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.volatility
[0m18:06:41.522976 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.volatility"
[0m18:06:41.526045 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.volatility
[0m18:06:41.527700 [debug] [Thread-1 (]: Began running node model.lab2_dbt.session_summary
[0m18:06:41.528670 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m18:06:41.529530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.volatility, now model.lab2_dbt.session_summary)
[0m18:06:41.530338 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.session_summary
[0m18:06:41.542631 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.session_summary"
[0m18:06:41.545416 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.session_summary
[0m18:06:41.592312 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.session_summary"
[0m18:06:41.598110 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.session_summary"
[0m18:06:41.599149 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.session_summary"} */
create or replace transient table user_db_lobster1.analytics.session_summary
         as
        (with __dbt__cte__moving_average as (
select 
date,
symbol,
avg(close) over(partition by symbol order by date rows between 9 preceding and current row) as ma_10
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__gap_analysis as (
select 
date,
symbol,
open - lag(close) over(partition by symbol order by date) as Gap,
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__volatility as (
select
date,
symbol,
high - low as volatality
from USER_DB_LOBSTER1.raw.market_price
),  __dbt__cte__rolling_volatality as (
with deviation as (
select
date,
symbol,
(close/lag(close) over(partition by symbol order by date) - 1) as deviation
from USER_DB_LOBSTER1.raw.market_price
)
select
date,
symbol,
stddev(deviation) over(partition by symbol order by date  rows between 13 preceding and current row) as rolling_volatality 
from deviation
),  __dbt__cte__rsi as (
with delta_close as(
select
date,
symbol,
close - lag(close) over(partition by symbol order by date) as delta
from USER_DB_LOBSTER1.raw.market_price
),
gain_and_loss as (
select 
date,
symbol,
case when delta > 0  then delta else 0 end as gain,
case when delta < 0 then abs(delta) else 0 end as lose 
from delta_close
),
rs as (
select 
date,
symbol,
avg(gain) over(partition by symbol order by date rows between 13 preceding and current row) as avg_gain,
avg(lose) over(partition by symbol order by date rows between 13 preceding and current row) as avg_loss
from gain_and_loss
)
select
date,
symbol,
round(100 - 100/(1 + (avg_gain/nullif(avg_loss,0)))) as rsi
from rs
) SELECT ma.date,ma.symbol,ma.ma_10,gap.Gap,v.volatality,rv.rolling_volatality,rsi.rsi
FROM __dbt__cte__moving_average ma
JOIN __dbt__cte__gap_analysis gap on ma.date = gap.date and ma.symbol = gap.symbol
join __dbt__cte__volatility v on v.date = ma.date and v.symbol = ma.symbol
join __dbt__cte__rolling_volatality rv on rv.date = ma.date and rv.symbol = ma.symbol
join __dbt__cte__rsi rsi on rsi.date = ma.date and rsi.symbol = ma.symbol
        );
[0m18:06:41.600266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:43.400386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.800 seconds
[0m18:06:43.442208 [debug] [Thread-1 (]: On model.lab2_dbt.session_summary: Close
[0m18:06:43.934353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5002bc6-68de-4797-b966-153f788f587a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60a186990>]}
[0m18:06:43.935658 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.40s]
[0m18:06:43.937046 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.session_summary
[0m18:06:43.939937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:43.940623 [debug] [MainThread]: Connection 'model.lab2_dbt.session_summary' was properly closed.
[0m18:06:43.941441 [info ] [MainThread]: 
[0m18:06:43.942392 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.27 seconds (6.27s).
[0m18:06:43.943983 [debug] [MainThread]: Command end result
[0m18:06:44.010412 [info ] [MainThread]: 
[0m18:06:44.011915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:44.013016 [info ] [MainThread]: 
[0m18:06:44.014111 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:06:44.015483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.171677, "process_user_time": 4.853146, "process_kernel_time": 0.849038, "process_mem_max_rss": "217368", "process_out_blocks": "1886", "process_in_blocks": "0"}
[0m18:06:44.016418 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:44.016264 after 8.17 seconds
[0m18:06:44.017075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc632074bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc632006d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6333fc1d0>]}
[0m18:06:44.017720 [debug] [MainThread]: Flushing usage events
[0m18:06:48.215623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09f6fd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09f739fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0a0118560>]}


============================== 18:06:48.223263 | 20c2be2e-1588-48ad-b2be-cb0ffa4b03c2 ==============================
[0m18:06:48.223263 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:48.224194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/lab2_dbt', 'log_path': '/opt/airflow/lab2_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:49.296496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb073ee7a70>]}
[0m18:06:49.353992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09f73a420>]}
[0m18:06:49.355001 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:06:49.478161 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:06:49.628926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:49.629498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:49.676156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0736bfa40>]}
[0m18:06:49.816083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb073243bf0>]}
[0m18:06:49.816909 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:06:49.817612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20c2be2e-1588-48ad-b2be-cb0ffa4b03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb087194a70>]}
[0m18:06:49.819903 [info ] [MainThread]: 
[0m18:06:49.820529 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:06:49.823060 [debug] [MainThread]: Command end result
[0m18:06:49.874083 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7290015, "process_user_time": 4.303706, "process_kernel_time": 0.674047, "process_mem_max_rss": "212172", "process_out_blocks": "1832", "process_in_blocks": "0"}
[0m18:06:49.874938 [debug] [MainThread]: Command `dbt test` succeeded at 18:06:49.874820 after 1.73 seconds
[0m18:06:49.875490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09f6fd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0a128fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb073a82930>]}
[0m18:06:49.876115 [debug] [MainThread]: Flushing usage events
[0m18:06:54.139406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbb3ac050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbbb90230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbbf63e60>]}


============================== 18:06:54.147323 | c5705774-8ef5-46e7-8ea0-b290dfd66cef ==============================
[0m18:06:54.147323 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:54.148237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/lab2_dbt/logs', 'profiles_dir': '/opt/airflow/lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/lab2_dbt --project-dir /opt/airflow/lab2_dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:55.326787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbb3ce570>]}
[0m18:06:55.401072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbbf436e0>]}
[0m18:06:55.402191 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:06:55.557157 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:06:55.741426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:55.742165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:55.802240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8f925280>]}
[0m18:06:55.956812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8f7c5640>]}
[0m18:06:55.957597 [info ] [MainThread]: Found 6 models, 1 snapshot, 1 source, 459 macros
[0m18:06:55.958315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8f488710>]}
[0m18:06:55.960627 [info ] [MainThread]: 
[0m18:06:55.961515 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:55.962991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_user_db_lobster1'
[0m18:06:55.985360 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1"
[0m18:06:55.986139 [debug] [ThreadPool]: On list_user_db_lobster1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1"} */
show terse schemas in database user_db_lobster1
    limit 10000
[0m18:06:55.986810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:57.253558 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.267 seconds
[0m18:06:57.256639 [debug] [ThreadPool]: On list_user_db_lobster1: Close
[0m18:06:57.582900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1, now list_user_db_lobster1_analytics)
[0m18:06:57.598666 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_analytics"
[0m18:06:57.599525 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_analytics"} */
show objects in user_db_lobster1.analytics limit 10000
[0m18:06:57.600218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:58.450221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.850 seconds
[0m18:06:58.453470 [debug] [ThreadPool]: On list_user_db_lobster1_analytics: Close
[0m18:06:58.774655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_user_db_lobster1_analytics, now list_user_db_lobster1_snapshot)
[0m18:06:58.781017 [debug] [ThreadPool]: Using snowflake connection "list_user_db_lobster1_snapshot"
[0m18:06:58.781856 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_user_db_lobster1_snapshot"} */
show objects in user_db_lobster1.snapshot limit 10000
[0m18:06:58.782579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:59.642228 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.860 seconds
[0m18:06:59.645342 [debug] [ThreadPool]: On list_user_db_lobster1_snapshot: Close
[0m18:07:00.006252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8ec29760>]}
[0m18:07:00.007637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:00.008526 [info ] [MainThread]: 
[0m18:07:00.022425 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.snapshot_session_summary
[0m18:07:00.023620 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m18:07:00.024917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_user_db_lobster1_snapshot, now snapshot.lab2_dbt.snapshot_session_summary)
[0m18:07:00.025657 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.snapshot_session_summary
[0m18:07:00.040116 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.snapshot_session_summary
[0m18:07:00.136273 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:00.137161 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

SELECT * FROM user_db_lobster1.analytics.session_summary
    ) as __dbt_sbq
    where false
    limit 0
[0m18:07:00.137874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:01.076280 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.938 seconds
[0m18:07:01.098609 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:01.100091 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m18:07:01.407598 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.306 seconds
[0m18:07:01.422263 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:01.423275 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m18:07:01.586838 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.163 seconds
[0m18:07:01.666007 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:01.667786 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
create or replace temporary table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:07:02.777497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.108 seconds
[0m18:07:02.783924 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:02.785030 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m18:07:02.900817 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.115 seconds
[0m18:07:02.907498 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:02.908392 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m18:07:03.037501 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.128 seconds
[0m18:07:03.043695 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.044687 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m18:07:03.149215 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.104 seconds
[0m18:07:03.155714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.156688 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m18:07:03.257144 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m18:07:03.268673 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.269568 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
describe table "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m18:07:03.365646 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.095 seconds
[0m18:07:03.405025 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.407035 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        

    with snapshot_query as (

        

SELECT * FROM user_db_lobster1.analytics.session_summary

    ),

    snapshotted_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    

        from "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || '_' || TO_VARCHAR(date) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        symbol || '_' || TO_VARCHAR(date) as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."DATE" != source_data."DATE"
        or
        (
            ((snapshotted_data."DATE" is null) and not (source_data."DATE" is null))
            or
            ((not snapshotted_data."DATE" is null) and (source_data."DATE" is null))
        ) or snapshotted_data."SYMBOL" != source_data."SYMBOL"
        or
        (
            ((snapshotted_data."SYMBOL" is null) and not (source_data."SYMBOL" is null))
            or
            ((not snapshotted_data."SYMBOL" is null) and (source_data."SYMBOL" is null))
        ) or snapshotted_data."MA_10" != source_data."MA_10"
        or
        (
            ((snapshotted_data."MA_10" is null) and not (source_data."MA_10" is null))
            or
            ((not snapshotted_data."MA_10" is null) and (source_data."MA_10" is null))
        ) or snapshotted_data."GAP" != source_data."GAP"
        or
        (
            ((snapshotted_data."GAP" is null) and not (source_data."GAP" is null))
            or
            ((not snapshotted_data."GAP" is null) and (source_data."GAP" is null))
        ) or snapshotted_data."VOLATALITY" != source_data."VOLATALITY"
        or
        (
            ((snapshotted_data."VOLATALITY" is null) and not (source_data."VOLATALITY" is null))
            or
            ((not snapshotted_data."VOLATALITY" is null) and (source_data."VOLATALITY" is null))
        ) or snapshotted_data."ROLLING_VOLATALITY" != source_data."ROLLING_VOLATALITY"
        or
        (
            ((snapshotted_data."ROLLING_VOLATALITY" is null) and not (source_data."ROLLING_VOLATALITY" is null))
            or
            ((not snapshotted_data."ROLLING_VOLATALITY" is null) and (source_data."ROLLING_VOLATALITY" is null))
        ) or snapshotted_data."RSI" != source_data."RSI"
        or
        (
            ((snapshotted_data."RSI" is null) and not (source_data."RSI" is null))
            or
            ((not snapshotted_data."RSI" is null) and (source_data."RSI" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:07:03.715192 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.306 seconds
[0m18:07:03.721260 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.722088 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:07:03.843528 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.121 seconds
[0m18:07:03.844948 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.848257 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.849080 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
BEGIN
[0m18:07:03.964746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m18:07:03.965917 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:03.967001 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
merge into "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "USER_DB_LOBSTER1"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "MA_10", "GAP", "VOLATALITY", "ROLLING_VOLATALITY", "RSI", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:07:04.642124 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.674 seconds
[0m18:07:04.643094 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.snapshot_session_summary"
[0m18:07:04.644035 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.snapshot_session_summary"} */
COMMIT
[0m18:07:05.460578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m18:07:05.488119 [debug] [Thread-1 (]: On snapshot.lab2_dbt.snapshot_session_summary: Close
[0m18:07:05.686519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5705774-8ef5-46e7-8ea0-b290dfd66cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8fa82870>]}
[0m18:07:05.688180 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 0[0m in 5.66s]
[0m18:07:05.689445 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.snapshot_session_summary
[0m18:07:05.692519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:05.693238 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.snapshot_session_summary' was properly closed.
[0m18:07:05.693886 [info ] [MainThread]: 
[0m18:07:05.694617 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m18:07:05.696036 [debug] [MainThread]: Command end result
[0m18:07:05.759610 [info ] [MainThread]: 
[0m18:07:05.760459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:05.761256 [info ] [MainThread]: 
[0m18:07:05.762086 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:07:05.763449 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.696003, "process_user_time": 5.299479, "process_kernel_time": 0.792273, "process_mem_max_rss": "218172", "process_out_blocks": "1897", "process_in_blocks": "0"}
[0m18:07:05.764299 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:07:05.764163 after 11.70 seconds
[0m18:07:05.764897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbf447ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbb97da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8f533ef0>]}
[0m18:07:05.765481 [debug] [MainThread]: Flushing usage events
[0m11:13:10.337618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b18b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446fbc0>]}


============================== 11:13:10.343705 | 3115ad8d-a733-42d9-b631-474a7db14f35 ==============================
[0m11:13:10.343705 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:13:10.344416 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'profiles_dir': '/Users/user/Desktop/airflow_setup/lab2_dbt', 'warn_error': 'None', 'introspect': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m11:13:10.351070 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m11:13:10.353141 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.08685418, "process_in_blocks": "0", "process_kernel_time": 0.223543, "process_mem_max_rss": "102809600", "process_out_blocks": "0", "process_user_time": 1.51656}
[0m11:13:10.353949 [debug] [MainThread]: Command `dbt docs serve` failed at 11:13:10.353802 after 0.09 seconds
[0m11:13:10.354399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499fec0>]}
[0m11:13:10.354871 [debug] [MainThread]: Flushing usage events
[0m11:13:10.719764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:00.839558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110506630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058bd70>]}


============================== 11:15:00.846310 | 6d25925f-d21b-4b96-b204-1bb8d386f5d6 ==============================
[0m11:15:00.846310 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:15:00.847046 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve --port 8085', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/user/Desktop/airflow_setup/lab2_dbt/logs', 'profiles_dir': '/Users/user/Desktop/airflow_setup/lab2_dbt', 'warn_error': 'None', 'empty': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:15:00.853085 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m11:15:00.855472 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.09653288, "process_in_blocks": "0", "process_kernel_time": 0.443381, "process_mem_max_rss": "103596032", "process_out_blocks": "0", "process_user_time": 1.847504}
[0m11:15:00.856306 [debug] [MainThread]: Command `dbt docs serve` failed at 11:15:00.856148 after 0.10 seconds
[0m11:15:00.856803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110506630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107685f0>]}
[0m11:15:00.857291 [debug] [MainThread]: Flushing usage events
[0m11:15:01.248914 [debug] [MainThread]: An error was encountered while trying to flush usage events
